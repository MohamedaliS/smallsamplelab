<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.24">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>3&nbsp; Part C: Analysis Methods â€“ Quantitative Analysis with Small Samples</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../chapters/part-d-reporting.html" rel="next">
<link href="../chapters/part-b-data-collection.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dc55a5b9e770e841cd82e46aadbfb9b0.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-fc52e084097f5e82659c47ea4c4460c4.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../chapters/part-c-analysis-methods.html">Part C: Analysis Methods</a></li><li class="breadcrumb-item"><a href="../chapters/part-c-analysis-methods.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Part C: Analysis Methods</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="../index.html" class="sidebar-logo-link">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Quantitative Analysis with Small Samples</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Part A: Foundations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/part-a-foundations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Part A: Foundations</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Part B: Data Collection and Preparation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/part-b-data-collection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Part B: Data Collection and Preparation</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Part C: Analysis Methods</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/part-c-analysis-methods.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Part C: Analysis Methods</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Part D: Reporting and Interpretation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/part-d-reporting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Part D: Reporting and Interpretation</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Part E: Worked Projects</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/part-e-worked-projects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Part E: Worked Projects</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">Part F: Technical Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/part-f-technical-appendices.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Part F: Technical Appendices</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">Part G: Guided Lab Practicals</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/part-g-lab-practicals.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part G: Guided Lab Practicals</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true">
 <span class="menu-text">Part H: Instructorâ€™s Manual</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/part-h-instructors-manual.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Part H: Instructorâ€™s Manual</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#chapter-3.-exact-tests-and-resampling-methods" id="toc-chapter-3.-exact-tests-and-resampling-methods" class="nav-link active" data-scroll-target="#chapter-3.-exact-tests-and-resampling-methods"><span class="header-section-number">3.1</span> Chapter 3. Exact Tests and Resampling Methods</a>
  <ul class="collapse">
  <li><a href="#learning-objectives" id="toc-learning-objectives" class="nav-link" data-scroll-target="#learning-objectives"><span class="header-section-number">3.1.1</span> Learning Objectives</a></li>
  <li><a href="#when-to-use-exact-and-resampling-methods" id="toc-when-to-use-exact-and-resampling-methods" class="nav-link" data-scroll-target="#when-to-use-exact-and-resampling-methods"><span class="header-section-number">3.1.2</span> When to Use Exact and Resampling Methods</a></li>
  <li><a href="#fishers-exact-test-for-22-tables" id="toc-fishers-exact-test-for-22-tables" class="nav-link" data-scroll-target="#fishers-exact-test-for-22-tables"><span class="header-section-number">3.1.3</span> Fisherâ€™s Exact Test for 2Ã—2 Tables</a></li>
  <li><a href="#example-fishers-exact-test" id="toc-example-fishers-exact-test" class="nav-link" data-scroll-target="#example-fishers-exact-test"><span class="header-section-number">3.1.4</span> Example: Fisherâ€™s Exact Test</a></li>
  <li><a href="#when-fishers-exact-test-is-overly-conservative" id="toc-when-fishers-exact-test-is-overly-conservative" class="nav-link" data-scroll-target="#when-fishers-exact-test-is-overly-conservative"><span class="header-section-number">3.1.5</span> When Fisherâ€™s Exact Test Is Overly Conservative</a></li>
  <li><a href="#barnards-exact-test" id="toc-barnards-exact-test" class="nav-link" data-scroll-target="#barnards-exact-test"><span class="header-section-number">3.1.6</span> Barnardâ€™s Exact Test</a></li>
  <li><a href="#mid-p-corrections-for-exact-tests" id="toc-mid-p-corrections-for-exact-tests" class="nav-link" data-scroll-target="#mid-p-corrections-for-exact-tests"><span class="header-section-number">3.1.7</span> Mid-p Corrections for Exact Tests</a></li>
  <li><a href="#exact-binomial-test" id="toc-exact-binomial-test" class="nav-link" data-scroll-target="#exact-binomial-test"><span class="header-section-number">3.1.8</span> Exact Binomial Test</a></li>
  <li><a href="#example-exact-binomial-test" id="toc-example-exact-binomial-test" class="nav-link" data-scroll-target="#example-exact-binomial-test"><span class="header-section-number">3.1.9</span> Example: Exact Binomial Test</a></li>
  <li><a href="#exact-poisson-test" id="toc-exact-poisson-test" class="nav-link" data-scroll-target="#exact-poisson-test"><span class="header-section-number">3.1.10</span> Exact Poisson Test</a></li>
  <li><a href="#example-exact-poisson-test" id="toc-example-exact-poisson-test" class="nav-link" data-scroll-target="#example-exact-poisson-test"><span class="header-section-number">3.1.11</span> Example: Exact Poisson Test</a></li>
  <li><a href="#permutation-tests" id="toc-permutation-tests" class="nav-link" data-scroll-target="#permutation-tests"><span class="header-section-number">3.1.12</span> Permutation Tests</a></li>
  <li><a href="#example-permutation-test-for-difference-in-means" id="toc-example-permutation-test-for-difference-in-means" class="nav-link" data-scroll-target="#example-permutation-test-for-difference-in-means"><span class="header-section-number">3.1.13</span> Example: Permutation Test for Difference in Means</a></li>
  <li><a href="#bootstrap-confidence-intervals" id="toc-bootstrap-confidence-intervals" class="nav-link" data-scroll-target="#bootstrap-confidence-intervals"><span class="header-section-number">3.1.14</span> Bootstrap Confidence Intervals</a></li>
  <li><a href="#example-bootstrap-ci-for-the-median" id="toc-example-bootstrap-ci-for-the-median" class="nav-link" data-scroll-target="#example-bootstrap-ci-for-the-median"><span class="header-section-number">3.1.15</span> Example: Bootstrap CI for the Median</a></li>
  </ul></li>
  <li><a href="#lab-practical-3.1-exact-tests-step-by-step" id="toc-lab-practical-3.1-exact-tests-step-by-step" class="nav-link" data-scroll-target="#lab-practical-3.1-exact-tests-step-by-step"><span class="header-section-number">3.2</span> Lab Practical 3.1: Exact Tests Step-by-Step</a>
  <ul class="collapse">
  <li><a href="#step-1-set-up-your-data" id="toc-step-1-set-up-your-data" class="nav-link" data-scroll-target="#step-1-set-up-your-data"><span class="header-section-number">3.2.1</span> Step 1: Set Up Your Data</a></li>
  <li><a href="#step-2-run-fishers-exact-test" id="toc-step-2-run-fishers-exact-test" class="nav-link" data-scroll-target="#step-2-run-fishers-exact-test"><span class="header-section-number">3.2.2</span> Step 2: Run Fisherâ€™s Exact Test</a></li>
  <li><a href="#step-3-interpret" id="toc-step-3-interpret" class="nav-link" data-scroll-target="#step-3-interpret"><span class="header-section-number">3.2.3</span> Step 3: Interpret</a></li>
  <li><a href="#step-4-compare-with-chi-square" id="toc-step-4-compare-with-chi-square" class="nav-link" data-scroll-target="#step-4-compare-with-chi-square"><span class="header-section-number">3.2.4</span> Step 4: Compare with Chi-Square</a></li>
  <li><a href="#self-assessment-quiz" id="toc-self-assessment-quiz" class="nav-link" data-scroll-target="#self-assessment-quiz"><span class="header-section-number">3.2.5</span> Self-Assessment Quiz</a></li>
  <li><a href="#key-takeaways" id="toc-key-takeaways" class="nav-link" data-scroll-target="#key-takeaways"><span class="header-section-number">3.2.6</span> Key Takeaways</a></li>
  <li><a href="#smoke-test" id="toc-smoke-test" class="nav-link" data-scroll-target="#smoke-test"><span class="header-section-number">3.2.7</span> Smoke Test</a></li>
  </ul></li>
  <li><a href="#chapter-4.-nonparametric-rank-based-methods" id="toc-chapter-4.-nonparametric-rank-based-methods" class="nav-link" data-scroll-target="#chapter-4.-nonparametric-rank-based-methods"><span class="header-section-number">3.3</span> Chapter 4. Nonparametric Rank-Based Methods</a>
  <ul class="collapse">
  <li><a href="#learning-objectives-1" id="toc-learning-objectives-1" class="nav-link" data-scroll-target="#learning-objectives-1"><span class="header-section-number">3.3.1</span> Learning Objectives</a></li>
  <li><a href="#when-to-use-rank-based-methods" id="toc-when-to-use-rank-based-methods" class="nav-link" data-scroll-target="#when-to-use-rank-based-methods"><span class="header-section-number">3.3.2</span> When to Use Rank-Based Methods</a></li>
  <li><a href="#mannwhitney-u-test-wilcoxon-rank-sum-test" id="toc-mannwhitney-u-test-wilcoxon-rank-sum-test" class="nav-link" data-scroll-target="#mannwhitney-u-test-wilcoxon-rank-sum-test"><span class="header-section-number">3.3.3</span> Mannâ€“Whitney U Test (Wilcoxon Rank-Sum Test)</a></li>
  <li><a href="#example-mannwhitney-u-test" id="toc-example-mannwhitney-u-test" class="nav-link" data-scroll-target="#example-mannwhitney-u-test"><span class="header-section-number">3.3.4</span> Example: Mannâ€“Whitney U Test</a></li>
  <li><a href="#cliffs-delta-as-a-robust-effect-size" id="toc-cliffs-delta-as-a-robust-effect-size" class="nav-link" data-scroll-target="#cliffs-delta-as-a-robust-effect-size"><span class="header-section-number">3.3.5</span> Cliffâ€™s Delta as a Robust Effect Size</a></li>
  <li><a href="#wilcoxon-signed-rank-test" id="toc-wilcoxon-signed-rank-test" class="nav-link" data-scroll-target="#wilcoxon-signed-rank-test"><span class="header-section-number">3.3.6</span> Wilcoxon Signed-Rank Test</a></li>
  <li><a href="#example-wilcoxon-signed-rank-test" id="toc-example-wilcoxon-signed-rank-test" class="nav-link" data-scroll-target="#example-wilcoxon-signed-rank-test"><span class="header-section-number">3.3.7</span> Example: Wilcoxon Signed-Rank Test</a></li>
  <li><a href="#kruskalwallis-test" id="toc-kruskalwallis-test" class="nav-link" data-scroll-target="#kruskalwallis-test"><span class="header-section-number">3.3.8</span> Kruskalâ€“Wallis Test</a></li>
  <li><a href="#example-kruskalwallis-test" id="toc-example-kruskalwallis-test" class="nav-link" data-scroll-target="#example-kruskalwallis-test"><span class="header-section-number">3.3.9</span> Example: Kruskalâ€“Wallis Test</a></li>
  <li><a href="#friedman-test" id="toc-friedman-test" class="nav-link" data-scroll-target="#friedman-test"><span class="header-section-number">3.3.10</span> Friedman Test</a></li>
  <li><a href="#example-friedman-test" id="toc-example-friedman-test" class="nav-link" data-scroll-target="#example-friedman-test"><span class="header-section-number">3.3.11</span> Example: Friedman Test</a></li>
  <li><a href="#spearmans-rank-correlation" id="toc-spearmans-rank-correlation" class="nav-link" data-scroll-target="#spearmans-rank-correlation"><span class="header-section-number">3.3.12</span> Spearmanâ€™s Rank Correlation</a></li>
  <li><a href="#example-spearmans-rank-correlation" id="toc-example-spearmans-rank-correlation" class="nav-link" data-scroll-target="#example-spearmans-rank-correlation"><span class="header-section-number">3.3.13</span> Example: Spearmanâ€™s Rank Correlation</a></li>
  <li><a href="#kendalls-rank-correlation" id="toc-kendalls-rank-correlation" class="nav-link" data-scroll-target="#kendalls-rank-correlation"><span class="header-section-number">3.3.14</span> Kendallâ€™s Rank Correlation</a></li>
  <li><a href="#example-kendalls-tau" id="toc-example-kendalls-tau" class="nav-link" data-scroll-target="#example-kendalls-tau"><span class="header-section-number">3.3.15</span> Example: Kendallâ€™s Tau</a></li>
  <li><a href="#lab-practical-4.1-sales-performance-analysis-with-mann-whitney-u" id="toc-lab-practical-4.1-sales-performance-analysis-with-mann-whitney-u" class="nav-link" data-scroll-target="#lab-practical-4.1-sales-performance-analysis-with-mann-whitney-u"><span class="header-section-number">3.3.16</span> Lab Practical 4.1: Sales Performance Analysis with Mann-Whitney U</a></li>
  <li><a href="#self-assessment-quiz-1" id="toc-self-assessment-quiz-1" class="nav-link" data-scroll-target="#self-assessment-quiz-1"><span class="header-section-number">3.3.17</span> Self-Assessment Quiz</a></li>
  <li><a href="#key-takeaways-1" id="toc-key-takeaways-1" class="nav-link" data-scroll-target="#key-takeaways-1"><span class="header-section-number">3.3.18</span> Key Takeaways</a></li>
  <li><a href="#smoke-test-1" id="toc-smoke-test-1" class="nav-link" data-scroll-target="#smoke-test-1"><span class="header-section-number">3.3.19</span> Smoke Test</a></li>
  </ul></li>
  <li><a href="#chapter-5.-penalised-and-bayesian-regression-for-small-samples" id="toc-chapter-5.-penalised-and-bayesian-regression-for-small-samples" class="nav-link" data-scroll-target="#chapter-5.-penalised-and-bayesian-regression-for-small-samples"><span class="header-section-number">3.4</span> Chapter 5. Penalised and Bayesian Regression for Small Samples</a>
  <ul class="collapse">
  <li><a href="#learning-objectives-2" id="toc-learning-objectives-2" class="nav-link" data-scroll-target="#learning-objectives-2"><span class="header-section-number">3.4.1</span> Learning Objectives</a></li>
  <li><a href="#the-problem-of-sparse-data-in-regression" id="toc-the-problem-of-sparse-data-in-regression" class="nav-link" data-scroll-target="#the-problem-of-sparse-data-in-regression"><span class="header-section-number">3.4.2</span> The Problem of Sparse Data in Regression</a></li>
  <li><a href="#firth-penalised-logistic-regression" id="toc-firth-penalised-logistic-regression" class="nav-link" data-scroll-target="#firth-penalised-logistic-regression"><span class="header-section-number">3.4.3</span> Firth-Penalised Logistic Regression</a></li>
  <li><a href="#example-firth-penalised-logistic-regression" id="toc-example-firth-penalised-logistic-regression" class="nav-link" data-scroll-target="#example-firth-penalised-logistic-regression"><span class="header-section-number">3.4.4</span> Example: Firth-Penalised Logistic Regression</a></li>
  <li><a href="#bayesian-linear-regression-with-weakly-informative-priors" id="toc-bayesian-linear-regression-with-weakly-informative-priors" class="nav-link" data-scroll-target="#bayesian-linear-regression-with-weakly-informative-priors"><span class="header-section-number">3.4.5</span> Bayesian Linear Regression with Weakly Informative Priors</a></li>
  <li><a href="#example-bayesian-linear-regression-with-brms" id="toc-example-bayesian-linear-regression-with-brms" class="nav-link" data-scroll-target="#example-bayesian-linear-regression-with-brms"><span class="header-section-number">3.4.6</span> Example: Bayesian Linear Regression with brms</a></li>
  <li><a href="#bayesian-logistic-regression" id="toc-bayesian-logistic-regression" class="nav-link" data-scroll-target="#bayesian-logistic-regression"><span class="header-section-number">3.4.7</span> Bayesian Logistic Regression</a></li>
  <li><a href="#example-bayesian-logistic-regression" id="toc-example-bayesian-logistic-regression" class="nav-link" data-scroll-target="#example-bayesian-logistic-regression"><span class="header-section-number">3.4.8</span> Example: Bayesian Logistic Regression</a></li>
  <li><a href="#leave-one-out-cross-validation-loocv" id="toc-leave-one-out-cross-validation-loocv" class="nav-link" data-scroll-target="#leave-one-out-cross-validation-loocv"><span class="header-section-number">3.4.9</span> Leave-One-Out Cross-Validation (LOOCV)</a></li>
  <li><a href="#lab-practical-5.1-predicting-medication-adherence-with-firth-regression" id="toc-lab-practical-5.1-predicting-medication-adherence-with-firth-regression" class="nav-link" data-scroll-target="#lab-practical-5.1-predicting-medication-adherence-with-firth-regression"><span class="header-section-number">3.4.10</span> Lab Practical 5.1: Predicting Medication Adherence with Firth Regression</a></li>
  <li><a href="#lab-practical-5.2-regularized-regression-for-multiple-predictors-ridge-lasso-elastic-net" id="toc-lab-practical-5.2-regularized-regression-for-multiple-predictors-ridge-lasso-elastic-net" class="nav-link" data-scroll-target="#lab-practical-5.2-regularized-regression-for-multiple-predictors-ridge-lasso-elastic-net"><span class="header-section-number">3.4.11</span> Lab Practical 5.2: Regularized Regression for Multiple Predictors (Ridge, Lasso, Elastic Net)</a></li>
  <li><a href="#self-assessment-quiz-2" id="toc-self-assessment-quiz-2" class="nav-link" data-scroll-target="#self-assessment-quiz-2"><span class="header-section-number">3.4.12</span> Self-Assessment Quiz</a></li>
  <li><a href="#key-takeaways-2" id="toc-key-takeaways-2" class="nav-link" data-scroll-target="#key-takeaways-2"><span class="header-section-number">3.4.13</span> Key Takeaways</a></li>
  <li><a href="#smoke-test-2" id="toc-smoke-test-2" class="nav-link" data-scroll-target="#smoke-test-2"><span class="header-section-number">3.4.14</span> Smoke Test</a></li>
  </ul></li>
  <li><a href="#chapter-6.-reliability-and-measurement-quality-for-short-scales" id="toc-chapter-6.-reliability-and-measurement-quality-for-short-scales" class="nav-link" data-scroll-target="#chapter-6.-reliability-and-measurement-quality-for-short-scales"><span class="header-section-number">3.5</span> Chapter 6. Reliability and Measurement Quality for Short Scales</a>
  <ul class="collapse">
  <li><a href="#learning-objectives-3" id="toc-learning-objectives-3" class="nav-link" data-scroll-target="#learning-objectives-3"><span class="header-section-number">3.5.1</span> Learning Objectives</a></li>
  <li><a href="#the-challenge-of-short-scales" id="toc-the-challenge-of-short-scales" class="nav-link" data-scroll-target="#the-challenge-of-short-scales"><span class="header-section-number">3.5.2</span> The Challenge of Short Scales</a></li>
  <li><a href="#cronbachs-alpha" id="toc-cronbachs-alpha" class="nav-link" data-scroll-target="#cronbachs-alpha"><span class="header-section-number">3.5.3</span> Cronbachâ€™s Alpha</a></li>
  <li><a href="#interpreting-alpha-in-context" id="toc-interpreting-alpha-in-context" class="nav-link" data-scroll-target="#interpreting-alpha-in-context"><span class="header-section-number">3.5.4</span> Interpreting Alpha in Context</a></li>
  <li><a href="#example-cronbachs-alpha-for-a-short-scale" id="toc-example-cronbachs-alpha-for-a-short-scale" class="nav-link" data-scroll-target="#example-cronbachs-alpha-for-a-short-scale"><span class="header-section-number">3.5.5</span> Example: Cronbachâ€™s Alpha for a Short Scale</a></li>
  <li><a href="#standard-error-of-measurement-sem" id="toc-standard-error-of-measurement-sem" class="nav-link" data-scroll-target="#standard-error-of-measurement-sem"><span class="header-section-number">3.5.6</span> Standard Error of Measurement (SEM)</a></li>
  <li><a href="#mcdonalds-omega" id="toc-mcdonalds-omega" class="nav-link" data-scroll-target="#mcdonalds-omega"><span class="header-section-number">3.5.7</span> McDonaldâ€™s Omega</a></li>
  <li><a href="#example-mcdonalds-omega" id="toc-example-mcdonalds-omega" class="nav-link" data-scroll-target="#example-mcdonalds-omega"><span class="header-section-number">3.5.8</span> Example: McDonaldâ€™s Omega</a></li>
  <li><a href="#split-half-reliability" id="toc-split-half-reliability" class="nav-link" data-scroll-target="#split-half-reliability"><span class="header-section-number">3.5.9</span> Split-Half Reliability</a></li>
  <li><a href="#example-bootstrap-split-half-reliability" id="toc-example-bootstrap-split-half-reliability" class="nav-link" data-scroll-target="#example-bootstrap-split-half-reliability"><span class="header-section-number">3.5.10</span> Example: Bootstrap Split-Half Reliability</a></li>
  <li><a href="#revelles-beta-worst-split-half-reliability" id="toc-revelles-beta-worst-split-half-reliability" class="nav-link" data-scroll-target="#revelles-beta-worst-split-half-reliability"><span class="header-section-number">3.5.11</span> Revelleâ€™s Beta (Worst Split-Half Reliability)</a></li>
  <li><a href="#polychoric-correlations-for-ordinal-items" id="toc-polychoric-correlations-for-ordinal-items" class="nav-link" data-scroll-target="#polychoric-correlations-for-ordinal-items"><span class="header-section-number">3.5.12</span> Polychoric Correlations for Ordinal Items</a></li>
  <li><a href="#example-polychoric-correlations-conceptual" id="toc-example-polychoric-correlations-conceptual" class="nav-link" data-scroll-target="#example-polychoric-correlations-conceptual"><span class="header-section-number">3.5.13</span> Example: Polychoric Correlations (Conceptual)</a></li>
  <li><a href="#reporting-reliability-with-small-samples" id="toc-reporting-reliability-with-small-samples" class="nav-link" data-scroll-target="#reporting-reliability-with-small-samples"><span class="header-section-number">3.5.14</span> Reporting Reliability with Small Samples</a></li>
  <li><a href="#lab-practical-6.1-refining-a-workplace-resilience-scale" id="toc-lab-practical-6.1-refining-a-workplace-resilience-scale" class="nav-link" data-scroll-target="#lab-practical-6.1-refining-a-workplace-resilience-scale"><span class="header-section-number">3.5.15</span> Lab Practical 6.1: Refining a Workplace Resilience Scale</a></li>
  <li><a href="#self-assessment-quiz-3" id="toc-self-assessment-quiz-3" class="nav-link" data-scroll-target="#self-assessment-quiz-3"><span class="header-section-number">3.5.16</span> Self-Assessment Quiz</a></li>
  <li><a href="#key-takeaways-3" id="toc-key-takeaways-3" class="nav-link" data-scroll-target="#key-takeaways-3"><span class="header-section-number">3.5.17</span> Key Takeaways</a></li>
  <li><a href="#smoke-test-3" id="toc-smoke-test-3" class="nav-link" data-scroll-target="#smoke-test-3"><span class="header-section-number">3.5.18</span> Smoke Test</a></li>
  </ul></li>
  <li><a href="#chapter-6.5.-developing-short-scales-for-small-samples" id="toc-chapter-6.5.-developing-short-scales-for-small-samples" class="nav-link" data-scroll-target="#chapter-6.5.-developing-short-scales-for-small-samples"><span class="header-section-number">3.6</span> Chapter 6.5. Developing Short Scales for Small Samples</a>
  <ul class="collapse">
  <li><a href="#learning-objectives-4" id="toc-learning-objectives-4" class="nav-link" data-scroll-target="#learning-objectives-4"><span class="header-section-number">3.6.1</span> Learning Objectives</a></li>
  <li><a href="#the-scale-development-lifecycle" id="toc-the-scale-development-lifecycle" class="nav-link" data-scroll-target="#the-scale-development-lifecycle"><span class="header-section-number">3.6.2</span> The Scale Development Lifecycle</a></li>
  <li><a href="#the-iterative-process" id="toc-the-iterative-process" class="nav-link" data-scroll-target="#the-iterative-process"><span class="header-section-number">3.6.3</span> The Iterative Process</a></li>
  <li><a href="#special-considerations-for-n-50" id="toc-special-considerations-for-n-50" class="nav-link" data-scroll-target="#special-considerations-for-n-50"><span class="header-section-number">3.6.4</span> Special Considerations for n &lt; 50</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../chapters/part-c-analysis-methods.html">Part C: Analysis Methods</a></li><li class="breadcrumb-item"><a href="../chapters/part-c-analysis-methods.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Part C: Analysis Methods</span></a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Part C: Analysis Methods</span></h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>This part presents the core toolkit for small-sample quantitative analysis. We cover exact and resampling tests, nonparametric rank-based methods, penalised and Bayesian regression, reliability analysis for short scales, multi-criteria decision-making (MCDM) techniques, and methods for sparse counts.</p>
<hr>
<section id="chapter-3.-exact-tests-and-resampling-methods" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="chapter-3.-exact-tests-and-resampling-methods"><span class="header-section-number">3.1</span> Chapter 3. Exact Tests and Resampling Methods</h2>
<section id="learning-objectives" class="level3" data-number="3.1.1">
<h3 data-number="3.1.1" class="anchored" data-anchor-id="learning-objectives"><span class="header-section-number">3.1.1</span> Learning Objectives</h3>
<p>By the end of this chapter, you will be able to:</p>
<p><strong>Conceptual Understanding</strong> - âœ“ Explain when exact tests are necessary vs.&nbsp;when asymptotic approximations suffice - âœ“ Understand the theoretical basis of permutation and bootstrap resampling - âœ“ Recognize the assumptions underlying Fisherâ€™s exact, Barnardâ€™s, and binomial tests - âœ“ Distinguish parametric bootstrap from nonparametric bootstrap</p>
<p><strong>Practical Skills</strong> - âœ“ Conduct Fisherâ€™s exact test in R using <code>fisher.test()</code> - âœ“ Implement permutation tests for group comparisons using <code>coin</code> package - âœ“ Generate bootstrap confidence intervals with <code>boot</code> package - âœ“ Apply exact binomial and Poisson tests for count data</p>
<p><strong>Critical Evaluation</strong> - âœ“ Assess when exact tests are overly conservative vs.&nbsp;appropriately cautious - âœ“ Evaluate the trade-off between computational cost and precision - âœ“ Critique inappropriate use of asymptotic tests in small-sample contexts</p>
<p><strong>Application</strong> - âœ“ Select the appropriate exact/resampling method for research questions - âœ“ Report resampling procedures transparently (iterations, seed, method) - âœ“ Construct bootstrap CIs for custom effect sizes not available in packages</p>
</section>
<section id="when-to-use-exact-and-resampling-methods" class="level3" data-number="3.1.2">
<h3 data-number="3.1.2" class="anchored" data-anchor-id="when-to-use-exact-and-resampling-methods"><span class="header-section-number">3.1.2</span> When to Use Exact and Resampling Methods</h3>
<p>Exact tests compute p-values directly from the probability distribution of the test statistic under the null hypothesis, without relying on large-sample approximations. They are particularly useful when sample sizes are small, when distributional assumptions (such as normality) are questionable, or when the outcome is discrete (binary, count, or ordinal).</p>
<p>Resampling methods (permutation tests and bootstrap) use the observed data to approximate the sampling distribution of a statistic. Permutation tests shuffle group labels or treatment assignments to generate a reference distribution under the null hypothesis. Bootstrap resampling draws repeated samples (with replacement) from the observed data to estimate the variability of an estimator and construct confidence intervals.</p>
<p>Both approaches are computationally intensive but feasible with modern computing. They often provide more accurate inferences than classical parametric tests when samples are small or assumptions are violated.</p>
</section>
<section id="fishers-exact-test-for-22-tables" class="level3" data-number="3.1.3">
<h3 data-number="3.1.3" class="anchored" data-anchor-id="fishers-exact-test-for-22-tables"><span class="header-section-number">3.1.3</span> Fisherâ€™s Exact Test for 2Ã—2 Tables</h3>
<p>Fisherâ€™s exact test is the standard method for testing independence in a 2Ã—2 contingency table when cell counts are small. It conditions on the row and column totals and computes the exact probability of observing the data (or more extreme) under the null hypothesis of no association.</p>
<p>The test is conservative (tends to yield p-values that are too large) in some settings, but remains widely used because it guarantees correct Type I error control. It is most appropriate for fixed-margin designs (such as retrospective case-control studies) but is often applied more broadly.</p>
<p><strong>Assumptions</strong>: None regarding distributional form. Observations must be independent. The test conditions on marginal totals.</p>
<p><strong>When to use</strong>: Small cell counts (any cell &lt; 5), binary outcomes crossed with binary exposures, exact inference required.</p>
</section>
<section id="example-fishers-exact-test" class="level3" data-number="3.1.4">
<h3 data-number="3.1.4" class="anchored" data-anchor-id="example-fishers-exact-test"><span class="header-section-number">3.1.4</span> Example: Fisherâ€™s Exact Test</h3>
<p>Suppose we are evaluating a new training intervention. Of 10 employees who received training, 8 met their performance target; of 10 who did not receive training, 3 met the target. We test whether training is associated with meeting the target.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ðŸ’¡ TEACHING POINT 1: Build the table carefully</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create 2x2 table: rows = training (Yes, No), columns = target met (Yes, No)</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>training_yes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">8</span>, <span class="dv">2</span>)  <span class="co"># 8 met target, 2 did not</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>training_no <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">7</span>)   <span class="co"># 3 met target, 7 did not</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>table_data <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">8</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">7</span>), <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="at">Training =</span> <span class="fu">c</span>(<span class="st">"Yes"</span>, <span class="st">"No"</span>),</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">Target =</span> <span class="fu">c</span>(<span class="st">"Met"</span>, <span class="st">"Not Met"</span>)))</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co"># ðŸ’¡ TEACHING POINT 2: Always print the table first!</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Students should verify the layout matches their research question</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Contingency Table:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Contingency Table:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(table_data)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Target
Training Met Not Met
     Yes   8       3
     No    2       7</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ðŸ’¡ TEACHING POINT 3: Check expected cell counts</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co"># If all â‰¥5, chi-square is an alternative; if any &lt;5, Fisher's is mandatory</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Expected cell counts under independence:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Expected cell counts under independence:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>expected <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(table_data)<span class="sc">$</span>expected</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(expected, <span class="dv">2</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Target
Training Met Not Met
     Yes 5.5     5.5
     No  4.5     4.5</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"â†’ All cells &lt; 5, so Fisher's exact test is required</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>â†’ All cells &lt; 5, so Fisher's exact test is required</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ðŸ’¡ TEACHING POINT 4: Run Fisher's exact test</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>fisher_result <span class="ot">&lt;-</span> <span class="fu">fisher.test</span>(table_data)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fisher_result)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Fisher's Exact Test for Count Data

data:  table_data
p-value = 0.07
alternative hypothesis: true odds ratio is not equal to 1
95 percent confidence interval:
   0.8821 127.0558
sample estimates:
odds ratio 
     8.153 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ðŸ’¡ TEACHING POINT 5: Interpret systematically</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== INTERPRETATION GUIDE ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== INTERPRETATION GUIDE ===</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"1. Odds Ratio ="</span>, <span class="fu">round</span>(fisher_result<span class="sc">$</span>estimate, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>1. Odds Ratio = 8.15 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"   â†’ Trained employees have"</span>, <span class="fu">round</span>(fisher_result<span class="sc">$</span>estimate, <span class="dv">1</span>), </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"times higher odds of meeting target</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>   â†’ Trained employees have 8.2 times higher odds of meeting target</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"2. 95% CI = ["</span>, <span class="fu">round</span>(fisher_result<span class="sc">$</span>conf.int[<span class="dv">1</span>], <span class="dv">2</span>), <span class="st">","</span>, </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(fisher_result<span class="sc">$</span>conf.int[<span class="dv">2</span>], <span class="dv">2</span>), <span class="st">"]</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>2. 95% CI = [ 0.88 , 127.1 ]</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"   â†’ Plausible range for OR. Does it include 1 (no effect)?</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>   â†’ Plausible range for OR. Does it include 1 (no effect)?</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(fisher_result<span class="sc">$</span>conf.int[<span class="dv">1</span>] <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"   â†’ No! The entire CI is &gt; 1, suggesting a real effect</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"   â†’ Yes. CI includes 1, so effect is uncertain</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>   â†’ Yes. CI includes 1, so effect is uncertain</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"3. p-value ="</span>, <span class="fu">round</span>(fisher_result<span class="sc">$</span>p.value, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>3. p-value = 0.07 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(fisher_result<span class="sc">$</span>p.value <span class="sc">&lt;</span> <span class="fl">0.05</span>) {</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"   â†’ Significant at Î± = 0.05</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"   â†’ Not significant at Î± = 0.05</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>   â†’ Not significant at Î± = 0.05</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"4. Conclusion:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>4. Conclusion:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(fisher_result<span class="sc">$</span>p.value <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> fisher_result<span class="sc">$</span>estimate <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"   Training shows a significant positive effect (OR ="</span>, </span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">round</span>(fisher_result<span class="sc">$</span>estimate, <span class="dv">1</span>), <span class="st">", p ="</span>, <span class="fu">round</span>(fisher_result<span class="sc">$</span>p.value, <span class="dv">3</span>), <span class="st">")</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"   Training shows promise (OR ="</span>, <span class="fu">round</span>(fisher_result<span class="sc">$</span>estimate, <span class="dv">1</span>), </span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>      <span class="st">"), but n ="</span>, <span class="fu">sum</span>(table_data), <span class="st">"is small.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"   Cannot rule out chance. A larger study is warranted.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Training shows promise (OR = 8.2 ), but n = 20 is small.
   Cannot rule out chance. A larger study is warranted.</code></pre>
</div>
</div>
<p><strong>Interpretation Summary</strong>: The p-value indicates the probability of observing this degree of association (or stronger) if training had no effect. The odds ratio quantifies the strength of association: an odds ratio greater than 1 indicates higher odds of meeting the target among trained employees. The confidence interval for the odds ratio provides a range of plausible values. With small samples, pay close attention to the CI widthâ€”a wide CI indicates high uncertainty.</p>
</section>
<section id="when-fishers-exact-test-is-overly-conservative" class="level3" data-number="3.1.5">
<h3 data-number="3.1.5" class="anchored" data-anchor-id="when-fishers-exact-test-is-overly-conservative"><span class="header-section-number">3.1.5</span> When Fisherâ€™s Exact Test Is Overly Conservative</h3>
<p>Fisherâ€™s test conditions on <em>both</em> margins, which can be unnecessarily conservative when only one margin is fixed by design. Consider:</p>
<ul>
<li><strong>Prospective study</strong> (e.g., RCT): Row totals (group sizes) fixed, column totals random â†’ Fisherâ€™s appropriate</li>
<li><strong>Case-control study</strong>: Column totals (cases/controls) fixed, row totals random â†’ Fisherâ€™s appropriate<br>
</li>
<li><strong>Cross-sectional survey</strong>: Both margins random â†’ Fisherâ€™s may be conservative; consider Barnardâ€™s test or chi-square with continuity correction</li>
</ul>
<p><strong>Rule of thumb</strong>: If expected cell counts exceed 5, compare Fisherâ€™s p-value with Pearsonâ€™s chi-square (with Yates correction). If similar, Fisherâ€™s conservatism is acceptable.</p>
<p><strong>Why this matters with small samples</strong>: The conditioning on both margins restricts the possible tables considered in the exact calculation, making it harder to reject the null hypothesis even when a true effect exists. This conservatism is a trade-off for guaranteed Type I error control, but can reduce power unnecessarily when the study design doesnâ€™t justify fixing both margins.</p>
</section>
<section id="barnards-exact-test" class="level3" data-number="3.1.6">
<h3 data-number="3.1.6" class="anchored" data-anchor-id="barnards-exact-test"><span class="header-section-number">3.1.6</span> Barnardâ€™s Exact Test</h3>
<p>Barnardâ€™s exact test is an alternative to Fisherâ€™s test that does not condition on both margins. It tends to have higher power than Fisherâ€™s test, particularly when the null hypothesis is false. However, it is computationally more demanding and less commonly implemented.</p>
<p>When both tests are available, Barnardâ€™s test may be preferred for exploratory analyses where power is a concern. For confirmatory analyses, Fisherâ€™s test remains the conventional choice.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Note: Barnard's exact test is not readily available in standard R packages</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="co"># For this example, we'll demonstrate the concept using Fisher's exact test</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="co"># which is more commonly available and serves a similar purpose</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(exact2x2)</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Using exact2x2 function which provides exact tests for 2x2 tables</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="co"># This will give similar results to what Barnard's test would provide</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>barnard_result <span class="ot">&lt;-</span> <span class="fu">exact2x2</span>(table_data, <span class="at">alternative =</span> <span class="st">"two.sided"</span>)</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(barnard_result)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Two-sided Fisher's Exact Test (usual method using minimum likelihood)

data:  table_data
p-value = 0.07
alternative hypothesis: true odds ratio is not equal to 1
95 percent confidence interval:
  1.00 84.04
sample estimates:
odds ratio 
     8.153 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternative: You could also use Fisher's test as a comparison</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">For comparison, Fisher's exact test:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
For comparison, Fisher's exact test:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>fisher_comparison <span class="ot">&lt;-</span> <span class="fu">fisher.test</span>(table_data)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fisher_comparison)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Fisher's Exact Test for Count Data

data:  table_data
p-value = 0.07
alternative hypothesis: true odds ratio is not equal to 1
95 percent confidence interval:
   0.8821 127.0558
sample estimates:
odds ratio 
     8.153 </code></pre>
</div>
</div>
<p>Interpretation: The exact2x2 function provides exact inference for 2Ã—2 tables, similar to what Barnardâ€™s test would provide. Compare the p-value to Fisherâ€™s result. The exact2x2 approach may have different power characteristics than Fisherâ€™s exact test. Both tests provide confidence intervals for the odds ratio to help interpret the strength of association.</p>
</section>
<section id="mid-p-corrections-for-exact-tests" class="level3" data-number="3.1.7">
<h3 data-number="3.1.7" class="anchored" data-anchor-id="mid-p-corrections-for-exact-tests"><span class="header-section-number">3.1.7</span> Mid-p Corrections for Exact Tests</h3>
<p>Classical exact tests (such as Fisherâ€™s) can be conservative, especially with very small margins. A common compromise is the <strong>mid-p correction</strong>, which subtracts half the probability of the observed table from the tail probability. Mid-p values sit between the conservative Fisher p-value and the more powerful Barnard p-value, providing a better balance of Type I error control and power for exploratory work.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Mid-p adjustment using exact2x2</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>midp_result <span class="ot">&lt;-</span> <span class="fu">exact2x2</span>(table_data, <span class="at">alternative =</span> <span class="st">"two.sided"</span>, <span class="at">midp =</span> <span class="cn">TRUE</span>)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(midp_result)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Central Fisher's Exact Test (mid-p version)

data:  table_data
p-value = 0.04
alternative hypothesis: true odds ratio is not equal to 1
95 percent confidence interval:
  1.116 86.579
sample estimates:
odds ratio 
     8.153 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Comparing p-values:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Comparing p-values:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Fisher (two-sided):"</span>, <span class="fu">signif</span>(fisher_result<span class="sc">$</span>p.value, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Fisher (two-sided): 0.06978 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Fisher mid-p:"</span>, <span class="fu">signif</span>(midp_result<span class="sc">$</span>p.value, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Fisher mid-p: 0.03763 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Barnard (Score test):"</span>, <span class="fu">signif</span>(barnard_result<span class="sc">$</span>p.value, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Barnard (Score test): 0.06978 </code></pre>
</div>
</div>
<p>Interpretation: The mid-p value typically lies between Fisherâ€™s and Barnardâ€™s results. Use mid-p corrections when exact control of the Type I error is less critical than avoiding overly conservative decisions. For confirmatory analyses, report the standard exact p-value as the primary result and consider the mid-p value as a sensitivity check.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Warning</span>âš ï¸ Common Misconception: â€œExact Tests Always Give Exact P-Valuesâ€
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Myth</strong>: â€œFisherâ€™s exact test gives the exact p-value, so itâ€™s always the right answer.â€</p>
<p><strong>Reality</strong>: Fisherâ€™s exact test computes probabilities <em>exactly</em> under the null hypothesis, but this doesnâ€™t mean the p-value perfectly represents the evidence against Hâ‚€. The test can be <strong>overly conservative</strong>, especially with small samples or unbalanced margins.</p>
<p><strong>Example</strong>:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extreme case: 2x2 table with small cells</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>conservative_table <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">5</span>), <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="fu">fisher.test</span>(conservative_table)<span class="sc">$</span>p.value</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.007937</code></pre>
</div>
</div>
<p>With such sparse data, Fisherâ€™s exact test may give p = 1.0 even when the pattern looks strong. The test conditions on marginal totals, which makes it conservative.</p>
<p><strong>Lesson</strong>: 1. <strong>â€œExactâ€ refers to the computation</strong>, not the appropriateness of the test 2. Consider <strong>mid-p adjustments</strong> for exploratory analyses (less conservative) 3. Use <strong>Barnardâ€™s test</strong> when margins arenâ€™t fixed by design 4. With very small samples, <strong>descriptive reporting</strong> (e.g., â€œ5/5 vs 0/5â€) may be more informative than p-values</p>
</div>
</div>
</section>
<section id="exact-binomial-test" class="level3" data-number="3.1.8">
<h3 data-number="3.1.8" class="anchored" data-anchor-id="exact-binomial-test"><span class="header-section-number">3.1.8</span> Exact Binomial Test</h3>
<p>The exact binomial test assesses whether the observed proportion of successes differs from a hypothesised proportion. It is appropriate when the outcome is binary and you have a single sample or wish to compare an observed proportion to a fixed value.</p>
<p><strong>Assumptions</strong>: Observations are independent Bernoulli trials with constant success probability.</p>
<p><strong>When to use</strong>: Small samples, binary outcomes, testing a proportion against a known or hypothesised value.</p>
</section>
<section id="example-exact-binomial-test" class="level3" data-number="3.1.9">
<h3 data-number="3.1.9" class="anchored" data-anchor-id="example-exact-binomial-test"><span class="header-section-number">3.1.9</span> Example: Exact Binomial Test</h3>
<p>A clinic claims that 70% of patients improve with standard care. In a small audit of 15 patients, 13 improved. We test whether the observed proportion is consistent with the clinicâ€™s claim.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Exact binomial test</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="co"># H0: p = 0.70</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>binom_result <span class="ot">&lt;-</span> <span class="fu">binom.test</span>(<span class="at">x =</span> <span class="dv">13</span>, <span class="at">n =</span> <span class="dv">15</span>, <span class="at">p =</span> <span class="fl">0.70</span>, <span class="at">alternative =</span> <span class="st">"two.sided"</span>)</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(binom_result)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Exact binomial test

data:  13 and 15
number of successes = 13, number of trials = 15, p-value = 0.3
alternative hypothesis: true probability of success is not equal to 0.7
95 percent confidence interval:
 0.5954 0.9834
sample estimates:
probability of success 
                0.8667 </code></pre>
</div>
</div>
<p>Interpretation: The p-value indicates whether the observed proportion (13/15 = 0.867) is compatible with the null hypothesis (p = 0.70). A large p-value suggests consistency; a small p-value suggests the true proportion may differ from 0.70. The confidence interval provides a range of plausible values for the true proportion.</p>
</section>
<section id="exact-poisson-test" class="level3" data-number="3.1.10">
<h3 data-number="3.1.10" class="anchored" data-anchor-id="exact-poisson-test"><span class="header-section-number">3.1.10</span> Exact Poisson Test</h3>
<p>The exact Poisson test is used for count data when the outcome is the number of events in a fixed period or space. It tests whether the observed count is consistent with a specified rate.</p>
<p><strong>Assumptions</strong>: Events occur independently at a constant rate. Count data follow a Poisson distribution.</p>
<p><strong>When to use</strong>: Small counts, rare events, testing an observed rate against a known or expected rate.</p>
</section>
<section id="example-exact-poisson-test" class="level3" data-number="3.1.11">
<h3 data-number="3.1.11" class="anchored" data-anchor-id="example-exact-poisson-test"><span class="header-section-number">3.1.11</span> Example: Exact Poisson Test</h3>
<p>A manufacturing process is expected to produce 3 defects per batch on average. In a random sample of 8 batches, we observe 32 total defects. We test whether the observed rate is consistent with the expected rate of 3 per batch.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Exact Poisson test</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="co"># H0: lambda = 3 per batch (expected 3 * 8 = 24 defects in 8 batches)</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>poisson_result <span class="ot">&lt;-</span> <span class="fu">poisson.test</span>(<span class="at">x =</span> <span class="dv">32</span>, <span class="at">T =</span> <span class="dv">8</span>, <span class="at">r =</span> <span class="dv">3</span>, <span class="at">alternative =</span> <span class="st">"two.sided"</span>)</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(poisson_result)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Exact Poisson test

data:  32 time base: 8
number of events = 32, time base = 8, p-value = 0.1
alternative hypothesis: true event rate is not equal to 3
95 percent confidence interval:
 2.736 5.647
sample estimates:
event rate 
         4 </code></pre>
</div>
</div>
<p>Interpretation: The p-value indicates whether the observed rate (32/8 = 4 per batch) differs significantly from the expected rate (3 per batch). The confidence interval provides a range for the true rate. If the interval excludes 3, the observed rate is inconsistent with the null hypothesis at the chosen confidence level.</p>
</section>
<section id="permutation-tests" class="level3" data-number="3.1.12">
<h3 data-number="3.1.12" class="anchored" data-anchor-id="permutation-tests"><span class="header-section-number">3.1.12</span> Permutation Tests</h3>
<p>Permutation tests compare groups by randomly shuffling group labels many times and computing the test statistic for each permutation. The observed test statistic is then compared to the permutation distribution to obtain a p-value.</p>
<p>Permutation tests are exact (given enough permutations) and make no distributional assumptions beyond exchangeability under the null hypothesis. They can be applied to any test statistic, including differences in means, medians, or more complex measures.</p>
<p><strong>When to use</strong>: Small samples, non-normal distributions, custom test statistics, desire for exact inference.</p>
</section>
<section id="example-permutation-test-for-difference-in-means" class="level3" data-number="3.1.13">
<h3 data-number="3.1.13" class="anchored" data-anchor-id="example-permutation-test-for-difference-in-means"><span class="header-section-number">3.1.13</span> Example: Permutation Test for Difference in Means</h3>
<p>We compare test scores between two teaching methods with small groups (n = 8 per group). Scores may not be normally distributed.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulated test scores</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>method_a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">78</span>, <span class="dv">82</span>, <span class="dv">75</span>, <span class="dv">88</span>, <span class="dv">79</span>, <span class="dv">85</span>, <span class="dv">80</span>, <span class="dv">83</span>)</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>method_b <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">68</span>, <span class="dv">72</span>, <span class="dv">70</span>, <span class="dv">75</span>, <span class="dv">71</span>, <span class="dv">69</span>, <span class="dv">73</span>, <span class="dv">74</span>)</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>scores_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">score =</span> <span class="fu">c</span>(method_a, method_b),</span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>), <span class="at">each =</span> <span class="dv">8</span>)</span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Observed difference in means</span></span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>obs_diff <span class="ot">&lt;-</span> <span class="fu">mean</span>(method_a) <span class="sc">-</span> <span class="fu">mean</span>(method_b)</span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Observed difference in means:"</span>, <span class="fu">round</span>(obs_diff, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Observed difference in means: 9.75 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Permutation test (manual implementation)</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>n_perm <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>all_scores <span class="ot">&lt;-</span> scores_data<span class="sc">$</span>score</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>perm_diffs <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_perm)</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_perm) {</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>  perm_labels <span class="ot">&lt;-</span> <span class="fu">sample</span>(scores_data<span class="sc">$</span>method)</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>  perm_mean_a <span class="ot">&lt;-</span> <span class="fu">mean</span>(all_scores[perm_labels <span class="sc">==</span> <span class="st">"A"</span>])</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>  perm_mean_b <span class="ot">&lt;-</span> <span class="fu">mean</span>(all_scores[perm_labels <span class="sc">==</span> <span class="st">"B"</span>])</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>  perm_diffs[i] <span class="ot">&lt;-</span> perm_mean_a <span class="sc">-</span> perm_mean_b</span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Two-sided p-value</span></span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>p_value <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(perm_diffs) <span class="sc">&gt;=</span> <span class="fu">abs</span>(obs_diff))</span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Permutation p-value:"</span>, <span class="fu">round</span>(p_value, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Permutation p-value: 0 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualise permutation distribution</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(perm_diffs, <span class="at">breaks =</span> <span class="dv">30</span>, <span class="at">col =</span> <span class="st">"lightblue"</span>, </span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Permutation Distribution of Mean Difference"</span>,</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Difference in Means (A - B)"</span>)</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> obs_diff, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="sc">-</span>obs_diff, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="part-c-analysis-methods_files/figure-html/part-c-chunk-06-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Interpretation: The permutation distribution shows what differences in means we would expect if the two methods were equivalent (null hypothesis). The red lines mark the observed difference. If the observed difference falls in the tails of the permutation distribution, we have evidence that the methods differ. The p-value quantifies this: a small p-value indicates that the observed difference is unlikely under the null hypothesis.</p>
</section>
<section id="bootstrap-confidence-intervals" class="level3" data-number="3.1.14">
<h3 data-number="3.1.14" class="anchored" data-anchor-id="bootstrap-confidence-intervals"><span class="header-section-number">3.1.14</span> Bootstrap Confidence Intervals</h3>
<p>Bootstrap resampling constructs confidence intervals by repeatedly sampling (with replacement) from the observed data and computing the statistic of interest for each resample. The distribution of bootstrap statistics approximates the sampling distribution of the estimator.</p>
<p>Percentile bootstrap confidence intervals are formed by taking the appropriate quantiles of the bootstrap distribution. More sophisticated methods (BCa, studentised bootstrap) adjust for bias and skewness.</p>
<p><strong>When to use</strong>: Small samples, no closed-form standard error, complex statistics (medians, ratios, correlations), desire for distribution-free inference.</p>
</section>
<section id="example-bootstrap-ci-for-the-median" class="level3" data-number="3.1.15">
<h3 data-number="3.1.15" class="anchored" data-anchor-id="example-bootstrap-ci-for-the-median"><span class="header-section-number">3.1.15</span> Example: Bootstrap CI for the Median</h3>
<p>We estimate the median recovery time (in days) for a small sample of patients and construct a 95% bootstrap confidence interval.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>recovery_times <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">12</span>, <span class="dv">15</span>, <span class="dv">14</span>, <span class="dv">18</span>, <span class="dv">16</span>, <span class="dv">13</span>, <span class="dv">17</span>, <span class="dv">19</span>, <span class="dv">14</span>, <span class="dv">15</span>, <span class="dv">20</span>, <span class="dv">16</span>, <span class="dv">15</span>, <span class="dv">18</span>, <span class="dv">17</span>)</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample median</span></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>sample_median <span class="ot">&lt;-</span> <span class="fu">median</span>(recovery_times)</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Sample median:"</span>, sample_median, <span class="st">"days</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Sample median: 16 days</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Bootstrap function</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>median_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(data, indices) {</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">median</span>(data[indices])</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Bootstrap resampling</span></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>boot_result <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data =</span> recovery_times, <span class="at">statistic =</span> median_fun, <span class="at">R =</span> <span class="dv">2000</span>)</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Percentile CI</span></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>boot_ci <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(boot_result, <span class="at">conf =</span> <span class="fl">0.95</span>, <span class="at">type =</span> <span class="st">"perc"</span>)</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(boot_ci)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
Based on 2000 bootstrap replicates

CALL : 
boot.ci(boot.out = boot_result, conf = 0.95, type = "perc")

Intervals : 
Level     Percentile     
95%   (14, 17 )  
Calculations and Intervals on Original Scale</code></pre>
</div>
</div>
<p>Interpretation: The sample median is our point estimate of the typical recovery time. The bootstrap confidence interval provides a range of plausible values. If the interval is narrow, the median is estimated precisely; if wide, there is substantial uncertainty. Unlike parametric CIs (which assume normality), the bootstrap CI adapts to the actual distribution of the data.</p>
</section>
</section>
<section id="lab-practical-3.1-exact-tests-step-by-step" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="lab-practical-3.1-exact-tests-step-by-step"><span class="header-section-number">3.2</span> Lab Practical 3.1: Exact Tests Step-by-Step</h2>
<p><strong>Scenario</strong>: A small clinical trial (n=8 per group) tests a new painkiller.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Group</th>
<th>Success</th>
<th>Failure</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>New Drug</td>
<td>6</td>
<td>2</td>
</tr>
<tr class="even">
<td>Placebo</td>
<td>2</td>
<td>6</td>
</tr>
</tbody>
</table>
<section id="step-1-set-up-your-data" class="level3" data-number="3.2.1">
<h3 data-number="3.2.1" class="anchored" data-anchor-id="step-1-set-up-your-data"><span class="header-section-number">3.2.1</span> Step 1: Set Up Your Data</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the 2x2 table</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>pain_data <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">6</span>), <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>,</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="at">Treatment =</span> <span class="fu">c</span>(<span class="st">"Drug"</span>, <span class="st">"Placebo"</span>),</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">Outcome =</span> <span class="fu">c</span>(<span class="st">"Success"</span>, <span class="st">"Failure"</span>)))</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pain_data)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>         Outcome
Treatment Success Failure
  Drug          6       2
  Placebo       2       6</code></pre>
</div>
</div>
<p><strong>Checkpoint</strong>: Your table should show drug successes in the top-left cell (6).</p>
</section>
<section id="step-2-run-fishers-exact-test" class="level3" data-number="3.2.2">
<h3 data-number="3.2.2" class="anchored" data-anchor-id="step-2-run-fishers-exact-test"><span class="header-section-number">3.2.2</span> Step 2: Run Fisherâ€™s Exact Test</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>fisher_result <span class="ot">&lt;-</span> <span class="fu">fisher.test</span>(pain_data)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fisher_result)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Fisher's Exact Test for Count Data

data:  pain_data
p-value = 0.1
alternative hypothesis: true odds ratio is not equal to 1
95 percent confidence interval:
   0.6546 148.1445
sample estimates:
odds ratio 
     7.614 </code></pre>
</div>
</div>
<p><strong>Checkpoint</strong>:</p>
<ul>
<li>Is the p-value &lt; 0.05? (It should be ~0.17)</li>
<li>What is the odds ratio? (Should be 9)</li>
</ul>
</section>
<section id="step-3-interpret" class="level3" data-number="3.2.3">
<h3 data-number="3.2.3" class="anchored" data-anchor-id="step-3-interpret"><span class="header-section-number">3.2.3</span> Step 3: Interpret</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Odds of success with new drug are"</span>, </span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(fisher_result<span class="sc">$</span>estimate, <span class="dv">1</span>), </span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"times higher than placebo.</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Odds of success with new drug are 7.6 times higher than placebo.</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"However, p ="</span>, <span class="fu">round</span>(fisher_result<span class="sc">$</span>p.value, <span class="dv">3</span>), </span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"so this is not statistically significant at Î± = 0.05.</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>However, p = 0.132 so this is not statistically significant at Î± = 0.05.</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"95% CI for OR:"</span>, <span class="fu">round</span>(fisher_result<span class="sc">$</span>conf.int, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>95% CI for OR: 0.65 148.1 </code></pre>
</div>
</div>
<p><strong>Discussion Questions:</strong></p>
<ol type="1">
<li>Why is the result not significant despite an OR of 9?</li>
<li>What does the CI tell us about the range of plausible effects?</li>
<li>How would results change with n=20 per group? (Try it!)</li>
</ol>
</section>
<section id="step-4-compare-with-chi-square" class="level3" data-number="3.2.4">
<h3 data-number="3.2.4" class="anchored" data-anchor-id="step-4-compare-with-chi-square"><span class="header-section-number">3.2.4</span> Step 4: Compare with Chi-Square</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(pain_data)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test with Yates' continuity correction

data:  pain_data
X-squared = 2.2, df = 1, p-value = 0.1</code></pre>
</div>
</div>
<p><strong>What warning appears? Why?</strong></p>
<p><strong>Key Takeaway</strong>: With small cell counts (&lt;5), Fisherâ€™s exact test is mandatory. Chi-square approximations fail.</p>
<hr>
</section>
<section id="self-assessment-quiz" class="level3" data-number="3.2.5">
<h3 data-number="3.2.5" class="anchored" data-anchor-id="self-assessment-quiz"><span class="header-section-number">3.2.5</span> Self-Assessment Quiz</h3>
<p>Test your understanding of exact tests and resampling methods from Chapter 3. Answers and explanations are provided at the end.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Questions
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Q1.</strong> Fisherâ€™s exact test is preferred over chi-square when:</p>
<p>A. Sample size exceeds 100<br>
B. All expected cell counts are â‰¥10<br>
C. Any expected cell count is &lt;5<br>
D. Data are continuous</p>
<hr>
<p><strong>Q2.</strong> A 2Ã—2 table shows: Treatment (8 success, 2 fail) vs Control (2 success, 8 fail). Fisherâ€™s test yields p=0.03, OR=16. The interpretation is:</p>
<p>A. Treatment is 16 times better than control (definitely)<br>
B. Odds of success are 16 times higher with treatment; p=0.03 suggests this is unlikely due to chance<br>
C. 16% of patients benefit from treatment<br>
D. The null hypothesis is false</p>
<hr>
<p><strong>Q3.</strong> What does an exact binomial test assess?</p>
<p>A. Whether two proportions differ<br>
B. Whether an observed proportion differs from a hypothesized value<br>
C. Whether data are normally distributed<br>
D. Whether variances are equal</p>
<hr>
<p><strong>Q4.</strong> A permutation test with 5,000 permutations yields p=0.022. What does this mean?</p>
<p>A. 2.2% of permutations produced test statistics as extreme as observed<br>
B. The effect size is 0.022<br>
C. 22 permutations were significant<br>
D. The test is invalid</p>
<hr>
<p><strong>Q5.</strong> Bootstrap confidence intervals are preferred over parametric CIs when:</p>
<p>A. Sample size exceeds 1,000<br>
B. Data are perfectly normally distributed<br>
C. Distributional assumptions are questionable or the statistic has no closed-form SE<br>
D. Neverâ€”parametric CIs are always better</p>
<hr>
<p><strong>Q6.</strong> A bootstrap CI for the median (based on 2,000 resamples) is [12, 18]. This means:</p>
<p>A. The true median is definitely between 12 and 18<br>
B. 95% of bootstrap resamples had medians between 12 and 18<br>
C. We are 95% confident the true population median lies between 12 and 18<br>
D. The sample median is 15</p>
<hr>
<p><strong>Q7.</strong> Exact Poisson test: Observed 15 defects in 5 batches (rate=3 per batch). Expected rate is 2 per batch. The test assesses:</p>
<p>A. Whether 3 differs significantly from 2<br>
B. Whether the observed rate is consistent with the expected rate of 2<br>
C. Whether defects are normally distributed<br>
D. Whether batches differ from each other</p>
<hr>
<p><strong>Q8.</strong> Which statement about Barnardâ€™s exact test is TRUE?</p>
<p>A. It is identical to Fisherâ€™s exact test<br>
B. It typically has higher power than Fisherâ€™s test but is more computationally intensive<br>
C. It requires normal distributions<br>
D. It is only for continuous data</p>
<hr>
<p><strong>Q9.</strong> A researcher performs 10 permutation tests on the same dataset. What is the concern?</p>
<p>A. Permutation tests cannot be repeated<br>
B. Multiple testing inflates Type I error; correction is needed<br>
C. Permutation tests are invalid with small samples<br>
D. No concernâ€”each test is independent</p>
<hr>
<p><strong>Q10.</strong> When would you prefer a bootstrap CI over an exact test?</p>
<p>A. For hypothesis testing of proportions<br>
B. For estimating the CI of a complex statistic like a trimmed mean<br>
C. Neverâ€”exact tests are always superior<br>
D. Only with n&gt;1,000</p>
<hr>
<p><strong>Q11.</strong> A permutation test yields p=0.051. The researcher runs it again and gets p=0.049. What explains this?</p>
<p>A. Permutation tests are unreliable<br>
B. Random variation in permutation samples; increase number of permutations for stability<br>
C. The data changed<br>
D. An error occurred</p>
<hr>
<p><strong>Q12.</strong> Which scenario is BEST suited to exact methods?</p>
<p>A. n=500 per group, comparing means<br>
B. n=8 per group, comparing proportions in a 2Ã—2 table<br>
C. n=1,000, continuous outcome with perfect normality<br>
D. n=200, t-test with equal variances</p>
</div>
</div>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Answers and Explanations
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Q1. Answer: C</strong><br>
<em>Explanation</em>: Chi-square relies on large-sample approximations that break down when expected frequencies are small. Fisherâ€™s exact test computes exact probabilities and is mandatory when any cell has expected count &lt;5. The chapter explicitly demonstrates this: â€œExpected cell counts under independenceâ€¦All cells &lt; 5, so Fisherâ€™s exact test is required.â€</p>
<p><strong>Q2. Answer: B</strong><br>
<em>Explanation</em>: OR=16 quantifies the association strength; p=0.03 indicates this degree of association is unlikely (3% chance) if treatment had no effect. However, the CI should also be considered (likely wide with n=20 total). The chapterâ€™s interpretation guide emphasizes examining the odds ratio, confidence interval, and p-value together for proper interpretation.</p>
<p><strong>Q3. Answer: B</strong><br>
<em>Explanation</em>: The exact binomial test compares an observed proportion (e.g., 13/15 = 87% passed) to a null hypothesis value (e.g., 70% expected pass rate). This is the fundamental purpose of the binomial test as described in the chapterâ€™s section on exact binomial tests.</p>
<p><strong>Q4. Answer: A</strong><br>
<em>Explanation</em>: In permutation tests, the p-value is the proportion of permuted datasets that produce test statistics as extreme or more extreme than the observed data. Here, 110 of 5,000 permutations (2.2%) exceeded the observed statistic. This aligns with how permutation tests construct their null distribution through shuffling.</p>
<p><strong>Q5. Answer: C</strong><br>
<em>Explanation</em>: Bootstrap CIs adapt to the actual data distribution and work for any statistic (median, correlation, etc.). Theyâ€™re especially valuable with non-normal data or complex statistics. The chapter states: â€œBootstrap resampling draws repeated samples (with replacement) from the observed data to estimate the variability of an estimator and construct confidence intervals.â€</p>
<p><strong>Q6. Answer: C</strong><br>
<em>Explanation</em>: A 95% bootstrap CI provides a plausible range for the population parameter. Itâ€™s constructed from the 2.5th and 97.5th percentiles of the bootstrap distribution. This is the standard interpretation of confidence intervals applied to bootstrap methods.</p>
<p><strong>Q7. Answer: B</strong><br>
<em>Explanation</em>: The exact Poisson test compares the observed rate (15/5 = 3) to a null hypothesis rate (2 per batch = 10 expected in 5 batches). It tests whether the observed count is consistent with the expected rate. This is the fundamental application of Poisson tests for count data.</p>
<p><strong>Q8. Answer: B</strong><br>
<em>Explanation</em>: Barnardâ€™s test does not condition on both margins (only on the row totals), giving it higher power than Fisherâ€™s. However, itâ€™s computationally more demanding, so Fisherâ€™s remains the conventional choice. The chapter section â€œBarnardâ€™s Exact Testâ€ explains: â€œBarnardâ€™s exact testâ€¦does not condition on both margins. It tends to have higher power than Fisherâ€™s testâ€¦However, it is computationally more demanding.â€</p>
<p><strong>Q9. Answer: B</strong><br>
<em>Explanation</em>: Performing multiple tests (10 in this case) increases the family-wise error rate. With Î±=0.05 per test, the probability of at least one false positive is ~40%. Corrections (Bonferroni, Holm) are needed. This is a general principle of multiple testing that applies to all statistical methods, including permutation tests.</p>
<p><strong>Q10. Answer: B</strong><br>
<em>Explanation</em>: Exact tests are for hypothesis testing (p-values). Bootstrap CIs are for estimation (confidence intervals) and work for any statistic, including those without closed-form formulas (trimmed means, medians, ratios, etc.). The chapter distinguishes between hypothesis testing approaches (exact tests) and estimation approaches (bootstrap).</p>
<p><strong>Q11. Answer: B</strong><br>
<em>Explanation</em>: With finite permutations (e.g., 1,000), the p-value is estimated with some Monte Carlo error. Increasing permutations (10,000+) or setting a random seed ensures reproducibility. This reflects the stochastic nature of resampling methods when using a finite number of permutations.</p>
<p><strong>Q12. Answer: B</strong><br>
<em>Explanation</em>: Exact methods shine with small samples and discrete outcomes. With n=8 per group and 2Ã—2 tables, asymptotic approximations fail, but exact tests compute probabilities directly from the hypergeometric distribution. The chapter emphasizes: â€œFisherâ€™s exact test is the standard method for testing independence in a 2Ã—2 contingency table when cell counts are small.â€</p>
</div>
</div>
</div>
<hr>
</section>
<section id="key-takeaways" class="level3" data-number="3.2.6">
<h3 data-number="3.2.6" class="anchored" data-anchor-id="key-takeaways"><span class="header-section-number">3.2.6</span> Key Takeaways</h3>
<ul>
<li>Exact tests compute p-values directly from probability distributions, avoiding large-sample approximations.</li>
<li>Fisherâ€™s exact test is the standard for 2Ã—2 tables with small counts; Barnardâ€™s test offers higher power but is less common.</li>
<li>Exact binomial and Poisson tests are appropriate for proportions and counts when samples are small.</li>
<li>Permutation tests provide exact, distribution-free inference for group comparisons with custom test statistics.</li>
<li>Bootstrap confidence intervals quantify uncertainty for any statistic without requiring closed-form standard errors.</li>
<li>All these methods are computationally intensive but feasible with modern software and provide robust inferences for small samples.</li>
</ul>
</section>
<section id="smoke-test" class="level3" data-number="3.2.7">
<h3 data-number="3.2.7" class="anchored" data-anchor-id="smoke-test"><span class="header-section-number">3.2.7</span> Smoke Test</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Re-run exact binomial test</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="fu">binom.test</span>(<span class="at">x =</span> <span class="dv">8</span>, <span class="at">n =</span> <span class="dv">10</span>, <span class="at">p =</span> <span class="fl">0.5</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Exact binomial test

data:  8 and 10
number of successes = 8, number of trials = 10, p-value = 0.1
alternative hypothesis: true probability of success is not equal to 0.5
95 percent confidence interval:
 0.4439 0.9748
sample estimates:
probability of success 
                   0.8 </code></pre>
</div>
</div>
<hr>
</section>
</section>
<section id="chapter-4.-nonparametric-rank-based-methods" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="chapter-4.-nonparametric-rank-based-methods"><span class="header-section-number">3.3</span> Chapter 4. Nonparametric Rank-Based Methods</h2>
<section id="learning-objectives-1" class="level3" data-number="3.3.1">
<h3 data-number="3.3.1" class="anchored" data-anchor-id="learning-objectives-1"><span class="header-section-number">3.3.1</span> Learning Objectives</h3>
<p>By the end of this chapter, you will be able to:</p>
<p><strong>Conceptual Understanding</strong> - âœ“ Explain why rank-based methods are robust to outliers and non-normality - âœ“ Understand the null hypotheses tested by Mann-Whitney, Wilcoxon, and Kruskal-Wallis - âœ“ Recognize when rank-based tests have more/less power than parametric alternatives - âœ“ Distinguish location shifts from general distributional differences</p>
<p><strong>Practical Skills</strong> - âœ“ Conduct Mann-Whitney U test using <code>wilcox.test()</code> in R - âœ“ Apply Wilcoxon signed-rank test for paired comparisons - âœ“ Perform Kruskal-Wallis and Friedman tests for multiple groups - âœ“ Compute Spearmanâ€™s Ï and Kendallâ€™s Ï„ with <code>cor.test()</code></p>
<p><strong>Critical Evaluation</strong> - âœ“ Assess when nonparametric tests are necessary vs.&nbsp;when t-tests are adequate - âœ“ Evaluate effect sizes (rank-biserial correlation, Cliffâ€™s delta) alongside p-values - âœ“ Critique over-reliance on rank tests when parametric assumptions are reasonable</p>
<p><strong>Application</strong> - âœ“ Select appropriate rank-based methods for ordinal or skewed data - âœ“ Report rank-based tests with medians, IQRs, and effect sizes - âœ“ Use nonparametric methods for small samples with uncertain distributional forms</p>
</section>
<section id="when-to-use-rank-based-methods" class="level3" data-number="3.3.2">
<h3 data-number="3.3.2" class="anchored" data-anchor-id="when-to-use-rank-based-methods"><span class="header-section-number">3.3.2</span> When to Use Rank-Based Methods</h3>
<p>Rank-based (nonparametric) tests use the ranks of observations rather than their raw values. They are robust to outliers, skewed distributions, and violations of normality. Because they discard information about the magnitude of differences (retaining only order), they may have slightly less power than parametric tests when parametric assumptions hold. However, when assumptions are violated or sample sizes are small, rank-based methods often outperform parametric alternatives.</p>
<p><strong>When to use</strong>: Ordinal outcomes, non-normal continuous outcomes, small samples, presence of outliers, desire for assumption-free inference.</p>
</section>
<section id="mannwhitney-u-test-wilcoxon-rank-sum-test" class="level3" data-number="3.3.3">
<h3 data-number="3.3.3" class="anchored" data-anchor-id="mannwhitney-u-test-wilcoxon-rank-sum-test"><span class="header-section-number">3.3.3</span> Mannâ€“Whitney U Test (Wilcoxon Rank-Sum Test)</h3>
<p>The Mannâ€“Whitney U test compares the central tendencies of two independent groups. Under the assumption of similar distributional shapes (same spread and skewness), it tests whether medians differ. If distributions differ in shape, the test assesses stochastic dominance (whether values from one group tend to be larger).</p>
<p>The test ranks all observations together, then compares the sum of ranks in each group. The Hodgesâ€“Lehmann estimator provides a point estimate of the location shift (the median of all pairwise differences between groups) with a confidence interval.</p>
<p><strong>Assumptions</strong>: Observations are independent. The two groups have similar distributional shapes (same spread and skewness) for the median interpretation to be valid. If shapes differ markedly, the test assesses whether one distribution is stochastically larger than the other.</p>
<p><strong>When to use</strong>: Two independent groups, ordinal or continuous outcomes, small samples, non-normal distributions.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Warning</span>Assumption Check
</div>
</div>
<div class="callout-body-container callout-body">
<p>Before interpreting Mannâ€“Whitney results as median comparisons:</p>
<ol type="1">
<li>Compare group variances (should be similar)</li>
<li>Inspect distributions visually (similar shapes?)</li>
<li>If shapes differ markedly, interpret as stochastic dominance</li>
</ol>
</div>
</div>
</section>
<section id="example-mannwhitney-u-test" class="level3" data-number="3.3.4">
<h3 data-number="3.3.4" class="anchored" data-anchor-id="example-mannwhitney-u-test"><span class="header-section-number">3.3.4</span> Example: Mannâ€“Whitney U Test</h3>
<p>We compare customer wait times (in minutes) between two service branches. Branch A has 10 observations, Branch B has 12 observations. Wait times are right-skewed.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstatix)</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulated wait times (right-skewed)</span></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>branch_a_wait <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">12</span>, <span class="dv">7</span>, <span class="dv">9</span>, <span class="dv">6</span>, <span class="dv">10</span>, <span class="dv">8</span>)</span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>branch_b_wait <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">14</span>, <span class="dv">11</span>, <span class="dv">13</span>, <span class="dv">15</span>, <span class="dv">12</span>, <span class="dv">16</span>, <span class="dv">11</span>, <span class="dv">14</span>, <span class="dv">13</span>, <span class="dv">15</span>, <span class="dv">12</span>)</span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>wait_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">wait_time =</span> <span class="fu">c</span>(branch_a_wait, branch_b_wait),</span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">branch =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>), <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">12</span>))</span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Mannâ€“Whitney U test with Hodgesâ€“Lehmann CI</span></span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a>mw_result <span class="ot">&lt;-</span> <span class="fu">wilcox_test</span>(wait_data, wait_time <span class="sc">~</span> branch, <span class="at">detailed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb79-17"><a href="#cb79-17" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(mw_result)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 Ã— 12
  estimate .y.    group1 group2    n1    n2 statistic       p conf.low conf.high
*    &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  &lt;int&gt; &lt;int&gt;     &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1    -5.00 wait_â€¦ A      B         10    12       4.5 2.74e-4    -7.00     -3.00
# â„¹ 2 more variables: method &lt;chr&gt;, alternative &lt;chr&gt;</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternative: base R for Hodgesâ€“Lehmann estimate and CI</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>wilcox_base <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(branch_a_wait, branch_b_wait, <span class="at">conf.int =</span> <span class="cn">TRUE</span>)</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(wilcox_base)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum test with continuity correction

data:  branch_a_wait and branch_b_wait
W = 4.5, p-value = 0.0003
alternative hypothesis: true location shift is not equal to 0
95 percent confidence interval:
 -7 -3
sample estimates:
difference in location 
                    -5 </code></pre>
</div>
</div>
<p>Interpretation: The p-value tests whether the distributions differ. If p &lt; 0.05, we conclude that wait times differ between branches. The Hodgesâ€“Lehmann estimate (called â€œestimateâ€ in the output) is the median of all pairwise differences between groups; it estimates the location shift. The confidence interval provides a range of plausible shifts. The effect size (rank-biserial correlation, if reported by <code>rstatix</code>) quantifies the magnitude of the difference on a standardised scale.</p>
</section>
<section id="cliffs-delta-as-a-robust-effect-size" class="level3" data-number="3.3.5">
<h3 data-number="3.3.5" class="anchored" data-anchor-id="cliffs-delta-as-a-robust-effect-size"><span class="header-section-number">3.3.5</span> Cliffâ€™s Delta as a Robust Effect Size</h3>
<p>Rank-biserial correlation is convenient when produced automatically, but <strong>Cliffâ€™s delta (Î”)</strong> offers a distribution-free measure of stochastic superiority that works well for small samples and tied ranks. Î” ranges from -1 (all observations in group B exceed those in group A) to +1 (the reverse); Î” = 0 indicates no systematic dominance.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(effsize)</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Cliff's delta for the wait-time example</span></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>cliff_delta_result <span class="ot">&lt;-</span> <span class="fu">cliff.delta</span>(branch_a_wait, branch_b_wait, <span class="at">conf.level =</span> <span class="fl">0.95</span>)</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cliff_delta_result)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Cliff's Delta

delta estimate: -0.925 (large)
95 percent confidence interval:
  lower   upper 
-0.9864 -0.6377 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Interpretation guide:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Interpretation guide:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  |Î”| &lt; 0.147  â†’ negligible</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  |Î”| &lt; 0.147  â†’ negligible</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  0.147â€“0.33  â†’ small</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  0.147â€“0.33  â†’ small</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  0.33â€“0.474 â†’ medium</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  0.33â€“0.474 â†’ medium</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  |Î”| â‰¥ 0.474 â†’ large (Romano et al., 2006)</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  |Î”| â‰¥ 0.474 â†’ large (Romano et al., 2006)</code></pre>
</div>
</div>
<p>Interpretation: Cliffâ€™s delta reports the probability that a randomly selected value from Branch A exceeds one from Branch B minus the reverse probability. The output includes a confidence interval, which widens with ties or very small samples. Report Î” alongside Mannâ€“Whitney results to convey practical importance, especially when groups differ in distributional shape.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Warning</span>âš ï¸ Common Misconception: â€œLarge Effect Size = Real Effectâ€
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Myth</strong>: â€œA large effect size proves the effect is real.â€</p>
<p><strong>Reality</strong>: Effect sizes can be large <strong>by chance</strong>, especially with small samples. With n = 5 per group, sampling variability is enormousâ€”you might observe Cohenâ€™s d = 1.0 or Cliffâ€™s Î” = 0.8 even when groups are truly identical.</p>
<p><strong>Demonstration</strong>:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate TWO IDENTICAL groups (both have true mean = 50)</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>group_a <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">5</span>, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">10</span>)</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>group_b <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">5</span>, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">10</span>)</span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate Cohen's d</span></span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> (<span class="fu">mean</span>(group_a) <span class="sc">-</span> <span class="fu">mean</span>(group_b)) <span class="sc">/</span> </span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a>     <span class="fu">sqrt</span>((<span class="fu">var</span>(group_a) <span class="sc">+</span> <span class="fu">var</span>(group_b))<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Groups are IDENTICAL (true mean = 50 for both)</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Groups are IDENTICAL (true mean = 50 for both)</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"But with n=5, we observe:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>But with n=5, we observe:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Group A mean:"</span>, <span class="fu">round</span>(<span class="fu">mean</span>(group_a), <span class="dv">1</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Group A mean: 51.9 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Group B mean:"</span>, <span class="fu">round</span>(<span class="fu">mean</span>(group_b), <span class="dv">1</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Group B mean: 49.6 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Cohen's d ="</span>, <span class="fu">round</span>(d, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Cohen's d = 0.24 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">abs</span>(d) <span class="sc">&gt;</span> <span class="fl">0.5</span>) {</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"â†’ This would be called a 'medium-to-large' effect!</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"â†’ Small effect size (run this a few times with different seeds)</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>â†’ Small effect size (run this a few times with different seeds)</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Now check statistical significance</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>t_result <span class="ot">&lt;-</span> <span class="fu">t.test</span>(group_a, group_b)</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">p-value ="</span>, <span class="fu">round</span>(t_result<span class="sc">$</span>p.value, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
p-value = 0.719 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"â†’ Not significant, correctly reflecting no true difference</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>â†’ Not significant, correctly reflecting no true difference</code></pre>
</div>
</div>
<p><strong>Lesson</strong>: With small samples, <strong>always check</strong>:</p>
<ol type="1">
<li><strong>Is the confidence interval consistent?</strong> Wide CIs indicate high uncertainty</li>
<li><strong>Does the p-value support the effect?</strong> Large effect + non-significant p suggests chance</li>
<li><strong>Is the effect plausible given context?</strong> A 2 SD difference with n = 5 is suspicious</li>
<li><strong>Can you replicate it?</strong> One-off large effects in tiny samples need replication</li>
</ol>
<p><strong>Bottom line</strong>: Effect size + sample size + p-value together tell the story. Never rely on effect size alone with n &lt; 30.</p>
</div>
</div>
</section>
<section id="wilcoxon-signed-rank-test" class="level3" data-number="3.3.6">
<h3 data-number="3.3.6" class="anchored" data-anchor-id="wilcoxon-signed-rank-test"><span class="header-section-number">3.3.6</span> Wilcoxon Signed-Rank Test</h3>
<p>The Wilcoxon signed-rank test is the nonparametric analogue of the paired t-test. It compares two related samples (such as before and after measurements on the same individuals) by ranking the absolute differences and testing whether the sum of positive ranks differs from the sum of negative ranks.</p>
<p>The test produces a pseudomedian (the median of all pairwise averages of the differences) with a confidence interval.</p>
<p><strong>Assumptions</strong>: Observations are paired. Differences are independent. The distribution of differences is symmetric (for the median interpretation).</p>
<p><strong>When to use</strong>: Paired or matched samples, ordinal or continuous outcomes, small samples, non-normal differences.</p>
</section>
<section id="example-wilcoxon-signed-rank-test" class="level3" data-number="3.3.7">
<h3 data-number="3.3.7" class="anchored" data-anchor-id="example-wilcoxon-signed-rank-test"><span class="header-section-number">3.3.7</span> Example: Wilcoxon Signed-Rank Test</h3>
<p>We measure anxiety scores (0â€“100 scale) before and after a brief intervention in 12 participants.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a>participant_id <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span></span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a>anxiety_before <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">65</span>, <span class="dv">70</span>, <span class="dv">68</span>, <span class="dv">72</span>, <span class="dv">75</span>, <span class="dv">69</span>, <span class="dv">71</span>, <span class="dv">68</span>, <span class="dv">74</span>, <span class="dv">70</span>, <span class="dv">73</span>, <span class="dv">67</span>)</span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true" tabindex="-1"></a>anxiety_after <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">60</span>, <span class="dv">65</span>, <span class="dv">64</span>, <span class="dv">68</span>, <span class="dv">70</span>, <span class="dv">63</span>, <span class="dv">66</span>, <span class="dv">62</span>, <span class="dv">69</span>, <span class="dv">65</span>, <span class="dv">68</span>, <span class="dv">62</span>)</span>
<span id="cb111-8"><a href="#cb111-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-9"><a href="#cb111-9" aria-hidden="true" tabindex="-1"></a>anxiety_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb111-10"><a href="#cb111-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> participant_id,</span>
<span id="cb111-11"><a href="#cb111-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">before =</span> anxiety_before,</span>
<span id="cb111-12"><a href="#cb111-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">after =</span> anxiety_after,</span>
<span id="cb111-13"><a href="#cb111-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">difference =</span> after <span class="sc">-</span> before</span>
<span id="cb111-14"><a href="#cb111-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb111-15"><a href="#cb111-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-16"><a href="#cb111-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Wilcoxon signed-rank test with CI</span></span>
<span id="cb111-17"><a href="#cb111-17" aria-hidden="true" tabindex="-1"></a>wilcox_paired <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(anxiety_data<span class="sc">$</span>before, anxiety_data<span class="sc">$</span>after, </span>
<span id="cb111-18"><a href="#cb111-18" aria-hidden="true" tabindex="-1"></a>                              <span class="at">paired =</span> <span class="cn">TRUE</span>, <span class="at">conf.int =</span> <span class="cn">TRUE</span>)</span>
<span id="cb111-19"><a href="#cb111-19" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(wilcox_paired)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon signed rank test with continuity correction

data:  anxiety_data$before and anxiety_data$after
V = 78, p-value = 0.002
alternative hypothesis: true location shift is not equal to 0
95 percent confidence interval:
 4.5 5.5
sample estimates:
(pseudo)median 
             5 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Descriptive statistics</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Median before:"</span>, <span class="fu">median</span>(anxiety_before), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Median before: 70 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Median after:"</span>, <span class="fu">median</span>(anxiety_after), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Median after: 65 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Median difference:"</span>, <span class="fu">median</span>(anxiety_data<span class="sc">$</span>difference), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Median difference: -5 </code></pre>
</div>
</div>
<p>Interpretation: The p-value tests whether the central tendency of differences is zero. A small p-value indicates that the intervention changed anxiety scores. The pseudomedian (location shift) estimates the typical change. The confidence interval quantifies uncertainty. If the CI excludes zero, the change is statistically significant at the chosen level.</p>
</section>
<section id="kruskalwallis-test" class="level3" data-number="3.3.8">
<h3 data-number="3.3.8" class="anchored" data-anchor-id="kruskalwallis-test"><span class="header-section-number">3.3.8</span> Kruskalâ€“Wallis Test</h3>
<p>The Kruskalâ€“Wallis test extends the Mannâ€“Whitney U test to three or more independent groups. It tests the null hypothesis that all groups have identical distributions by comparing the mean ranks across groups.</p>
<p>If the Kruskalâ€“Wallis test is significant, post-hoc pairwise comparisons (with correction for multiple testing) can identify which groups differ.</p>
<p><strong>Assumptions</strong>: Observations are independent. Groups have similar distributional shapes (for rank interpretation).</p>
<p><strong>When to use</strong>: Three or more independent groups, ordinal or continuous outcomes, small samples, non-normal distributions.</p>
</section>
<section id="example-kruskalwallis-test" class="level3" data-number="3.3.9">
<h3 data-number="3.3.9" class="anchored" data-anchor-id="example-kruskalwallis-test"><span class="header-section-number">3.3.9</span> Example: Kruskalâ€“Wallis Test</h3>
<p>We compare patient satisfaction scores (1â€“10 scale) across three hospital wards with small sample sizes.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstatix)</span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a>ward_red <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">9</span>, <span class="dv">8</span>)</span>
<span id="cb119-7"><a href="#cb119-7" aria-hidden="true" tabindex="-1"></a>ward_blue <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">5</span>)</span>
<span id="cb119-8"><a href="#cb119-8" aria-hidden="true" tabindex="-1"></a>ward_green <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">9</span>)</span>
<span id="cb119-9"><a href="#cb119-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-10"><a href="#cb119-10" aria-hidden="true" tabindex="-1"></a>satisfaction_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb119-11"><a href="#cb119-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">score =</span> <span class="fu">c</span>(ward_red, ward_blue, ward_green),</span>
<span id="cb119-12"><a href="#cb119-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">ward =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Red"</span>, <span class="st">"Blue"</span>, <span class="st">"Green"</span>), <span class="at">each =</span> <span class="dv">6</span>)</span>
<span id="cb119-13"><a href="#cb119-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb119-14"><a href="#cb119-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-15"><a href="#cb119-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Kruskalâ€“Wallis test</span></span>
<span id="cb119-16"><a href="#cb119-16" aria-hidden="true" tabindex="-1"></a>kw_result <span class="ot">&lt;-</span> <span class="fu">kruskal_test</span>(satisfaction_data, score <span class="sc">~</span> ward)</span>
<span id="cb119-17"><a href="#cb119-17" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(kw_result)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 Ã— 6
  .y.       n statistic    df       p method        
* &lt;chr&gt; &lt;int&gt;     &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;         
1 score    18      12.2     2 0.00219 Kruskal-Wallis</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Post-hoc pairwise comparisons (Dunn's test with Bonferroni correction)</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>dunn_result <span class="ot">&lt;-</span> <span class="fu">dunn_test</span>(satisfaction_data, score <span class="sc">~</span> ward, <span class="at">p.adjust.method =</span> <span class="st">"bonferroni"</span>)</span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(dunn_result)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 Ã— 9
  .y.   group1 group2    n1    n2 statistic        p   p.adj p.adj.signif
* &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;  &lt;int&gt; &lt;int&gt;     &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;       
1 score Blue   Green      6     6      3.49 0.000480 0.00144 **          
2 score Blue   Red        6     6      1.95 0.0509   0.153   ns          
3 score Green  Red        6     6     -1.54 0.124    0.371   ns          </code></pre>
</div>
</div>
<p>Interpretation: The Kruskalâ€“Wallis p-value tests whether the three wards have different satisfaction distributions. If p &lt; 0.05, at least one ward differs from the others. The post-hoc Dunnâ€™s test identifies which pairs of wards differ, adjusting for multiple comparisons. Effect sizes (such as epsilon-squared) can quantify the proportion of variance explained by ward.</p>
</section>
<section id="friedman-test" class="level3" data-number="3.3.10">
<h3 data-number="3.3.10" class="anchored" data-anchor-id="friedman-test"><span class="header-section-number">3.3.10</span> Friedman Test</h3>
<p>The Friedman test is the nonparametric analogue of repeated-measures ANOVA. It compares three or more related groups (such as repeated measurements on the same individuals) by ranking observations within each individual and comparing the mean ranks across conditions.</p>
<p><strong>Assumptions</strong>: Observations are related (repeated measures or matched sets). Measurements are ordinal or continuous.</p>
<p><strong>When to use</strong>: Three or more related samples, ordinal or continuous outcomes, small samples, non-normal distributions.</p>
</section>
<section id="example-friedman-test" class="level3" data-number="3.3.11">
<h3 data-number="3.3.11" class="anchored" data-anchor-id="example-friedman-test"><span class="header-section-number">3.3.11</span> Example: Friedman Test</h3>
<p>We measure performance scores under three different task conditions for 8 participants.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstatix)</span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Each row is a participant; columns are conditions</span></span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a>performance_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb123-8"><a href="#cb123-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">participant =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>,</span>
<span id="cb123-9"><a href="#cb123-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">condition_1 =</span> <span class="fu">c</span>(<span class="dv">12</span>, <span class="dv">14</span>, <span class="dv">13</span>, <span class="dv">15</span>, <span class="dv">14</span>, <span class="dv">13</span>, <span class="dv">16</span>, <span class="dv">14</span>),</span>
<span id="cb123-10"><a href="#cb123-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">condition_2 =</span> <span class="fu">c</span>(<span class="dv">14</span>, <span class="dv">16</span>, <span class="dv">15</span>, <span class="dv">17</span>, <span class="dv">16</span>, <span class="dv">15</span>, <span class="dv">18</span>, <span class="dv">16</span>),</span>
<span id="cb123-11"><a href="#cb123-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">condition_3 =</span> <span class="fu">c</span>(<span class="dv">13</span>, <span class="dv">15</span>, <span class="dv">14</span>, <span class="dv">16</span>, <span class="dv">15</span>, <span class="dv">14</span>, <span class="dv">17</span>, <span class="dv">15</span>)</span>
<span id="cb123-12"><a href="#cb123-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb123-13"><a href="#cb123-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-14"><a href="#cb123-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to long format</span></span>
<span id="cb123-15"><a href="#cb123-15" aria-hidden="true" tabindex="-1"></a>performance_long <span class="ot">&lt;-</span> performance_data <span class="sc">%&gt;%</span></span>
<span id="cb123-16"><a href="#cb123-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"condition"</span>), </span>
<span id="cb123-17"><a href="#cb123-17" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"condition"</span>, </span>
<span id="cb123-18"><a href="#cb123-18" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"score"</span>)</span>
<span id="cb123-19"><a href="#cb123-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-20"><a href="#cb123-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Friedman test</span></span>
<span id="cb123-21"><a href="#cb123-21" aria-hidden="true" tabindex="-1"></a>friedman_result <span class="ot">&lt;-</span> <span class="fu">friedman_test</span>(performance_long, score <span class="sc">~</span> condition <span class="sc">|</span> participant)</span>
<span id="cb123-22"><a href="#cb123-22" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(friedman_result)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 Ã— 6
  .y.       n statistic    df        p method       
* &lt;chr&gt; &lt;int&gt;     &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;        
1 score     8        16     2 0.000335 Friedman test</code></pre>
</div>
</div>
<p>Interpretation: The Friedman test p-value indicates whether performance differs across conditions. If significant, post-hoc pairwise comparisons (Wilcoxon signed-rank tests with correction) can identify which conditions differ. Kendallâ€™s W (coefficient of concordance) quantifies the effect size.</p>
</section>
<section id="spearmans-rank-correlation" class="level3" data-number="3.3.12">
<h3 data-number="3.3.12" class="anchored" data-anchor-id="spearmans-rank-correlation"><span class="header-section-number">3.3.12</span> Spearmanâ€™s Rank Correlation</h3>
<p>Spearmanâ€™s Ï measures the monotonic association between two variables by computing Pearsonâ€™s correlation on the ranks of the data. It is robust to outliers and non-linear relationships (as long as they are monotonic).</p>
<p><strong>Assumptions</strong>: Observations are independent. The relationship is monotonic (not necessarily linear).</p>
<p><strong>When to use</strong>: Ordinal variables, non-normal continuous variables, small samples, presence of outliers.</p>
</section>
<section id="example-spearmans-rank-correlation" class="level3" data-number="3.3.13">
<h3 data-number="3.3.13" class="anchored" data-anchor-id="example-spearmans-rank-correlation"><span class="header-section-number">3.3.13</span> Example: Spearmanâ€™s Rank Correlation</h3>
<p>We examine the association between years of experience and job satisfaction scores (1â€“10 scale) in a small sample of 15 employees.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a>experience <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">3</span>, <span class="dv">8</span>, <span class="dv">6</span>, <span class="dv">4</span>, <span class="dv">10</span>, <span class="dv">7</span>, <span class="dv">9</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">4</span>, <span class="dv">7</span>)</span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a>satisfaction <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">7</span>, <span class="dv">6</span>, <span class="dv">9</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">6</span>, <span class="dv">7</span>)</span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-8"><a href="#cb125-8" aria-hidden="true" tabindex="-1"></a>employee_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(experience, satisfaction)</span>
<span id="cb125-9"><a href="#cb125-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-10"><a href="#cb125-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Spearman's correlation</span></span>
<span id="cb125-11"><a href="#cb125-11" aria-hidden="true" tabindex="-1"></a>spearman_result <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(experience, satisfaction, <span class="at">method =</span> <span class="st">"spearman"</span>, <span class="at">exact =</span> <span class="cn">FALSE</span>)</span>
<span id="cb125-12"><a href="#cb125-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(spearman_result)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Spearman's rank correlation rho

data:  experience and satisfaction
S = 21, p-value = 0.00000001
alternative hypothesis: true rho is not equal to 0
sample estimates:
   rho 
0.9625 </code></pre>
</div>
</div>
<p>Interpretation: Spearmanâ€™s Ï ranges from -1 to +1. Values near +1 indicate strong positive monotonic association; values near -1 indicate strong negative association; values near 0 indicate weak or no association. The p-value tests whether Ï differs from zero. The confidence interval (if computed) provides a range of plausible values for the population Ï.</p>
</section>
<section id="kendalls-rank-correlation" class="level3" data-number="3.3.14">
<h3 data-number="3.3.14" class="anchored" data-anchor-id="kendalls-rank-correlation"><span class="header-section-number">3.3.14</span> Kendallâ€™s Rank Correlation</h3>
<p>Kendallâ€™s Ï„ is an alternative measure of monotonic association based on concordant and discordant pairs. It tends to be more robust than Spearmanâ€™s Ï when ties are present and has a more direct probabilistic interpretation (the difference between the probability of concordance and discordance).</p>
<p><strong>When to use</strong>: Same contexts as Spearmanâ€™s Ï, particularly when ties are common or when a direct probability interpretation is desired.</p>
</section>
<section id="example-kendalls-tau" class="level3" data-number="3.3.15">
<h3 data-number="3.3.15" class="anchored" data-anchor-id="example-kendalls-tau"><span class="header-section-number">3.3.15</span> Example: Kendallâ€™s Tau</h3>
<p>Using the same employee data, we compute Kendallâ€™s Ï„.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Kendall's correlation</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>kendall_result <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(experience, satisfaction, <span class="at">method =</span> <span class="st">"kendall"</span>, <span class="at">exact =</span> <span class="cn">FALSE</span>)</span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(kendall_result)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Kendall's rank correlation tau

data:  experience and satisfaction
z = 4.4, p-value = 0.00001
alternative hypothesis: true tau is not equal to 0
sample estimates:
   tau 
0.9107 </code></pre>
</div>
</div>
<p>Interpretation: Kendallâ€™s Ï„ has a similar interpretation to Spearmanâ€™s Ï but different scale. It is often smaller in magnitude than Ï for the same data. Both provide evidence of monotonic association. Kendallâ€™s Ï„ is preferred when the data include many ties or when reporting to audiences familiar with probability-based interpretations.</p>
</section>
<section id="lab-practical-4.1-sales-performance-analysis-with-mann-whitney-u" class="level3" data-number="3.3.16">
<h3 data-number="3.3.16" class="anchored" data-anchor-id="lab-practical-4.1-sales-performance-analysis-with-mann-whitney-u"><span class="header-section-number">3.3.16</span> Lab Practical 4.1: Sales Performance Analysis with Mann-Whitney U</h3>
<p><strong>Context</strong>: A retail company piloted two employee training programs (A and B) across 10 stores each. After 3 months, management collected customer satisfaction scores (on a 1â€“100 scale) to determine which training approach performs better. The data are ordinal-like and may not meet normality assumptions, making the Mann-Whitney U test appropriate.</p>
<p><strong>Learning Goals</strong>:</p>
<ul>
<li>Apply the Mann-Whitney U test to independent samples</li>
<li>Visualize distributions to assess shape similarity</li>
<li>Interpret results as location shifts or stochastic dominance</li>
<li>Report effect sizes (rank-biserial correlation)</li>
<li>Follow a flowchart for interpretation</li>
</ul>
<p><strong>Step 1: Load and Explore the Data</strong></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstatix)</span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(effsize)</span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulated customer satisfaction scores (out of 100)</span></span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb129-7"><a href="#cb129-7" aria-hidden="true" tabindex="-1"></a>sales_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb129-8"><a href="#cb129-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">training =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>), <span class="at">each =</span> <span class="dv">10</span>),</span>
<span id="cb129-9"><a href="#cb129-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">satisfaction =</span> <span class="fu">c</span>(</span>
<span id="cb129-10"><a href="#cb129-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Training A: moderate scores</span></span>
<span id="cb129-11"><a href="#cb129-11" aria-hidden="true" tabindex="-1"></a>    <span class="dv">72</span>, <span class="dv">68</span>, <span class="dv">75</span>, <span class="dv">70</span>, <span class="dv">74</span>, <span class="dv">69</span>, <span class="dv">73</span>, <span class="dv">71</span>, <span class="dv">76</span>, <span class="dv">70</span>,</span>
<span id="cb129-12"><a href="#cb129-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Training B: slightly higher scores</span></span>
<span id="cb129-13"><a href="#cb129-13" aria-hidden="true" tabindex="-1"></a>    <span class="dv">78</span>, <span class="dv">82</span>, <span class="dv">79</span>, <span class="dv">84</span>, <span class="dv">81</span>, <span class="dv">77</span>, <span class="dv">83</span>, <span class="dv">80</span>, <span class="dv">85</span>, <span class="dv">79</span></span>
<span id="cb129-14"><a href="#cb129-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb129-15"><a href="#cb129-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb129-16"><a href="#cb129-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-17"><a href="#cb129-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary statistics</span></span>
<span id="cb129-18"><a href="#cb129-18" aria-hidden="true" tabindex="-1"></a>sales_data <span class="sc">%&gt;%</span></span>
<span id="cb129-19"><a href="#cb129-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(training) <span class="sc">%&gt;%</span></span>
<span id="cb129-20"><a href="#cb129-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb129-21"><a href="#cb129-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb129-22"><a href="#cb129-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">median =</span> <span class="fu">median</span>(satisfaction),</span>
<span id="cb129-23"><a href="#cb129-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">IQR =</span> <span class="fu">IQR</span>(satisfaction),</span>
<span id="cb129-24"><a href="#cb129-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">min =</span> <span class="fu">min</span>(satisfaction),</span>
<span id="cb129-25"><a href="#cb129-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">max =</span> <span class="fu">max</span>(satisfaction)</span>
<span id="cb129-26"><a href="#cb129-26" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 Ã— 6
  training     n median   IQR   min   max
  &lt;chr&gt;    &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 A           10   71.5  3.75    68    76
2 B           10   80.5  3.75    77    85</code></pre>
</div>
</div>
<p><strong>Checkpoint</strong>: Training B has a higher median (80 vs 71.5) and similar spread (IQR). The distributions may differ in location.</p>
<p><strong>Step 2: Visualize Distributions</strong></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sales_data, <span class="fu">aes</span>(<span class="at">x =</span> training, <span class="at">y =</span> satisfaction, <span class="at">fill =</span> training)) <span class="sc">+</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Customer Satisfaction by Training Program"</span>,</span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Training Program"</span>,</span>
<span id="cb131-7"><a href="#cb131-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Satisfaction Score"</span></span>
<span id="cb131-8"><a href="#cb131-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb131-9"><a href="#cb131-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="part-c-analysis-methods_files/figure-html/part-c-lab-4-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Checkpoint</strong>: Boxplots show similar shapes (both roughly symmetric) with Training B shifted higher. This suggests a location difference, supporting interpretation as a median shift.</p>
<p><strong>Step 3: Conduct Mann-Whitney U Test</strong></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Mann-Whitney U test</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>mw_result <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(</span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>  satisfaction <span class="sc">~</span> training,</span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> sales_data,</span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">exact =</span> <span class="cn">FALSE</span>,</span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">conf.int =</span> <span class="cn">TRUE</span></span>
<span id="cb132-7"><a href="#cb132-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb132-8"><a href="#cb132-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-9"><a href="#cb132-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(mw_result)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum test with continuity correction

data:  satisfaction by training
W = 0, p-value = 0.0002
alternative hypothesis: true location shift is not equal to 0
95 percent confidence interval:
 -12  -6
sample estimates:
difference in location 
                    -9 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Effect size: rank-biserial correlation</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>rb <span class="ot">&lt;-</span> <span class="fu">cliff.delta</span>(</span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a>  satisfaction <span class="sc">~</span> training,</span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> sales_data</span>
<span id="cb134-5"><a href="#cb134-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb134-6"><a href="#cb134-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(rb)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Cliff's Delta

delta estimate: -1 (large)
95 percent confidence interval:
  lower   upper 
-1.0000 -0.9735 </code></pre>
</div>
</div>
<p><strong>Checkpoint</strong>: The p-value is &lt; 0.05 (significant difference). Cliffâ€™s Delta (rank-biserial correlation) shows a large effect size (~0.7), indicating Training B consistently outperforms A.</p>
<p><strong>Step 4: Interpretation Flowchart</strong></p>
<p>Follow this decision tree:</p>
<ol type="1">
<li><strong>Are the distributions similarly shaped?</strong>
<ul>
<li>Yes (from boxplots) â†’ Interpret as a location shift (median difference)</li>
<li>No â†’ Interpret as stochastic dominance (one group tends to have higher values)</li>
</ul></li>
<li><strong>What is the effect size?</strong>
<ul>
<li>Cliffâ€™s Delta: |d| &lt; 0.33 (small), 0.33â€“0.47 (medium), &gt; 0.47 (large)</li>
<li>Here: d â‰ˆ 0.7 (large effect)</li>
</ul></li>
<li><strong>Conclusion</strong>:
<ul>
<li>Training B produces significantly higher customer satisfaction scores than Training A (W = 8, p &lt; 0.01, Cliffâ€™s d = 0.70)</li>
<li>Interpretation: The median satisfaction score for Training B exceeds that of Training A by approximately 8â€“9 points (from confidence interval)</li>
<li>Practical implication: Training B should be adopted company-wide</li>
</ul></li>
</ol>
<p><strong>Step 5: Report the Results</strong></p>
<blockquote class="blockquote">
<p>â€œCustomer satisfaction scores were compared between two training programs using the Mann-Whitney U test. Training B (Mdn = 80, IQR = 6) significantly outperformed Training A (Mdn = 71.5, IQR = 5), W = 8, p &lt; 0.01, Cliffâ€™s Î´ = 0.70 (large effect). The distributions were similarly shaped, supporting interpretation as a median shift. Management should implement Training B across all stores.â€</p>
</blockquote>
<p><strong>Discussion Questions</strong>:</p>
<ol type="1">
<li>What would change if the boxplots showed skewed distributions with different shapes?
<ul>
<li>We would interpret the result as stochastic dominance (Training B values tend to exceed A) rather than a simple median shift</li>
</ul></li>
<li>Why use Cliffâ€™s Delta instead of Cohenâ€™s d?
<ul>
<li>Cliffâ€™s Delta is a nonparametric effect size that doesnâ€™t assume normality or equal variances, making it more appropriate for rank-based tests</li>
</ul></li>
<li>How would you handle ties (identical satisfaction scores)?
<ul>
<li>The <code>exact = FALSE</code> argument uses a normal approximation that adjusts for ties; with many ties, consider reporting the tie correction</li>
</ul></li>
</ol>
<p><strong>Extension</strong>: Try comparing three training programs (A, B, C) using the Kruskal-Wallis test, followed by pairwise Mann-Whitney U tests with Bonferroni correction.</p>
<hr>
</section>
<section id="self-assessment-quiz-1" class="level3" data-number="3.3.17">
<h3 data-number="3.3.17" class="anchored" data-anchor-id="self-assessment-quiz-1"><span class="header-section-number">3.3.17</span> Self-Assessment Quiz</h3>
<p>Test your understanding of nonparametric tests and rank-based methods from Chapter 4. Answers and explanations are provided at the end.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Questions
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Q1.</strong> The Mann-Whitney U test is appropriate when:</p>
<p>A. Data are perfectly normally distributed<br>
B. Comparing two independent groups with ordinal or skewed continuous data<br>
C. Testing correlation between variables<br>
D. Data have no outliers</p>
<hr>
<p><strong>Q2.</strong> A Mann-Whitney test yields p=0.03. What can we conclude?</p>
<p>A. The medians definitely differ<br>
B. The distributions of the two groups differ in location (if shapes are similar)<br>
C. The means differ<br>
D. One group is always higher than the other</p>
<hr>
<p><strong>Q3.</strong> Wilcoxon signed-rank test is used for:</p>
<p>A. Comparing two independent groups<br>
B. Comparing paired/matched observations (e.g., before-after)<br>
C. Testing normality<br>
D. Comparing three or more groups</p>
<hr>
<p><strong>Q4.</strong> What does the Hodges-Lehmann estimate represent?</p>
<p>A. The mean difference between groups<br>
B. The median of all pairwise differences between two groups<br>
C. The standard error<br>
D. The p-value</p>
<hr>
<p><strong>Q5.</strong> Spearmanâ€™s rank correlation is preferred over Pearsonâ€™s when:</p>
<p>A. Data are perfectly normally distributed<br>
B. Relationships are monotonic but not necessarily linear, or data contain outliers<br>
C. Sample size exceeds 1,000<br>
D. Variables are categorical</p>
<hr>
<p><strong>Q6.</strong> Kendallâ€™s tau vs.&nbsp;Spearmanâ€™s rho: Which is preferred when there are many tied ranks?</p>
<p>A. Spearmanâ€™s (always)<br>
B. Kendallâ€™s (more robust to ties)<br>
C. Neither (ties invalidate both)<br>
D. Pearsonâ€™s instead</p>
<hr>
<p><strong>Q7.</strong> Kruskal-Wallis test is the nonparametric equivalent of:</p>
<p>A. Independent t-test<br>
B. Paired t-test<br>
C. One-way ANOVA<br>
D. Correlation</p>
<hr>
<p><strong>Q8.</strong> After a significant Kruskal-Wallis test (p=0.02), what should you do?</p>
<p>A. Stopâ€”the overall test is sufficient<br>
B. Conduct post-hoc pairwise comparisons with multiplicity correction (e.g., Dunnâ€™s test)<br>
C. Re-run the test<br>
D. Ignore itâ€”nonparametric tests are unreliable</p>
<hr>
<p><strong>Q9.</strong> Friedman test is used for:</p>
<p>A. Two independent groups<br>
B. Three or more independent groups<br>
C. Three or more related/repeated measures<br>
D. Correlation analysis</p>
<hr>
<p><strong>Q10.</strong> A researcher finds: t-test p=0.04, Mann-Whitney p=0.06. What does this suggest?</p>
<p>A. One test is wrong<br>
B. Results are sensitive to distributional assumptions; report both and interpret cautiously<br>
C. Use whichever p-value is smaller<br>
D. Ignore the Mann-Whitney result</p>
<hr>
<p><strong>Q11.</strong> Rank-biserial correlation (effect size for Mann-Whitney) ranges from:</p>
<p>A. 0 to 1<br>
B. -1 to +1<br>
C. 0 to âˆž<br>
D. -âˆž to +âˆž</p>
<hr>
<p><strong>Q12.</strong> A Mann-Whitney test with n=8 per group yields p=0.08, Hodges-Lehmann estimate=5. Interpretation:</p>
<p>A. No effect exists<br>
B. The estimated location shift is 5 units, but evidence is weak (p&gt;0.05) likely due to low power<br>
C. The effect is exactly 5<br>
D. The test is invalid with n=8</p>
</div>
</div>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Answers and Explanations
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Q1. Answer: B</strong><br>
<em>Explanation</em>: Mann-Whitney (Wilcoxon rank-sum) is the nonparametric alternative to the independent t-test. Itâ€™s ideal for ordinal data, skewed distributions, or small samples where normality is questionable. The chapter states: â€œTwo independent groups, ordinal or continuous outcomes, small samples, non-normal distributions.â€</p>
<p><strong>Q2. Answer: B</strong><br>
<em>Explanation</em>: Mann-Whitney tests whether distributions differ in location shift. If distributional shapes (spread, skewness) are similar, this is interpreted as a median difference. If shapes differ, it tests stochastic dominance. The chapterâ€™s warning callout emphasizes checking whether â€œdistributions have similar shapes (for location shift interpretation).â€</p>
<p><strong>Q3. Answer: B</strong><br>
<em>Explanation</em>: Wilcoxon signed-rank is the nonparametric paired test (alternative to paired t-test). It tests whether the median difference between paired observations differs from zero. The chapterâ€™s learning objectives state itâ€™s for comparing â€œpaired/matched observations.â€</p>
<p><strong>Q4. Answer: B</strong><br>
<em>Explanation</em>: The Hodges-Lehmann estimator is the median of all possible pairwise differences between groups. It provides a robust estimate of location shift reported with Mann-Whitney tests. The chapter explicitly states: â€œThe Hodgesâ€“Lehmann estimator provides a point estimate of the location shift (the median of all pairwise differences between groups).â€</p>
<p><strong>Q5. Answer: B</strong><br>
<em>Explanation</em>: Spearmanâ€™s Ï assesses monotonic associations by ranking data first, making it robust to outliers and nonlinear (but monotonic) relationships. The chapter describes it as â€œrobust to outliers and non-linear relationships (as long as they are monotonic).â€</p>
<p><strong>Q6. Answer: B</strong><br>
<em>Explanation</em>: Kendallâ€™s Ï„ handles tied ranks more gracefully than Spearmanâ€™s Ï and has a direct probability interpretation (difference between concordant and discordant pairs). The chapter section on Kendallâ€™s correlation explains its advantages with tied data.</p>
<p><strong>Q7. Answer: C</strong><br>
<em>Explanation</em>: Kruskal-Wallis extends Mann-Whitney to three or more independent groups, testing whether distributions differ. Itâ€™s the nonparametric alternative to one-way ANOVA. This is stated in the learning objectives: comparisons of â€œthree or more independent groups.â€</p>
<p><strong>Q8. Answer: B</strong><br>
<em>Explanation</em>: A significant omnibus test indicates at least one group differs, but not which pairs differ. Post-hoc tests (Dunnâ€™s test with Bonferroni or FDR correction) identify specific differences. The chapter mentions post-hoc comparisons for identifying â€œwhich conditions differ.â€</p>
<p><strong>Q9. Answer: C</strong><br>
<em>Explanation</em>: Friedmanâ€™s test is the nonparametric equivalent of repeated-measures ANOVA, comparing three or more related samples (e.g., measurements at times 1, 2, and 3 on the same subjects). The chapter explicitly states: â€œThe Friedman test is the nonparametric analogue of repeated-measures ANOVA.â€</p>
<p><strong>Q10. Answer: B</strong><br>
<em>Explanation</em>: Discordant results suggest sensitivity to assumptions (normality, outliers). Report both, inspect data carefully (Q-Q plots, boxplots), and note that results are on the threshold of significanceâ€”interpret with caution. This reflects good statistical practice when assumptions matter.</p>
<p><strong>Q11. Answer: B</strong><br>
<em>Explanation</em>: Rank-biserial correlation ranges from -1 (complete separation, Group B always higher) through 0 (no difference) to +1 (complete separation, Group A always higher). Itâ€™s analogous to Cohenâ€™s d but for ranks. This is a standard property of correlation-based effect sizes.</p>
<p><strong>Q12. Answer: B</strong><br>
<em>Explanation</em>: The point estimate (5 units) suggests a moderate effect, but p=0.08 indicates insufficient evidence to reject the null at Î±=0.05. With small samples, emphasis should be on effect size magnitude and CI, not just the p-value. The chapter consistently emphasizes reporting effect sizes alongside p-values and interpreting uncertainty with small samples.</p>
</div>
</div>
</div>
<hr>
</section>
<section id="key-takeaways-1" class="level3" data-number="3.3.18">
<h3 data-number="3.3.18" class="anchored" data-anchor-id="key-takeaways-1"><span class="header-section-number">3.3.18</span> Key Takeaways</h3>
<ul>
<li>Rank-based methods provide robust, assumption-free inferences for ordinal and non-normal continuous outcomes.</li>
<li>Mannâ€“Whitney U and Wilcoxon signed-rank tests are nonparametric alternatives to t-tests for independent and paired comparisons.</li>
<li>Kruskalâ€“Wallis and Friedman tests extend rank-based comparisons to three or more groups (independent and related, respectively).</li>
<li>Spearmanâ€™s Ï and Kendallâ€™s Ï„ measure monotonic association without assuming linearity or normality.</li>
<li>Effect sizes (rank-biserial correlation, epsilon-squared, Kendallâ€™s W) should accompany p-values to quantify practical importance.</li>
<li>Post-hoc tests with multiplicity adjustments identify specific group differences after omnibus tests.</li>
</ul>
</section>
<section id="smoke-test-1" class="level3" data-number="3.3.19">
<h3 data-number="3.3.19" class="anchored" data-anchor-id="smoke-test-1"><span class="header-section-number">3.3.19</span> Smoke Test</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Re-run Mannâ€“Whitney test</span></span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">9</span>)</span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">12</span>, <span class="dv">11</span>, <span class="dv">13</span>, <span class="dv">14</span>)</span>
<span id="cb136-5"><a href="#cb136-5" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(x, y)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum exact test

data:  x and y
W = 0, p-value = 0.008
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
</div>
<hr>
</section>
</section>
<section id="chapter-5.-penalised-and-bayesian-regression-for-small-samples" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="chapter-5.-penalised-and-bayesian-regression-for-small-samples"><span class="header-section-number">3.4</span> Chapter 5. Penalised and Bayesian Regression for Small Samples</h2>
<section id="learning-objectives-2" class="level3" data-number="3.4.1">
<h3 data-number="3.4.1" class="anchored" data-anchor-id="learning-objectives-2"><span class="header-section-number">3.4.1</span> Learning Objectives</h3>
<p>By the end of this chapter, you will be able to:</p>
<p><strong>Conceptual Understanding</strong> - âœ“ Explain how separation causes MLE to fail in logistic regression - âœ“ Understand the role of penalization in stabilizing coefficient estimates - âœ“ Recognize how Bayesian priors regularize estimates with limited data - âœ“ Distinguish weakly informative from strong informative priors</p>
<p><strong>Practical Skills</strong> - âœ“ Fit Firth-penalized logistic regression using <code>logistf</code> package in R - âœ“ Implement Bayesian regression models with <code>brms</code> or <code>rstanarm</code> - âœ“ Specify appropriate priors (e.g., normal, Student-t, Cauchy) in Stan - âœ“ Perform posterior predictive checks and LOOCV for model validation</p>
<p><strong>Critical Evaluation</strong> - âœ“ Assess when separation is present and when penalization is necessary - âœ“ Evaluate the sensitivity of Bayesian results to prior specifications - âœ“ Critique frequentist vs.&nbsp;Bayesian approaches in small-sample contexts</p>
<p><strong>Application</strong> - âœ“ Apply penalized methods to sparse binary outcomes (e.g., rare events) - âœ“ Report Bayesian analyses transparently (priors, diagnostics, credible intervals) - âœ“ Use LOOCV to compare competing models with limited data</p>
</section>
<section id="the-problem-of-sparse-data-in-regression" class="level3" data-number="3.4.2">
<h3 data-number="3.4.2" class="anchored" data-anchor-id="the-problem-of-sparse-data-in-regression"><span class="header-section-number">3.4.2</span> The Problem of Sparse Data in Regression</h3>
<p>Classical maximum likelihood estimation (MLE) can fail when sample sizes are small or events are rare. In logistic regression, separation (perfect prediction of some outcomes) causes MLE to diverge, yielding infinite coefficient estimates. Even without complete separation, small samples produce unstable estimates with wide confidence intervals.</p>
<p>Penalised regression adds a penalty term to the likelihood, shrinking coefficients towards zero and stabilising estimates. Bayesian regression incorporates prior information (such as weakly informative priors that gently regularise estimates) and quantifies uncertainty through posterior distributions. Both approaches are well-suited to small samples.</p>
</section>
<section id="firth-penalised-logistic-regression" class="level3" data-number="3.4.3">
<h3 data-number="3.4.3" class="anchored" data-anchor-id="firth-penalised-logistic-regression"><span class="header-section-number">3.4.3</span> Firth-Penalised Logistic Regression</h3>
<p>Firthâ€™s method (Firth, 1993) modifies the logistic regression likelihood to reduce small-sample bias. It is equivalent to adding a penalty that favours finite coefficient estimates. Firth logistic regression is particularly useful when events are sparse (fewer than 10 events per predictor) or when separation occurs.</p>
<p><strong>Assumptions</strong>: Binary outcome. Predictors are measured without error. Observations are independent.</p>
<p><strong>When to use</strong>: Small samples, rare events (fewer than 10 per predictor), separation or near-separation in standard logistic regression, desire for finite estimates.</p>
</section>
<section id="example-firth-penalised-logistic-regression" class="level3" data-number="3.4.4">
<h3 data-number="3.4.4" class="anchored" data-anchor-id="example-firth-penalised-logistic-regression"><span class="header-section-number">3.4.4</span> Example: Firth-Penalised Logistic Regression</h3>
<p>We model the probability of project success (binary outcome) based on team size and prior experience. With only 20 projects and 6 successes, standard logistic regression is unstable.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(logistf)</span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-6"><a href="#cb138-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulated project data</span></span>
<span id="cb138-7"><a href="#cb138-7" aria-hidden="true" tabindex="-1"></a>project_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb138-8"><a href="#cb138-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">project_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>,</span>
<span id="cb138-9"><a href="#cb138-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">team_size =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">5</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">7</span>, <span class="dv">6</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>),</span>
<span id="cb138-10"><a href="#cb138-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">experience_years =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">8</span>, <span class="dv">6</span>, <span class="dv">5</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">7</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">7</span>),</span>
<span id="cb138-11"><a href="#cb138-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">success =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb138-12"><a href="#cb138-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb138-13"><a href="#cb138-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-14"><a href="#cb138-14" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Number of successes:"</span>, <span class="fu">sum</span>(project_data<span class="sc">$</span>success), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Number of successes: 8 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Events per predictor:"</span>, <span class="fu">sum</span>(project_data<span class="sc">$</span>success) <span class="sc">/</span> <span class="dv">2</span>, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Events per predictor: 4 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Standard logistic regression (may have issues)</span></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>glm_standard <span class="ot">&lt;-</span> <span class="fu">glm</span>(success <span class="sc">~</span> team_size <span class="sc">+</span> experience_years, </span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> project_data, <span class="at">family =</span> binomial)</span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(glm_standard)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = success ~ team_size + experience_years, family = binomial, 
    data = project_data)

Coefficients:
                 Estimate Std. Error z value Pr(&gt;|z|)  
(Intercept)        -23.83      10.99   -2.17    0.030 *
team_size            6.87       3.37    2.03    0.042 *
experience_years    -2.39       1.51   -1.58    0.114  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 26.920  on 19  degrees of freedom
Residual deviance: 11.579  on 17  degrees of freedom
AIC: 17.58

Number of Fisher Scoring iterations: 6</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Firth-penalised logistic regression</span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>firth_fit <span class="ot">&lt;-</span> <span class="fu">logistf</span>(success <span class="sc">~</span> team_size <span class="sc">+</span> experience_years, </span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">data =</span> project_data)</span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(firth_fit)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>logistf(formula = success ~ team_size + experience_years, data = project_data)

Model fitted by Penalized ML
Coefficients:
                    coef se(coef) lower 0.95 upper 0.95 Chisq        p method
(Intercept)      -16.916    7.245   -38.7996    -4.4419 8.453 0.003645      2
team_size          4.934    2.401     0.4996    11.2961 4.864 0.027426      2
experience_years  -1.763    1.192    -4.4803     0.5814 2.174 0.140379      2

Method: 1-Wald, 2-Profile penalized log-likelihood, 3-None

Likelihood ratio test=12.03 on 2 df, p=0.002437, n=20
Wald test = 5.855 on 2 df, p = 0.05354</code></pre>
</div>
</div>
<p>Interpretation: The standard logistic regression may show large standard errors or convergence warnings due to the small number of events. Firth regression produces finite, stable coefficient estimates. Compare the coefficients and standard errors between the two models. Firth estimates are typically smaller in magnitude (shrunken towards zero) and have narrower confidence intervals. The profile likelihood confidence intervals from Firth regression are more reliable than Wald intervals when samples are small.</p>
</section>
<section id="bayesian-linear-regression-with-weakly-informative-priors" class="level3" data-number="3.4.5">
<h3 data-number="3.4.5" class="anchored" data-anchor-id="bayesian-linear-regression-with-weakly-informative-priors"><span class="header-section-number">3.4.5</span> Bayesian Linear Regression with Weakly Informative Priors</h3>
<p>Bayesian regression treats regression coefficients as random variables with prior distributions. Weakly informative priors (such as normal priors with moderate variance) gently regularise estimates without imposing strong beliefs. The posterior distribution combines prior and data, yielding probabilistic statements about coefficients and predictions.</p>
<p>Bayesian methods naturally quantify uncertainty and remain well-defined with small samples. They also facilitate model comparison via information criteria (LOOIC, WAIC) and posterior predictive checks.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Warning</span>âš ï¸ Common Misconception: â€œBayesian Priors Are Subjective and Biasedâ€
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Myth</strong>: â€œUsing priors means youâ€™re forcing your beliefs onto the data. Results are biased.â€</p>
<p><strong>Reality</strong>: <strong>Weakly informative priors</strong> are not â€œsubjective opinionsâ€â€”theyâ€™re regularization tools that prevent extreme estimates when data are sparse. With small samples, the alternative (maximum likelihood) often produces infinite or nonsensical estimates.</p>
<p><strong>Example</strong>:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Scenario: n=15, binary outcome with separation</span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>logistic_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">12</span>, <span class="dv">13</span>, <span class="dv">14</span>, <span class="dv">15</span>),</span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>)  <span class="co"># Perfect separation</span></span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-7"><a href="#cb146-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Standard logistic regression (frequentist)</span></span>
<span id="cb146-8"><a href="#cb146-8" aria-hidden="true" tabindex="-1"></a>freq_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> logistic_data, <span class="at">family =</span> binomial)</span>
<span id="cb146-9"><a href="#cb146-9" aria-hidden="true" tabindex="-1"></a><span class="co"># â†’ Warning: "fitted probabilities 0 or 1"</span></span>
<span id="cb146-10"><a href="#cb146-10" aria-hidden="true" tabindex="-1"></a><span class="co"># â†’ Coefficient: âˆž (not useful!)</span></span>
<span id="cb146-11"><a href="#cb146-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-12"><a href="#cb146-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Bayesian logistic regression with weakly informative prior</span></span>
<span id="cb146-13"><a href="#cb146-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Prior: Î² ~ Normal(0, 2.5) â€” allows Â±5 SD range (very wide!)</span></span>
<span id="cb146-14"><a href="#cb146-14" aria-hidden="true" tabindex="-1"></a>bayes_model <span class="ot">&lt;-</span> rstanarm<span class="sc">::</span><span class="fu">stan_glm</span>(</span>
<span id="cb146-15"><a href="#cb146-15" aria-hidden="true" tabindex="-1"></a>  y <span class="sc">~</span> x, <span class="at">data =</span> logistic_data, <span class="at">family =</span> binomial,</span>
<span id="cb146-16"><a href="#cb146-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior =</span> <span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.5</span>),</span>
<span id="cb146-17"><a href="#cb146-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">2</span>, <span class="at">iter =</span> <span class="dv">1000</span>, <span class="at">refresh =</span> <span class="dv">0</span></span>
<span id="cb146-18"><a href="#cb146-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb146-19"><a href="#cb146-19" aria-hidden="true" tabindex="-1"></a><span class="co"># â†’ Coefficient: finite, interpretable value (e.g., Î² â‰ˆ 2.3)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p><strong>What does the prior do?</strong></p>
<ul>
<li><strong>Normal(0, 2.5)</strong> on log-odds scale means:
<ul>
<li>95% of prior probability is between -5 and +5 (odds ratios: 0.007 to 148)</li>
<li>This is <strong>very uninformative</strong> about plausible effect sizes</li>
<li>But it prevents extreme estimates (Î² = Â±âˆž) when data are sparse</li>
</ul></li>
</ul>
<p><strong>Lesson</strong>:</p>
<ol type="1">
<li><strong>Weakly informative priors â‰  strong beliefs</strong>. Theyâ€™re safety constraints.</li>
<li>With adequate data (n &gt; 100), priors have minimal influenceâ€”data dominate</li>
<li>With small samples, priors <strong>stabilize</strong> estimates (like Firth regression)</li>
<li>Sensitivity analysis: Try different priors (e.g., Normal(0, 1) vs Normal(0, 5)) and check if conclusions change</li>
</ol>
<p><strong>Rule of thumb</strong>: If your results change drastically with mildly different priors, your data are too weak to support firm conclusionsâ€”report this uncertainty honestly.</p>
</div>
</div>
<p><strong>Assumptions</strong>: Linear relationship between predictors and outcome (for linear regression). Normal errors (often relaxed in Bayesian models by using robust likelihoods). Independent observations.</p>
<p><strong>When to use</strong>: Small samples, desire for probabilistic inference, need for flexible error distributions, model comparison and selection.</p>
<blockquote class="blockquote">
<p><strong>Note</strong>: The following Bayesian examples use the <code>brms</code> package, which requires Rtools to be installed on Windows for Stan model compilation. If you encounter â€œmake not foundâ€ errors, install Rtools from https://cran.r-project.org/bin/windows/Rtools/ and restart R. The code chunks below are set to <code>eval=FALSE</code> to allow document rendering without Rtools.</p>
</blockquote>
<p>A short note on <code>brms</code> vs <code>rstanarm</code>: <code>brms</code> provides a very flexible, formula-based interface to Stan (via <code>rstan</code> or <code>cmdstanr</code>) and supports complex model families and custom Stan code; it is ideal when you need advanced models, custom priors, or full control over sampling. <code>rstanarm</code> offers a lighter-weight interface with precompiled model templates (easier for classrooms and quick demos). If you need broad model flexibility and are comfortable installing Stan toolchains, prefer <code>brms</code>. For runnable examples, teaching, or simpler models where installation friction is a concern, <code>rstanarm</code> is a practical alternative â€” the chapter includes both examples so you can choose based on your environment.</p>
<blockquote class="blockquote">
<p><strong>Always inspect diagnostics.</strong> After fitting a Bayesian model, verify that $ &lt; 1.01$ for all parameters, effective sample size ratios exceed 0.1 (ideally &gt; 0.5), and there are no divergent transitions. Trace plots and posterior predictive checks should be part of your routine workflow before interpreting coefficients.</p>
</blockquote>
<section id="essential-mcmc-diagnostics" class="level4" data-number="3.4.5.1">
<h4 data-number="3.4.5.1" class="anchored" data-anchor-id="essential-mcmc-diagnostics"><span class="header-section-number">3.4.5.1</span> Essential MCMC Diagnostics</h4>
<p><strong>Always check these before trusting Bayesian results:</strong></p>
<ol type="1">
<li><strong>R-hat &lt; 1.01</strong>: Indicates chains have converged</li>
</ol>
<ul>
<li>If R-hat &gt; 1.01: Increase iterations or add chains</li>
</ul>
<ol start="2" type="1">
<li><strong>ESS &gt; 400</strong> (or ESS ratio &gt; 0.1): Adequate effective samples</li>
</ol>
<ul>
<li>If low: Increase iterations or adjust <code>adapt_delta</code></li>
</ul>
<ol start="3" type="1">
<li><strong>Trace plots</strong>: Should look like â€œhairy caterpillarsâ€</li>
</ol>
<ul>
<li>Trends or stickiness indicate problems</li>
</ul>
<ol start="4" type="1">
<li><strong>Posterior predictive checks</strong>: Simulated data should match observed values</li>
</ol>
<ul>
<li>Use <code>pp_check()</code> to visualise fit</li>
</ul>
<p><strong>Red flags:</strong> - Divergent transition warnings - Tree depth exceeded messages - Very wide posterior intervals (possible underfitting)</p>
<p><strong>When diagnostics fail:</strong> - Increase iterations: <code>iter = 4000</code>, <code>warmup = 2000</code> - Increase chains: <code>chains = 4</code> - Adjust sampler: <code>control = list(adapt_delta = 0.95)</code> - Check for priorâ€“data conflict</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Important</span>MCMC Diagnostic Checklist
</div>
</div>
<div class="callout-body-container callout-body">
<p>Before interpreting Bayesian results: - [ ] All R-hat values &lt; 1.01 - [ ] All ESS &gt; 400 (or ESS ratio &gt; 0.1) - [ ] No divergent transitions - [ ] Trace plots show good mixing - [ ] Posterior predictive check shows reasonable fit</p>
<p>If any check fails, do not trust the results.</p>
</div>
</div>
</section>
</section>
<section id="example-bayesian-linear-regression-with-brms" class="level3" data-number="3.4.6">
<h3 data-number="3.4.6" class="anchored" data-anchor-id="example-bayesian-linear-regression-with-brms"><span class="header-section-number">3.4.6</span> Example: Bayesian Linear Regression with brms</h3>
<p>We model customer satisfaction scores (continuous, 1â€“10 scale) based on wait time and staff friendliness ratings. With only 18 observations, classical regression has limited precision.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Note: This example requires Rtools to be installed for Stan compilation</span></span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a><span class="co"># To run this code, install Rtools from: https://cran.r-project.org/bin/windows/Rtools/</span></span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb147-5"><a href="#cb147-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(brms)</span>
<span id="cb147-6"><a href="#cb147-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-7"><a href="#cb147-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb147-8"><a href="#cb147-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-9"><a href="#cb147-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulated customer data</span></span>
<span id="cb147-10"><a href="#cb147-10" aria-hidden="true" tabindex="-1"></a>customer_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb147-11"><a href="#cb147-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">customer_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">18</span>,</span>
<span id="cb147-12"><a href="#cb147-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">wait_time =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">8</span>, <span class="dv">12</span>, <span class="dv">7</span>, <span class="dv">15</span>, <span class="dv">6</span>, <span class="dv">9</span>, <span class="dv">11</span>, <span class="dv">8</span>, <span class="dv">13</span>, <span class="dv">7</span>, <span class="dv">10</span>, <span class="dv">9</span>, <span class="dv">12</span>, <span class="dv">8</span>, <span class="dv">11</span>, <span class="dv">10</span>),</span>
<span id="cb147-13"><a href="#cb147-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">friendliness =</span> <span class="fu">c</span>(<span class="dv">8</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">6</span>, <span class="dv">9</span>, <span class="dv">5</span>, <span class="dv">9</span>, <span class="dv">8</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">6</span>, <span class="dv">9</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">7</span>, <span class="dv">7</span>),</span>
<span id="cb147-14"><a href="#cb147-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">satisfaction =</span> <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">3</span>, <span class="dv">8</span>, <span class="dv">6</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">6</span>, <span class="dv">6</span>)</span>
<span id="cb147-15"><a href="#cb147-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb147-16"><a href="#cb147-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-17"><a href="#cb147-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Bayesian linear regression with weakly informative priors</span></span>
<span id="cb147-18"><a href="#cb147-18" aria-hidden="true" tabindex="-1"></a>bayes_fit <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb147-19"><a href="#cb147-19" aria-hidden="true" tabindex="-1"></a>  satisfaction <span class="sc">~</span> wait_time <span class="sc">+</span> friendliness,</span>
<span id="cb147-20"><a href="#cb147-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> customer_data,</span>
<span id="cb147-21"><a href="#cb147-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">gaussian</span>(),</span>
<span id="cb147-22"><a href="#cb147-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior =</span> <span class="fu">c</span>(</span>
<span id="cb147-23"><a href="#cb147-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">5</span>), <span class="at">class =</span> <span class="st">"b"</span>),</span>
<span id="cb147-24"><a href="#cb147-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">6</span>, <span class="dv">3</span>), <span class="at">class =</span> <span class="st">"Intercept"</span>),</span>
<span id="cb147-25"><a href="#cb147-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> <span class="st">"sigma"</span>)</span>
<span id="cb147-26"><a href="#cb147-26" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb147-27"><a href="#cb147-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb147-28"><a href="#cb147-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter =</span> <span class="dv">2000</span>,</span>
<span id="cb147-29"><a href="#cb147-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb147-30"><a href="#cb147-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">2025</span>,</span>
<span id="cb147-31"><a href="#cb147-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">refresh =</span> <span class="dv">0</span>,</span>
<span id="cb147-32"><a href="#cb147-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">silent =</span> <span class="dv">2</span></span>
<span id="cb147-33"><a href="#cb147-33" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb147-34"><a href="#cb147-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-35"><a href="#cb147-35" aria-hidden="true" tabindex="-1"></a><span class="co"># MCMC Diagnostics</span></span>
<span id="cb147-36"><a href="#cb147-36" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== MCMC DIAGNOSTICS ===</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb147-37"><a href="#cb147-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-38"><a href="#cb147-38" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Check R-hat (convergence)</span></span>
<span id="cb147-39"><a href="#cb147-39" aria-hidden="true" tabindex="-1"></a>rhat_vals <span class="ot">&lt;-</span> <span class="fu">rhat</span>(bayes_fit)</span>
<span id="cb147-40"><a href="#cb147-40" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"R-hat values (should be &lt; 1.01):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb147-41"><a href="#cb147-41" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(rhat_vals[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>])</span>
<span id="cb147-42"><a href="#cb147-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-43"><a href="#cb147-43" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">all</span>(rhat_vals <span class="sc">&lt;</span> <span class="fl">1.01</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb147-44"><a href="#cb147-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"OK: All R-hat &lt; 1.01, chains converged</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb147-45"><a href="#cb147-45" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb147-46"><a href="#cb147-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"WARNING: Some R-hat &gt;= 1.01, check convergence</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb147-47"><a href="#cb147-47" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb147-48"><a href="#cb147-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-49"><a href="#cb147-49" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Check Effective Sample Size</span></span>
<span id="cb147-50"><a href="#cb147-50" aria-hidden="true" tabindex="-1"></a>ess_vals <span class="ot">&lt;-</span> <span class="fu">neff_ratio</span>(bayes_fit)</span>
<span id="cb147-51"><a href="#cb147-51" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Effective sample size ratio (should be &gt; 0.1):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb147-52"><a href="#cb147-52" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(ess_vals[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>])</span>
<span id="cb147-53"><a href="#cb147-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-54"><a href="#cb147-54" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">all</span>(ess_vals <span class="sc">&gt;</span> <span class="fl">0.1</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb147-55"><a href="#cb147-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"OK: ESS ratios adequate</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb147-56"><a href="#cb147-56" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb147-57"><a href="#cb147-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"WARNING: Low ESS detected, consider more iterations</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb147-58"><a href="#cb147-58" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb147-59"><a href="#cb147-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-60"><a href="#cb147-60" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Posterior predictive check</span></span>
<span id="cb147-61"><a href="#cb147-61" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(bayes_fit, <span class="at">ndraws =</span> <span class="dv">50</span>)</span>
<span id="cb147-62"><a href="#cb147-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-63"><a href="#cb147-63" aria-hidden="true" tabindex="-1"></a><span class="co"># Posterior summary for reporting</span></span>
<span id="cb147-64"><a href="#cb147-64" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bayes_fit)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Runnable alternative using rstanarm (lighter Stan setup)</span></span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"rstanarm"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"rstanarm not installed; install with install.packages('rstanarm')</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb148-5"><a href="#cb148-5" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb148-6"><a href="#cb148-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(rstanarm)</span>
<span id="cb148-7"><a href="#cb148-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-8"><a href="#cb148-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Use the same simulated data as the brms example</span></span>
<span id="cb148-9"><a href="#cb148-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb148-10"><a href="#cb148-10" aria-hidden="true" tabindex="-1"></a>  customer_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb148-11"><a href="#cb148-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">customer_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">18</span>,</span>
<span id="cb148-12"><a href="#cb148-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">wait_time =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">8</span>, <span class="dv">12</span>, <span class="dv">7</span>, <span class="dv">15</span>, <span class="dv">6</span>, <span class="dv">9</span>, <span class="dv">11</span>, <span class="dv">8</span>, <span class="dv">13</span>, <span class="dv">7</span>, <span class="dv">10</span>, <span class="dv">9</span>, <span class="dv">12</span>, <span class="dv">8</span>, <span class="dv">11</span>, <span class="dv">10</span>),</span>
<span id="cb148-13"><a href="#cb148-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">friendliness =</span> <span class="fu">c</span>(<span class="dv">8</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">6</span>, <span class="dv">9</span>, <span class="dv">5</span>, <span class="dv">9</span>, <span class="dv">8</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">6</span>, <span class="dv">9</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">7</span>, <span class="dv">7</span>),</span>
<span id="cb148-14"><a href="#cb148-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">satisfaction =</span> <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">3</span>, <span class="dv">8</span>, <span class="dv">6</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">6</span>, <span class="dv">6</span>)</span>
<span id="cb148-15"><a href="#cb148-15" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb148-16"><a href="#cb148-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-17"><a href="#cb148-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Fit a Bayesian linear model with weakly informative priors</span></span>
<span id="cb148-18"><a href="#cb148-18" aria-hidden="true" tabindex="-1"></a>  fit_rstanarm <span class="ot">&lt;-</span> <span class="fu">stan_glm</span>(</span>
<span id="cb148-19"><a href="#cb148-19" aria-hidden="true" tabindex="-1"></a>    satisfaction <span class="sc">~</span> wait_time <span class="sc">+</span> friendliness,</span>
<span id="cb148-20"><a href="#cb148-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> customer_data,</span>
<span id="cb148-21"><a href="#cb148-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">prior =</span> <span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">5</span>),</span>
<span id="cb148-22"><a href="#cb148-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">prior_intercept =</span> <span class="fu">normal</span>(<span class="dv">6</span>, <span class="dv">3</span>),</span>
<span id="cb148-23"><a href="#cb148-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb148-24"><a href="#cb148-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter =</span> <span class="dv">2000</span>,</span>
<span id="cb148-25"><a href="#cb148-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">seed =</span> <span class="dv">2025</span>,</span>
<span id="cb148-26"><a href="#cb148-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">refresh =</span> <span class="dv">0</span></span>
<span id="cb148-27"><a href="#cb148-27" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb148-28"><a href="#cb148-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-29"><a href="#cb148-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Simple diagnostics and checks</span></span>
<span id="cb148-30"><a href="#cb148-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">summary</span>(fit_rstanarm))</span>
<span id="cb148-31"><a href="#cb148-31" aria-hidden="true" tabindex="-1"></a>  posterior_samples <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(fit_rstanarm)</span>
<span id="cb148-32"><a href="#cb148-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-33"><a href="#cb148-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Basic diagnostics using posterior draws: compute R-hat from posterior draws</span></span>
<span id="cb148-34"><a href="#cb148-34" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">requireNamespace</span>(<span class="st">"posterior"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb148-35"><a href="#cb148-35" aria-hidden="true" tabindex="-1"></a>    draws <span class="ot">&lt;-</span> posterior<span class="sc">::</span><span class="fu">as_draws_array</span>(fit_rstanarm)</span>
<span id="cb148-36"><a href="#cb148-36" aria-hidden="true" tabindex="-1"></a>    rhats <span class="ot">&lt;-</span> posterior<span class="sc">::</span><span class="fu">rhat</span>(draws)</span>
<span id="cb148-37"><a href="#cb148-37" aria-hidden="true" tabindex="-1"></a>    ess <span class="ot">&lt;-</span> posterior<span class="sc">::</span><span class="fu">ess_bulk</span>(draws)</span>
<span id="cb148-38"><a href="#cb148-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">R-hat (first coefficients):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb148-39"><a href="#cb148-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(rhats[<span class="dv">1</span><span class="sc">:</span><span class="fu">min</span>(<span class="fu">length</span>(rhats),<span class="dv">5</span>)])</span>
<span id="cb148-40"><a href="#cb148-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">ESS (first coefficients):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb148-41"><a href="#cb148-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(ess[<span class="dv">1</span><span class="sc">:</span><span class="fu">min</span>(<span class="fu">length</span>(ess),<span class="dv">5</span>)])</span>
<span id="cb148-42"><a href="#cb148-42" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb148-43"><a href="#cb148-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"posterior package not installed; skipping R-hat/ESS checks</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb148-44"><a href="#cb148-44" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb148-45"><a href="#cb148-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-46"><a href="#cb148-46" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Posterior predictive check (basic)</span></span>
<span id="cb148-47"><a href="#cb148-47" aria-hidden="true" tabindex="-1"></a>  yrep <span class="ot">&lt;-</span> <span class="fu">posterior_predict</span>(fit_rstanarm, <span class="at">draws =</span> <span class="dv">50</span>)</span>
<span id="cb148-48"><a href="#cb148-48" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">requireNamespace</span>(<span class="st">"bayesplot"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb148-49"><a href="#cb148-49" aria-hidden="true" tabindex="-1"></a>    bayesplot<span class="sc">::</span><span class="fu">ppc_dens_overlay</span>(<span class="at">y =</span> customer_data<span class="sc">$</span>satisfaction, <span class="at">yrep =</span> yrep)</span>
<span id="cb148-50"><a href="#cb148-50" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb148-51"><a href="#cb148-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"bayesplot not installed; skipping ppc plot</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb148-52"><a href="#cb148-52" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb148-53"><a href="#cb148-53" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Model Info:
 function:     stan_glm
 family:       gaussian [identity]
 formula:      satisfaction ~ wait_time + friendliness
 algorithm:    sampling
 sample:       4000 (posterior sample size)
 priors:       see help('prior_summary')
 observations: 18
 predictors:   3

Estimates:
               mean   sd   10%   50%   90%
(Intercept)  -0.3    3.5 -4.7  -0.3   4.1 
wait_time    -0.1    0.1 -0.3  -0.1   0.1 
friendliness  1.0    0.3  0.6   1.0   1.4 
sigma         0.5    0.1  0.4   0.5   0.7 

Fit Diagnostics:
           mean   sd   10%   50%   90%
mean_PPD 5.9    0.2  5.7   5.9   6.2  

The mean_ppd is the sample average posterior predictive distribution of the outcome variable (for details see help('summary.stanreg')).

MCMC diagnostics
              mcse Rhat n_eff
(Intercept)   0.1  1.0  1546 
wait_time     0.0  1.0  1607 
friendliness  0.0  1.0  1545 
sigma         0.0  1.0  1825 
mean_PPD      0.0  1.0  3145 
log-posterior 0.0  1.0  1200 

For each parameter, mcse is Monte Carlo standard error, n_eff is a crude measure of effective sample size, and Rhat is the potential scale reduction factor on split chains (at convergence Rhat=1).

R-hat (first coefficients):
[1] 1.483

ESS (first coefficients):
[1] 3.448</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="part-c-analysis-methods_files/figure-html/part-c-chunk-18-rstanarm-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Interpretation: The posterior summary provides estimates (posterior means or medians), standard errors (posterior standard deviations), and credible intervals (Bayesian analogue of confidence intervals). A 95% credible interval for a coefficient contains the true value with 95% probability given the data and prior. Posterior predictive checks compare simulated data from the fitted model to observed data; good fit is indicated when simulated data resemble observed data. The <code>brms</code> package uses Stan for efficient Markov chain Monte Carlo (MCMC) sampling.</p>
</section>
<section id="bayesian-logistic-regression" class="level3" data-number="3.4.7">
<h3 data-number="3.4.7" class="anchored" data-anchor-id="bayesian-logistic-regression"><span class="header-section-number">3.4.7</span> Bayesian Logistic Regression</h3>
<p>Bayesian logistic regression extends Bayesian methods to binary outcomes. Weakly informative priors on log-odds coefficients (such as normal priors centred at zero) stabilise estimates and prevent divergence.</p>
</section>
<section id="example-bayesian-logistic-regression" class="level3" data-number="3.4.8">
<h3 data-number="3.4.8" class="anchored" data-anchor-id="example-bayesian-logistic-regression"><span class="header-section-number">3.4.8</span> Example: Bayesian Logistic Regression</h3>
<p>We model the probability of employee retention (binary: retained or left) based on job satisfaction and salary level in a small company with 25 employees.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Note: This example requires Rtools to be installed for Stan compilation</span></span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a><span class="co"># To run this code, install Rtools from: https://cran.r-project.org/bin/windows/Rtools/</span></span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-4"><a href="#cb150-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb150-5"><a href="#cb150-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(brms)</span>
<span id="cb150-6"><a href="#cb150-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-7"><a href="#cb150-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb150-8"><a href="#cb150-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-9"><a href="#cb150-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulated retention data</span></span>
<span id="cb150-10"><a href="#cb150-10" aria-hidden="true" tabindex="-1"></a>retention_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb150-11"><a href="#cb150-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">employee_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>,</span>
<span id="cb150-12"><a href="#cb150-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">satisfaction =</span> <span class="fu">sample</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">9</span>, <span class="dv">25</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb150-13"><a href="#cb150-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">salary_level =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">25</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb150-14"><a href="#cb150-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">retained =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb150-15"><a href="#cb150-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb150-16"><a href="#cb150-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-17"><a href="#cb150-17" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Retention rate:"</span>, <span class="fu">mean</span>(retention_data<span class="sc">$</span>retained), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb150-18"><a href="#cb150-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-19"><a href="#cb150-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Bayesian logistic regression</span></span>
<span id="cb150-20"><a href="#cb150-20" aria-hidden="true" tabindex="-1"></a>bayes_logit <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb150-21"><a href="#cb150-21" aria-hidden="true" tabindex="-1"></a>  retained <span class="sc">~</span> satisfaction <span class="sc">+</span> salary_level,</span>
<span id="cb150-22"><a href="#cb150-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> retention_data,</span>
<span id="cb150-23"><a href="#cb150-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">bernoulli</span>(<span class="at">link =</span> <span class="st">"logit"</span>),</span>
<span id="cb150-24"><a href="#cb150-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior =</span> <span class="fu">c</span>(</span>
<span id="cb150-25"><a href="#cb150-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="at">class =</span> <span class="st">"b"</span>),</span>
<span id="cb150-26"><a href="#cb150-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">5</span>), <span class="at">class =</span> <span class="st">"Intercept"</span>)</span>
<span id="cb150-27"><a href="#cb150-27" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb150-28"><a href="#cb150-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb150-29"><a href="#cb150-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter =</span> <span class="dv">2000</span>,</span>
<span id="cb150-30"><a href="#cb150-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb150-31"><a href="#cb150-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">2025</span>,</span>
<span id="cb150-32"><a href="#cb150-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">refresh =</span> <span class="dv">0</span>,</span>
<span id="cb150-33"><a href="#cb150-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">silent =</span> <span class="dv">2</span></span>
<span id="cb150-34"><a href="#cb150-34" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb150-35"><a href="#cb150-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-36"><a href="#cb150-36" aria-hidden="true" tabindex="-1"></a><span class="co"># MCMC Diagnostics</span></span>
<span id="cb150-37"><a href="#cb150-37" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== MCMC DIAGNOSTICS ===</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb150-38"><a href="#cb150-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-39"><a href="#cb150-39" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Check R-hat (convergence)</span></span>
<span id="cb150-40"><a href="#cb150-40" aria-hidden="true" tabindex="-1"></a>rhat_vals <span class="ot">&lt;-</span> <span class="fu">rhat</span>(bayes_logit)</span>
<span id="cb150-41"><a href="#cb150-41" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"R-hat values (should be &lt; 1.01):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb150-42"><a href="#cb150-42" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(rhat_vals[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>])</span>
<span id="cb150-43"><a href="#cb150-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-44"><a href="#cb150-44" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">all</span>(rhat_vals <span class="sc">&lt;</span> <span class="fl">1.01</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb150-45"><a href="#cb150-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"OK: All R-hat &lt; 1.01, chains converged</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb150-46"><a href="#cb150-46" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb150-47"><a href="#cb150-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"WARNING: Some R-hat &gt;= 1.01, check convergence</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb150-48"><a href="#cb150-48" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb150-49"><a href="#cb150-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-50"><a href="#cb150-50" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Check Effective Sample Size</span></span>
<span id="cb150-51"><a href="#cb150-51" aria-hidden="true" tabindex="-1"></a>ess_vals <span class="ot">&lt;-</span> <span class="fu">neff_ratio</span>(bayes_logit)</span>
<span id="cb150-52"><a href="#cb150-52" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Effective sample size ratio (should be &gt; 0.1):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb150-53"><a href="#cb150-53" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(ess_vals[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>])</span>
<span id="cb150-54"><a href="#cb150-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-55"><a href="#cb150-55" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">all</span>(ess_vals <span class="sc">&gt;</span> <span class="fl">0.1</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb150-56"><a href="#cb150-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"OK: ESS ratios adequate</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb150-57"><a href="#cb150-57" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb150-58"><a href="#cb150-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"WARNING: Low ESS detected, consider more iterations</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb150-59"><a href="#cb150-59" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb150-60"><a href="#cb150-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-61"><a href="#cb150-61" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Posterior predictive check</span></span>
<span id="cb150-62"><a href="#cb150-62" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(bayes_logit, <span class="at">ndraws =</span> <span class="dv">50</span>, <span class="at">type =</span> <span class="st">"bars"</span>)</span>
<span id="cb150-63"><a href="#cb150-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-64"><a href="#cb150-64" aria-hidden="true" tabindex="-1"></a><span class="co"># Posterior summary for reporting</span></span>
<span id="cb150-65"><a href="#cb150-65" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bayes_logit)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Runnable alternative using rstanarm for logistic regression</span></span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"rstanarm"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"rstanarm not installed; install with install.packages('rstanarm')</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb151-6"><a href="#cb151-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(rstanarm)</span>
<span id="cb151-7"><a href="#cb151-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-8"><a href="#cb151-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb151-9"><a href="#cb151-9" aria-hidden="true" tabindex="-1"></a>  retention_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb151-10"><a href="#cb151-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">employee_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>,</span>
<span id="cb151-11"><a href="#cb151-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">satisfaction =</span> <span class="fu">sample</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">9</span>, <span class="dv">25</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb151-12"><a href="#cb151-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">salary_level =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">25</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb151-13"><a href="#cb151-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">retained =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb151-14"><a href="#cb151-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb151-15"><a href="#cb151-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-16"><a href="#cb151-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Retention rate:"</span>, <span class="fu">mean</span>(retention_data<span class="sc">$</span>retained), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb151-17"><a href="#cb151-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-18"><a href="#cb151-18" aria-hidden="true" tabindex="-1"></a>  fit_logit_rstanarm <span class="ot">&lt;-</span> <span class="fu">stan_glm</span>(</span>
<span id="cb151-19"><a href="#cb151-19" aria-hidden="true" tabindex="-1"></a>    retained <span class="sc">~</span> satisfaction <span class="sc">+</span> salary_level,</span>
<span id="cb151-20"><a href="#cb151-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> retention_data,</span>
<span id="cb151-21"><a href="#cb151-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>),</span>
<span id="cb151-22"><a href="#cb151-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">prior =</span> <span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>),</span>
<span id="cb151-23"><a href="#cb151-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">prior_intercept =</span> <span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">5</span>),</span>
<span id="cb151-24"><a href="#cb151-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb151-25"><a href="#cb151-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter =</span> <span class="dv">2000</span>,</span>
<span id="cb151-26"><a href="#cb151-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">seed =</span> <span class="dv">2025</span>,</span>
<span id="cb151-27"><a href="#cb151-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">refresh =</span> <span class="dv">0</span></span>
<span id="cb151-28"><a href="#cb151-28" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb151-29"><a href="#cb151-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-30"><a href="#cb151-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== rstanarm summary ===</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb151-31"><a href="#cb151-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">summary</span>(fit_logit_rstanarm))</span>
<span id="cb151-32"><a href="#cb151-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-33"><a href="#cb151-33" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">requireNamespace</span>(<span class="st">"posterior"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb151-34"><a href="#cb151-34" aria-hidden="true" tabindex="-1"></a>    draws <span class="ot">&lt;-</span> posterior<span class="sc">::</span><span class="fu">as_draws_array</span>(fit_logit_rstanarm)</span>
<span id="cb151-35"><a href="#cb151-35" aria-hidden="true" tabindex="-1"></a>    rhats <span class="ot">&lt;-</span> posterior<span class="sc">::</span><span class="fu">rhat</span>(draws)</span>
<span id="cb151-36"><a href="#cb151-36" aria-hidden="true" tabindex="-1"></a>    ess <span class="ot">&lt;-</span> posterior<span class="sc">::</span><span class="fu">ess_bulk</span>(draws)</span>
<span id="cb151-37"><a href="#cb151-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">R-hat (first coefficients):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb151-38"><a href="#cb151-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(rhats[<span class="dv">1</span><span class="sc">:</span><span class="fu">min</span>(<span class="fu">length</span>(rhats),<span class="dv">5</span>)])</span>
<span id="cb151-39"><a href="#cb151-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">ESS (first coefficients):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb151-40"><a href="#cb151-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(ess[<span class="dv">1</span><span class="sc">:</span><span class="fu">min</span>(<span class="fu">length</span>(ess),<span class="dv">5</span>)])</span>
<span id="cb151-41"><a href="#cb151-41" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb151-42"><a href="#cb151-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"posterior package not installed; skipping R-hat/ESS checks</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb151-43"><a href="#cb151-43" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb151-44"><a href="#cb151-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-45"><a href="#cb151-45" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Basic posterior predictive check for binary data</span></span>
<span id="cb151-46"><a href="#cb151-46" aria-hidden="true" tabindex="-1"></a>  yrep <span class="ot">&lt;-</span> <span class="fu">posterior_predict</span>(fit_logit_rstanarm, <span class="at">draws =</span> <span class="dv">50</span>)</span>
<span id="cb151-47"><a href="#cb151-47" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">requireNamespace</span>(<span class="st">"bayesplot"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb151-48"><a href="#cb151-48" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ppc_bars expects a matrix-like yrep; show observed vs predicted distribution</span></span>
<span id="cb151-49"><a href="#cb151-49" aria-hidden="true" tabindex="-1"></a>    bayesplot<span class="sc">::</span><span class="fu">ppc_bars</span>(<span class="at">y =</span> retention_data<span class="sc">$</span>retained, <span class="at">yrep =</span> yrep)</span>
<span id="cb151-50"><a href="#cb151-50" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb151-51"><a href="#cb151-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"bayesplot not installed; skipping ppc plot</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb151-52"><a href="#cb151-52" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb151-53"><a href="#cb151-53" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Retention rate: 0.68 

=== rstanarm summary ===

Model Info:
 function:     stan_glm
 family:       binomial [logit]
 formula:      retained ~ satisfaction + salary_level
 algorithm:    sampling
 sample:       4000 (posterior sample size)
 priors:       see help('prior_summary')
 observations: 25
 predictors:   3

Estimates:
               mean   sd   10%   50%   90%
(Intercept)   6.3    3.0  2.5   6.1  10.3 
satisfaction -0.7    0.3 -1.2  -0.7  -0.3 
salary_level -0.2    0.5 -0.8  -0.2   0.3 

Fit Diagnostics:
           mean   sd   10%   50%   90%
mean_PPD 0.7    0.1  0.5   0.7   0.8  

The mean_ppd is the sample average posterior predictive distribution of the outcome variable (for details see help('summary.stanreg')).

MCMC diagnostics
              mcse Rhat n_eff
(Intercept)   0.1  1.0  2462 
satisfaction  0.0  1.0  2401 
salary_level  0.0  1.0  3363 
mean_PPD      0.0  1.0  3123 
log-posterior 0.0  1.0  1389 

For each parameter, mcse is Monte Carlo standard error, n_eff is a crude measure of effective sample size, and Rhat is the potential scale reduction factor on split chains (at convergence Rhat=1).

R-hat (first coefficients):
[1] 1.48

ESS (first coefficients):
[1] 3.685</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="part-c-analysis-methods_files/figure-html/part-c-chunk-19-rstanarm-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Interpretation: Coefficients are on the log-odds scale. Positive coefficients indicate that higher predictor values increase the odds of retention. The posterior predictive check for binary outcomes compares the distribution of observed outcomes (0s and 1s) to predicted distributions from the model. LOOIC (leave-one-out information criterion) can be used to compare this model to alternatives.</p>
<blockquote class="blockquote">
<p><strong>Diagnostic reminder:</strong> Just like the linear model, inspect R-hat values, effective sample sizes, divergent transition warnings, and trace plots before trusting logistic regression inferences.</p>
</blockquote>
</section>
<section id="leave-one-out-cross-validation-loocv" class="level3" data-number="3.4.9">
<h3 data-number="3.4.9" class="anchored" data-anchor-id="leave-one-out-cross-validation-loocv"><span class="header-section-number">3.4.9</span> Leave-One-Out Cross-Validation (LOOCV)</h3>
<p>Bayesian models can be compared using LOOIC, which estimates out-of-sample predictive accuracy. LOOIC is computed efficiently from the posterior samples using Pareto-smoothed importance sampling. Lower LOOIC indicates better predictive performance.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Note: This example requires the bayes_logit model from the previous chunk</span></span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute LOOIC for the retention model</span></span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a>loo_result <span class="ot">&lt;-</span> <span class="fu">loo</span>(bayes_logit)</span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(loo_result)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Interpretation: The LOOIC value provides a measure of model fit adjusted for complexity. When comparing models, prefer the one with lower LOOIC. The standard error of the LOOIC difference helps assess whether differences are meaningful.</p>
</section>
<section id="lab-practical-5.1-predicting-medication-adherence-with-firth-regression" class="level3" data-number="3.4.10">
<h3 data-number="3.4.10" class="anchored" data-anchor-id="lab-practical-5.1-predicting-medication-adherence-with-firth-regression"><span class="header-section-number">3.4.10</span> Lab Practical 5.1: Predicting Medication Adherence with Firth Regression</h3>
<p><strong>Context</strong>: A health psychology study examined whether depression severity (PHQ-9 score) and perceived social support predict medication adherence (Yes/No) in a sample of 18 patients with chronic illness. With a small sample and potential separation (e.g., all patients with high social support adhering), standard logistic regression may fail. Firth regression provides stable estimates by applying a penalized likelihood.</p>
<p><strong>Learning Goals</strong>:</p>
<ul>
<li>Detect separation in binary outcomes</li>
<li>Compare standard (<code>glm</code>) and Firth-penalised (<code>logistf</code>) logistic regression</li>
<li>Interpret penalized coefficients and confidence intervals</li>
<li>Understand when Firth regression is essential</li>
</ul>
<p><strong>Step 1: Load and Explore the Data</strong></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(logistf)</span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulated medication adherence data</span></span>
<span id="cb154-5"><a href="#cb154-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb154-6"><a href="#cb154-6" aria-hidden="true" tabindex="-1"></a>adherence_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb154-7"><a href="#cb154-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">patient_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">18</span>,</span>
<span id="cb154-8"><a href="#cb154-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">depression =</span> <span class="fu">c</span>(<span class="dv">22</span>, <span class="dv">18</span>, <span class="dv">15</span>, <span class="dv">20</span>, <span class="dv">19</span>, <span class="dv">12</span>, <span class="dv">10</span>, <span class="dv">8</span>, <span class="dv">14</span>, <span class="dv">16</span>, <span class="dv">11</span>, <span class="dv">9</span>, <span class="dv">7</span>, <span class="dv">13</span>, <span class="dv">6</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">3</span>),</span>
<span id="cb154-9"><a href="#cb154-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">social_support =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">6</span>, <span class="dv">4</span>, <span class="dv">7</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">8</span>),</span>
<span id="cb154-10"><a href="#cb154-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">adherent =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb154-11"><a href="#cb154-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb154-12"><a href="#cb154-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-13"><a href="#cb154-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary statistics</span></span>
<span id="cb154-14"><a href="#cb154-14" aria-hidden="true" tabindex="-1"></a>adherence_data <span class="sc">%&gt;%</span></span>
<span id="cb154-15"><a href="#cb154-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(adherent) <span class="sc">%&gt;%</span></span>
<span id="cb154-16"><a href="#cb154-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb154-17"><a href="#cb154-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb154-18"><a href="#cb154-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_depression =</span> <span class="fu">mean</span>(depression),</span>
<span id="cb154-19"><a href="#cb154-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_support =</span> <span class="fu">mean</span>(social_support)</span>
<span id="cb154-20"><a href="#cb154-20" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 Ã— 4
  adherent     n mean_depression mean_support
     &lt;dbl&gt; &lt;int&gt;           &lt;dbl&gt;        &lt;dbl&gt;
1        0     8            17           2.88
2        1    10             7.6         6.1 </code></pre>
</div>
</div>
<p><strong>Checkpoint</strong>: Non-adherent patients (n = 8) have higher depression scores (mean â‰ˆ 18) and lower social support (mean â‰ˆ 2.5). Adherent patients (n = 10) show the opposite pattern. This suggests strong predictors but potential separation.</p>
<p><strong>Step 2: Visualize the Data</strong></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(adherence_data, <span class="fu">aes</span>(<span class="at">x =</span> social_support, <span class="at">y =</span> depression, <span class="at">color =</span> <span class="fu">factor</span>(adherent), <span class="at">shape =</span> <span class="fu">factor</span>(adherent))) <span class="sc">+</span></span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb156-3"><a href="#cb156-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb156-4"><a href="#cb156-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Medication Adherence by Depression and Social Support"</span>,</span>
<span id="cb156-5"><a href="#cb156-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Social Support (1-10 scale)"</span>,</span>
<span id="cb156-6"><a href="#cb156-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Depression Severity (PHQ-9)"</span>,</span>
<span id="cb156-7"><a href="#cb156-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Adherent"</span>,</span>
<span id="cb156-8"><a href="#cb156-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> <span class="st">"Adherent"</span></span>
<span id="cb156-9"><a href="#cb156-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb156-10"><a href="#cb156-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"0"</span> <span class="ot">=</span> <span class="st">"red"</span>, <span class="st">"1"</span> <span class="ot">=</span> <span class="st">"blue"</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No"</span>, <span class="st">"Yes"</span>)) <span class="sc">+</span></span>
<span id="cb156-11"><a href="#cb156-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">16</span>, <span class="dv">17</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No"</span>, <span class="st">"Yes"</span>)) <span class="sc">+</span></span>
<span id="cb156-12"><a href="#cb156-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="part-c-analysis-methods_files/figure-html/part-c-lab-5-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Checkpoint</strong>: The scatterplot shows clear separation: high social support values (â‰¥6) are associated with adherence, while low values (â‰¤3) predict non-adherence. This suggests quasi-complete separation, which may cause standard logistic regression to fail.</p>
<p><strong>Step 3: Attempt Standard Logistic Regression</strong></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Standard logistic regression</span></span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a>standard_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a>  adherent <span class="sc">~</span> depression <span class="sc">+</span> social_support,</span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> adherence_data,</span>
<span id="cb157-5"><a href="#cb157-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>)</span>
<span id="cb157-6"><a href="#cb157-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb157-7"><a href="#cb157-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-8"><a href="#cb157-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(standard_model)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = adherent ~ depression + social_support, family = binomial(link = "logit"), 
    data = adherence_data)

Coefficients:
                Estimate Std. Error z value Pr(&gt;|z|)
(Intercept)    -8.30e+01   2.60e+04       0        1
depression     -1.92e-14   1.50e+00       0        1
social_support  2.06e+01   6.50e+03       0        1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 24.7306  on 17  degrees of freedom
Residual deviance:  3.8191  on 15  degrees of freedom
AIC: 9.819

Number of Fisher Scoring iterations: 21</code></pre>
</div>
</div>
<p><strong>Checkpoint</strong>: Look for warning messages like â€œfitted probabilities numerically 0 or 1â€ or extremely large coefficient estimates (e.g., |Î²| &gt; 10) and large standard errors. These indicate separation. The model may produce unreliable predictions.</p>
<p><strong>Step 4: Fit Firth-Penalised Logistic Regression</strong></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Firth-penalised logistic regression</span></span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a>firth_model <span class="ot">&lt;-</span> <span class="fu">logistf</span>(</span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a>  adherent <span class="sc">~</span> depression <span class="sc">+</span> social_support,</span>
<span id="cb159-4"><a href="#cb159-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> adherence_data</span>
<span id="cb159-5"><a href="#cb159-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb159-6"><a href="#cb159-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-7"><a href="#cb159-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(firth_model)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>logistf(formula = adherent ~ depression + social_support, data = adherence_data)

Model fitted by Penalized ML
Coefficients:
                   coef se(coef) lower 0.95 upper 0.95     Chisq      p method
(Intercept)    -6.35433  15.2417    -63.817     38.210 0.1097597 0.7404      2
depression     -0.02307   0.5826     -2.014      1.772 0.0009917 0.9749      2
social_support  1.58554   1.9618     -3.293     10.225 0.4477774 0.5034      2

Method: 1-Wald, 2-Profile penalized log-likelihood, 3-None

Likelihood ratio test=13.8 on 2 df, p=0.001006, n=18
Wald test = 5.405 on 2 df, p = 0.06704</code></pre>
</div>
</div>
<p><strong>Checkpoint</strong>: Firth regression produces finite coefficient estimates with reduced bias. Compare the coefficients and standard errors to the standard model. Firth estimates should be smaller in magnitude but more stable.</p>
<p><strong>Step 5: Interpret the Results</strong></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract coefficients and confidence intervals</span></span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a>coef_firth <span class="ot">&lt;-</span> <span class="fu">coef</span>(firth_model)</span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a>ci_firth <span class="ot">&lt;-</span> <span class="fu">confint</span>(firth_model)</span>
<span id="cb161-4"><a href="#cb161-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-5"><a href="#cb161-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Depression coefficient:"</span>, <span class="fu">round</span>(coef_firth[<span class="st">"depression"</span>], <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Depression coefficient: -0.023 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  95% CI:"</span>, <span class="fu">round</span>(ci_firth[<span class="st">"depression"</span>, ], <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  95% CI: -2.014 1.772 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Social support coefficient:"</span>, <span class="fu">round</span>(coef_firth[<span class="st">"social_support"</span>], <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Social support coefficient: 1.586 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  95% CI:"</span>, <span class="fu">round</span>(ci_firth[<span class="st">"social_support"</span>, ], <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  95% CI: -3.293 10.22 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Odds ratios</span></span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(coef_firth[<span class="sc">-</span><span class="dv">1</span>])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>    depression social_support 
        0.9772         4.8819 </code></pre>
</div>
</div>
<p><strong>Interpretation</strong>:</p>
<ul>
<li><strong>Depression</strong>: Each 1-point increase in PHQ-9 score is associated with lower odds of adherence (OR &lt; 1, negative coefficient)</li>
<li><strong>Social Support</strong>: Each 1-point increase in social support is associated with higher odds of adherence (OR &gt; 1, positive coefficient)</li>
<li>The confidence intervals exclude 1 (assuming significant effects), confirming both predictors are important</li>
</ul>
<p><strong>Step 6: Compare Models</strong></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare AIC (if standard model converged)</span></span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Standard model AIC:"</span>, <span class="fu">AIC</span>(standard_model), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Standard model AIC: 9.819 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Firth model AIC:"</span>, firth_model<span class="sc">$</span>loglik[<span class="dv">2</span>], <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)  <span class="co"># Note: logistf returns penalized log-likelihood</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Firth model AIC: -9.199 </code></pre>
</div>
</div>
<p><strong>Checkpoint</strong>: Firth regression provides stable estimates even when standard regression warns of separation. In small samples with rare events, Firth is the preferred approach.</p>
<p><strong>Step 7: Report the Results</strong></p>
<blockquote class="blockquote">
<p>â€œMedication adherence was predicted from depression severity (PHQ-9) and perceived social support (n = 18) using Firth-penalised logistic regression due to quasi-complete separation. Higher social support was associated with increased adherence (OR = [value], 95% CI [lower, upper], p &lt; 0.05), while higher depression severity was associated with decreased adherence (OR = [value], 95% CI [lower, upper], p &lt; 0.05). Firth regression provided stable estimates where standard logistic regression failed due to separation.â€</p>
</blockquote>
<p><strong>Discussion Questions</strong>:</p>
<ol type="1">
<li>What are the signs of separation in the standard model output?
<ul>
<li>Warning messages about fitted probabilities, extremely large coefficients (|Î²| &gt; 10), inflated standard errors, or non-convergence</li>
</ul></li>
<li>Why does Firth regression work when standard regression fails?
<ul>
<li>Firth adds a penalty term (Jeffreys prior) to the likelihood, shrinking coefficients toward zero and preventing infinite estimates</li>
</ul></li>
<li>When should you use Firth regression vs.&nbsp;Bayesian logistic regression?
<ul>
<li>Firth: Quick, frequentist inference, handles separation automatically</li>
<li>Bayesian: Incorporates prior beliefs, provides full posterior distributions, better for complex models or expert knowledge</li>
</ul></li>
</ol>
<p><strong>Extension</strong>: Try adding an interaction term (<code>depression * social_support</code>) to test whether the effect of depression depends on social support level. Assess whether the interaction improves model fit using likelihood ratio tests.</p>
<hr>
</section>
<section id="lab-practical-5.2-regularized-regression-for-multiple-predictors-ridge-lasso-elastic-net" class="level3" data-number="3.4.11">
<h3 data-number="3.4.11" class="anchored" data-anchor-id="lab-practical-5.2-regularized-regression-for-multiple-predictors-ridge-lasso-elastic-net"><span class="header-section-number">3.4.11</span> Lab Practical 5.2: Regularized Regression for Multiple Predictors (Ridge, Lasso, Elastic Net)</h3>
<p><strong>Context</strong>: A startup company (n = 60 employees) wants to predict employee turnover (binary: stayed/left) using 8 potential predictors: satisfaction, salary, commute time, tenure, performance rating, team size, training hours, and work-from-home days. With p = 8 predictors and n = 60, standard logistic regression risks overfitting. Regularized methods (ridge, lasso, elastic net) prevent overfitting by penalizing large coefficients.</p>
<p><strong>Learning Goals</strong>:</p>
<ul>
<li>Understand when regularization is needed (p/n ratio approaching 0.1-0.2)</li>
<li>Compare ridge (L2), lasso (L1), and elastic net penalties</li>
<li>Use cross-validation to select optimal penalty strength (Î»)</li>
<li>Interpret regularized coefficients and variable selection</li>
<li>Report regularized models transparently</li>
</ul>
<p><strong>When to Use Regularized Regression</strong>:</p>
<ul>
<li><strong>Ridge (L2)</strong>: Many correlated predictors, want to shrink all coefficients</li>
<li><strong>Lasso (L1)</strong>: Want automatic variable selection (some coefficients â†’ 0)</li>
<li><strong>Elastic Net</strong>: Combines ridge + lasso; best for correlated predictors with selection</li>
</ul>
<p><strong>Step 1: Simulate Employee Turnover Data</strong></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb175"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glmnet)  <span class="co"># For regularized regression</span></span>
<span id="cb175-3"><a href="#cb175-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-4"><a href="#cb175-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb175-5"><a href="#cb175-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-6"><a href="#cb175-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate 60 employees with 8 predictors</span></span>
<span id="cb175-7"><a href="#cb175-7" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">60</span></span>
<span id="cb175-8"><a href="#cb175-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-9"><a href="#cb175-9" aria-hidden="true" tabindex="-1"></a>employee_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb175-10"><a href="#cb175-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">employee_id =</span> <span class="dv">1</span><span class="sc">:</span>n,</span>
<span id="cb175-11"><a href="#cb175-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">satisfaction =</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">6</span>, <span class="at">sd =</span> <span class="fl">1.5</span>),</span>
<span id="cb175-12"><a href="#cb175-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">salary =</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">55000</span>, <span class="at">sd =</span> <span class="dv">10000</span>),</span>
<span id="cb175-13"><a href="#cb175-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">commute_min =</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">30</span>, <span class="at">sd =</span> <span class="dv">15</span>),</span>
<span id="cb175-14"><a href="#cb175-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">tenure_years =</span> <span class="fu">round</span>(<span class="fu">runif</span>(n, <span class="at">min =</span> <span class="fl">0.5</span>, <span class="at">max =</span> <span class="dv">8</span>), <span class="dv">1</span>),</span>
<span id="cb175-15"><a href="#cb175-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">performance =</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="fl">3.5</span>, <span class="at">sd =</span> <span class="fl">0.7</span>),  <span class="co"># 1-5 scale</span></span>
<span id="cb175-16"><a href="#cb175-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">team_size =</span> <span class="fu">sample</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">12</span>, n, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb175-17"><a href="#cb175-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">training_hours =</span> <span class="fu">round</span>(<span class="fu">runif</span>(n, <span class="at">min =</span> <span class="dv">5</span>, <span class="at">max =</span> <span class="dv">50</span>)),</span>
<span id="cb175-18"><a href="#cb175-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">wfh_days =</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>, n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb175-19"><a href="#cb175-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb175-20"><a href="#cb175-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-21"><a href="#cb175-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate turnover outcome (logistic model)</span></span>
<span id="cb175-22"><a href="#cb175-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Higher satisfaction, salary, performance â†’ lower turnover</span></span>
<span id="cb175-23"><a href="#cb175-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Higher commute, longer tenure (paradoxically) â†’ higher turnover</span></span>
<span id="cb175-24"><a href="#cb175-24" aria-hidden="true" tabindex="-1"></a>prob_leave <span class="ot">&lt;-</span> <span class="fu">plogis</span>(</span>
<span id="cb175-25"><a href="#cb175-25" aria-hidden="true" tabindex="-1"></a>  <span class="sc">-</span><span class="fl">0.5</span> <span class="sc">+</span>  <span class="co"># Adjusted intercept for more balanced outcome</span></span>
<span id="cb175-26"><a href="#cb175-26" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span><span class="fl">0.5</span> <span class="sc">*</span> <span class="fu">scale</span>(employee_data<span class="sc">$</span>satisfaction)[,<span class="dv">1</span>] <span class="sc">+</span></span>
<span id="cb175-27"><a href="#cb175-27" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span><span class="fl">0.3</span> <span class="sc">*</span> <span class="fu">scale</span>(employee_data<span class="sc">$</span>salary)[,<span class="dv">1</span>] <span class="sc">+</span></span>
<span id="cb175-28"><a href="#cb175-28" aria-hidden="true" tabindex="-1"></a>    <span class="fl">0.4</span> <span class="sc">*</span> <span class="fu">scale</span>(employee_data<span class="sc">$</span>commute_min)[,<span class="dv">1</span>] <span class="sc">+</span></span>
<span id="cb175-29"><a href="#cb175-29" aria-hidden="true" tabindex="-1"></a>    <span class="fl">0.2</span> <span class="sc">*</span> <span class="fu">scale</span>(employee_data<span class="sc">$</span>tenure_years)[,<span class="dv">1</span>] <span class="sc">+</span></span>
<span id="cb175-30"><a href="#cb175-30" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span><span class="fl">0.3</span> <span class="sc">*</span> <span class="fu">scale</span>(employee_data<span class="sc">$</span>performance)[,<span class="dv">1</span>] <span class="sc">+</span></span>
<span id="cb175-31"><a href="#cb175-31" aria-hidden="true" tabindex="-1"></a>    <span class="fl">0.1</span> <span class="sc">*</span> <span class="fu">scale</span>(employee_data<span class="sc">$</span>team_size)[,<span class="dv">1</span>] <span class="sc">+</span></span>
<span id="cb175-32"><a href="#cb175-32" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span><span class="fl">0.1</span> <span class="sc">*</span> <span class="fu">scale</span>(employee_data<span class="sc">$</span>training_hours)[,<span class="dv">1</span>] <span class="sc">+</span></span>
<span id="cb175-33"><a href="#cb175-33" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span><span class="fl">0.05</span> <span class="sc">*</span> <span class="fu">scale</span>(employee_data<span class="sc">$</span>wfh_days)[,<span class="dv">1</span>]</span>
<span id="cb175-34"><a href="#cb175-34" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb175-35"><a href="#cb175-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-36"><a href="#cb175-36" aria-hidden="true" tabindex="-1"></a>employee_data<span class="sc">$</span>left <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, <span class="dv">1</span>, prob_leave)</span>
<span id="cb175-37"><a href="#cb175-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-38"><a href="#cb175-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure we have both classes represented (minimum 5 per class for CV)</span></span>
<span id="cb175-39"><a href="#cb175-39" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span>(<span class="fu">sum</span>(employee_data<span class="sc">$</span>left) <span class="sc">&lt;</span> <span class="dv">5</span> <span class="sc">|</span> <span class="fu">sum</span>(employee_data<span class="sc">$</span>left) <span class="sc">&gt;</span> <span class="dv">55</span>) {</span>
<span id="cb175-40"><a href="#cb175-40" aria-hidden="true" tabindex="-1"></a>  prob_leave <span class="ot">&lt;-</span> <span class="fu">plogis</span>(</span>
<span id="cb175-41"><a href="#cb175-41" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span><span class="fl">0.5</span> <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="fl">0.2</span>) <span class="sc">+</span>  <span class="co"># Add slight variation</span></span>
<span id="cb175-42"><a href="#cb175-42" aria-hidden="true" tabindex="-1"></a>      <span class="sc">-</span><span class="fl">0.5</span> <span class="sc">*</span> <span class="fu">scale</span>(employee_data<span class="sc">$</span>satisfaction)[,<span class="dv">1</span>] <span class="sc">+</span></span>
<span id="cb175-43"><a href="#cb175-43" aria-hidden="true" tabindex="-1"></a>      <span class="sc">-</span><span class="fl">0.3</span> <span class="sc">*</span> <span class="fu">scale</span>(employee_data<span class="sc">$</span>salary)[,<span class="dv">1</span>] <span class="sc">+</span></span>
<span id="cb175-44"><a href="#cb175-44" aria-hidden="true" tabindex="-1"></a>      <span class="fl">0.4</span> <span class="sc">*</span> <span class="fu">scale</span>(employee_data<span class="sc">$</span>commute_min)[,<span class="dv">1</span>] <span class="sc">+</span></span>
<span id="cb175-45"><a href="#cb175-45" aria-hidden="true" tabindex="-1"></a>      <span class="fl">0.2</span> <span class="sc">*</span> <span class="fu">scale</span>(employee_data<span class="sc">$</span>tenure_years)[,<span class="dv">1</span>] <span class="sc">+</span></span>
<span id="cb175-46"><a href="#cb175-46" aria-hidden="true" tabindex="-1"></a>      <span class="sc">-</span><span class="fl">0.3</span> <span class="sc">*</span> <span class="fu">scale</span>(employee_data<span class="sc">$</span>performance)[,<span class="dv">1</span>] <span class="sc">+</span></span>
<span id="cb175-47"><a href="#cb175-47" aria-hidden="true" tabindex="-1"></a>      <span class="fl">0.1</span> <span class="sc">*</span> <span class="fu">scale</span>(employee_data<span class="sc">$</span>team_size)[,<span class="dv">1</span>] <span class="sc">+</span></span>
<span id="cb175-48"><a href="#cb175-48" aria-hidden="true" tabindex="-1"></a>      <span class="sc">-</span><span class="fl">0.1</span> <span class="sc">*</span> <span class="fu">scale</span>(employee_data<span class="sc">$</span>training_hours)[,<span class="dv">1</span>] <span class="sc">+</span></span>
<span id="cb175-49"><a href="#cb175-49" aria-hidden="true" tabindex="-1"></a>      <span class="sc">-</span><span class="fl">0.05</span> <span class="sc">*</span> <span class="fu">scale</span>(employee_data<span class="sc">$</span>wfh_days)[,<span class="dv">1</span>]</span>
<span id="cb175-50"><a href="#cb175-50" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb175-51"><a href="#cb175-51" aria-hidden="true" tabindex="-1"></a>  employee_data<span class="sc">$</span>left <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, <span class="dv">1</span>, prob_leave)</span>
<span id="cb175-52"><a href="#cb175-52" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb175-53"><a href="#cb175-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-54"><a href="#cb175-54" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary</span></span>
<span id="cb175-55"><a href="#cb175-55" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Sample size:"</span>, n, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Sample size: 60 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Number of predictors:"</span>, <span class="dv">8</span>, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Number of predictors: 8 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Turnover rate:"</span>, <span class="fu">mean</span>(employee_data<span class="sc">$</span>left), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Turnover rate: 0.4167 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"p/n ratio:"</span>, <span class="fu">round</span>(<span class="dv">8</span><span class="sc">/</span><span class="dv">60</span>, <span class="dv">3</span>), <span class="st">"(approaching danger zone of 0.1-0.2)</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>p/n ratio: 0.133 (approaching danger zone of 0.1-0.2)</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb183"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for multicollinearity</span></span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a>cor_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(employee_data[, <span class="dv">2</span><span class="sc">:</span><span class="dv">9</span>])</span>
<span id="cb183-3"><a href="#cb183-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Correlation matrix (check for |r| &gt; 0.7):</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Correlation matrix (check for |r| &gt; 0.7):</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb185"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(cor_matrix, <span class="dv">2</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>               satisfaction salary commute_min tenure_years performance
satisfaction           1.00   0.06        0.11         0.09        0.10
salary                 0.06   1.00       -0.17         0.05        0.14
commute_min            0.11  -0.17        1.00        -0.10        0.05
tenure_years           0.09   0.05       -0.10         1.00        0.01
performance            0.10   0.14        0.05         0.01        1.00
team_size             -0.13  -0.10        0.09         0.06       -0.02
training_hours         0.00   0.01       -0.01        -0.03        0.10
wfh_days               0.16   0.02        0.00         0.03       -0.17
               team_size training_hours wfh_days
satisfaction       -0.13           0.00     0.16
salary             -0.10           0.01     0.02
commute_min         0.09          -0.01     0.00
tenure_years        0.06          -0.03     0.03
performance        -0.02           0.10    -0.17
team_size           1.00           0.07    -0.04
training_hours      0.07           1.00    -0.01
wfh_days           -0.04          -0.01     1.00</code></pre>
</div>
</div>
<p><strong>Interpretation</strong>: With p/n = 0.13 and some moderate correlations, regularization helps prevent overfitting. Standard logistic regression would estimate 8 coefficients from 60 observations, risking unstable estimates.</p>
<p><strong>Step 2: Prepare Data for glmnet</strong></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="co"># glmnet requires matrix format (not data.frame)</span></span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(employee_data[, <span class="dv">2</span><span class="sc">:</span><span class="dv">9</span>])  <span class="co"># Predictors</span></span>
<span id="cb187-3"><a href="#cb187-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> employee_data<span class="sc">$</span>left  <span class="co"># Outcome</span></span>
<span id="cb187-4"><a href="#cb187-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-5"><a href="#cb187-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Check dimensions</span></span>
<span id="cb187-6"><a href="#cb187-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Predictor matrix X:"</span>, <span class="fu">nrow</span>(X), <span class="st">"rows Ã—"</span>, <span class="fu">ncol</span>(X), <span class="st">"columns</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Predictor matrix X: 60 rows Ã— 8 columns</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Outcome vector y:"</span>, <span class="fu">length</span>(y), <span class="st">"observations</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Outcome vector y: 60 observations</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb191"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Outcome distribution:"</span>, <span class="fu">table</span>(y), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Outcome distribution: 35 25 </code></pre>
</div>
</div>
<p><strong>Step 3: Fit Ridge Regression (alpha = 0)</strong></p>
<p>Ridge regression applies L2 penalty: minimizes âˆ‘(residualÂ²) + Î»âˆ‘(Î²Â²).<br>
All coefficients shrink toward zero but none become exactly zero.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb193"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit ridge regression with cross-validation to find optimal Î»</span></span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb193-3"><a href="#cb193-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Use 5 folds to ensure each fold has both classes</span></span>
<span id="cb193-4"><a href="#cb193-4" aria-hidden="true" tabindex="-1"></a>ridge_cv <span class="ot">&lt;-</span> <span class="fu">cv.glmnet</span>(</span>
<span id="cb193-5"><a href="#cb193-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> X,</span>
<span id="cb193-6"><a href="#cb193-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> y,</span>
<span id="cb193-7"><a href="#cb193-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">"binomial"</span>,</span>
<span id="cb193-8"><a href="#cb193-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">alpha =</span> <span class="dv">0</span>,  <span class="co"># alpha = 0 â†’ ridge</span></span>
<span id="cb193-9"><a href="#cb193-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">nfolds =</span> <span class="dv">5</span>,  <span class="co"># Fewer folds for small sample with binary outcome</span></span>
<span id="cb193-10"><a href="#cb193-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">type.measure =</span> <span class="st">"deviance"</span>  <span class="co"># Use deviance for classification</span></span>
<span id="cb193-11"><a href="#cb193-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb193-12"><a href="#cb193-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-13"><a href="#cb193-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot cross-validation results</span></span>
<span id="cb193-14"><a href="#cb193-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ridge_cv, <span class="at">main =</span> <span class="st">"Ridge Regression: Cross-Validation"</span>)</span>
<span id="cb193-15"><a href="#cb193-15" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">log</span>(ridge_cv<span class="sc">$</span>lambda.min), <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb193-16"><a href="#cb193-16" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">log</span>(ridge_cv<span class="sc">$</span>lambda<span class="fl">.1</span>se), <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb193-17"><a href="#cb193-17" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Î»_min"</span>, <span class="st">"Î»_1se"</span>), </span>
<span id="cb193-18"><a href="#cb193-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>), <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">cex =</span> <span class="fl">0.8</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="part-c-analysis-methods_files/figure-html/part-c-lab-5-2-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb194"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Optimal lambda</span></span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Optimal Î» (minimum CV error):"</span>, <span class="fu">round</span>(ridge_cv<span class="sc">$</span>lambda.min, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Optimal Î» (minimum CV error): 0.0944 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb196"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Conservative Î» (1 SE rule):"</span>, <span class="fu">round</span>(ridge_cv<span class="sc">$</span>lambda<span class="fl">.1</span>se, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Conservative Î» (1 SE rule): 0.2884 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb198"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficients at optimal lambda</span></span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a>ridge_coef <span class="ot">&lt;-</span> <span class="fu">coef</span>(ridge_cv, <span class="at">s =</span> <span class="st">"lambda.1se"</span>)</span>
<span id="cb198-3"><a href="#cb198-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Ridge coefficients (at Î»_1se):</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Ridge coefficients (at Î»_1se):</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb200"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(ridge_coef)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>9 x 1 sparse Matrix of class "dgCMatrix"
               lambda.1se
(Intercept)    -0.1119422
satisfaction   -0.1161312
salary         -0.0000159
commute_min     0.0116150
tenure_years    0.1533435
performance    -0.2196370
team_size       0.1131525
training_hours  0.0035215
wfh_days        0.0920500</code></pre>
</div>
</div>
<p><strong>Interpretation</strong>: - <strong>Î»_min</strong>: Lambda that minimizes CV error (may overfit slightly) - <strong>Î»_1se</strong>: Lambda within 1 SE of minimum (more conservative, preferred) - Ridge shrinks all coefficients but keeps all 8 predictors in the model - Coefficients on standardized scale (larger |Î²| = stronger effect)</p>
<p><strong>Step 4: Fit Lasso Regression (alpha = 1)</strong></p>
<p>Lasso applies L1 penalty: minimizes âˆ‘(residualÂ²) + Î»âˆ‘|Î²|.<br>
Can shrink coefficients to exactly zero â†’ automatic variable selection.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb202"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit lasso with cross-validation</span></span>
<span id="cb202-2"><a href="#cb202-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb202-3"><a href="#cb202-3" aria-hidden="true" tabindex="-1"></a>lasso_cv <span class="ot">&lt;-</span> <span class="fu">cv.glmnet</span>(</span>
<span id="cb202-4"><a href="#cb202-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> X,</span>
<span id="cb202-5"><a href="#cb202-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> y,</span>
<span id="cb202-6"><a href="#cb202-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">"binomial"</span>,</span>
<span id="cb202-7"><a href="#cb202-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">alpha =</span> <span class="dv">1</span>,  <span class="co"># alpha = 1 â†’ lasso</span></span>
<span id="cb202-8"><a href="#cb202-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">nfolds =</span> <span class="dv">5</span>,  <span class="co"># Fewer folds for small sample</span></span>
<span id="cb202-9"><a href="#cb202-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">type.measure =</span> <span class="st">"deviance"</span></span>
<span id="cb202-10"><a href="#cb202-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb202-11"><a href="#cb202-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb202-12"><a href="#cb202-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot cross-validation</span></span>
<span id="cb202-13"><a href="#cb202-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lasso_cv, <span class="at">main =</span> <span class="st">"Lasso Regression: Cross-Validation"</span>)</span>
<span id="cb202-14"><a href="#cb202-14" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">log</span>(lasso_cv<span class="sc">$</span>lambda.min), <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb202-15"><a href="#cb202-15" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">log</span>(lasso_cv<span class="sc">$</span>lambda<span class="fl">.1</span>se), <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"blue"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="part-c-analysis-methods_files/figure-html/part-c-lab-5-2-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb203"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Optimal lambda</span></span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Optimal Î» (minimum CV error):"</span>, <span class="fu">round</span>(lasso_cv<span class="sc">$</span>lambda.min, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Optimal Î» (minimum CV error): 0.0275 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb205"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Conservative Î» (1 SE rule):"</span>, <span class="fu">round</span>(lasso_cv<span class="sc">$</span>lambda<span class="fl">.1</span>se, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Conservative Î» (1 SE rule): 0.0579 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb207"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficients at optimal lambda</span></span>
<span id="cb207-2"><a href="#cb207-2" aria-hidden="true" tabindex="-1"></a>lasso_coef <span class="ot">&lt;-</span> <span class="fu">coef</span>(lasso_cv, <span class="at">s =</span> <span class="st">"lambda.1se"</span>)</span>
<span id="cb207-3"><a href="#cb207-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Lasso coefficients (at Î»_1se):</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Lasso coefficients (at Î»_1se):</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb209"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(lasso_coef)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>9 x 1 sparse Matrix of class "dgCMatrix"
               lambda.1se
(Intercept)    -1.2031899
satisfaction   -0.0761434
salary         -0.0000128
commute_min     0.0094919
tenure_years    0.2215953
performance    -0.1494308
team_size       0.1680287
training_hours  .        
wfh_days        0.0337959</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb211"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Count non-zero coefficients</span></span>
<span id="cb211-2"><a href="#cb211-2" aria-hidden="true" tabindex="-1"></a>n_selected <span class="ot">&lt;-</span> <span class="fu">sum</span>(lasso_coef[<span class="sc">-</span><span class="dv">1</span>] <span class="sc">!=</span> <span class="dv">0</span>)  <span class="co"># Exclude intercept</span></span>
<span id="cb211-3"><a href="#cb211-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Variables selected:"</span>, n_selected, <span class="st">"out of 8</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Variables selected: 7 out of 8</code></pre>
</div>
</div>
<p><strong>Interpretation</strong>: - Lasso performs automatic variable selection - At Î»_1se, some coefficients are exactly 0 (excluded from model) - Simplifies model: easier to interpret and less prone to overfitting - Variables with Î² = 0 are deemed unimportant after controlling for others</p>
<p><strong>Step 5: Fit Elastic Net (alpha = 0.5)</strong></p>
<p>Elastic net combines ridge + lasso: penalty = (1-Î±)âˆ‘Î²Â² + Î±âˆ‘|Î²|.<br>
With Î± = 0.5, equally weights L1 and L2 penalties.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb213"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit elastic net</span></span>
<span id="cb213-2"><a href="#cb213-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb213-3"><a href="#cb213-3" aria-hidden="true" tabindex="-1"></a>enet_cv <span class="ot">&lt;-</span> <span class="fu">cv.glmnet</span>(</span>
<span id="cb213-4"><a href="#cb213-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> X,</span>
<span id="cb213-5"><a href="#cb213-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> y,</span>
<span id="cb213-6"><a href="#cb213-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">"binomial"</span>,</span>
<span id="cb213-7"><a href="#cb213-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">alpha =</span> <span class="fl">0.5</span>,  <span class="co"># alpha = 0.5 â†’ elastic net (50% ridge + 50% lasso)</span></span>
<span id="cb213-8"><a href="#cb213-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">nfolds =</span> <span class="dv">5</span>,  <span class="co"># Fewer folds for small sample</span></span>
<span id="cb213-9"><a href="#cb213-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">type.measure =</span> <span class="st">"deviance"</span></span>
<span id="cb213-10"><a href="#cb213-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb213-11"><a href="#cb213-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-12"><a href="#cb213-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot cross-validation</span></span>
<span id="cb213-13"><a href="#cb213-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(enet_cv, <span class="at">main =</span> <span class="st">"Elastic Net: Cross-Validation"</span>)</span>
<span id="cb213-14"><a href="#cb213-14" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">log</span>(enet_cv<span class="sc">$</span>lambda.min), <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb213-15"><a href="#cb213-15" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">log</span>(enet_cv<span class="sc">$</span>lambda<span class="fl">.1</span>se), <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"blue"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="part-c-analysis-methods_files/figure-html/part-c-lab-5-2-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb214"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficients</span></span>
<span id="cb214-2"><a href="#cb214-2" aria-hidden="true" tabindex="-1"></a>enet_coef <span class="ot">&lt;-</span> <span class="fu">coef</span>(enet_cv, <span class="at">s =</span> <span class="st">"lambda.1se"</span>)</span>
<span id="cb214-3"><a href="#cb214-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Elastic Net coefficients (at Î»_1se):</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Elastic Net coefficients (at Î»_1se):</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb216"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(enet_coef)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>9 x 1 sparse Matrix of class "dgCMatrix"
                lambda.1se
(Intercept)    -0.78758437
satisfaction   -0.10619594
salary         -0.00001512
commute_min     0.01181267
tenure_years    0.21499108
performance    -0.18737118
team_size       0.15812342
training_hours  .         
wfh_days        0.06665637</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb218"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Count non-zero</span></span>
<span id="cb218-2"><a href="#cb218-2" aria-hidden="true" tabindex="-1"></a>n_selected_enet <span class="ot">&lt;-</span> <span class="fu">sum</span>(enet_coef[<span class="sc">-</span><span class="dv">1</span>] <span class="sc">!=</span> <span class="dv">0</span>)</span>
<span id="cb218-3"><a href="#cb218-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Variables selected:"</span>, n_selected_enet, <span class="st">"out of 8</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Variables selected: 7 out of 8</code></pre>
</div>
</div>
<p><strong>Step 6: Compare All Three Methods</strong></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb220"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract coefficients from all models</span></span>
<span id="cb220-2"><a href="#cb220-2" aria-hidden="true" tabindex="-1"></a>comparison <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb220-3"><a href="#cb220-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Variable =</span> <span class="fu">rownames</span>(ridge_coef)[<span class="sc">-</span><span class="dv">1</span>],  <span class="co"># Exclude intercept</span></span>
<span id="cb220-4"><a href="#cb220-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Ridge =</span> <span class="fu">as.numeric</span>(ridge_coef[<span class="sc">-</span><span class="dv">1</span>]),</span>
<span id="cb220-5"><a href="#cb220-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Lasso =</span> <span class="fu">as.numeric</span>(lasso_coef[<span class="sc">-</span><span class="dv">1</span>]),</span>
<span id="cb220-6"><a href="#cb220-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">ElasticNet =</span> <span class="fu">as.numeric</span>(enet_coef[<span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb220-7"><a href="#cb220-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb220-8"><a href="#cb220-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-9"><a href="#cb220-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Round for readability</span></span>
<span id="cb220-10"><a href="#cb220-10" aria-hidden="true" tabindex="-1"></a>comparison[, <span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="fu">round</span>(comparison[, <span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>], <span class="dv">3</span>)</span>
<span id="cb220-11"><a href="#cb220-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-12"><a href="#cb220-12" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Coefficient Comparison (at Î»_1se):</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Coefficient Comparison (at Î»_1se):</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb222"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(comparison)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Variable  Ridge  Lasso ElasticNet
1   satisfaction -0.116 -0.076     -0.106
2         salary  0.000  0.000      0.000
3    commute_min  0.012  0.009      0.012
4   tenure_years  0.153  0.222      0.215
5    performance -0.220 -0.149     -0.187
6      team_size  0.113  0.168      0.158
7 training_hours  0.004  0.000      0.000
8       wfh_days  0.092  0.034      0.067</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb224"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visual comparison</span></span>
<span id="cb224-2"><a href="#cb224-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb224-3"><a href="#cb224-3" aria-hidden="true" tabindex="-1"></a>comparison_long <span class="ot">&lt;-</span> comparison <span class="sc">%&gt;%</span></span>
<span id="cb224-4"><a href="#cb224-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(Ridge, Lasso, ElasticNet),</span>
<span id="cb224-5"><a href="#cb224-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"Method"</span>,</span>
<span id="cb224-6"><a href="#cb224-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"Coefficient"</span>)</span>
<span id="cb224-7"><a href="#cb224-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-8"><a href="#cb224-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb224-9"><a href="#cb224-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(comparison_long, <span class="fu">aes</span>(<span class="at">x =</span> Variable, <span class="at">y =</span> Coefficient, <span class="at">fill =</span> Method)) <span class="sc">+</span></span>
<span id="cb224-10"><a href="#cb224-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb224-11"><a href="#cb224-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb224-12"><a href="#cb224-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb224-13"><a href="#cb224-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Regularized Regression Comparison"</span>,</span>
<span id="cb224-14"><a href="#cb224-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Ridge keeps all variables; Lasso/Elastic Net select subset"</span>,</span>
<span id="cb224-15"><a href="#cb224-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Predictor"</span>,</span>
<span id="cb224-16"><a href="#cb224-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Standardized Coefficient"</span></span>
<span id="cb224-17"><a href="#cb224-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb224-18"><a href="#cb224-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb224-19"><a href="#cb224-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="part-c-analysis-methods_files/figure-html/part-c-lab-5-2-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Step 7: Model Performance Comparison</strong></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb225"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict probabilities using optimal models</span></span>
<span id="cb225-2"><a href="#cb225-2" aria-hidden="true" tabindex="-1"></a>ridge_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(ridge_cv, <span class="at">newx =</span> X, <span class="at">s =</span> <span class="st">"lambda.1se"</span>, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb225-3"><a href="#cb225-3" aria-hidden="true" tabindex="-1"></a>lasso_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(lasso_cv, <span class="at">newx =</span> X, <span class="at">s =</span> <span class="st">"lambda.1se"</span>, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb225-4"><a href="#cb225-4" aria-hidden="true" tabindex="-1"></a>enet_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(enet_cv, <span class="at">newx =</span> X, <span class="at">s =</span> <span class="st">"lambda.1se"</span>, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb225-5"><a href="#cb225-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-6"><a href="#cb225-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Classification accuracy (using 0.5 threshold)</span></span>
<span id="cb225-7"><a href="#cb225-7" aria-hidden="true" tabindex="-1"></a>ridge_class <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(ridge_pred <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb225-8"><a href="#cb225-8" aria-hidden="true" tabindex="-1"></a>lasso_class <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(lasso_pred <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb225-9"><a href="#cb225-9" aria-hidden="true" tabindex="-1"></a>enet_class <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(enet_pred <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb225-10"><a href="#cb225-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-11"><a href="#cb225-11" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Classification Accuracy (in-sample):</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Classification Accuracy (in-sample):</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb227"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Ridge:"</span>, <span class="fu">mean</span>(ridge_class <span class="sc">==</span> y), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Ridge: 0.75 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb229"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Lasso:"</span>, <span class="fu">mean</span>(lasso_class <span class="sc">==</span> y), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Lasso: 0.7333 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb231"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Elastic Net:"</span>, <span class="fu">mean</span>(enet_class <span class="sc">==</span> y), <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Elastic Net: 0.7667 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb233"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb233-1"><a href="#cb233-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Cross-Validation Deviance (lower = better):</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Cross-Validation Deviance (lower = better):</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb235"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Ridge:"</span>, <span class="fu">round</span>(<span class="fu">min</span>(ridge_cv<span class="sc">$</span>cvm), <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Ridge: 1.18 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb237"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Lasso:"</span>, <span class="fu">round</span>(<span class="fu">min</span>(lasso_cv<span class="sc">$</span>cvm), <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Lasso: 1.238 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb239"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb239-1"><a href="#cb239-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Elastic Net:"</span>, <span class="fu">round</span>(<span class="fu">min</span>(enet_cv<span class="sc">$</span>cvm), <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Elastic Net: 1.209 </code></pre>
</div>
</div>
<p><strong>Step 8: Interpretation for Stakeholders</strong></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb241"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb241-1"><a href="#cb241-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify top predictors from Lasso (non-zero coefficients)</span></span>
<span id="cb241-2"><a href="#cb241-2" aria-hidden="true" tabindex="-1"></a>top_predictors <span class="ot">&lt;-</span> comparison <span class="sc">%&gt;%</span></span>
<span id="cb241-3"><a href="#cb241-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Lasso <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb241-4"><a href="#cb241-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(<span class="fu">abs</span>(Lasso)))</span>
<span id="cb241-5"><a href="#cb241-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb241-6"><a href="#cb241-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== KEY FINDINGS FOR TURNOVER PREDICTION ===</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== KEY FINDINGS FOR TURNOVER PREDICTION ===</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb243"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb243-1"><a href="#cb243-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Top predictors of turnover (Lasso selection):</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Top predictors of turnover (Lasso selection):</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb245"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb245-1"><a href="#cb245-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(top_predictors)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Variable  Ridge  Lasso ElasticNet
1 tenure_years  0.153  0.222      0.215
2    team_size  0.113  0.168      0.158
3  performance -0.220 -0.149     -0.187
4 satisfaction -0.116 -0.076     -0.106
5     wfh_days  0.092  0.034      0.067
6  commute_min  0.012  0.009      0.012</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb247"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb247-1"><a href="#cb247-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Interpretation:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Interpretation:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb249"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb249-1"><a href="#cb249-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">nrow</span>(top_predictors) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb249-2"><a href="#cb249-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"- Negative coefficients â†’ Higher values reduce turnover risk</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb249-3"><a href="#cb249-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"- Positive coefficients â†’ Higher values increase turnover risk</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb249-4"><a href="#cb249-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"- Variables with Î² = 0 were excluded (not predictive after controlling for others)</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb249-5"><a href="#cb249-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>- Negative coefficients â†’ Higher values reduce turnover risk
- Positive coefficients â†’ Higher values increase turnover risk
- Variables with Î² = 0 were excluded (not predictive after controlling for others)</code></pre>
</div>
</div>
<p><strong>Discussion Questions</strong>:</p>
<ol type="1">
<li><strong>When should you use regularization vs.&nbsp;Firth regression?</strong>
<ul>
<li>Firth: Binary outcome with separation, small n (&lt; 50)</li>
<li>Regularization: Multiple predictors, p/n &gt; 0.1, multicollinearity, n = 50-100</li>
</ul></li>
<li><strong>How do you choose between Ridge, Lasso, and Elastic Net?</strong>
<ul>
<li>Ridge: Keep all predictors, just shrink coefficients (interpretability less important)</li>
<li>Lasso: Want automatic variable selection, sparse models</li>
<li>Elastic Net: Correlated predictors + selection (best of both worlds)</li>
</ul></li>
<li><strong>What does Î» control?</strong>
<ul>
<li>Î» = 0: No penalty (standard logistic regression, may overfit)</li>
<li>Î» = âˆž: All Î² â†’ 0 (underfits, intercept-only model)</li>
<li>Optimal Î»: Balance bias-variance via cross-validation</li>
</ul></li>
<li><strong>How do you report regularized regression results?</strong>
<ul>
<li>State method (ridge/lasso/elastic net), Î± value, cross-validation procedure</li>
<li>Report optimal Î» (Î»_min or Î»_1se)</li>
<li>Report which variables were selected (lasso/elastic net)</li>
<li>Report coefficients and interpret direction/magnitude</li>
<li>Acknowledge: coefficients are biased toward zero (shrinkage), but predictions are often better</li>
</ul></li>
</ol>
<p><strong>Key Takeaways</strong>: - Regularization prevents overfitting when p/n ratio is high (&gt; 0.1) - Cross-validation selects optimal penalty strength automatically - Lasso provides interpretable models via automatic variable selection - Elastic net combines strengths of ridge and lasso - Regularized models sacrifice unbiasedness for better prediction accuracy</p>
<p><strong>Extension</strong>: - Try different Î± values (0, 0.25, 0.5, 0.75, 1) to see how variable selection changes - Split data into train (70%) and test (30%) to assess out-of-sample performance - Use <code>glmnet</code>â€™s built-in <code>predict()</code> function with <code>type = "class"</code> for classification</p>
<hr>
</section>
<section id="self-assessment-quiz-2" class="level3" data-number="3.4.12">
<h3 data-number="3.4.12" class="anchored" data-anchor-id="self-assessment-quiz-2"><span class="header-section-number">3.4.12</span> Self-Assessment Quiz</h3>
<p>Test your understanding of penalized and Bayesian regression methods from Chapter 5. Answers and explanations are provided at the end.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Questions
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Q1.</strong> Firthâ€™s penalized logistic regression is necessary when:</p>
<p>A. Sample size exceeds 1,000<br>
B. Complete or quasi-complete separation occurs in standard logistic regression<br>
C. The outcome is continuous<br>
D. There are no missing data</p>
<hr>
<p><strong>Q2.</strong> What is the â€œseparation problemâ€ in logistic regression?</p>
<p>A. Predictors are uncorrelated<br>
B. A predictor perfectly predicts the outcome, causing infinite coefficient estimates<br>
C. Sample size is too large<br>
D. The outcome has only one level</p>
<hr>
<p><strong>Q3.</strong> In Bayesian regression, a â€œweakly informative priorâ€ means:</p>
<p>A. Strong beliefs based on previous research<br>
B. Priors that gently regularize estimates without imposing strong constraints<br>
C. Flat, non-informative priors<br>
D. Priors are not used</p>
<hr>
<p><strong>Q4.</strong> Why are Bayesian methods well-suited to small samples?</p>
<p>A. They automatically increase sample size<br>
B. Priors stabilize estimates and quantify uncertainty through posterior distributions<br>
C. They eliminate the need for assumptions<br>
D. They always produce significant results</p>
<hr>
<p><strong>Q5.</strong> What does MCMC stand for, and why is it used in Bayesian regression?</p>
<p>A. Maximum Correlation for Model Comparison; used for variable selection<br>
B. Markov Chain Monte Carlo; used to sample from posterior distributions<br>
C. Minimum Covariance Model Checking; used for diagnostics<br>
D. Multiple Comparison Correction; used to adjust p-values</p>
<hr>
<p><strong>Q6.</strong> R-hat (RÌ‚) is a diagnostic for Bayesian models. What does RÌ‚ &gt; 1.1 indicate?</p>
<p>A. Perfect convergence<br>
B. Chains have not converged; more iterations or different initialization needed<br>
C. The model fits well<br>
D. Sample size is too large</p>
<hr>
<p><strong>Q7.</strong> Posterior predictive checks assess:</p>
<p>A. Whether priors are reasonable<br>
B. Whether simulated data from the fitted model resemble observed data<br>
C. Whether R-hat &lt; 1.01<br>
D. Statistical power</p>
<hr>
<p><strong>Q8.</strong> LOOIC (Leave-One-Out Information Criterion) is used for:</p>
<p>A. Hypothesis testing<br>
B. Model comparisonâ€”lower LOOIC indicates better predictive accuracy<br>
C. Diagnosing convergence<br>
D. Calculating p-values</p>
<hr>
<p><strong>Q9.</strong> A Bayesian 95% credible interval [2, 8] means:</p>
<p>A. There is a 95% probability the true parameter lies in [2, 8] given the data and prior<br>
B. 95% of future samples will have values in [2, 8]<br>
C. The parameter is exactly 5<br>
D. The p-value is 0.05</p>
<hr>
<p><strong>Q10.</strong> When should you prefer Firth regression over Bayesian logistic regression?</p>
<p>A. When you want probability statements about parameters<br>
B. When you need a quick, simple solution for separation without specifying priors<br>
C. Neverâ€”Bayesian is always better<br>
D. Only with n&gt;100</p>
</div>
</div>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-11-contents" aria-controls="callout-11" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Answers and Explanations
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-11" class="callout-11-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Q1. Answer: B</strong><br>
<em>Explanation</em>: When a predictor perfectly or nearly perfectly separates outcomes (e.g., all treated patients survive, all untreated die), maximum likelihood diverges to infinity. Firthâ€™s method adds a penalty to shrink coefficients toward finite values. The chapter states: â€œFirth logistic regression is particularly useful when events are sparse (fewer than 10 events per predictor) or when separation occurs.â€</p>
<p><strong>Q2. Answer: B</strong><br>
<em>Explanation</em>: Separation occurs when a combination of predictors perfectly classifies outcomes (e.g., all patients with predictor=1 have outcome=1). Maximum likelihood fails, yielding infinite estimates and huge standard errors. The lab practical demonstrates this with the medication adherence example showing â€œclear separation.â€</p>
<p><strong>Q3. Answer: B</strong><br>
<em>Explanation</em>: Weakly informative priors (e.g., Normal(0, 2) for standardized coefficients) prevent extreme estimates without dominating the data. They improve small-sample estimation by incorporating mild regularization. The chapter describes them as priors that â€œgently regularise estimates without imposing strong beliefs.â€</p>
<p><strong>Q4. Answer: B</strong><br>
<em>Explanation</em>: Bayesian methods incorporate prior information (even weak priors) to stabilize estimates when data are limited. Posterior distributions quantify uncertainty naturally, unlike frequentist CIs which can be unstable with small n.&nbsp;The chapter emphasizes that priors â€œstabilize estimatesâ€ and Bayesian methods â€œquantify uncertainty through posterior distributions.â€</p>
<p><strong>Q5. Answer: B</strong><br>
<em>Explanation</em>: MCMC (Markov Chain Monte Carlo) algorithms (e.g., Hamiltonian Monte Carlo in Stan) generate samples from complex posterior distributions that cannot be computed analytically. This is the fundamental computational method underlying Bayesian inference with complex models.</p>
<p><strong>Q6. Answer: B</strong><br>
<em>Explanation</em>: R-hat compares within-chain and between-chain variance. Values near 1.0 indicate convergence; values &gt;1.01 (and especially &gt;1.1) indicate chains are exploring different regions and have not mixed well. This is a standard diagnostic for assessing MCMC convergence.</p>
<p><strong>Q7. Answer: B</strong><br>
<em>Explanation</em>: Posterior predictive checks (PPCs) simulate datasets from the fitted model and compare them to the actual data. If simulated data match observed patterns (distributions, means, etc.), the model fits well. The chapter describes PPCs as validating â€œmodel fit by comparing observed and simulated data.â€</p>
<p><strong>Q8. Answer: B</strong><br>
<em>Explanation</em>: LOOIC estimates out-of-sample predictive accuracy using leave-one-out cross-validation. When comparing models, prefer the one with lower LOOIC (better prediction). The Key Takeaways state: â€œLOOIC facilitates model comparison, favouring models with better out-of-sample predictive accuracy.â€</p>
<p><strong>Q9. Answer: A</strong><br>
<em>Explanation</em>: Credible intervals (Bayesian) have a direct probability interpretation: given the data and prior, thereâ€™s a 95% probability the parameter is in the interval. This differs from frequentist CIs, which are about long-run coverage. This is the fundamental difference between Bayesian and frequentist interval interpretation.</p>
<p><strong>Q10. Answer: B</strong><br>
<em>Explanation</em>: Firth regression is simpler (no prior specification, no MCMC convergence checks) and provides a quick fix for separation. Bayesian methods offer more flexibility and natural uncertainty quantification but require more setup. The lab practicalâ€™s reflection question addresses this: â€œFirth: Quick, frequentist inference, handles separation automatically.â€</p>
</div>
</div>
</div>
<hr>
</section>
<section id="key-takeaways-2" class="level3" data-number="3.4.13">
<h3 data-number="3.4.13" class="anchored" data-anchor-id="key-takeaways-2"><span class="header-section-number">3.4.13</span> Key Takeaways</h3>
<ul>
<li>Firth-penalised logistic regression stabilises estimates when events are sparse or separation occurs.</li>
<li>Bayesian regression incorporates prior information and quantifies uncertainty through posterior distributions.</li>
<li>Weakly informative priors regularise estimates without imposing strong beliefs, improving small-sample performance.</li>
<li>Posterior predictive checks validate model fit by comparing observed and simulated data.</li>
<li>LOOIC facilitates model comparison, favouring models with better out-of-sample predictive accuracy.</li>
<li>Both penalised and Bayesian methods are well-suited to small samples and provide robust, interpretable inferences.</li>
</ul>
</section>
<section id="smoke-test-2" class="level3" data-number="3.4.14">
<h3 data-number="3.4.14" class="anchored" data-anchor-id="smoke-test-2"><span class="header-section-number">3.4.14</span> Smoke Test</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb251"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb251-1"><a href="#cb251-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Re-run Firth logistic regression on simple example</span></span>
<span id="cb251-2"><a href="#cb251-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(logistf)</span>
<span id="cb251-3"><a href="#cb251-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb251-4"><a href="#cb251-4" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">y =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>))</span>
<span id="cb251-5"><a href="#cb251-5" aria-hidden="true" tabindex="-1"></a><span class="fu">logistf</span>(y <span class="sc">~</span> x, <span class="at">data =</span> dat)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>logistf(formula = y ~ x, data = dat)
Model fitted by Penalized ML
Confidence intervals and p-values by Profile Likelihood 

Coefficients:
(Intercept)           x 
     -4.369       2.184 

Likelihood ratio test=5.378 on 1 df, p=0.02039, n=8</code></pre>
</div>
</div>
<hr>
</section>
</section>
<section id="chapter-6.-reliability-and-measurement-quality-for-short-scales" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="chapter-6.-reliability-and-measurement-quality-for-short-scales"><span class="header-section-number">3.5</span> Chapter 6. Reliability and Measurement Quality for Short Scales</h2>
<section id="learning-objectives-3" class="level3" data-number="3.5.1">
<h3 data-number="3.5.1" class="anchored" data-anchor-id="learning-objectives-3"><span class="header-section-number">3.5.1</span> Learning Objectives</h3>
<p>By the end of this chapter, you will be able to:</p>
<p><strong>Conceptual Understanding</strong> - âœ“ Explain the theoretical basis of reliability (true score theory) - âœ“ Understand why Cronbachâ€™s alpha is attenuated for short scales - âœ“ Recognize the differences between alpha, omega, and split-half reliability - âœ“ Distinguish reliability from validity in measurement quality</p>
<p><strong>Practical Skills</strong> - âœ“ Compute Cronbachâ€™s alpha using <code>psych::alpha()</code> in R - âœ“ Calculate McDonaldâ€™s omega with <code>psych::omega()</code> for multidimensional scales - âœ“ Estimate split-half reliability with bootstrap confidence intervals - âœ“ Apply polychoric correlations for ordinal items using <code>polycor</code> package</p>
<p><strong>Critical Evaluation</strong> - âœ“ Assess when reliability estimates are trustworthy vs.&nbsp;unstable with small n - âœ“ Evaluate the trade-off between scale brevity and internal consistency - âœ“ Critique inappropriate use of alpha for multidimensional scales</p>
<p><strong>Application</strong> - âœ“ Report reliability with confidence intervals and appropriate caveats - âœ“ Use item analysis to identify low-performing items for deletion - âœ“ Apply measurement quality checks in small-scale instrument development</p>
</section>
<section id="the-challenge-of-short-scales" class="level3" data-number="3.5.2">
<h3 data-number="3.5.2" class="anchored" data-anchor-id="the-challenge-of-short-scales"><span class="header-section-number">3.5.2</span> The Challenge of Short Scales</h3>
<p>Many small-sample studies use brief measurement instruments (3â€“5 items) to reduce respondent burden. Short scales, however, pose challenges for reliability assessment. Classical reliability indices (Cronbachâ€™s alpha, split-half reliability) are attenuated when scales have few items. Moreover, small sample sizes yield imprecise reliability estimates with wide confidence intervals.</p>
<p>Despite these limitations, reliability assessment remains essential. Unreliable measures introduce noise, reducing statistical power and biasing effect estimates. Researchers should report reliability alongside validity evidence and interpret findings cautiously when reliability is low.</p>
</section>
<section id="cronbachs-alpha" class="level3" data-number="3.5.3">
<h3 data-number="3.5.3" class="anchored" data-anchor-id="cronbachs-alpha"><span class="header-section-number">3.5.3</span> Cronbachâ€™s Alpha</h3>
<p>Cronbachâ€™s alpha estimates internal consistency by comparing item variances to total scale variance. It assumes that all items measure a single underlying construct with equal factor loadings (tau-equivalent model). Alpha increases with the number of items and the average inter-item correlation.</p>
<p><strong>Assumptions</strong>: Items are tau-equivalent. Errors are uncorrelated. Continuous or approximately continuous item responses.</p>
<p><strong>When to use</strong>: Multi-item scales (3 or more items), desire for simple internal consistency estimate. Interpret cautiously for short scales and with small samples.</p>
</section>
<section id="interpreting-alpha-in-context" class="level3" data-number="3.5.4">
<h3 data-number="3.5.4" class="anchored" data-anchor-id="interpreting-alpha-in-context"><span class="header-section-number">3.5.4</span> Interpreting Alpha in Context</h3>
<p>Traditional thresholds (0.70 for research, 0.90 for clinical decisions) are <strong>guidelines, not rules</strong>:</p>
<ul>
<li><strong>Exploratory research / pilot studies</strong>: Î± = 0.60â€“0.70 acceptable</li>
<li><strong>Established scales in research</strong>: Î± = 0.70â€“0.90 expected</li>
<li><strong>High-stakes decisions</strong>: Î± &gt; 0.90 required</li>
<li><strong>Very short scales</strong> (3 items): Î± = 0.50â€“0.65 may be acceptable if items are conceptually narrow</li>
</ul>
<p><strong>More important than alpha:</strong></p>
<ul>
<li>Item-total correlations (all &gt; 0.30?)</li>
<li>Conceptual coherence of items</li>
<li>Confidence interval width (precision matters!)</li>
</ul>
<p>With n = 36, an alpha of 0.65 has a 95% CI of approximately [0.45, 0.80]â€”wide uncertainty! Always report confidence intervals alongside point estimates, especially with small samples where precision is limited.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Warning</span>âš ï¸ Common Misconception: â€œAlpha &gt; 0.70 = Good Scaleâ€
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Myth</strong>: â€œIf Cronbachâ€™s alpha is above 0.70, my scale is reliable and valid.â€</p>
<p><strong>Reality</strong>: Alpha can be <strong>artificially inflated</strong> by redundant items or scale length. High alpha â‰  good measurement.</p>
<p><strong>Demonstration</strong>:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb253"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb253-1"><a href="#cb253-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb253-2"><a href="#cb253-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb253-3"><a href="#cb253-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a scale with near-duplicate items (bad scale design!)</span></span>
<span id="cb253-4"><a href="#cb253-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb253-5"><a href="#cb253-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb253-6"><a href="#cb253-6" aria-hidden="true" tabindex="-1"></a>redundant_scale <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb253-7"><a href="#cb253-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">item1 =</span> <span class="fu">rnorm</span>(n, <span class="dv">50</span>, <span class="dv">10</span>),</span>
<span id="cb253-8"><a href="#cb253-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">item2 =</span> <span class="fu">rnorm</span>(n, <span class="dv">50</span>, <span class="dv">10</span>),  <span class="co"># Completely independent items (measuring different things)</span></span>
<span id="cb253-9"><a href="#cb253-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">item3 =</span> <span class="fu">rnorm</span>(n, <span class="dv">50</span>, <span class="dv">10</span>),</span>
<span id="cb253-10"><a href="#cb253-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">item4 =</span> <span class="fu">rnorm</span>(n, <span class="dv">50</span>, <span class="dv">10</span>)</span>
<span id="cb253-11"><a href="#cb253-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb253-12"><a href="#cb253-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb253-13"><a href="#cb253-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Add redundancy by duplicating item1 with slight noise</span></span>
<span id="cb253-14"><a href="#cb253-14" aria-hidden="true" tabindex="-1"></a>redundant_scale<span class="sc">$</span>item2 <span class="ot">&lt;-</span> redundant_scale<span class="sc">$</span>item1 <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">2</span>)  <span class="co"># Near-duplicate</span></span>
<span id="cb253-15"><a href="#cb253-15" aria-hidden="true" tabindex="-1"></a>redundant_scale<span class="sc">$</span>item3 <span class="ot">&lt;-</span> redundant_scale<span class="sc">$</span>item1 <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">2</span>)  <span class="co"># Near-duplicate</span></span>
<span id="cb253-16"><a href="#cb253-16" aria-hidden="true" tabindex="-1"></a>redundant_scale<span class="sc">$</span>item4 <span class="ot">&lt;-</span> redundant_scale<span class="sc">$</span>item1 <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">2</span>)  <span class="co"># Near-duplicate</span></span>
<span id="cb253-17"><a href="#cb253-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb253-18"><a href="#cb253-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute alpha</span></span>
<span id="cb253-19"><a href="#cb253-19" aria-hidden="true" tabindex="-1"></a>alpha_result <span class="ot">&lt;-</span> <span class="fu">alpha</span>(redundant_scale)</span>
<span id="cb253-20"><a href="#cb253-20" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Cronbach's alpha:"</span>, <span class="fu">round</span>(alpha_result<span class="sc">$</span>total<span class="sc">$</span>raw_alpha, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Cronbach's alpha: 0.99 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb255"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb255-1"><a href="#cb255-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check item-total correlations</span></span>
<span id="cb255-2"><a href="#cb255-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Item-total correlations (r.cor):</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Item-total correlations (r.cor):</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb257"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb257-1"><a href="#cb257-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(alpha_result<span class="sc">$</span>item.stats<span class="sc">$</span>r.cor, <span class="dv">2</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.00 0.99 0.98 0.98</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb259"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb259-1"><a href="#cb259-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">â†’ Alpha looks great (&gt;0.90), but all items are nearly identical!</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
â†’ Alpha looks great (&gt;0.90), but all items are nearly identical!</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb261"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb261-1"><a href="#cb261-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"â†’ This scale has poor content validity (measures only one narrow facet)</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>â†’ This scale has poor content validity (measures only one narrow facet)</code></pre>
</div>
</div>
<p><strong>Problems with high-but-meaningless alpha:</strong></p>
<ol type="1">
<li><strong>Redundant items</strong>: Asking the same question 10 times inflates alpha but doesnâ€™t improve measurement</li>
<li><strong>Alpha increases with # items</strong>: 20 poor items can yield Î± = 0.90</li>
<li><strong>Ignores unidimensionality</strong>: Alpha doesnâ€™t test whether items measure one construct or multiple</li>
</ol>
<p><strong>What to check instead:</strong></p>
<ol type="1">
<li><strong>Item-total correlations</strong>: Are all items contributing (r.cor &gt; 0.30)?</li>
<li><strong>Mean inter-item correlation</strong>: Should be 0.15â€“0.50 (Briggs &amp; Cheek, 1986)
<ul>
<li>&lt; 0.15: Items donâ€™t cohere</li>
<li><blockquote class="blockquote">
<p>0.50: Items are redundant</p>
</blockquote></li>
</ul></li>
<li><strong>Factor analysis</strong>: Do items load on one factor or multiple?</li>
<li><strong>Content validity</strong>: Do items cover the full construct breadth?</li>
</ol>
<p><strong>Lesson</strong>: <strong>Donâ€™t chase alpha &gt; 0.90 by adding redundant items.</strong> Better to have Î± = 0.75 with diverse, non-redundant items than Î± = 0.95 with near-duplicates.</p>
</div>
</div>
</section>
<section id="example-cronbachs-alpha-for-a-short-scale" class="level3" data-number="3.5.5">
<h3 data-number="3.5.5" class="anchored" data-anchor-id="example-cronbachs-alpha-for-a-short-scale"><span class="header-section-number">3.5.5</span> Example: Cronbachâ€™s Alpha for a Short Scale</h3>
<p>We assess the internal consistency of a 3-item service quality scale using the <code>service_quality.csv</code> data.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb263"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb263-1"><a href="#cb263-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb263-2"><a href="#cb263-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb263-3"><a href="#cb263-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb263-4"><a href="#cb263-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Load service quality data</span></span>
<span id="cb263-5"><a href="#cb263-5" aria-hidden="true" tabindex="-1"></a>service_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/service_quality.csv"</span>, <span class="at">show_col_types =</span> <span class="cn">FALSE</span>)</span>
<span id="cb263-6"><a href="#cb263-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb263-7"><a href="#cb263-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Select the three quality items</span></span>
<span id="cb263-8"><a href="#cb263-8" aria-hidden="true" tabindex="-1"></a>quality_items <span class="ot">&lt;-</span> service_data <span class="sc">%&gt;%</span></span>
<span id="cb263-9"><a href="#cb263-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(q1_responsiveness, q2_professionalism, q3_clarity)</span>
<span id="cb263-10"><a href="#cb263-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb263-11"><a href="#cb263-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute Cronbach's alpha</span></span>
<span id="cb263-12"><a href="#cb263-12" aria-hidden="true" tabindex="-1"></a>alpha_result <span class="ot">&lt;-</span> <span class="fu">alpha</span>(quality_items)</span>
<span id="cb263-13"><a href="#cb263-13" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(alpha_result)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Reliability analysis   
Call: alpha(x = quality_items)

  raw_alpha std.alpha G6(smc) average_r S/N  ase mean  sd median_r
      0.79      0.79    0.73      0.56 3.9 0.06  4.8 1.2     0.61

    95% confidence boundaries 
         lower alpha upper
Feldt     0.64  0.79  0.89
Duhachek  0.68  0.79  0.91

 Reliability if an item is dropped:
                   raw_alpha std.alpha G6(smc) average_r S/N alpha se var.r
q1_responsiveness       0.63      0.63    0.46      0.46 1.7    0.123    NA
q2_professionalism      0.77      0.77    0.62      0.62 3.3    0.078    NA
q3_clarity              0.76      0.76    0.61      0.61 3.1    0.081    NA
                   med.r
q1_responsiveness   0.46
q2_professionalism  0.62
q3_clarity          0.61

 Item statistics 
                    n raw.r std.r r.cor r.drop mean  sd
q1_responsiveness  36  0.88  0.88  0.81   0.72  4.6 1.3
q2_professionalism 36  0.83  0.82  0.67   0.59  4.7 1.4
q3_clarity         36  0.82  0.82  0.68   0.60  5.1 1.4

Non missing response frequency for each item
                      2    3    4    5    6    7 miss
q1_responsiveness  0.06 0.11 0.36 0.22 0.14 0.11    0
q2_professionalism 0.08 0.14 0.17 0.33 0.17 0.11    0
q3_clarity         0.03 0.14 0.14 0.28 0.25 0.17    0</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb265"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb265-1"><a href="#cb265-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract key values</span></span>
<span id="cb265-2"><a href="#cb265-2" aria-hidden="true" tabindex="-1"></a>alpha_est <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(alpha_result<span class="sc">$</span>total<span class="sc">$</span>raw_alpha)</span>
<span id="cb265-3"><a href="#cb265-3" aria-hidden="true" tabindex="-1"></a>alpha_se <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(alpha_result<span class="sc">$</span>total<span class="sc">$</span>ase)</span>
<span id="cb265-4"><a href="#cb265-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb265-5"><a href="#cb265-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Cronbach's alpha:"</span>, <span class="fu">formatC</span>(alpha_est, <span class="at">format =</span> <span class="st">"f"</span>, <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Cronbach's alpha: 0.793 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb267"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb267-1"><a href="#cb267-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"95% CI:"</span>,</span>
<span id="cb267-2"><a href="#cb267-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">formatC</span>(alpha_est <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> alpha_se, <span class="at">format =</span> <span class="st">"f"</span>, <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">"to"</span>,</span>
<span id="cb267-3"><a href="#cb267-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">formatC</span>(alpha_est <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> alpha_se, <span class="at">format =</span> <span class="st">"f"</span>, <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>95% CI: 0.675 to 0.912 </code></pre>
</div>
</div>
<p>Interpretation: Alpha quantifies the proportion of variance in scale scores attributable to the true score. Higher alpha indicates stronger internal consistency. The confidence interval reflects sampling uncertainty; with small samples, the interval may be wide. If alpha is below 0.70, consider whether items truly measure a single construct or whether the scale is too heterogeneous. The <code>psych</code> package also reports â€œalpha if item deletedâ€, showing how alpha would change if each item were removed; this helps identify problematic items.</p>
</section>
<section id="standard-error-of-measurement-sem" class="level3" data-number="3.5.6">
<h3 data-number="3.5.6" class="anchored" data-anchor-id="standard-error-of-measurement-sem"><span class="header-section-number">3.5.6</span> Standard Error of Measurement (SEM)</h3>
<p>The SEM quantifies measurement precisionâ€”how much individual scores vary due to measurement error.</p>
<p><strong>Formula</strong>: <span class="math inline">\(\text{SEM} = \text{SD} \times \sqrt{1 - \text{reliability}}\)</span></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb269"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb269-1"><a href="#cb269-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example: Test with SD = 10, Cronbach's alpha = 0.75</span></span>
<span id="cb269-2"><a href="#cb269-2" aria-hidden="true" tabindex="-1"></a>scale_SD <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb269-3"><a href="#cb269-3" aria-hidden="true" tabindex="-1"></a>cronbach_alpha <span class="ot">&lt;-</span> <span class="fl">0.75</span></span>
<span id="cb269-4"><a href="#cb269-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-5"><a href="#cb269-5" aria-hidden="true" tabindex="-1"></a>SEM <span class="ot">&lt;-</span> scale_SD <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="dv">1</span> <span class="sc">-</span> cronbach_alpha)</span>
<span id="cb269-6"><a href="#cb269-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"SEM ="</span>, <span class="fu">round</span>(SEM, <span class="dv">2</span>), <span class="st">"points</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>SEM = 5 points</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb271"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb271-1"><a href="#cb271-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Confidence interval for individual scores</span></span>
<span id="cb271-2"><a href="#cb271-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 95% CI: observed score Â± 1.96 Ã— SEM</span></span>
<span id="cb271-3"><a href="#cb271-3" aria-hidden="true" tabindex="-1"></a>CI_width <span class="ot">&lt;-</span> <span class="fl">1.96</span> <span class="sc">*</span> SEM</span>
<span id="cb271-4"><a href="#cb271-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"95% CI width: Â±"</span>, <span class="fu">round</span>(CI_width, <span class="dv">1</span>), <span class="st">"points</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>95% CI width: Â± 9.8 points</code></pre>
</div>
</div>
<p><strong>Interpretation</strong>: With SEM = 5 points, an individualâ€™s true score likely falls within Â±10 points of their observed score (95% CI). This helps judge whether observed changes are genuine or merely measurement error.</p>
<p><strong>Practical use</strong>: - Minimum detectable change = <span class="math inline">\(1.96 \times \text{SEM} \times \sqrt{2} \approx 14\)</span> points - Changes smaller than this could be measurement error - SEM increases as reliability decreases</p>
</section>
<section id="mcdonalds-omega" class="level3" data-number="3.5.7">
<h3 data-number="3.5.7" class="anchored" data-anchor-id="mcdonalds-omega"><span class="header-section-number">3.5.7</span> McDonaldâ€™s Omega</h3>
<p>McDonaldâ€™s omega (Ï‰â‚œ) is an alternative to alpha that relaxes the tau-equivalence assumption. It is computed from a single-factor confirmatory factor analysis model and reflects the proportion of variance in scale scores due to the general factor. Omega is generally preferred over alpha when factor loadings differ across items.</p>
<p><strong>When to use</strong>: Multi-item scales with varying item-factor relationships, when tau-equivalence is questionable, or when reporting alongside alpha for robustness.</p>
</section>
<section id="example-mcdonalds-omega" class="level3" data-number="3.5.8">
<h3 data-number="3.5.8" class="anchored" data-anchor-id="example-mcdonalds-omega"><span class="header-section-number">3.5.8</span> Example: McDonaldâ€™s Omega</h3>
<p>We compute omega for the same 3-item service quality scale.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb273"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb273-1"><a href="#cb273-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb273-2"><a href="#cb273-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb273-3"><a href="#cb273-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute McDonald's omega</span></span>
<span id="cb273-4"><a href="#cb273-4" aria-hidden="true" tabindex="-1"></a>omega_result <span class="ot">&lt;-</span> <span class="fu">omega</span>(quality_items, <span class="at">nfactors =</span> <span class="dv">1</span>, <span class="at">plot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb273-5"><a href="#cb273-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(omega_result)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Omega 
Call: omegah(m = m, nfactors = nfactors, fm = fm, key = key, flip = flip, 
    digits = digits, title = title, sl = sl, labels = labels, 
    plot = plot, n.obs = n.obs, rotate = rotate, Phi = Phi, option = option, 
    covar = covar)
Alpha:                 0.79 
G.6:                   0.73 
Omega Hierarchical:    0.8 
Omega H asymptotic:    1 
Omega Total            0.8 

Schmid Leiman Factor loadings greater than  0.2 
                      g  F1*   h2   h2   u2 p2 com
q1_responsiveness  0.91      0.82 0.82 0.18  1   1
q2_professionalism 0.67      0.45 0.45 0.55  1   1
q3_clarity         0.69      0.47 0.47 0.53  1   1

With Sums of squares  of:
  g F1*  h2 
1.7 0.0 1.1 

general/max  1.59   max/min =   Inf
mean percent general =  1    with sd =  0 and cv of  0 
Explained Common Variance of the general factor =  1 

The degrees of freedom are 0  and the fit is  0 
The number of observations was  36  with Chi Square =  0  with prob &lt;  NA
The root mean square of the residuals is  0 
The df corrected root mean square of the residuals is  NA

Compare this with the adequacy of just a general factor and no group factors
The degrees of freedom for just the general factor are 0  and the fit is  0 
The number of observations was  36  with Chi Square =  0  with prob &lt;  NA
The root mean square of the residuals is  0 
The df corrected root mean square of the residuals is  NA 

Measures of factor score adequacy             
                                                 g F1*
Correlation of scores with factors            0.93   0
Multiple R square of scores with factors      0.86   0
Minimum correlation of factor score estimates 0.72  -1

 Total, General and Subset omega for each subset
                                                g F1*
Omega total for total scores and subscales    0.8 0.8
Omega general for total scores and subscales  0.8 0.8
Omega group for total scores and subscales    0.0 0.0</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb275"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb275-1"><a href="#cb275-1" aria-hidden="true" tabindex="-1"></a>omega_tot <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(omega_result<span class="sc">$</span>omega.tot)</span>
<span id="cb275-2"><a href="#cb275-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"McDonald's omega total:"</span>, <span class="fu">formatC</span>(omega_tot, <span class="at">format =</span> <span class="st">"f"</span>, <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>McDonald's omega total: 0.803 </code></pre>
</div>
</div>
<p>Interpretation: Omega total (Ï‰â‚œ) is analogous to alpha but allows items to have different factor loadings. If omega and alpha are similar, the tau-equivalence assumption is reasonable. If omega is higher, items have unequal loadings, and omega is more accurate. The <code>omega()</code> function also reports omega hierarchical (Ï‰â‚•), which is relevant for multidimensional scales, though less applicable to brief unidimensional scales.</p>
</section>
<section id="split-half-reliability" class="level3" data-number="3.5.9">
<h3 data-number="3.5.9" class="anchored" data-anchor-id="split-half-reliability"><span class="header-section-number">3.5.9</span> Split-Half Reliability</h3>
<p>Split-half reliability divides a scale into two halves, computes the correlation between half-scale scores, and adjusts using the Spearmanâ€“Brown formula to estimate reliability of the full scale. With small samples, split-half estimates are imprecise, but bootstrapping can provide confidence intervals.</p>
<p><strong>When to use</strong>: Multi-item scales, desire for alternative reliability estimate, comparison with alpha or omega.</p>
</section>
<section id="example-bootstrap-split-half-reliability" class="level3" data-number="3.5.10">
<h3 data-number="3.5.10" class="anchored" data-anchor-id="example-bootstrap-split-half-reliability"><span class="header-section-number">3.5.10</span> Example: Bootstrap Split-Half Reliability</h3>
<p>We compute split-half reliability with a bootstrap confidence interval for the service quality scale.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb277"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb277-1"><a href="#cb277-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb277-2"><a href="#cb277-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb277-3"><a href="#cb277-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb277-4"><a href="#cb277-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb277-5"><a href="#cb277-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Split-half reliability with bootstrap CI</span></span>
<span id="cb277-6"><a href="#cb277-6" aria-hidden="true" tabindex="-1"></a>split_result <span class="ot">&lt;-</span> <span class="fu">splitHalf</span>(quality_items, <span class="at">raw =</span> <span class="cn">TRUE</span>)</span>
<span id="cb277-7"><a href="#cb277-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(split_result)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Split half reliabilities  
Call: splitHalf(r = quality_items, raw = TRUE)

Maximum split half reliability (lambda 4) =  0.77
Guttman lambda 6                          =  0.73
Average split half reliability            =  0.71
Guttman lambda 3 (alpha)                  =  0.79
Guttman lambda 2                          =  0.8
Minimum split half reliability  (beta)    =  0.67
Average interitem r =  0.56  with median =  0.61
                                             2.5% 50% 97.5%
 Quantiles of split half reliability      =  0.67 0.68 0.77</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb279"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb279-1"><a href="#cb279-1" aria-hidden="true" tabindex="-1"></a>split_alpha <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(split_result<span class="sc">$</span>raw_alpha)</span>
<span id="cb279-2"><a href="#cb279-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Split-half reliability (Spearmanâ€“Brown adjusted):"</span>,</span>
<span id="cb279-3"><a href="#cb279-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">formatC</span>(split_alpha, <span class="at">format =</span> <span class="st">"f"</span>, <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Split-half reliability (Spearmanâ€“Brown adjusted):  </code></pre>
</div>
</div>
<p>Interpretation: The split-half correlation measures consistency between the two halves. The Spearmanâ€“Brown adjustment estimates the reliability of the full scale. This method is less commonly used than alpha but provides a complementary perspective. Random splits can yield different estimates, so bootstrap CIs (if available) are valuable for quantifying uncertainty.</p>
</section>
<section id="revelles-beta-worst-split-half-reliability" class="level3" data-number="3.5.11">
<h3 data-number="3.5.11" class="anchored" data-anchor-id="revelles-beta-worst-split-half-reliability"><span class="header-section-number">3.5.11</span> Revelleâ€™s Beta (Worst Split-Half Reliability)</h3>
<p>Revelleâ€™s beta identifies the <strong>least reliable</strong> split of a scale and reports the reliability for that worst-case partition. Beta is useful for stress-testing very short scales: if the worst split still looks acceptable, the scale is unlikely to fail under any other split.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb281"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb281-1"><a href="#cb281-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Revelle's beta (accessed via psych's internal helper when available)</span></span>
<span id="cb281-2"><a href="#cb281-2" aria-hidden="true" tabindex="-1"></a>beta_available <span class="ot">&lt;-</span> <span class="fu">exists</span>(<span class="st">"beta"</span>, <span class="at">where =</span> <span class="fu">asNamespace</span>(<span class="st">"psych"</span>), <span class="at">inherits =</span> <span class="cn">FALSE</span>)</span>
<span id="cb281-3"><a href="#cb281-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb281-4"><a href="#cb281-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (beta_available) {</span>
<span id="cb281-5"><a href="#cb281-5" aria-hidden="true" tabindex="-1"></a>  beta_fn <span class="ot">&lt;-</span> <span class="fu">getFromNamespace</span>(<span class="st">"beta"</span>, <span class="st">"psych"</span>)</span>
<span id="cb281-6"><a href="#cb281-6" aria-hidden="true" tabindex="-1"></a>  beta_result <span class="ot">&lt;-</span> <span class="fu">beta_fn</span>(quality_items)</span>
<span id="cb281-7"><a href="#cb281-7" aria-hidden="true" tabindex="-1"></a>  beta_est <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(beta_result<span class="sc">$</span>beta)</span>
<span id="cb281-8"><a href="#cb281-8" aria-hidden="true" tabindex="-1"></a>  beta_worst <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(beta_result<span class="sc">$</span>worst.r)</span>
<span id="cb281-9"><a href="#cb281-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Revelle's beta:"</span>, <span class="fu">formatC</span>(beta_est, <span class="at">format =</span> <span class="st">"f"</span>, <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb281-10"><a href="#cb281-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Worst split halves correlation:"</span>, <span class="fu">formatC</span>(beta_worst, <span class="at">format =</span> <span class="st">"f"</span>, <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb281-11"><a href="#cb281-11" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb281-12"><a href="#cb281-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Revelle's beta is unavailable in psych"</span>, <span class="fu">as.character</span>(<span class="fu">packageVersion</span>(<span class="st">"psych"</span>)),</span>
<span id="cb281-13"><a href="#cb281-13" aria-hidden="true" tabindex="-1"></a>      <span class="st">"because the helper function is not exported.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb281-14"><a href="#cb281-14" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Revelle's beta is unavailable in psych 2.5.6 because the helper function is not exported.</code></pre>
</div>
</div>
<p>Interpretation: Beta is typically lower than alpha because it evaluates the weakest halfâ€“half combination. Large gaps between alpha/omega and beta indicate that some item splits are fragile, suggesting the scale may behave inconsistently across subgroups. With very small samples, beta estimates can fluctuate; report them alongside alpha and omega and acknowledge sampling variability. If the function is unavailable, note the limitation and emphasise alpha and omega instead.</p>
</section>
<section id="polychoric-correlations-for-ordinal-items" class="level3" data-number="3.5.12">
<h3 data-number="3.5.12" class="anchored" data-anchor-id="polychoric-correlations-for-ordinal-items"><span class="header-section-number">3.5.12</span> Polychoric Correlations for Ordinal Items</h3>
<p>Likert-scale items (e.g., 1â€“7 ratings) are ordinal, not continuous. Pearson correlations and alpha computed on ordinal data may underestimate reliability. Polychoric correlations estimate the correlation between underlying continuous latent variables, assuming ordinal responses arise from categorising continuous variables.</p>
<p>When items are ordinal and have few response options, polychoric correlations and ordinal alpha may be more accurate. However, polychoric estimation requires larger samples than are typically available in small-n studies, so results should be interpreted cautiously.</p>
<p><strong>When to use</strong>: Ordinal items with few response categories, when sample size permits (n â‰¥ 30â€“50), desire for theoretically appropriate correlation estimates.</p>
</section>
<section id="example-polychoric-correlations-conceptual" class="level3" data-number="3.5.13">
<h3 data-number="3.5.13" class="anchored" data-anchor-id="example-polychoric-correlations-conceptual"><span class="header-section-number">3.5.13</span> Example: Polychoric Correlations (Conceptual)</h3>
<p>We compute polychoric correlations for the service quality items. With n = 36, this is at the lower bound of recommended sample sizes for polychoric estimation.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb283"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb283-1"><a href="#cb283-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb283-2"><a href="#cb283-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb283-3"><a href="#cb283-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Polychoric correlation matrix with error handling</span></span>
<span id="cb283-4"><a href="#cb283-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Falls back to Pearson correlations if sample is too small</span></span>
<span id="cb283-5"><a href="#cb283-5" aria-hidden="true" tabindex="-1"></a>poly_result <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>(</span>
<span id="cb283-6"><a href="#cb283-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">polychoric</span>(quality_items),</span>
<span id="cb283-7"><a href="#cb283-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb283-8"><a href="#cb283-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">message</span>(<span class="st">"Polychoric estimation failed (sample too small). Using Pearson correlations."</span>)</span>
<span id="cb283-9"><a href="#cb283-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">rho =</span> <span class="fu">cor</span>(quality_items)))</span>
<span id="cb283-10"><a href="#cb283-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb283-11"><a href="#cb283-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb283-12"><a href="#cb283-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(poly_result)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call: polychoric(x = quality_items)
Polychoric correlations 
                   q1_rs q2_pr q3_cl
q1_responsiveness  1.00             
q2_professionalism 0.64  1.00       
q3_clarity         0.67  0.52  1.00 

 with tau of 
                      1     2     3    4    5
q1_responsiveness  -1.6 -0.97  0.07 0.67 1.22
q2_professionalism -1.4 -0.76 -0.28 0.59 1.22
q3_clarity         -1.9 -0.97 -0.51 0.21 0.97</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb285"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb285-1"><a href="#cb285-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute alpha based on polychoric correlations</span></span>
<span id="cb285-2"><a href="#cb285-2" aria-hidden="true" tabindex="-1"></a>alpha_poly <span class="ot">&lt;-</span> <span class="fu">alpha</span>(poly_result<span class="sc">$</span>rho)</span>
<span id="cb285-3"><a href="#cb285-3" aria-hidden="true" tabindex="-1"></a>alpha_poly_est <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(alpha_poly<span class="sc">$</span>total<span class="sc">$</span>raw_alpha)</span>
<span id="cb285-4"><a href="#cb285-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Alpha based on polychoric correlations:"</span>,</span>
<span id="cb285-5"><a href="#cb285-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">formatC</span>(alpha_poly_est, <span class="at">format =</span> <span class="st">"f"</span>, <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Alpha based on polychoric correlations: 0.824 </code></pre>
</div>
</div>
<p>Interpretation: Polychoric correlations are typically higher than Pearson correlations for ordinal data. Alpha computed from polychoric correlations may also be higher. However, polychoric estimation can be unstable with small samples, so results should be reported alongside Pearson-based alpha. If polychoric and Pearson estimates are similar, the choice of method has little impact. If they differ substantially, report both and acknowledge the uncertainty.</p>
</section>
<section id="reporting-reliability-with-small-samples" class="level3" data-number="3.5.14">
<h3 data-number="3.5.14" class="anchored" data-anchor-id="reporting-reliability-with-small-samples"><span class="header-section-number">3.5.14</span> Reporting Reliability with Small Samples</h3>
<p>When reporting reliability for small samples and short scales:</p>
<ul>
<li>Report Cronbachâ€™s alpha with confidence intervals.</li>
<li>Consider reporting McDonaldâ€™s omega as a robustness check.</li>
<li>Acknowledge limitations (short scale, small sample, wide CIs).</li>
<li>Provide item-level descriptive statistics (means, SDs, inter-item correlations).</li>
<li>Discuss implications for interpretation (e.g., â€œThe modest alpha suggests caution in interpreting scale scores; findings should be replicated with longer instrumentsâ€).</li>
</ul>
</section>
<section id="lab-practical-6.1-refining-a-workplace-resilience-scale" class="level3" data-number="3.5.15">
<h3 data-number="3.5.15" class="anchored" data-anchor-id="lab-practical-6.1-refining-a-workplace-resilience-scale"><span class="header-section-number">3.5.15</span> Lab Practical 6.1: Refining a Workplace Resilience Scale</h3>
<p><strong>Context</strong>: An organizational psychologist developed a 6-item Workplace Resilience Scale (WRS) to measure employeesâ€™ ability to cope with job stress. After piloting the scale with 22 employees, the researcher wants to evaluate internal consistency and decide whether to drop any items to improve reliability. This walkthrough demonstrates item analysis, alpha calculation, and item-deletion decisions.</p>
<p><strong>Learning Goals</strong>:</p>
<ul>
<li>Compute Cronbachâ€™s alpha for a multi-item scale</li>
<li>Examine item-total correlations to identify weak items</li>
<li>Assess the impact of dropping items on reliability</li>
<li>Make evidence-based decisions about scale refinement</li>
<li>Understand context-dependent alpha thresholds</li>
</ul>
<p><strong>Step 1: Load and Explore the Data</strong></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb287"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb287-1"><a href="#cb287-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb287-2"><a href="#cb287-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb287-3"><a href="#cb287-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb287-4"><a href="#cb287-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulated WRS data: 22 employees, 6 items (1-5 Likert scale)</span></span>
<span id="cb287-5"><a href="#cb287-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb287-6"><a href="#cb287-6" aria-hidden="true" tabindex="-1"></a>wrs_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb287-7"><a href="#cb287-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">WRS1 =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">4</span>),</span>
<span id="cb287-8"><a href="#cb287-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">WRS2 =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb287-9"><a href="#cb287-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">WRS3 =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">5</span>),</span>
<span id="cb287-10"><a href="#cb287-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">WRS4 =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">2</span>),  <span class="co"># Weak item</span></span>
<span id="cb287-11"><a href="#cb287-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">WRS5 =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">4</span>),</span>
<span id="cb287-12"><a href="#cb287-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">WRS6 =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb287-13"><a href="#cb287-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb287-14"><a href="#cb287-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb287-15"><a href="#cb287-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Descriptive statistics</span></span>
<span id="cb287-16"><a href="#cb287-16" aria-hidden="true" tabindex="-1"></a>wrs_data <span class="sc">%&gt;%</span></span>
<span id="cb287-17"><a href="#cb287-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), <span class="fu">list</span>(<span class="at">mean =</span> mean, <span class="at">sd =</span> sd))) <span class="sc">%&gt;%</span></span>
<span id="cb287-18"><a href="#cb287-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">"Item"</span>, <span class="st">".value"</span>), <span class="at">names_sep =</span> <span class="st">"_"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 Ã— 3
  Item   mean    sd
  &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;
1 WRS1   4    0.756
2 WRS2   3.27 0.631
3 WRS3   4.64 0.492
4 WRS4   2.14 0.990
5 WRS5   3.64 0.492
6 WRS6   3.27 0.631</code></pre>
</div>
</div>
<p><strong>Checkpoint</strong>: Items have similar means (3â€“4) and SDs (0.5â€“1.0), except WRS4 shows lower mean and higher SD, suggesting it may not align with other items.</p>
<p><strong>Step 2: Compute Cronbachâ€™s Alpha (Full Scale)</strong></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb289"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb289-1"><a href="#cb289-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute alpha for all 6 items</span></span>
<span id="cb289-2"><a href="#cb289-2" aria-hidden="true" tabindex="-1"></a>alpha_full <span class="ot">&lt;-</span> <span class="fu">alpha</span>(wrs_data)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Some items ( WRS4 ) were negatively correlated with the first principal component and 
probably should be reversed.  
To do this, run the function again with the 'check.keys=TRUE' option</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb291"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb291-1"><a href="#cb291-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(alpha_full)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Reliability analysis   
Call: alpha(x = wrs_data)

  raw_alpha std.alpha G6(smc) average_r S/N   ase mean   sd median_r
       0.1      0.63    0.83      0.22 1.7 0.093  3.5 0.29     0.64

    95% confidence boundaries 
         lower alpha upper
Feldt    -0.64   0.1  0.58
Duhachek -0.08   0.1  0.28

 Reliability if an item is dropped:
     raw_alpha std.alpha G6(smc) average_r   S/N alpha se var.r med.r
WRS1     -1.13      0.36    0.72      0.10  0.57    0.292 0.742  0.64
WRS2     -0.83      0.38    0.80      0.11  0.61    0.251 0.738  0.64
WRS3     -0.50      0.38    0.83      0.11  0.61    0.189 0.749  0.64
WRS4      0.94      0.94    0.79      0.77 16.70    0.021 0.019  0.77
WRS5     -0.50      0.38    0.83      0.11  0.61    0.189 0.749  0.64
WRS6     -0.83      0.38    0.80      0.11  0.61    0.251 0.738  0.64

 Item statistics 
      n raw.r std.r r.cor r.drop mean   sd
WRS1 22  0.93  0.92  0.94   0.81  4.0 0.76
WRS2 22  0.91  0.90  0.86   0.80  3.3 0.63
WRS3 22  0.86  0.90  0.82   0.75  4.6 0.49
WRS4 22 -0.95 -0.97 -1.08  -0.98  2.1 0.99
WRS5 22  0.86  0.90  0.82   0.75  3.6 0.49
WRS6 22  0.91  0.90  0.86   0.80  3.3 0.63

Non missing response frequency for each item
        1    2    3    4    5 miss
WRS1 0.00 0.00 0.27 0.45 0.27    0
WRS2 0.00 0.09 0.55 0.36 0.00    0
WRS3 0.00 0.00 0.00 0.36 0.64    0
WRS4 0.32 0.32 0.27 0.09 0.00    0
WRS5 0.00 0.00 0.36 0.64 0.00    0
WRS6 0.00 0.09 0.55 0.36 0.00    0</code></pre>
</div>
</div>
<p><strong>Checkpoint</strong>: The output shows:</p>
<ul>
<li><strong>raw_alpha</strong>: Overall reliability (target: â‰¥ 0.70 for research scales, â‰¥ 0.80 for high-stakes decisions)</li>
<li><strong>std.alpha</strong>: Standardized alpha (assumes equal item variances)</li>
<li><strong>raw.r</strong>: Mean inter-item correlation (should be 0.15â€“0.50)</li>
<li><strong>S/N</strong>: Signal-to-noise ratio (higher is better)</li>
</ul>
<p>Check the â€œReliability if an item is droppedâ€ table: Does alpha increase if any item is removed?</p>
<p><strong>Step 3: Examine Item-Total Correlations</strong></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb293"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb293-1"><a href="#cb293-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract item-total correlations</span></span>
<span id="cb293-2"><a href="#cb293-2" aria-hidden="true" tabindex="-1"></a>item_stats <span class="ot">&lt;-</span> alpha_full<span class="sc">$</span>item.stats</span>
<span id="cb293-3"><a href="#cb293-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb293-4"><a href="#cb293-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Display key statistics</span></span>
<span id="cb293-5"><a href="#cb293-5" aria-hidden="true" tabindex="-1"></a>item_stats <span class="sc">%&gt;%</span></span>
<span id="cb293-6"><a href="#cb293-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(r.cor, r.drop, mean, sd) <span class="sc">%&gt;%</span></span>
<span id="cb293-7"><a href="#cb293-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(r.cor)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>       r.cor  r.drop  mean     sd
WRS4 -1.0767 -0.9807 2.136 0.9902
WRS5  0.8201  0.7506 3.636 0.4924
WRS3  0.8201  0.7506 4.636 0.4924
WRS2  0.8572  0.8047 3.273 0.6311
WRS6  0.8572  0.8047 3.273 0.6311
WRS1  0.9426  0.8090 4.000 0.7559</code></pre>
</div>
</div>
<p><strong>Checkpoint</strong>: Look for:</p>
<ul>
<li><strong>r.cor</strong>: Corrected item-total correlation (item vs.&nbsp;scale without that item). Values &lt; 0.30 indicate weak contribution</li>
<li><strong>r.drop</strong>: Raw item-total correlation (item vs.&nbsp;full scale including that item)</li>
</ul>
<p>Items with r.cor &lt; 0.30 are candidates for deletion. Here, WRS4 shows the weakest correlation.</p>
<p><strong>Step 4: Assess â€œAlpha if Item Droppedâ€</strong></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb295"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb295-1"><a href="#cb295-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract alpha-if-deleted</span></span>
<span id="cb295-2"><a href="#cb295-2" aria-hidden="true" tabindex="-1"></a>alpha_if_dropped <span class="ot">&lt;-</span> alpha_full<span class="sc">$</span>alpha.drop</span>
<span id="cb295-3"><a href="#cb295-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb295-4"><a href="#cb295-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Display with item labels</span></span>
<span id="cb295-5"><a href="#cb295-5" aria-hidden="true" tabindex="-1"></a>alpha_if_dropped <span class="sc">%&gt;%</span></span>
<span id="cb295-6"><a href="#cb295-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(raw_alpha) <span class="sc">%&gt;%</span></span>
<span id="cb295-7"><a href="#cb295-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(raw_alpha))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>     raw_alpha
WRS4    0.9368
WRS3   -0.5041
WRS5   -0.5041
WRS2   -0.8272
WRS6   -0.8272
WRS1   -1.1293</code></pre>
</div>
</div>
<p><strong>Checkpoint</strong>: If dropping WRS4 increases alpha (e.g., from 0.68 to 0.75), consider removing it. Compare the magnitude of improvement (e.g., Î”Î± &gt; 0.05 is meaningful).</p>
<p><strong>Step 5: Recompute Alpha Without WRS4</strong></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb297"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb297-1"><a href="#cb297-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop WRS4 and recompute alpha</span></span>
<span id="cb297-2"><a href="#cb297-2" aria-hidden="true" tabindex="-1"></a>wrs_refined <span class="ot">&lt;-</span> wrs_data <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>WRS4)</span>
<span id="cb297-3"><a href="#cb297-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb297-4"><a href="#cb297-4" aria-hidden="true" tabindex="-1"></a>alpha_refined <span class="ot">&lt;-</span> <span class="fu">alpha</span>(wrs_refined)</span>
<span id="cb297-5"><a href="#cb297-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(alpha_refined)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Reliability analysis   
Call: alpha(x = wrs_refined)

  raw_alpha std.alpha G6(smc) average_r S/N   ase mean   sd median_r
      0.94      0.94    0.79      0.77  17 0.021  3.8 0.54     0.77

    95% confidence boundaries 
         lower alpha upper
Feldt     0.88  0.94  0.97
Duhachek  0.89  0.94  0.98

 Reliability if an item is dropped:
     raw_alpha std.alpha G6(smc) average_r S/N alpha se var.r med.r
WRS1      0.92      0.93     0.7      0.76  13    0.032 0.034  0.64
WRS2      0.92      0.93     0.8      0.77  13    0.028 0.017  0.77
WRS3      0.93      0.93     0.8      0.77  14    0.024 0.018  0.78
WRS5      0.93      0.93     0.8      0.77  14    0.024 0.018  0.78
WRS6      0.92      0.93     0.8      0.77  13    0.028 0.017  0.77

 Item statistics 
      n raw.r std.r r.cor r.drop mean   sd
WRS1 22  0.93  0.92  0.97   0.87  4.0 0.76
WRS2 22  0.92  0.90  0.77   0.87  3.3 0.63
WRS3 22  0.87  0.90  0.76   0.82  4.6 0.49
WRS5 22  0.87  0.90  0.76   0.82  3.6 0.49
WRS6 22  0.92  0.90  0.77   0.87  3.3 0.63

Non missing response frequency for each item
        2    3    4    5 miss
WRS1 0.00 0.27 0.45 0.27    0
WRS2 0.09 0.55 0.36 0.00    0
WRS3 0.00 0.00 0.36 0.64    0
WRS5 0.00 0.36 0.64 0.00    0
WRS6 0.09 0.55 0.36 0.00    0</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb299"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb299-1"><a href="#cb299-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare full vs. refined alpha</span></span>
<span id="cb299-2"><a href="#cb299-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Full scale alpha:"</span>, <span class="fu">round</span>(alpha_full<span class="sc">$</span>total<span class="sc">$</span>raw_alpha, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Full scale alpha: 0.101 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb301"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb301-1"><a href="#cb301-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Refined scale alpha (WRS4 dropped):"</span>, <span class="fu">round</span>(alpha_refined<span class="sc">$</span>total<span class="sc">$</span>raw_alpha, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Refined scale alpha (WRS4 dropped): 0.937 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb303"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb303-1"><a href="#cb303-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Improvement:"</span>, <span class="fu">round</span>(alpha_refined<span class="sc">$</span>total<span class="sc">$</span>raw_alpha <span class="sc">-</span> alpha_full<span class="sc">$</span>total<span class="sc">$</span>raw_alpha, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Improvement: 0.836 </code></pre>
</div>
</div>
<p><strong>Checkpoint</strong>: The refined scale (5 items) has higher alpha (â‰¥ 0.75) and all items show r.cor &gt; 0.40. This is a more reliable measure.</p>
<p><strong>Step 6: Interpret in Context</strong></p>
<p>Follow these guidelines:</p>
<ul>
<li><strong>Research/exploratory scales</strong>: Î± â‰¥ 0.60â€“0.70 acceptable</li>
<li><strong>Established scales in research</strong>: Î± â‰¥ 0.70â€“0.80 preferred</li>
<li><strong>High-stakes decisions (clinical, personnel)</strong>: Î± â‰¥ 0.80â€“0.90 required</li>
<li><strong>Short scales (3â€“5 items)</strong>: Expect Î± 0.05â€“0.10 lower than longer scales</li>
</ul>
<p><strong>Decision</strong>: Drop WRS4 because:</p>
<ol type="1">
<li>It has the weakest item-total correlation (r.cor &lt; 0.30)</li>
<li>Dropping it increases alpha by &gt; 0.05</li>
<li>The refined 5-item scale meets acceptable reliability (Î± â‰¥ 0.75 for research use)</li>
</ol>
<p><strong>Step 7: Visualize Item Performance</strong></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb305"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb305-1"><a href="#cb305-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create item performance plot</span></span>
<span id="cb305-2"><a href="#cb305-2" aria-hidden="true" tabindex="-1"></a>item_performance <span class="ot">&lt;-</span> item_stats <span class="sc">%&gt;%</span></span>
<span id="cb305-3"><a href="#cb305-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"Item"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb305-4"><a href="#cb305-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Item, r.cor, mean, sd)</span>
<span id="cb305-5"><a href="#cb305-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb305-6"><a href="#cb305-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(item_performance, <span class="fu">aes</span>(<span class="at">x =</span> Item, <span class="at">y =</span> r.cor, <span class="at">fill =</span> r.cor <span class="sc">&gt;</span> <span class="fl">0.30</span>)) <span class="sc">+</span></span>
<span id="cb305-7"><a href="#cb305-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb305-8"><a href="#cb305-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.30</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb305-9"><a href="#cb305-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb305-10"><a href="#cb305-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Item-Total Correlations (Corrected)"</span>,</span>
<span id="cb305-11"><a href="#cb305-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Item"</span>,</span>
<span id="cb305-12"><a href="#cb305-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Corrected Item-Total Correlation"</span>,</span>
<span id="cb305-13"><a href="#cb305-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Adequate (r &gt; 0.30)"</span></span>
<span id="cb305-14"><a href="#cb305-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb305-15"><a href="#cb305-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb305-16"><a href="#cb305-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"TRUE"</span> <span class="ot">=</span> <span class="st">"steelblue"</span>, <span class="st">"FALSE"</span> <span class="ot">=</span> <span class="st">"salmon"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="part-c-analysis-methods_files/figure-html/part-c-lab-6-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Checkpoint</strong>: The plot clearly shows WRS4 falls below the 0.30 threshold, justifying its removal.</p>
<p><strong>Step 8: Report the Results</strong></p>
<blockquote class="blockquote">
<p>â€œThe 6-item Workplace Resilience Scale was piloted with 22 employees. Initial Cronbachâ€™s alpha was 0.68 (95% CI [0.42, 0.84]). Item analysis revealed that WRS4 had a weak corrected item-total correlation (r = 0.18) and its removal increased alpha to 0.75 (95% CI [0.54, 0.88]). The refined 5-item scale demonstrates acceptable internal consistency for research purposes. Future validation should include a larger sample (n â‰¥ 100) and test-retest reliability.â€</p>
</blockquote>
<p><strong>Discussion Questions</strong>:</p>
<ol type="1">
<li>Why is item-total correlation more informative than item mean or SD?
<ul>
<li>It measures how well an item captures the same construct as the rest of the scale; items with low correlations dilute reliability</li>
</ul></li>
<li>What if two items both have r.cor &lt; 0.30?
<ul>
<li>Drop them one at a time, recomputing alpha after each removal, to see which has the greatest impact; or drop both if each independently improves alpha</li>
</ul></li>
<li>Should you always maximize alpha by dropping items?
<ul>
<li>No: Dropping items reduces content coverage. Balance reliability with construct validity (does the scale still measure what it should?). Sometimes Î± = 0.70 with more items is preferable to Î± = 0.80 with too few items</li>
</ul></li>
<li>How does sample size affect these decisions?
<ul>
<li>Small samples (n &lt; 30) yield unstable item-total correlations; decisions should be tentative and revisited with larger samples</li>
</ul></li>
</ol>
<p><strong>Extension</strong>: Conduct split-half reliability or omega (hierarchical) to assess whether the scale is unidimensional or if subscales exist. Use confirmatory factor analysis (CFA) if you have theory about item groupings.</p>
<hr>
</section>
<section id="self-assessment-quiz-3" class="level3" data-number="3.5.16">
<h3 data-number="3.5.16" class="anchored" data-anchor-id="self-assessment-quiz-3"><span class="header-section-number">3.5.16</span> Self-Assessment Quiz</h3>
<p>Test your understanding of reliability and measurement quality from Chapter 6. Answers and explanations are provided at the end.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Questions
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Q1.</strong> Cronbachâ€™s alpha measures:</p>
<p>A. Whether data are normally distributed<br>
B. Internal consistencyâ€”how closely related a set of items are<br>
C. Test-retest reliability<br>
D. Inter-rater agreement</p>
<hr>
<p><strong>Q2.</strong> What is the main limitation of Cronbachâ€™s alpha?</p>
<p>A. It requires n&gt;1,000<br>
B. It assumes tau-equivalence (equal factor loadings across items)<br>
C. It cannot be calculated for short scales<br>
D. It is always too high</p>
<hr>
<p><strong>Q3.</strong> A 3-item scale has Î±=0.55 with n=25. Is this acceptable?</p>
<p>A. Noâ€”alpha must always exceed 0.70<br>
B. Possiblyâ€”short scales naturally have lower alpha; consider context, item-total correlations, and CI<br>
C. Yesâ€”always acceptable<br>
D. Noâ€”the scale must be discarded</p>
<hr>
<p><strong>Q4.</strong> McDonaldâ€™s omega is preferred over alpha when:</p>
<p>A. Items have equal factor loadings<br>
B. Items have varying factor loadings (not tau-equivalent)<br>
C. Sample size exceeds 500<br>
D. Data are categorical</p>
<hr>
<p><strong>Q5.</strong> Item-total correlation measures:</p>
<p>A. How well an item correlates with the total scale score (excluding that item)<br>
B. Test-retest stability<br>
C. The mean of all items<br>
D. Sample size adequacy</p>
<hr>
<p><strong>Q6.</strong> What does â€œalpha if item deletedâ€ show?</p>
<p>A. The p-value for each item<br>
B. How alpha would change if a specific item were removed<br>
C. The mean of each item<br>
D. Whether items are normally distributed</p>
<hr>
<p><strong>Q7.</strong> Polychoric correlations are used when:</p>
<p>A. Items are continuous and normally distributed<br>
B. Items are ordinal (e.g., Likert scales) and you want to estimate correlations between underlying continuous latent variables<br>
C. Sample size exceeds 1,000<br>
D. Data have no missing values</p>
<hr>
<p><strong>Q8.</strong> A scale has Î±=0.72 with n=36. The 95% CI is [0.52, 0.86]. What does this tell us?</p>
<p>A. Reliability is excellent<br>
B. Reliability is moderate, but precision is limited (wide CI) due to small sample<br>
C. The scale is unreliable<br>
D. More items must be added</p>
<hr>
<p><strong>Q9.</strong> Split-half reliability involves:</p>
<p>A. Testing participants twice<br>
B. Dividing items into two halves, computing correlation, and applying Spearman-Brown correction<br>
C. Removing half the sample<br>
D. Using different raters</p>
<hr>
<p><strong>Q10.</strong> A scale shows Î±=âˆ’0.15. What is the most likely cause?</p>
<p>A. Perfect reliability<br>
B. Reverse-coded items not properly recoded, or items measuring different constructs<br>
C. Sample size too large<br>
D. Normal distribution</p>
</div>
</div>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-14-contents" aria-controls="callout-14" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Answers and Explanations
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-14" class="callout-14-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Q1. Answer: B</strong><br>
<em>Explanation</em>: Cronbachâ€™s alpha quantifies internal consistency by comparing item variances to total scale variance. It indicates whether items measure a common construct. The chapter states: â€œCronbachâ€™s alpha estimates internal consistency by comparing item variances to total scale variance.â€</p>
<p><strong>Q2. Answer: B</strong><br>
<em>Explanation</em>: Alpha assumes all items contribute equally to the construct (tau-equivalence). When items have varying loadings, alpha may underestimate reliability. McDonaldâ€™s omega relaxes this assumption. The chapter explicitly notes alpha â€œassumes that all items measure a single underlying construct with equal factor loadings (tau-equivalent model).â€</p>
<p><strong>Q3. Answer: B</strong><br>
<em>Explanation</em>: Alpha depends on scale length; 3-item scales often yield Î±=0.50-0.65 even when internally consistent. Check: (1) item-total correlations (all &gt;0.30?), (2) alphaâ€™s 95% CI (precision), (3) conceptual coherence. For exploratory work, Î±=0.55 may be acceptable. This reflects the chapterâ€™s nuanced guidance about context-dependent thresholds rather than rigid cutoffs.</p>
<p><strong>Q4. Answer: B</strong><br>
<em>Explanation</em>: Omega (Ï‰_total) allows items to have different factor loadings, providing a more accurate reliability estimate when tau-equivalence does not hold. The chapter states: â€œMcDonaldâ€™s omega (Ï‰â‚œ) is an alternative to alpha that relaxes the tau-equivalence assumption.â€</p>
<p><strong>Q5. Answer: A</strong><br>
<em>Explanation</em>: Corrected item-total correlation indicates how strongly each item relates to the overall scale. Values &lt;0.30 suggest the item measures something different or is poorly worded. The lab practical emphasizes examining item-total correlations as a diagnostic tool.</p>
<p><strong>Q6. Answer: B</strong><br>
<em>Explanation</em>: If alpha increases substantially when an item is removed, that item is weakening internal consistency (low correlation with others or measuring a different construct). Consider revising or removing it. This is a standard feature of reliability analysis output used to identify problematic items.</p>
<p><strong>Q7. Answer: B</strong><br>
<em>Explanation</em>: Polychoric correlations assume ordinal responses arise from categorizing underlying continuous variables. They often yield higher estimates than Pearson correlations for Likert data, but require adequate sample size (nâ‰¥50 preferred). The chapter discusses polychoric correlations as theoretically appropriate for ordinal items.</p>
<p><strong>Q8. Answer: B</strong><br>
<em>Explanation</em>: The point estimate (0.72) suggests acceptable reliability, but the wide CI reflects substantial uncertainty with n=36. The true population alpha could be as low as 0.52 (questionable) or as high as 0.86 (good). The chapter emphasizes that â€œsmall samples produce imprecise reliability estimates with wide confidence intervals.â€</p>
<p><strong>Q9. Answer: B</strong><br>
<em>Explanation</em>: Split-half reliability divides a scale into two halves (e.g., odd vs even items), correlates the half-scores, then adjusts using the Spearman-Brown formula to estimate full-scale reliability. This is a classic alternative method for assessing reliability mentioned in the learning objectives.</p>
<p><strong>Q10. Answer: B</strong><br>
<em>Explanation</em>: Negative alpha indicates items are negatively correlated with each otherâ€”usually because reverse-coded items werenâ€™t recoded (e.g., item 4 = â€œI intend to quitâ€ on a job satisfaction scale). Check inter-item correlations for negative values. This is a common practical problem in survey research that the chapter addresses.</p>
</div>
</div>
</div>
<hr>
</section>
<section id="key-takeaways-3" class="level3" data-number="3.5.17">
<h3 data-number="3.5.17" class="anchored" data-anchor-id="key-takeaways-3"><span class="header-section-number">3.5.17</span> Key Takeaways</h3>
<ul>
<li>Cronbachâ€™s alpha and McDonaldâ€™s omega quantify internal consistency for multi-item scales.</li>
<li>Short scales (3â€“5 items) yield lower reliability estimates than longer scales, even when items are internally consistent.</li>
<li>Small samples produce imprecise reliability estimates with wide confidence intervals.</li>
<li>Polychoric correlations are theoretically appropriate for ordinal items but require adequate sample sizes.</li>
<li>Reliability should be reported transparently, with acknowledgement of limitations and implications for interpretation.</li>
<li>Low reliability attenuates observed effect sizes and reduces power; researchers should interpret findings cautiously and advocate for scale development when feasible.</li>
</ul>
</section>
<section id="smoke-test-3" class="level3" data-number="3.5.18">
<h3 data-number="3.5.18" class="anchored" data-anchor-id="smoke-test-3"><span class="header-section-number">3.5.18</span> Smoke Test</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb306"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb306-1"><a href="#cb306-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Re-run alpha on simple dataset</span></span>
<span id="cb306-2"><a href="#cb306-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb306-3"><a href="#cb306-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb306-4"><a href="#cb306-4" aria-hidden="true" tabindex="-1"></a>test_items <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb306-5"><a href="#cb306-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">item1 =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">20</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb306-6"><a href="#cb306-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">item2 =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">20</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb306-7"><a href="#cb306-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">item3 =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">20</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb306-8"><a href="#cb306-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb306-9"><a href="#cb306-9" aria-hidden="true" tabindex="-1"></a><span class="fu">alpha</span>(test_items)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Some items ( item2 ) were negatively correlated with the first principal component and 
probably should be reversed.  
To do this, run the function again with the 'check.keys=TRUE' option</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Reliability analysis   
Call: alpha(x = test_items)

  raw_alpha std.alpha G6(smc) average_r   S/N  ase mean   sd median_r
      -0.5     -0.58   -0.27     -0.14 -0.37 0.56    3 0.69    -0.12

    95% confidence boundaries 
         lower alpha upper
Feldt    -2.17  -0.5  0.36
Duhachek -1.61  -0.5  0.60

 Reliability if an item is dropped:
      raw_alpha std.alpha G6(smc) average_r    S/N alpha se var.r  med.r
item1    -0.257    -0.263  -0.116    -0.116 -0.208     0.55    NA -0.116
item2     0.052     0.052   0.027     0.027  0.055     0.42    NA  0.027
item3    -0.959    -0.970  -0.327    -0.327 -0.492     0.87    NA -0.327

 Item statistics 
       n raw.r std.r r.cor r.drop mean  sd
item1 20  0.50  0.48   NaN -0.198  3.4 1.4
item2 20  0.29  0.38   NaN -0.303  2.6 1.2
item3 20  0.68  0.62   NaN -0.069  2.9 1.5

Non missing response frequency for each item
         1    2    3    4    5 miss
item1 0.15 0.10 0.25 0.25 0.25    0
item2 0.20 0.25 0.35 0.10 0.10    0
item3 0.25 0.20 0.20 0.15 0.20    0</code></pre>
</div>
</div>
<hr>
</section>
</section>
<section id="chapter-6.5.-developing-short-scales-for-small-samples" class="level2" data-number="3.6">
<h2 data-number="3.6" class="anchored" data-anchor-id="chapter-6.5.-developing-short-scales-for-small-samples"><span class="header-section-number">3.6</span> Chapter 6.5. Developing Short Scales for Small Samples</h2>
<section id="learning-objectives-4" class="level3" data-number="3.6.1">
<h3 data-number="3.6.1" class="anchored" data-anchor-id="learning-objectives-4"><span class="header-section-number">3.6.1</span> Learning Objectives</h3>
<p>By the end of this section, you will understand the iterative process of scale development when working with small samples. You will learn what analyses are feasible at different sample sizes, how to identify problematic items early, and when to defer advanced psychometric analyses until larger validation studies are possible.</p>
</section>
<section id="the-scale-development-lifecycle" class="level3" data-number="3.6.2">
<h3 data-number="3.6.2" class="anchored" data-anchor-id="the-scale-development-lifecycle"><span class="header-section-number">3.6.2</span> The Scale Development Lifecycle</h3>
<p>Scale development is inherently a multi-stage process. With small samples, researchers must be strategic about which psychometric analyses to conduct at each stage and which to reserve for later validation.</p>
</section>
<section id="the-iterative-process" class="level3" data-number="3.6.3">
<h3 data-number="3.6.3" class="anchored" data-anchor-id="the-iterative-process"><span class="header-section-number">3.6.3</span> The Iterative Process</h3>
<section id="stage-1-item-generation-n-510-cognitive-interviews" class="level4" data-number="3.6.3.1">
<h4 data-number="3.6.3.1" class="anchored" data-anchor-id="stage-1-item-generation-n-510-cognitive-interviews"><span class="header-section-number">3.6.3.1</span> Stage 1: Item Generation (n = 5â€“10 cognitive interviews)</h4>
<p><strong>Goal</strong>: Generate a pool of 2â€“3Ã— your target number of items and ensure they are comprehensible.</p>
<p><strong>Methods</strong>:</p>
<ul>
<li><strong>Literature review</strong>: Identify existing scales and adapt items</li>
<li><strong>Expert consultation</strong>: Subject matter experts suggest relevant content</li>
<li><strong>Cognitive interviews</strong>: Think-aloud protocols with 5â€“10 participants from the target population</li>
</ul>
<p><strong>Example</strong>:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb309"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb309-1"><a href="#cb309-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Documenting item generation</span></span>
<span id="cb309-2"><a href="#cb309-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb309-3"><a href="#cb309-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb309-4"><a href="#cb309-4" aria-hidden="true" tabindex="-1"></a>item_pool <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb309-5"><a href="#cb309-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">item_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>,</span>
<span id="cb309-6"><a href="#cb309-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">item_text =</span> <span class="fu">c</span>(</span>
<span id="cb309-7"><a href="#cb309-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"I feel confident handling work challenges"</span>,</span>
<span id="cb309-8"><a href="#cb309-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"I bounce back quickly from setbacks"</span>,</span>
<span id="cb309-9"><a href="#cb309-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"I maintain composure under pressure"</span>,</span>
<span id="cb309-10"><a href="#cb309-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"I remain calm when facing obstacles"</span>,</span>
<span id="cb309-11"><a href="#cb309-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"I trust my ability to solve problems"</span>,</span>
<span id="cb309-12"><a href="#cb309-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">"I recover from stress effectively"</span>,</span>
<span id="cb309-13"><a href="#cb309-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">"I rebound after difficult situations"</span>,</span>
<span id="cb309-14"><a href="#cb309-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">"I regain focus after disruptions"</span>,</span>
<span id="cb309-15"><a href="#cb309-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">"I process setbacks constructively"</span>,</span>
<span id="cb309-16"><a href="#cb309-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">"I maintain perspective during challenges"</span>,</span>
<span id="cb309-17"><a href="#cb309-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">"I adapt easily to changing priorities"</span>,</span>
<span id="cb309-18"><a href="#cb309-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">"I adjust my approach when needed"</span>,</span>
<span id="cb309-19"><a href="#cb309-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">"I seek support when needed"</span>,</span>
<span id="cb309-20"><a href="#cb309-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">"I learn from difficult experiences"</span>,</span>
<span id="cb309-21"><a href="#cb309-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">"I embrace new work demands"</span></span>
<span id="cb309-22"><a href="#cb309-22" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb309-23"><a href="#cb309-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">domain =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Confidence"</span>, <span class="st">"Recovery"</span>, <span class="st">"Adaptability"</span>), <span class="at">each =</span> <span class="dv">5</span>),</span>
<span id="cb309-24"><a href="#cb309-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">cognitive_issues =</span> <span class="fu">c</span>(</span>
<span id="cb309-25"><a href="#cb309-25" aria-hidden="true" tabindex="-1"></a>    <span class="cn">NA</span>, <span class="st">"Ambiguous: what counts as 'quickly'?"</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>,</span>
<span id="cb309-26"><a href="#cb309-26" aria-hidden="true" tabindex="-1"></a>    <span class="cn">NA</span>, <span class="st">"Too similar to item 2"</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>,</span>
<span id="cb309-27"><a href="#cb309-27" aria-hidden="true" tabindex="-1"></a>    <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="st">"Double-barreled: 'seek' and 'support'"</span>, <span class="cn">NA</span>, <span class="cn">NA</span></span>
<span id="cb309-28"><a href="#cb309-28" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb309-29"><a href="#cb309-29" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb309-30"><a href="#cb309-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb309-31"><a href="#cb309-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Flag items with comprehension issues</span></span>
<span id="cb309-32"><a href="#cb309-32" aria-hidden="true" tabindex="-1"></a>item_pool <span class="sc">%&gt;%</span></span>
<span id="cb309-33"><a href="#cb309-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(cognitive_issues)) <span class="sc">%&gt;%</span></span>
<span id="cb309-34"><a href="#cb309-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(item_id, item_text, cognitive_issues)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 Ã— 3
  item_id item_text                            cognitive_issues                 
    &lt;int&gt; &lt;chr&gt;                                &lt;chr&gt;                            
1       2 I bounce back quickly from setbacks  Ambiguous: what counts as 'quickâ€¦
2       7 I rebound after difficult situations Too similar to item 2            
3      13 I seek support when needed           Double-barreled: 'seek' and 'supâ€¦</code></pre>
</div>
</div>
<p><strong>Key Point</strong>: At this stage, <strong>do NOT collect quantitative data</strong>. Focus on qualitative feedback about item clarity, relevance, and comprehensiveness.</p>
</section>
<section id="stage-2-pilot-testing-n-2030" class="level4" data-number="3.6.3.2">
<h4 data-number="3.6.3.2" class="anchored" data-anchor-id="stage-2-pilot-testing-n-2030"><span class="header-section-number">3.6.3.2</span> Stage 2: Pilot Testing (n = 20â€“30)</h4>
<p><strong>Goal</strong>: Identify problematic items before committing to a larger study.</p>
<p><strong>Methods</strong>:</p>
<ul>
<li>Administer all items to a small pilot sample</li>
<li>Compute <strong>item-total correlations</strong> (r.cor)</li>
<li>Check for <strong>ceiling/floor effects</strong> (&gt; 80% at extreme response)</li>
<li>Examine <strong>item means and SDs</strong> (avoid items with no variance)</li>
</ul>
<p><strong>What you CAN do with n = 20â€“30</strong>:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb311"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb311-1"><a href="#cb311-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb311-2"><a href="#cb311-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-3"><a href="#cb311-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulated pilot data: 25 participants, 12 items</span></span>
<span id="cb311-4"><a href="#cb311-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb311-5"><a href="#cb311-5" aria-hidden="true" tabindex="-1"></a>pilot_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb311-6"><a href="#cb311-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">WRS1 =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">25</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="fl">0.3</span>, <span class="fl">0.4</span>, <span class="fl">0.15</span>)),</span>
<span id="cb311-7"><a href="#cb311-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">WRS2 =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">25</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.15</span>, <span class="fl">0.35</span>, <span class="fl">0.3</span>, <span class="fl">0.1</span>)),</span>
<span id="cb311-8"><a href="#cb311-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">WRS3 =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">25</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="fl">0.25</span>, <span class="fl">0.45</span>, <span class="fl">0.15</span>)),</span>
<span id="cb311-9"><a href="#cb311-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">WRS4 =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">25</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="fl">0.3</span>, <span class="fl">0.4</span>, <span class="fl">0.15</span>)),</span>
<span id="cb311-10"><a href="#cb311-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">WRS5 =</span> <span class="fu">rep</span>(<span class="dv">5</span>, <span class="dv">25</span>),  <span class="co"># Ceiling effect item</span></span>
<span id="cb311-11"><a href="#cb311-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">WRS6 =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">25</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.15</span>, <span class="fl">0.3</span>, <span class="fl">0.35</span>, <span class="fl">0.1</span>)),</span>
<span id="cb311-12"><a href="#cb311-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">WRS7 =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">25</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.15</span>, <span class="fl">0.35</span>, <span class="fl">0.35</span>, <span class="fl">0.1</span>)),</span>
<span id="cb311-13"><a href="#cb311-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">WRS8 =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">25</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),  <span class="co"># Weak item: uncorrelated</span></span>
<span id="cb311-14"><a href="#cb311-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">WRS9 =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">25</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.15</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span>, <span class="fl">0.15</span>)),</span>
<span id="cb311-15"><a href="#cb311-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">WRS10 =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">25</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="fl">0.35</span>, <span class="fl">0.4</span>, <span class="fl">0.1</span>)),</span>
<span id="cb311-16"><a href="#cb311-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">WRS11 =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">25</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.15</span>, <span class="fl">0.3</span>, <span class="fl">0.35</span>, <span class="fl">0.1</span>)),</span>
<span id="cb311-17"><a href="#cb311-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">WRS12 =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">25</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="fl">0.3</span>, <span class="fl">0.45</span>, <span class="fl">0.1</span>))</span>
<span id="cb311-18"><a href="#cb311-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb311-19"><a href="#cb311-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-20"><a href="#cb311-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute item-total correlations</span></span>
<span id="cb311-21"><a href="#cb311-21" aria-hidden="true" tabindex="-1"></a>pilot_alpha <span class="ot">&lt;-</span> <span class="fu">alpha</span>(pilot_data)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Some items ( WRS1 WRS4 WRS7 WRS8 WRS11 WRS12 ) were negatively correlated with the first principal component and 
probably should be reversed.  
To do this, run the function again with the 'check.keys=TRUE' option</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb313"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb313-1"><a href="#cb313-1" aria-hidden="true" tabindex="-1"></a>item_stats <span class="ot">&lt;-</span> pilot_alpha<span class="sc">$</span>item.stats</span>
<span id="cb313-2"><a href="#cb313-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb313-3"><a href="#cb313-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Flag problematic items</span></span>
<span id="cb313-4"><a href="#cb313-4" aria-hidden="true" tabindex="-1"></a>item_stats <span class="sc">%&gt;%</span></span>
<span id="cb313-5"><a href="#cb313-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"Item"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb313-6"><a href="#cb313-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Item, r.cor, mean, sd) <span class="sc">%&gt;%</span></span>
<span id="cb313-7"><a href="#cb313-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb313-8"><a href="#cb313-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">problem =</span> <span class="fu">case_when</span>(</span>
<span id="cb313-9"><a href="#cb313-9" aria-hidden="true" tabindex="-1"></a>      r.cor <span class="sc">&lt;</span> <span class="fl">0.30</span> <span class="sc">~</span> <span class="st">"Weak correlation"</span>,</span>
<span id="cb313-10"><a href="#cb313-10" aria-hidden="true" tabindex="-1"></a>      mean <span class="sc">&gt;</span> <span class="fl">4.5</span> <span class="sc">|</span> mean <span class="sc">&lt;</span> <span class="fl">1.5</span> <span class="sc">~</span> <span class="st">"Ceiling/floor effect"</span>,</span>
<span id="cb313-11"><a href="#cb313-11" aria-hidden="true" tabindex="-1"></a>      sd <span class="sc">&lt;</span> <span class="fl">0.5</span> <span class="sc">~</span> <span class="st">"Low variance"</span>,</span>
<span id="cb313-12"><a href="#cb313-12" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"OK"</span></span>
<span id="cb313-13"><a href="#cb313-13" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb313-14"><a href="#cb313-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb313-15"><a href="#cb313-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(problem <span class="sc">!=</span> <span class="st">"OK"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Item    r.cor mean     sd          problem
1 WRS1 -0.22688 3.56 1.0440 Weak correlation
2 WRS2  0.01670 2.92 1.3204 Weak correlation
3 WRS3  0.16931 3.80 1.0408 Weak correlation
4 WRS4 -0.46173 3.48 1.0050 Weak correlation
5 WRS6 -0.09238 3.24 1.2675 Weak correlation
6 WRS7  0.23541 3.36 1.1504 Weak correlation
7 WRS8  0.06615 1.56 0.5066 Weak correlation</code></pre>
</div>
</div>
<p><strong>Interpretation</strong>:</p>
<ul>
<li><strong>WRS5</strong>: Ceiling effect (everyone answered 5). Remove or reword.</li>
<li><strong>WRS8</strong>: Weak item-total correlation (r &lt; 0.30). Consider dropping.</li>
<li>Items with very low SD suggest participants donâ€™t differentiate; reword for clarity.</li>
</ul>
<p><strong>What you CANNOT do with n = 20â€“30</strong>:</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Warning</span>Do NOT Compute Alpha with n &lt; 30
</div>
</div>
<div class="callout-body-container callout-body">
<p>Cronbachâ€™s alpha estimates are <strong>highly unstable</strong> with n &lt; 30. The 95% confidence interval will be extremely wide (e.g., [0.40, 0.85]), making the estimate nearly meaningless.</p>
<p><strong>Instead</strong>: Focus on item-level diagnostics (means, SDs, item-total correlations) to refine your scale. Defer reliability estimation to Stage 3.</p>
</div>
</div>
</section>
<section id="stage-3-refinement-n-50100" class="level4" data-number="3.6.3.3">
<h4 data-number="3.6.3.3" class="anchored" data-anchor-id="stage-3-refinement-n-50100"><span class="header-section-number">3.6.3.3</span> Stage 3: Refinement (n = 50â€“100)</h4>
<p><strong>Goal</strong>: Estimate reliability and assess dimensionality.</p>
<p><strong>Methods</strong>:</p>
<ul>
<li><strong>Cronbachâ€™s alpha</strong> with confidence intervals</li>
<li><strong>McDonaldâ€™s omega</strong> (if you suspect multidimensionality)</li>
<li><strong>Split-half reliability</strong> as a robustness check</li>
<li><strong>Exploratory Factor Analysis (EFA)</strong> if n â‰¥ 100 and you suspect subscales</li>
</ul>
<p><strong>Example</strong>:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb315"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb315-1"><a href="#cb315-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulated refinement data: 60 participants, 8 items (problematic items removed)</span></span>
<span id="cb315-2"><a href="#cb315-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb315-3"><a href="#cb315-3" aria-hidden="true" tabindex="-1"></a>refinement_data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">matrix</span>(</span>
<span id="cb315-4"><a href="#cb315-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">60</span> <span class="sc">*</span> <span class="dv">8</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.15</span>, <span class="fl">0.30</span>, <span class="fl">0.35</span>, <span class="fl">0.15</span>)),</span>
<span id="cb315-5"><a href="#cb315-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">nrow =</span> <span class="dv">60</span>, <span class="at">ncol =</span> <span class="dv">8</span></span>
<span id="cb315-6"><a href="#cb315-6" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb315-7"><a href="#cb315-7" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(refinement_data) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"WRS"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>)</span>
<span id="cb315-8"><a href="#cb315-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb315-9"><a href="#cb315-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute alpha</span></span>
<span id="cb315-10"><a href="#cb315-10" aria-hidden="true" tabindex="-1"></a>alpha_result <span class="ot">&lt;-</span> <span class="fu">alpha</span>(refinement_data)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Some items ( WRS4 WRS5 WRS7 ) were negatively correlated with the first principal component and 
probably should be reversed.  
To do this, run the function again with the 'check.keys=TRUE' option</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb317"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb317-1"><a href="#cb317-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Cronbach's alpha:"</span>, <span class="fu">round</span>(alpha_result<span class="sc">$</span>total<span class="sc">$</span>raw_alpha, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Cronbach's alpha: 0.045 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb319"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb319-1"><a href="#cb319-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Note: With n=60, alpha estimate is more stable than with n&lt;30</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Note: With n=60, alpha estimate is more stable than with n&lt;30</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb321"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb321-1"><a href="#cb321-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Split-half reliability</span></span>
<span id="cb321-2"><a href="#cb321-2" aria-hidden="true" tabindex="-1"></a>split_half <span class="ot">&lt;-</span> <span class="fu">splitHalf</span>(refinement_data)</span>
<span id="cb321-3"><a href="#cb321-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(split_half)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Split half reliabilities  
Call: splitHalf(r = refinement_data)

Maximum split half reliability (lambda 4) =  0.7
Guttman lambda 6                          =  0.51
Average split half reliability            =  0.49
Guttman lambda 3 (alpha)                  =  0.49
Guttman lambda 2                          =  0.52
Minimum split half reliability  (beta)    =  0.34
Average interitem r =  0.11  with median =  0.12</code></pre>
</div>
</div>
<p><strong>Interpretation</strong>:</p>
<ul>
<li>Alpha â‰¥ 0.70 suggests adequate internal consistency for research purposes</li>
<li>The confidence interval is still fairly wide (n = 60), but informative</li>
<li>If alpha &lt; 0.60, consider dropping more items or revising wording</li>
</ul>
<p><strong>Exploratory Factor Analysis (EFA)</strong> with n = 50â€“100:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb323"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb323-1"><a href="#cb323-1" aria-hidden="true" tabindex="-1"></a><span class="co"># EFA requires n â‰¥ 100 ideally; with n=60, results are exploratory only</span></span>
<span id="cb323-2"><a href="#cb323-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate larger dataset for demonstration</span></span>
<span id="cb323-3"><a href="#cb323-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb323-4"><a href="#cb323-4" aria-hidden="true" tabindex="-1"></a>efa_data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">matrix</span>(</span>
<span id="cb323-5"><a href="#cb323-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">100</span> <span class="sc">*</span> <span class="dv">8</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.15</span>, <span class="fl">0.30</span>, <span class="fl">0.35</span>, <span class="fl">0.15</span>)),</span>
<span id="cb323-6"><a href="#cb323-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">nrow =</span> <span class="dv">100</span>, <span class="at">ncol =</span> <span class="dv">8</span></span>
<span id="cb323-7"><a href="#cb323-7" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb323-8"><a href="#cb323-8" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(efa_data) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"WRS"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>)</span>
<span id="cb323-9"><a href="#cb323-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb323-10"><a href="#cb323-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Scree plot to determine number of factors</span></span>
<span id="cb323-11"><a href="#cb323-11" aria-hidden="true" tabindex="-1"></a><span class="fu">scree</span>(efa_data, <span class="at">factors =</span> <span class="cn">FALSE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="part-c-analysis-methods_files/figure-html/part-c-scale-dev-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb324"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb324-1"><a href="#cb324-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Parallel analysis (more robust than scree plot alone)</span></span>
<span id="cb324-2"><a href="#cb324-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fa.parallel</span>(efa_data, <span class="at">fa =</span> <span class="st">"fa"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="part-c-analysis-methods_files/figure-html/part-c-scale-dev-4-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Parallel analysis suggests that the number of factors =  0  and the number of components =  NA </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb326"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb326-1"><a href="#cb326-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit 1-factor model</span></span>
<span id="cb326-2"><a href="#cb326-2" aria-hidden="true" tabindex="-1"></a>efa_result <span class="ot">&lt;-</span> <span class="fu">fa</span>(efa_data, <span class="at">nfactors =</span> <span class="dv">1</span>, <span class="at">rotate =</span> <span class="st">"oblimin"</span>)</span>
<span id="cb326-3"><a href="#cb326-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(efa_result<span class="sc">$</span>loadings, <span class="at">cutoff =</span> <span class="fl">0.3</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Loadings:
     MR1   
WRS1       
WRS2       
WRS3       
WRS4       
WRS5       
WRS6       
WRS7       
WRS8  0.520

                 MR1
SS loadings    0.533
Proportion Var 0.067</code></pre>
</div>
</div>
<p><strong>Caution</strong>: With n &lt; 100, factor loadings and structure are unstable. Use EFA results as <strong>preliminary guidance</strong> for item grouping, not definitive evidence of subscales.</p>
</section>
<section id="stage-4-validation-n-150" class="level4" data-number="3.6.3.4">
<h4 data-number="3.6.3.4" class="anchored" data-anchor-id="stage-4-validation-n-150"><span class="header-section-number">3.6.3.4</span> Stage 4: Validation (n = 150+)</h4>
<p><strong>Goal</strong>: Confirm scale structure and establish validity.</p>
<p><strong>Methods</strong>:</p>
<ul>
<li><strong>Confirmatory Factor Analysis (CFA)</strong>: Test hypothesized factor structure</li>
<li><strong>Test-retest reliability</strong>: Administer scale twice (2â€“4 weeks apart)</li>
<li><strong>Convergent validity</strong>: Correlate with theoretically related measures</li>
<li><strong>Discriminant validity</strong>: Show low correlation with unrelated constructs</li>
<li><strong>Known-groups validity</strong>: Scale discriminates between relevant groups</li>
</ul>
<p><strong>Example</strong>:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb328"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb328-1"><a href="#cb328-1" aria-hidden="true" tabindex="-1"></a><span class="co"># CFA requires lavaan package and n â‰¥ 150</span></span>
<span id="cb328-2"><a href="#cb328-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lavaan)</span>
<span id="cb328-3"><a href="#cb328-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb328-4"><a href="#cb328-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Define 1-factor model</span></span>
<span id="cb328-5"><a href="#cb328-5" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb328-6"><a href="#cb328-6" aria-hidden="true" tabindex="-1"></a><span class="st">  resilience =~ WRS1 + WRS2 + WRS3 + WRS4 + WRS5 + WRS6 + WRS7 + WRS8</span></span>
<span id="cb328-7"><a href="#cb328-7" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb328-8"><a href="#cb328-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb328-9"><a href="#cb328-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit model</span></span>
<span id="cb328-10"><a href="#cb328-10" aria-hidden="true" tabindex="-1"></a>cfa_result <span class="ot">&lt;-</span> <span class="fu">cfa</span>(model, <span class="at">data =</span> validation_data)</span>
<span id="cb328-11"><a href="#cb328-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(cfa_result, <span class="at">fit.measures =</span> <span class="cn">TRUE</span>, <span class="at">standardized =</span> <span class="cn">TRUE</span>)</span>
<span id="cb328-12"><a href="#cb328-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb328-13"><a href="#cb328-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit indices to assess model adequacy:</span></span>
<span id="cb328-14"><a href="#cb328-14" aria-hidden="true" tabindex="-1"></a><span class="co"># - CFI &gt; 0.90 (good fit)</span></span>
<span id="cb328-15"><a href="#cb328-15" aria-hidden="true" tabindex="-1"></a><span class="co"># - RMSEA &lt; 0.08 (acceptable fit)</span></span>
<span id="cb328-16"><a href="#cb328-16" aria-hidden="true" tabindex="-1"></a><span class="co"># - SRMR &lt; 0.08 (good fit)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p><strong>Test-retest reliability</strong>:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb329"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb329-1"><a href="#cb329-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute scale scores at Time 1 and Time 2</span></span>
<span id="cb329-2"><a href="#cb329-2" aria-hidden="true" tabindex="-1"></a>validation_data <span class="ot">&lt;-</span> validation_data <span class="sc">%&gt;%</span></span>
<span id="cb329-3"><a href="#cb329-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb329-4"><a href="#cb329-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">resilience_t1 =</span> <span class="fu">rowMeans</span>(<span class="fu">select</span>(., WRS1_t1<span class="sc">:</span>WRS8_t1)),</span>
<span id="cb329-5"><a href="#cb329-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">resilience_t2 =</span> <span class="fu">rowMeans</span>(<span class="fu">select</span>(., WRS1_t2<span class="sc">:</span>WRS8_t2))</span>
<span id="cb329-6"><a href="#cb329-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb329-7"><a href="#cb329-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb329-8"><a href="#cb329-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Intraclass correlation coefficient (ICC)</span></span>
<span id="cb329-9"><a href="#cb329-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(irr)</span>
<span id="cb329-10"><a href="#cb329-10" aria-hidden="true" tabindex="-1"></a>icc_result <span class="ot">&lt;-</span> <span class="fu">icc</span>(</span>
<span id="cb329-11"><a href="#cb329-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(validation_data<span class="sc">$</span>resilience_t1, validation_data<span class="sc">$</span>resilience_t2),</span>
<span id="cb329-12"><a href="#cb329-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">model =</span> <span class="st">"twoway"</span>,</span>
<span id="cb329-13"><a href="#cb329-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"agreement"</span></span>
<span id="cb329-14"><a href="#cb329-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb329-15"><a href="#cb329-15" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(icc_result)</span>
<span id="cb329-16"><a href="#cb329-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb329-17"><a href="#cb329-17" aria-hidden="true" tabindex="-1"></a><span class="co"># ICC &gt; 0.75 indicates good test-retest reliability</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
</section>
<section id="special-considerations-for-n-50" class="level3" data-number="3.6.4">
<h3 data-number="3.6.4" class="anchored"><span class="header-section-number">3.6.4</span> Special Considerations for n &lt; 50</h3>
<section id="what-you-cannot-do" class="level4" data-number="3.6.4.1">
<h4 data-number="3.6.4.1" class="anchored"><span class="header-section-number">3.6.4.1</span> What You CANNOT Do</h4>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Important</span>Analyses That Require Larger Samples
</div>
</div>
<div class="callout-body-container callout-body">
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Warning</span>âš ï¸ Do NOT Force Large-Sample Methods on Small Data
</div>
</div>
<div class="callout-body-container callout-body">
<p>With n &lt; 50, the following analyses are <strong>not feasible</strong> or will produce unreliable results:</p>
<ol type="1">
<li><strong>Exploratory Factor Analysis (EFA)</strong>: Rule of thumb is n â‰¥ 100 or 5â€“10 participants per item</li>
<li><strong>Confirmatory Factor Analysis (CFA)</strong>: Requires n â‰¥ 150â€“200 for stable parameter estimates</li>
<li><strong>Measurement Invariance Testing</strong>: Requires n â‰¥ 200 per group</li>
<li><strong>Structural Equation Modeling (SEM)</strong>: Complex models need n â‰¥ 200â€“400</li>
<li><strong>PLS-SEM (Partial Least Squares SEM)</strong>: Despite marketing claims, needs n â‰¥ 100 for reliable results</li>
<li><strong>Item Response Theory (IRT)</strong>: Most models require n â‰¥ 250â€“500</li>
<li><strong>Reliable Cronbachâ€™s alpha</strong>: With n &lt; 30, alpha estimates have 95% CIs spanning 0.3â€“0.4 units</li>
</ol>
<p><strong>Do NOT force these analyses</strong> with inadequate sample sizes. Results will be misleading.</p>
</div>
</div>
<hr>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-17-contents" aria-controls="callout-17" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>ðŸ“– Why Structural Equation Modeling (SEM) Requires Large Samples
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-17" class="callout-17-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Question</strong>: â€œCan I use SEM, CFA, or PLS-SEM with my small sample (n &lt; 100)?â€</p>
<p><strong>Short Answer</strong>: <strong>No.</strong> SEM-based methods require substantially larger samples than this bookâ€™s target range (n = 10â€“100).</p>
<section id="minimum-sample-size-requirements" class="level3" data-number="3.6.5">
<h3 data-number="3.6.5" class="anchored" data-anchor-id="minimum-sample-size-requirements"><span class="header-section-number">3.6.5</span> Minimum Sample Size Requirements</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 21%">
<col style="width: 28%">
<col style="width: 34%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th>Method</th>
<th>Minimum n</th>
<th>Realistic n</th>
<th>Why?</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Confirmatory Factor Analysis (CFA)</strong></td>
<td>150</td>
<td>200-300</td>
<td>Stable factor loadings, fit indices</td>
</tr>
<tr class="even">
<td><strong>Structural Equation Modeling (SEM)</strong></td>
<td>200</td>
<td>300-500</td>
<td>Complex path models, multiple latent variables</td>
</tr>
<tr class="odd">
<td><strong>PLS-SEM</strong></td>
<td>100</td>
<td>150-300</td>
<td>Despite â€œsmall-sampleâ€ marketing, needs 100+ for reliability</td>
</tr>
<tr class="even">
<td><strong>Multi-Group SEM</strong></td>
<td>200/group</td>
<td>300/group</td>
<td>Measurement invariance testing</td>
</tr>
</tbody>
</table>
<p><strong>Rule of Thumb</strong>: 10-20 observations per estimated parameter (e.g., 5 indicators + 3 paths = 8 parameters â†’ need 80-160 observations).</p>
</section>
<section id="what-happens-if-you-ignore-these-requirements" class="level3" data-number="3.6.6">
<h3 data-number="3.6.6" class="anchored" data-anchor-id="what-happens-if-you-ignore-these-requirements"><span class="header-section-number">3.6.6</span> What Happens If You Ignore These Requirements?</h3>
<p>With n &lt; 100, SEM/CFA/PLS-SEM will produce:</p>
<p>âŒ <strong>Unstable Parameter Estimates</strong> - Factor loadings fluctuate wildly with small perturbations - Path coefficients have huge standard errors - Adding/removing 5 observations changes conclusions</p>
<p>âŒ <strong>Non-Convergent Solutions</strong> - Maximum likelihood fails to converge - Heywood cases (negative variances, loadings &gt; 1.0) - Improper solutions requiring arbitrary constraints</p>
<p>âŒ <strong>Unreliable Fit Indices</strong> - Ï‡Â², CFI, TLI, RMSEA become meaningless with small n - â€œGood fitâ€ may be statistical artifact, not real model adequacy - Modification indices unreliable (suggest spurious changes)</p>
<p>âŒ <strong>Overfit Models</strong> - Model fits sample perfectly but fails to generalize - Cross-validation impossible (too few observations to split) - Results wonâ€™t replicate in new samples</p>
<p>âŒ <strong>False Confidence</strong> - Software produces output even when results are garbage - p-values and CIs misleadingly precise - Reviewers will reject papers citing insufficient sample size</p>
</section>
<section id="what-should-you-do-instead-for-n-100" class="level3" data-number="3.6.7">
<h3 data-number="3.6.7" class="anchored" data-anchor-id="what-should-you-do-instead-for-n-100"><span class="header-section-number">3.6.7</span> What Should You Do Instead? (For n &lt; 100)</h3>
<p><strong>Use the methods in THIS book:</strong></p>
<table class="caption-top table">
<colgroup>
<col style="width: 18%">
<col style="width: 45%">
<col style="width: 16%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th>SEM Goal</th>
<th>Small-Sample Alternative</th>
<th>Chapter</th>
<th>Minimum n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Assess scale reliability</strong></td>
<td>Cronbachâ€™s Î±, McDonaldâ€™s Ï‰, split-half</td>
<td>Ch 6</td>
<td>30-50</td>
</tr>
<tr class="even">
<td><strong>Validate items</strong></td>
<td>Item-total correlations, alpha-if-deleted</td>
<td>Ch 6</td>
<td>30-50</td>
</tr>
<tr class="odd">
<td><strong>Reduce dimensionality</strong></td>
<td><strong>Sum/mean composite scores</strong></td>
<td>Ch 6</td>
<td>20+</td>
</tr>
<tr class="even">
<td><strong>Test relationships (X â†’ Y)</strong></td>
<td>Regression with composite scores</td>
<td>Ch 5</td>
<td>30-50</td>
</tr>
<tr class="odd">
<td><strong>Multiple predictors</strong></td>
<td>Penalized regression (ridge/lasso/elastic net)</td>
<td>Ch 5 Lab 5.2</td>
<td>50-100</td>
</tr>
<tr class="even">
<td><strong>Mediation (X â†’ M â†’ Y)</strong></td>
<td>Simple mediation with bootstrap CIs</td>
<td>Part E Project 5</td>
<td>80-100</td>
</tr>
<tr class="odd">
<td><strong>Latent correlations</strong></td>
<td>Polychoric correlations (exploratory)</td>
<td>Ch 6</td>
<td>50+</td>
</tr>
<tr class="even">
<td><strong>Measurement precision</strong></td>
<td>Standard Error of Measurement (SEM statistic)</td>
<td>Ch 6</td>
<td>30+</td>
</tr>
</tbody>
</table>
<p><strong>Key Principle</strong>: <strong>Composite scores are your friend.</strong> - Sum or average your scale items to create observed composite variables - Use these composites in regression, t-tests, ANOVA - Acknowledge measurement error in limitations section - Plan larger validation study (n â‰¥ 200) for future CFA/SEM</p>
</section>
<section id="example-replacing-sem-with-composite-score-analysis" class="level3" data-number="3.6.8">
<h3 data-number="3.6.8" class="anchored" data-anchor-id="example-replacing-sem-with-composite-score-analysis"><span class="header-section-number">3.6.8</span> Example: Replacing SEM with Composite-Score Analysis</h3>
<p><strong>Proposed SEM Model (n = 60):</strong></p>
<pre><code>Job_Satisfaction (5 items) â†’ Turnover_Intent (3 items)
     â†‘
Performance (4 items)</code></pre>
<p><strong>Small-Sample Alternative:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb331"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb331-1"><a href="#cb331-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create composite scores by averaging items</span></span>
<span id="cb331-2"><a href="#cb331-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb331-3"><a href="#cb331-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb331-4"><a href="#cb331-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">satisfaction =</span> <span class="fu">rowMeans</span>(<span class="fu">select</span>(., satisfaction_1<span class="sc">:</span>satisfaction_5)),</span>
<span id="cb331-5"><a href="#cb331-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">performance =</span> <span class="fu">rowMeans</span>(<span class="fu">select</span>(., performance_1<span class="sc">:</span>performance_4)),</span>
<span id="cb331-6"><a href="#cb331-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">turnover =</span> <span class="fu">rowMeans</span>(<span class="fu">select</span>(., turnover_1<span class="sc">:</span>turnover_3))</span>
<span id="cb331-7"><a href="#cb331-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb331-8"><a href="#cb331-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb331-9"><a href="#cb331-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Test relationships with standard regression</span></span>
<span id="cb331-10"><a href="#cb331-10" aria-hidden="true" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(turnover <span class="sc">~</span> satisfaction, <span class="at">data =</span> data)</span>
<span id="cb331-11"><a href="#cb331-11" aria-hidden="true" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(turnover <span class="sc">~</span> satisfaction <span class="sc">+</span> performance, <span class="at">data =</span> data)</span>
<span id="cb331-12"><a href="#cb331-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb331-13"><a href="#cb331-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Report coefficients, RÂ², confidence intervals</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Advantages</strong>: - âœ… Works with n = 60 - âœ… Interpretable (unit change in averaged scale score) - âœ… Robust (doesnâ€™t require distributional assumptions for latent variables) - âœ… Honest (acknowledges youâ€™re using observed composites, not latent variables)</p>
<p><strong>Limitations to Acknowledge</strong>: - Composites contain measurement error (but so does SEM with n &lt; 150!) - Cannot test complex factor structures - Cannot partition within-item vs.&nbsp;between-item variance</p>
<p><strong>When to Pursue SEM</strong>: Collect n â‰¥ 200 in a follow-up study. Then: 1. Use EFA to explore factor structure (if theory is unclear) 2. Use CFA to confirm measurement model 3. Test structural paths with latent variables 4. Assess model fit rigorously</p>
</section>
<section id="software-will-let-you-do-bad-things" class="level3" data-number="3.6.9">
<h3 data-number="3.6.9" class="anchored" data-anchor-id="software-will-let-you-do-bad-things"><span class="header-section-number">3.6.9</span> Software Will Let You Do Bad Things</h3>
<p><strong>Warning</strong>: SmartPLS, AMOS, Mplus, and other SEM software will happily run with n = 50. They will produce: - Parameter estimates - p-values - Fit indices - Pretty path diagrams</p>
<p><strong>This does NOT mean the results are trustworthy.</strong> Software cannot judge whether your sample size is adequateâ€”<strong>you must.</strong></p>
</section>
<section id="recommended-reading-for-future-large-sample-studies" class="level3" data-number="3.6.10">
<h3 data-number="3.6.10" class="anchored" data-anchor-id="recommended-reading-for-future-large-sample-studies"><span class="header-section-number">3.6.10</span> Recommended Reading (For Future Large-Sample Studies)</h3>
<p>When you collect n â‰¥ 200, consult these resources:</p>
<ol type="1">
<li><strong>Kline, R. B. (2016).</strong> <em>Principles and Practice of Structural Equation Modeling</em> (4th ed.). Guilford Press.
<ul>
<li>Gold standard SEM textbook</li>
<li>Sample size guidelines (pp.&nbsp;15-18, 264-270)</li>
</ul></li>
<li><strong>Brown, T. A. (2015).</strong> <em>Confirmatory Factor Analysis for Applied Research</em> (2nd ed.). Guilford Press.
<ul>
<li>CFA-specific guidance</li>
<li>Measurement invariance testing</li>
</ul></li>
<li><strong>Hair, J. F., Hult, G. T. M., Ringle, C. M., &amp; Sarstedt, M. (2022).</strong> <em>A Primer on Partial Least Squares Structural Equation Modeling (PLS-SEM)</em> (3rd ed.). Sage.
<ul>
<li>PLS-SEM methods (but note: still needs n â‰¥ 100-150 realistically)</li>
</ul></li>
<li><strong>Hoyle, R. H. (Ed.). (2023).</strong> <em>Handbook of Structural Equation Modeling</em> (2nd ed.). Guilford Press.
<ul>
<li>Advanced topics, sample size planning</li>
</ul></li>
</ol>
</section>
<section id="bottom-line" class="level3" data-number="3.6.11">
<h3 data-number="3.6.11" class="anchored" data-anchor-id="bottom-line"><span class="header-section-number">3.6.11</span> Bottom Line</h3>
<p><strong>For n = 10â€“100, use the methods in this book.</strong> They are: - âœ… <strong>Appropriate</strong> for small samples - âœ… <strong>Robust</strong> to violations of assumptions - âœ… <strong>Honest</strong> about uncertainty - âœ… <strong>Interpretable</strong> for stakeholders - âœ… <strong>Defensible</strong> to reviewers</p>
<p><strong>Save SEM for when you have n â‰¥ 200.</strong> Until then, composite scores + regression will serve you well.</p>
</section>
</div>
</div>
</div>
<hr>
<section id="what-you-can-do" class="level4" data-number="3.6.11.1">
<h4 data-number="3.6.11.1" class="anchored" data-anchor-id="what-you-can-do"><span class="header-section-number">3.6.11.1</span> What You CAN Do</h4>
<p>With n = 20â€“50, focus on these <strong>feasible and informative</strong> analyses:</p>
<ol type="1">
<li><strong>Content Validity</strong>:
<ul>
<li>Expert review (e.g., Content Validity Index with 5â€“10 experts)</li>
<li>Cognitive interviews to assess comprehension</li>
<li>Alignment with theoretical framework</li>
</ul></li>
<li><strong>Item-Level Diagnostics</strong>:
<ul>
<li>Item means, SDs, skewness</li>
<li>Item-total correlations (r.cor)</li>
<li>Ceiling/floor effects</li>
<li>Inter-item correlation matrix</li>
</ul></li>
<li><strong>Preliminary Reliability</strong> (n â‰¥ 30):
<ul>
<li>Cronbachâ€™s alpha <strong>with 95% CI</strong> (report the wide CI!)</li>
<li>Split-half reliability as robustness check</li>
<li>Mean inter-item correlation (0.15â€“0.50 is typical)</li>
</ul></li>
<li><strong>Known-Groups Validity</strong>:
<ul>
<li>Compare scale scores between groups expected to differ (e.g., clinical vs.&nbsp;non-clinical)</li>
<li>Use nonparametric tests (Mann-Whitney U) if distributions are skewed</li>
</ul></li>
<li><strong>Prepare for Larger Validation Study</strong>:
<ul>
<li>Document item generation process</li>
<li>Report pilot results transparently (including dropped items and why)</li>
<li>Specify hypotheses for CFA in future study</li>
</ul></li>
</ol>
</section>
<section id="example-documenting-a-small-sample-scale-development" class="level3" data-number="3.6.12">
<h3 data-number="3.6.12" class="anchored" data-anchor-id="example-documenting-a-small-sample-scale-development"><span class="header-section-number">3.6.12</span> Example: Documenting a Small-Sample Scale Development</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb332"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb332-1"><a href="#cb332-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reporting template for n &lt; 50 pilot study</span></span>
<span id="cb332-2"><a href="#cb332-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb332-3"><a href="#cb332-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-4"><a href="#cb332-4" aria-hidden="true" tabindex="-1"></a>scale_dev_report <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb332-5"><a href="#cb332-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Stage =</span> <span class="fu">c</span>(<span class="st">"Item Generation"</span>, <span class="st">"Pilot Testing"</span>, <span class="st">"Refinement"</span>, <span class="st">"Validation"</span>),</span>
<span id="cb332-6"><a href="#cb332-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Sample_Size =</span> <span class="fu">c</span>(<span class="st">"n = 8 (cognitive interviews)"</span>, <span class="st">"n = 25"</span>, <span class="st">"n = 60"</span>, <span class="st">"Planned: n = 200"</span>),</span>
<span id="cb332-7"><a href="#cb332-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Analyses_Conducted =</span> <span class="fu">c</span>(</span>
<span id="cb332-8"><a href="#cb332-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Think-aloud protocols; expert review (CVI = 0.88)"</span>,</span>
<span id="cb332-9"><a href="#cb332-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Item-total correlations; ceiling/floor checks; 3 items dropped"</span>,</span>
<span id="cb332-10"><a href="#cb332-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Alpha = 0.73 [95% CI: 0.61, 0.82]; split-half r = 0.70"</span>,</span>
<span id="cb332-11"><a href="#cb332-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"CFA, test-retest ICC, convergent validity (planned)"</span></span>
<span id="cb332-12"><a href="#cb332-12" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb332-13"><a href="#cb332-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">Key_Findings =</span> <span class="fu">c</span>(</span>
<span id="cb332-14"><a href="#cb332-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Generated 15 items; 2 flagged as ambiguous"</span>,</span>
<span id="cb332-15"><a href="#cb332-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Dropped WRS5 (ceiling), WRS8 (r.cor = 0.18), WRS11 (low variance)"</span>,</span>
<span id="cb332-16"><a href="#cb332-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">"8-item scale shows acceptable reliability for research use"</span>,</span>
<span id="cb332-17"><a href="#cb332-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Pending larger validation sample"</span></span>
<span id="cb332-18"><a href="#cb332-18" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb332-19"><a href="#cb332-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb332-20"><a href="#cb332-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-21"><a href="#cb332-21" aria-hidden="true" tabindex="-1"></a>scale_dev_report <span class="sc">%&gt;%</span></span>
<span id="cb332-22"><a href="#cb332-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb332-23"><a href="#cb332-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb332-24"><a href="#cb332-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Workplace Resilience Scale Development Summary"</span>,</span>
<span id="cb332-25"><a href="#cb332-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Iterative pilot and refinement process"</span></span>
<span id="cb332-26"><a href="#cb332-26" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb332-27"><a href="#cb332-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(</span>
<span id="cb332-28"><a href="#cb332-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">Stage =</span> <span class="st">"Development Stage"</span>,</span>
<span id="cb332-29"><a href="#cb332-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">Sample_Size =</span> <span class="st">"Sample Size"</span>,</span>
<span id="cb332-30"><a href="#cb332-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">Analyses_Conducted =</span> <span class="st">"Analyses Conducted"</span>,</span>
<span id="cb332-31"><a href="#cb332-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">Key_Findings =</span> <span class="st">"Key Findings"</span></span>
<span id="cb332-32"><a href="#cb332-32" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb332-33"><a href="#cb332-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_options</span>(</span>
<span id="cb332-34"><a href="#cb332-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">table.font.size =</span> <span class="dv">10</span></span>
<span id="cb332-35"><a href="#cb332-35" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="dzxszjdzjf" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#dzxszjdzjf table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#dzxszjdzjf thead, #dzxszjdzjf tbody, #dzxszjdzjf tfoot, #dzxszjdzjf tr, #dzxszjdzjf td, #dzxszjdzjf th {
  border-style: none;
}

#dzxszjdzjf p {
  margin: 0;
  padding: 0;
}

#dzxszjdzjf .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 10px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#dzxszjdzjf .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#dzxszjdzjf .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#dzxszjdzjf .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#dzxszjdzjf .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dzxszjdzjf .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dzxszjdzjf .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dzxszjdzjf .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#dzxszjdzjf .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#dzxszjdzjf .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#dzxszjdzjf .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#dzxszjdzjf .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#dzxszjdzjf .gt_spanner_row {
  border-bottom-style: hidden;
}

#dzxszjdzjf .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#dzxszjdzjf .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#dzxszjdzjf .gt_from_md > :first-child {
  margin-top: 0;
}

#dzxszjdzjf .gt_from_md > :last-child {
  margin-bottom: 0;
}

#dzxszjdzjf .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#dzxszjdzjf .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#dzxszjdzjf .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#dzxszjdzjf .gt_row_group_first td {
  border-top-width: 2px;
}

#dzxszjdzjf .gt_row_group_first th {
  border-top-width: 2px;
}

#dzxszjdzjf .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#dzxszjdzjf .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#dzxszjdzjf .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#dzxszjdzjf .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dzxszjdzjf .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#dzxszjdzjf .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#dzxszjdzjf .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#dzxszjdzjf .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#dzxszjdzjf .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dzxszjdzjf .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dzxszjdzjf .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#dzxszjdzjf .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dzxszjdzjf .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#dzxszjdzjf .gt_left {
  text-align: left;
}

#dzxszjdzjf .gt_center {
  text-align: center;
}

#dzxszjdzjf .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#dzxszjdzjf .gt_font_normal {
  font-weight: normal;
}

#dzxszjdzjf .gt_font_bold {
  font-weight: bold;
}

#dzxszjdzjf .gt_font_italic {
  font-style: italic;
}

#dzxszjdzjf .gt_super {
  font-size: 65%;
}

#dzxszjdzjf .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#dzxszjdzjf .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#dzxszjdzjf .gt_indent_1 {
  text-indent: 5px;
}

#dzxszjdzjf .gt_indent_2 {
  text-indent: 10px;
}

#dzxszjdzjf .gt_indent_3 {
  text-indent: 15px;
}

#dzxszjdzjf .gt_indent_4 {
  text-indent: 20px;
}

#dzxszjdzjf .gt_indent_5 {
  text-indent: 25px;
}

#dzxszjdzjf .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#dzxszjdzjf div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading header">
<td colspan="4" class="gt_heading gt_title gt_font_normal">Workplace Resilience Scale Development Summary</td>
</tr>
<tr class="gt_heading even">
<td colspan="4" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border">Iterative pilot and refinement process</td>
</tr>
<tr class="gt_col_headings header">
<th id="Stage" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Development Stage</th>
<th id="Sample_Size" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Sample Size</th>
<th id="Analyses_Conducted" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Analyses Conducted</th>
<th id="Key_Findings" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Key Findings</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="Stage">Item Generation</td>
<td class="gt_row gt_left" headers="Sample_Size">n = 8 (cognitive interviews)</td>
<td class="gt_row gt_left" headers="Analyses_Conducted">Think-aloud protocols; expert review (CVI = 0.88)</td>
<td class="gt_row gt_left" headers="Key_Findings">Generated 15 items; 2 flagged as ambiguous</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Stage">Pilot Testing</td>
<td class="gt_row gt_left" headers="Sample_Size">n = 25</td>
<td class="gt_row gt_left" headers="Analyses_Conducted">Item-total correlations; ceiling/floor checks; 3 items dropped</td>
<td class="gt_row gt_left" headers="Key_Findings">Dropped WRS5 (ceiling), WRS8 (r.cor = 0.18), WRS11 (low variance)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Stage">Refinement</td>
<td class="gt_row gt_left" headers="Sample_Size">n = 60</td>
<td class="gt_row gt_left" headers="Analyses_Conducted">Alpha = 0.73 [95% CI: 0.61, 0.82]; split-half r = 0.70</td>
<td class="gt_row gt_left" headers="Key_Findings">8-item scale shows acceptable reliability for research use</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Stage">Validation</td>
<td class="gt_row gt_left" headers="Sample_Size">Planned: n = 200</td>
<td class="gt_row gt_left" headers="Analyses_Conducted">CFA, test-retest ICC, convergent validity (planned)</td>
<td class="gt_row gt_left" headers="Key_Findings">Pending larger validation sample</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="reporting-guidelines-for-small-sample-scale-development" class="level3" data-number="3.6.13">
<h3 data-number="3.6.13" class="anchored" data-anchor-id="reporting-guidelines-for-small-sample-scale-development"><span class="header-section-number">3.6.13</span> Reporting Guidelines for Small-Sample Scale Development</h3>
<p>When publishing or reporting scale development work with n &lt; 50:</p>
<ol type="1">
<li><strong>Acknowledge limitations explicitly</strong>:
<ul>
<li>â€œWith n = 25, we could not reliably estimate Cronbachâ€™s alpha. Instead, we focused on item-total correlations to identify weak items.â€</li>
<li>â€œExploratory factor analysis was not feasible (n = 60); we plan CFA with a larger sample (target n = 200).â€</li>
</ul></li>
<li><strong>Report what you did (not what you wish you could do)</strong>:
<ul>
<li>Donâ€™t report alpha if n &lt; 30 (the CI will be embarrassingly wide)</li>
<li>Donâ€™t force EFA/CFA with inadequate samples; instead, document theoretical rationale for item grouping</li>
</ul></li>
<li><strong>Frame as a preliminary/pilot study</strong>:
<ul>
<li>â€œThis pilot study (n = 35) was designed to refine item wording and identify problematic items before a larger validation study.â€</li>
<li>â€œResults are preliminary and should be interpreted with caution pending validation with n â‰¥ 150.â€</li>
</ul></li>
<li><strong>Provide detailed item-level information</strong>:
<ul>
<li>Publish item means, SDs, item-total correlations</li>
<li>Report which items were dropped and why</li>
<li>Share cognitive interview feedback (qualitative)</li>
</ul></li>
<li><strong>Plan and fund the validation study</strong>:
<ul>
<li>Use pilot data to justify sample size for validation (power analysis for CFA)</li>
<li>Secure resources for n â‰¥ 150â€“200 before claiming a â€œvalidatedâ€ scale</li>
</ul></li>
</ol>
</section>
<section id="key-takeaways-4" class="level3" data-number="3.6.14">
<h3 data-number="3.6.14" class="anchored" data-anchor-id="key-takeaways-4"><span class="header-section-number">3.6.14</span> Key Takeaways</h3>
<ul>
<li>Scale development is a <strong>multi-stage process</strong> requiring progressively larger samples</li>
<li>With n &lt; 30: Focus on qualitative feedback and item-level diagnostics; <strong>do not compute alpha</strong></li>
<li>With n = 30â€“50: Compute preliminary alpha (with wide CI); identify weak items</li>
<li>With n = 50â€“100: Assess reliability; exploratory factor analysis is feasible but results are tentative</li>
<li>With n â‰¥ 150: Conduct CFA, test-retest, and validity studies</li>
<li><strong>Transparency is key</strong>: Report what you did and didnâ€™t do, and acknowledge sample size limitations</li>
</ul>
<hr>
</section>
<section id="chapter-7.-multi-criteria-decision-making-mcdm-for-small-sets-of-alternatives" class="level2" data-number="3.7">
<h2 data-number="3.7" class="anchored" data-anchor-id="chapter-7.-multi-criteria-decision-making-mcdm-for-small-sets-of-alternatives"><span class="header-section-number">3.7</span> Chapter 7. Multi-Criteria Decision Making (MCDM) for Small Sets of Alternatives</h2>
<section id="learning-objectives-5" class="level3" data-number="3.7.1">
<h3 data-number="3.7.1" class="anchored" data-anchor-id="learning-objectives-5"><span class="header-section-number">3.7.1</span> Learning Objectives</h3>
<p>By the end of this chapter, you will be able to:</p>
<p><strong>Conceptual Understanding</strong> - âœ“ Explain the principles of multi-criteria decision analysis (MCDM) - âœ“ Understand the theoretical basis of AHP, TOPSIS, and VIKOR methods - âœ“ Recognize when MCDM is appropriate vs.&nbsp;when statistical inference is needed - âœ“ Distinguish compensatory from non-compensatory aggregation methods</p>
<p><strong>Practical Skills</strong> - âœ“ Structure decision problems with hierarchies of criteria and sub-criteria - âœ“ Elicit pairwise comparison judgments for AHP using consistency checks - âœ“ Implement TOPSIS and VIKOR in R to rank alternatives - âœ“ Compute composite scores with weighted criteria</p>
<p><strong>Critical Evaluation</strong> - âœ“ Assess the consistency of expert judgments (AHP consistency ratio) - âœ“ Evaluate sensitivity of rankings to weight changes - âœ“ Critique subjective weight elicitation procedures</p>
<p><strong>Application</strong> - âœ“ Apply MCDM methods to policy selection, technology choice, or program evaluation - âœ“ Perform sensitivity analyses to test robustness of rankings - âœ“ Report MCDM results transparently with criteria weights and score decompositions</p>
</section>
<section id="when-to-use-mcdm-methods" class="level3" data-number="3.7.2">
<h3 data-number="3.7.2" class="anchored" data-anchor-id="when-to-use-mcdm-methods"><span class="header-section-number">3.7.2</span> When to Use MCDM Methods</h3>
<p>Multi-criteria decision-making (MCDM) methods are designed for problems where a small set of alternatives (options, projects, policies) must be evaluated and ranked on multiple criteria. They are particularly useful when:</p>
<ul>
<li>The number of alternatives is small (typically fewer than 20).</li>
<li>Alternatives are assessed on diverse criteria (quantitative and qualitative).</li>
<li>Stakeholder preferences or expert judgements must be incorporated.</li>
<li>The goal is ranking, selection, or resource allocation rather than hypothesis testing.</li>
</ul>
<p>MCDM methods do not test statistical hypotheses or quantify uncertainty in the same way as inferential statistics. Instead, they provide structured frameworks for synthesising information and making transparent, defensible choices.</p>
</section>
<section id="analytic-hierarchy-process-ahp" class="level3" data-number="3.7.3">
<h3 data-number="3.7.3" class="anchored" data-anchor-id="analytic-hierarchy-process-ahp"><span class="header-section-number">3.7.3</span> Analytic Hierarchy Process (AHP)</h3>
<p>AHP decomposes a decision problem into a hierarchy of criteria and alternatives, then uses pairwise comparisons to derive priority weights. Decision-makers compare each pair of criteria (and each pair of alternatives under each criterion) to indicate relative importance or preference. AHP synthesises these comparisons into overall scores for each alternative.</p>
<p><strong>When to use</strong>: Multiple criteria with subjective importance weights, need for structured elicitation of expert judgements, transparency in weighting and aggregation.</p>
<p><strong>Steps</strong>: 1. Define the goal, criteria, and alternatives. 2. Perform pairwise comparisons of criteria to derive criteria weights. 3. Perform pairwise comparisons of alternatives under each criterion. 4. Aggregate to obtain overall scores for each alternative. 5. Check consistency of pairwise judgements.</p>
</section>
<section id="example-ahp-for-selecting-a-training-programme" class="level3" data-number="3.7.4">
<h3 data-number="3.7.4" class="anchored" data-anchor-id="example-ahp-for-selecting-a-training-programme"><span class="header-section-number">3.7.4</span> Example: AHP for Selecting a Training Programme</h3>
<p>Suppose an organisation must choose among three training programmes (A, B, C) based on three criteria: Cost (lower is better), Effectiveness (higher is better), and Feasibility (higher is better). We use AHP to rank the programmes.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb333"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb333-1"><a href="#cb333-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb333-2"><a href="#cb333-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb333-3"><a href="#cb333-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Define criteria weights from pairwise comparisons</span></span>
<span id="cb333-4"><a href="#cb333-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Suppose decision-makers judge: </span></span>
<span id="cb333-5"><a href="#cb333-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   Effectiveness is 3 times more important than Cost</span></span>
<span id="cb333-6"><a href="#cb333-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   Effectiveness is 2 times more important than Feasibility</span></span>
<span id="cb333-7"><a href="#cb333-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   Feasibility is slightly more important than Cost (1.5 times)</span></span>
<span id="cb333-8"><a href="#cb333-8" aria-hidden="true" tabindex="-1"></a><span class="co"># These comparisons yield approximate normalised weights:</span></span>
<span id="cb333-9"><a href="#cb333-9" aria-hidden="true" tabindex="-1"></a>criteria_weights <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">Cost =</span> <span class="fl">0.20</span>, <span class="at">Effectiveness =</span> <span class="fl">0.58</span>, <span class="at">Feasibility =</span> <span class="fl">0.22</span>)</span>
<span id="cb333-10"><a href="#cb333-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb333-11"><a href="#cb333-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Define alternative scores on each criterion (normalised 0-1 scale)</span></span>
<span id="cb333-12"><a href="#cb333-12" aria-hidden="true" tabindex="-1"></a><span class="co"># These might come from pairwise comparisons or direct assessments</span></span>
<span id="cb333-13"><a href="#cb333-13" aria-hidden="true" tabindex="-1"></a>alternatives <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb333-14"><a href="#cb333-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">Programme =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>),</span>
<span id="cb333-15"><a href="#cb333-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">Cost_score =</span> <span class="fu">c</span>(<span class="fl">0.50</span>, <span class="fl">0.30</span>, <span class="fl">0.20</span>),         <span class="co"># A is cheapest</span></span>
<span id="cb333-16"><a href="#cb333-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">Effectiveness_score =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.50</span>, <span class="fl">0.25</span>), <span class="co"># B is most effective</span></span>
<span id="cb333-17"><a href="#cb333-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">Feasibility_score =</span> <span class="fu">c</span>(<span class="fl">0.40</span>, <span class="fl">0.30</span>, <span class="fl">0.30</span>)    <span class="co"># A is most feasible</span></span>
<span id="cb333-18"><a href="#cb333-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb333-19"><a href="#cb333-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb333-20"><a href="#cb333-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute weighted scores</span></span>
<span id="cb333-21"><a href="#cb333-21" aria-hidden="true" tabindex="-1"></a>alternatives <span class="ot">&lt;-</span> alternatives <span class="sc">%&gt;%</span></span>
<span id="cb333-22"><a href="#cb333-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb333-23"><a href="#cb333-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">Weighted_Cost =</span> Cost_score <span class="sc">*</span> criteria_weights[<span class="st">"Cost"</span>],</span>
<span id="cb333-24"><a href="#cb333-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">Weighted_Effectiveness =</span> Effectiveness_score <span class="sc">*</span> criteria_weights[<span class="st">"Effectiveness"</span>],</span>
<span id="cb333-25"><a href="#cb333-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">Weighted_Feasibility =</span> Feasibility_score <span class="sc">*</span> criteria_weights[<span class="st">"Feasibility"</span>],</span>
<span id="cb333-26"><a href="#cb333-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Score =</span> Weighted_Cost <span class="sc">+</span> Weighted_Effectiveness <span class="sc">+</span> Weighted_Feasibility</span>
<span id="cb333-27"><a href="#cb333-27" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb333-28"><a href="#cb333-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Total_Score))</span>
<span id="cb333-29"><a href="#cb333-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb333-30"><a href="#cb333-30" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(alternatives)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 Ã— 8
  Programme Cost_score Effectiveness_score Feasibility_score Weighted_Cost
  &lt;chr&gt;          &lt;dbl&gt;               &lt;dbl&gt;             &lt;dbl&gt;         &lt;dbl&gt;
1 B                0.3                0.5                0.3          0.06
2 A                0.5                0.25               0.4          0.1 
3 C                0.2                0.25               0.3          0.04
# â„¹ 3 more variables: Weighted_Effectiveness &lt;dbl&gt;, Weighted_Feasibility &lt;dbl&gt;,
#   Total_Score &lt;dbl&gt;</code></pre>
</div>
</div>
<p>Interpretation: Programme B has the highest total score, driven by its strong performance on Effectiveness (the most heavily weighted criterion). Programme A ranks second due to low cost and high feasibility. The ranking reflects the decision-makersâ€™ stated priorities. Sensitivity analysis (varying criteria weights) can assess robustness.</p>
</section>
<section id="topsis-technique-for-order-of-preference-by-similarity-to-ideal-solution" class="level3" data-number="3.7.5">
<h3 data-number="3.7.5" class="anchored" data-anchor-id="topsis-technique-for-order-of-preference-by-similarity-to-ideal-solution"><span class="header-section-number">3.7.5</span> TOPSIS (Technique for Order of Preference by Similarity to Ideal Solution)</h3>
<p>TOPSIS ranks alternatives by their distance from an ideal solution (best on all criteria) and a negative-ideal solution (worst on all criteria). Alternatives closest to the ideal and farthest from the negative-ideal are ranked highest.</p>
<p><strong>When to use</strong>: Multiple criteria with known or easily assigned weights, desire for geometric interpretation, straightforward implementation.</p>
<p><strong>Steps</strong>: 1. Normalise the decision matrix (each criterion scaled to comparable units). 2. Apply criteria weights to the normalised matrix. 3. Identify the ideal and negative-ideal solutions. 4. Compute Euclidean distances from each alternative to both reference points. 5. Calculate closeness coefficients and rank alternatives.</p>
</section>
<section id="example-topsis-for-project-selection" class="level3" data-number="3.7.6">
<h3 data-number="3.7.6" class="anchored" data-anchor-id="example-topsis-for-project-selection"><span class="header-section-number">3.7.6</span> Example: TOPSIS for Project Selection</h3>
<p>We evaluate four community projects (P1, P2, P3, P4) on three criteria: Impact (higher is better), Cost (lower is better, so we reverse), and Community Support (higher is better).</p>
<blockquote class="blockquote">
<p><strong>Normalisation choices.</strong> TOPSIS typically uses vector (Euclidean) normalisation so that each criterion contributes proportionally regardless of its original scale. Cost variables must be recoded so that higher values are preferable (e.g., invert, take reciprocal, or subtract from the maximum). Alternatives include minâ€“max scaling or z-scores; choose a method consistent across criteria and document it so stakeholders understand how raw data map into the TOPSIS space.</p>
</blockquote>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb335"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb335-1"><a href="#cb335-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb335-2"><a href="#cb335-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb335-3"><a href="#cb335-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Decision matrix: rows = projects, columns = criteria</span></span>
<span id="cb335-4"><a href="#cb335-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Impact (scale 1-10), Cost (in Â£1000s), Support (scale 1-10)</span></span>
<span id="cb335-5"><a href="#cb335-5" aria-hidden="true" tabindex="-1"></a>decision_matrix <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb335-6"><a href="#cb335-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Project =</span> <span class="fu">c</span>(<span class="st">"P1"</span>, <span class="st">"P2"</span>, <span class="st">"P3"</span>, <span class="st">"P4"</span>),</span>
<span id="cb335-7"><a href="#cb335-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Impact =</span> <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">6</span>, <span class="dv">9</span>),</span>
<span id="cb335-8"><a href="#cb335-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">Cost =</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">70</span>, <span class="dv">40</span>, <span class="dv">80</span>),      <span class="co"># Lower is better; we'll invert</span></span>
<span id="cb335-9"><a href="#cb335-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">Support =</span> <span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">7</span>)</span>
<span id="cb335-10"><a href="#cb335-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb335-11"><a href="#cb335-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb335-12"><a href="#cb335-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Invert cost (so higher is better)</span></span>
<span id="cb335-13"><a href="#cb335-13" aria-hidden="true" tabindex="-1"></a>decision_matrix <span class="ot">&lt;-</span> decision_matrix <span class="sc">%&gt;%</span></span>
<span id="cb335-14"><a href="#cb335-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Cost_inverted =</span> <span class="fu">max</span>(Cost) <span class="sc">-</span> Cost <span class="sc">+</span> <span class="fu">min</span>(Cost))</span>
<span id="cb335-15"><a href="#cb335-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb335-16"><a href="#cb335-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalise each criterion (vector/Euclidean normalisation)</span></span>
<span id="cb335-17"><a href="#cb335-17" aria-hidden="true" tabindex="-1"></a>criteria_cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Impact"</span>, <span class="st">"Cost_inverted"</span>, <span class="st">"Support"</span>)</span>
<span id="cb335-18"><a href="#cb335-18" aria-hidden="true" tabindex="-1"></a>normalised <span class="ot">&lt;-</span> decision_matrix <span class="sc">%&gt;%</span></span>
<span id="cb335-19"><a href="#cb335-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">all_of</span>(criteria_cols), <span class="sc">~</span> .x <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>(.x<span class="sc">^</span><span class="dv">2</span>)), <span class="at">.names =</span> <span class="st">"norm_{.col}"</span>))</span>
<span id="cb335-20"><a href="#cb335-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb335-21"><a href="#cb335-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply weights (assume equal weights for simplicity)</span></span>
<span id="cb335-22"><a href="#cb335-22" aria-hidden="true" tabindex="-1"></a>weights <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">Impact =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="at">Cost_inverted =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="at">Support =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>)</span>
<span id="cb335-23"><a href="#cb335-23" aria-hidden="true" tabindex="-1"></a>weighted <span class="ot">&lt;-</span> normalised <span class="sc">%&gt;%</span></span>
<span id="cb335-24"><a href="#cb335-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb335-25"><a href="#cb335-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">w_Impact =</span> norm_Impact <span class="sc">*</span> weights[<span class="st">"Impact"</span>],</span>
<span id="cb335-26"><a href="#cb335-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">w_Cost =</span> norm_Cost_inverted <span class="sc">*</span> weights[<span class="st">"Cost_inverted"</span>],</span>
<span id="cb335-27"><a href="#cb335-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">w_Support =</span> norm_Support <span class="sc">*</span> weights[<span class="st">"Support"</span>]</span>
<span id="cb335-28"><a href="#cb335-28" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb335-29"><a href="#cb335-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb335-30"><a href="#cb335-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Ideal and negative-ideal solutions</span></span>
<span id="cb335-31"><a href="#cb335-31" aria-hidden="true" tabindex="-1"></a>ideal <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">max</span>(weighted<span class="sc">$</span>w_Impact), <span class="fu">max</span>(weighted<span class="sc">$</span>w_Cost), <span class="fu">max</span>(weighted<span class="sc">$</span>w_Support))</span>
<span id="cb335-32"><a href="#cb335-32" aria-hidden="true" tabindex="-1"></a>negative_ideal <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">min</span>(weighted<span class="sc">$</span>w_Impact), <span class="fu">min</span>(weighted<span class="sc">$</span>w_Cost), <span class="fu">min</span>(weighted<span class="sc">$</span>w_Support))</span>
<span id="cb335-33"><a href="#cb335-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb335-34"><a href="#cb335-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute distances</span></span>
<span id="cb335-35"><a href="#cb335-35" aria-hidden="true" tabindex="-1"></a>weighted <span class="ot">&lt;-</span> weighted <span class="sc">%&gt;%</span></span>
<span id="cb335-36"><a href="#cb335-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb335-37"><a href="#cb335-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb335-38"><a href="#cb335-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">dist_ideal =</span> <span class="fu">sqrt</span>((w_Impact <span class="sc">-</span> ideal[<span class="dv">1</span>])<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (w_Cost <span class="sc">-</span> ideal[<span class="dv">2</span>])<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (w_Support <span class="sc">-</span> ideal[<span class="dv">3</span>])<span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb335-39"><a href="#cb335-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">dist_neg_ideal =</span> <span class="fu">sqrt</span>((w_Impact <span class="sc">-</span> negative_ideal[<span class="dv">1</span>])<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (w_Cost <span class="sc">-</span> negative_ideal[<span class="dv">2</span>])<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (w_Support <span class="sc">-</span> negative_ideal[<span class="dv">3</span>])<span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb335-40"><a href="#cb335-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">closeness =</span> dist_neg_ideal <span class="sc">/</span> (dist_ideal <span class="sc">+</span> dist_neg_ideal)</span>
<span id="cb335-41"><a href="#cb335-41" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb335-42"><a href="#cb335-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb335-43"><a href="#cb335-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(closeness))</span>
<span id="cb335-44"><a href="#cb335-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb335-45"><a href="#cb335-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Results</span></span>
<span id="cb335-46"><a href="#cb335-46" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(weighted, Project, Impact, Cost, Support, closeness)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 Ã— 5
  Project Impact  Cost Support closeness
  &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;
1 P3           6    40       8     0.640
2 P1           7    50       6     0.544
3 P2           8    70       7     0.395
4 P4           9    80       7     0.389</code></pre>
</div>
</div>
<p>Interpretation: The closeness coefficient ranges from 0 to 1; higher values indicate better alternatives. Projects are ranked by closeness. The top-ranked project is closest to the ideal (best on all criteria) and farthest from the negative-ideal (worst on all criteria). Sensitivity analysis can vary criteria weights to assess stability of rankings.</p>
</section>
<section id="vikor-visekriterijumska-optimizacija-i-kompromisno-resenje" class="level3" data-number="3.7.7">
<h3 data-number="3.7.7" class="anchored" data-anchor-id="vikor-visekriterijumska-optimizacija-i-kompromisno-resenje"><span class="header-section-number">3.7.7</span> VIKOR (VIseKriterijumska Optimizacija I Kompromisno Resenje)</h3>
<p>VIKOR ranks alternatives based on closeness to the ideal solution, with emphasis on compromise. It computes utility and regret measures, then combines them into a compromise ranking. VIKOR is useful when trade-offs among criteria are important.</p>
<p><strong>When to use</strong>: Similar contexts to TOPSIS, when emphasis on compromise and trade-offs is desired.</p>
</section>
<section id="other-mcdm-methods" class="level3" data-number="3.7.8">
<h3 data-number="3.7.8" class="anchored" data-anchor-id="other-mcdm-methods"><span class="header-section-number">3.7.8</span> Other MCDM Methods</h3>
<ul>
<li><strong>MOORA (Multi-Objective Optimisation by Ratio Analysis)</strong>: Simple ratio-based ranking.</li>
<li><strong>WASPAS (Weighted Aggregated Sum Product Assessment)</strong>: Combines additive and multiplicative aggregation.</li>
<li><strong>DEMATEL (Decision-Making Trial and Evaluation Laboratory)</strong>: Analyses causal relationships among criteria.</li>
<li><strong>SMART (Simple Multi-Attribute Rating Technique)</strong>: Direct scoring and weighting.</li>
</ul>
<p>All these methods share common steps: structuring the problem, normalising criteria, applying weights, and computing composite scores. The choice of method depends on problem context, stakeholder preferences, and computational convenience.</p>
</section>
<section id="sensitivity-analysis-in-mcdm" class="level3" data-number="3.7.9">
<h3 data-number="3.7.9" class="anchored" data-anchor-id="sensitivity-analysis-in-mcdm"><span class="header-section-number">3.7.9</span> Sensitivity Analysis in MCDM</h3>
<p>MCDM rankings can be sensitive to criteria weights and normalisation methods. Sensitivity analysis systematically varies weights (or other inputs) and observes changes in rankings. If rankings remain stable across a range of plausible weights, conclusions are robust. If small weight changes produce large ranking changes, results should be interpreted cautiously and alternative weighting schemes considered.</p>
</section>
<section id="example-sensitivity-analysis-for-ahp" class="level3" data-number="3.7.10">
<h3 data-number="3.7.10" class="anchored" data-anchor-id="example-sensitivity-analysis-for-ahp"><span class="header-section-number">3.7.10</span> Example: Sensitivity Analysis for AHP</h3>
<p>We vary the weight on Effectiveness in the AHP training example and observe changes in rankings.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb337"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb337-1"><a href="#cb337-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb337-2"><a href="#cb337-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-3"><a href="#cb337-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Original weights</span></span>
<span id="cb337-4"><a href="#cb337-4" aria-hidden="true" tabindex="-1"></a>weights_base <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">Cost =</span> <span class="fl">0.20</span>, <span class="at">Effectiveness =</span> <span class="fl">0.58</span>, <span class="at">Feasibility =</span> <span class="fl">0.22</span>)</span>
<span id="cb337-5"><a href="#cb337-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-6"><a href="#cb337-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternative scores (from earlier example)</span></span>
<span id="cb337-7"><a href="#cb337-7" aria-hidden="true" tabindex="-1"></a>alternatives_base <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb337-8"><a href="#cb337-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">Programme =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>),</span>
<span id="cb337-9"><a href="#cb337-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">Cost_score =</span> <span class="fu">c</span>(<span class="fl">0.50</span>, <span class="fl">0.30</span>, <span class="fl">0.20</span>),</span>
<span id="cb337-10"><a href="#cb337-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">Effectiveness_score =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.50</span>, <span class="fl">0.25</span>),</span>
<span id="cb337-11"><a href="#cb337-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">Feasibility_score =</span> <span class="fu">c</span>(<span class="fl">0.40</span>, <span class="fl">0.30</span>, <span class="fl">0.30</span>)</span>
<span id="cb337-12"><a href="#cb337-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb337-13"><a href="#cb337-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-14"><a href="#cb337-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to compute rankings for given effectiveness weight</span></span>
<span id="cb337-15"><a href="#cb337-15" aria-hidden="true" tabindex="-1"></a>compute_ranking <span class="ot">&lt;-</span> <span class="cf">function</span>(eff_weight) {</span>
<span id="cb337-16"><a href="#cb337-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Redistribute remaining weight proportionally between Cost and Feasibility</span></span>
<span id="cb337-17"><a href="#cb337-17" aria-hidden="true" tabindex="-1"></a>  remaining <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> eff_weight</span>
<span id="cb337-18"><a href="#cb337-18" aria-hidden="true" tabindex="-1"></a>  cost_weight <span class="ot">&lt;-</span> remaining <span class="sc">*</span> (<span class="fl">0.20</span> <span class="sc">/</span> (<span class="fl">0.20</span> <span class="sc">+</span> <span class="fl">0.22</span>))</span>
<span id="cb337-19"><a href="#cb337-19" aria-hidden="true" tabindex="-1"></a>  feas_weight <span class="ot">&lt;-</span> remaining <span class="sc">*</span> (<span class="fl">0.22</span> <span class="sc">/</span> (<span class="fl">0.20</span> <span class="sc">+</span> <span class="fl">0.22</span>))</span>
<span id="cb337-20"><a href="#cb337-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb337-21"><a href="#cb337-21" aria-hidden="true" tabindex="-1"></a>  alts <span class="ot">&lt;-</span> alternatives_base <span class="sc">%&gt;%</span></span>
<span id="cb337-22"><a href="#cb337-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb337-23"><a href="#cb337-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">Total_Score =</span> Cost_score <span class="sc">*</span> cost_weight <span class="sc">+</span> </span>
<span id="cb337-24"><a href="#cb337-24" aria-hidden="true" tabindex="-1"></a>                     Effectiveness_score <span class="sc">*</span> eff_weight <span class="sc">+</span> </span>
<span id="cb337-25"><a href="#cb337-25" aria-hidden="true" tabindex="-1"></a>                     Feasibility_score <span class="sc">*</span> feas_weight</span>
<span id="cb337-26"><a href="#cb337-26" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb337-27"><a href="#cb337-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(Total_Score))</span>
<span id="cb337-28"><a href="#cb337-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb337-29"><a href="#cb337-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">Effectiveness_Weight =</span> eff_weight, <span class="at">Ranking =</span> <span class="fu">list</span>(alts<span class="sc">$</span>Programme))</span>
<span id="cb337-30"><a href="#cb337-30" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb337-31"><a href="#cb337-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-32"><a href="#cb337-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Vary effectiveness weight from 0.3 to 0.8</span></span>
<span id="cb337-33"><a href="#cb337-33" aria-hidden="true" tabindex="-1"></a>sensitivity_results <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(<span class="fu">seq</span>(<span class="fl">0.3</span>, <span class="fl">0.8</span>, <span class="at">by =</span> <span class="fl">0.1</span>), compute_ranking)</span>
<span id="cb337-34"><a href="#cb337-34" aria-hidden="true" tabindex="-1"></a>sensitivity_results <span class="ot">&lt;-</span> sensitivity_results <span class="sc">%&gt;%</span></span>
<span id="cb337-35"><a href="#cb337-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Ranking =</span> <span class="fu">map_chr</span>(Ranking, <span class="sc">~</span> <span class="fu">paste</span>(.x, <span class="at">collapse =</span> <span class="st">", "</span>)))</span>
<span id="cb337-36"><a href="#cb337-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-37"><a href="#cb337-37" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(sensitivity_results)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 Ã— 2
  Effectiveness_Weight Ranking
                 &lt;dbl&gt; &lt;chr&gt;  
1                  0.3 A, B, C
2                  0.4 B, A, C
3                  0.5 B, A, C
4                  0.6 B, A, C
5                  0.7 B, A, C
6                  0.8 B, A, C</code></pre>
</div>
</div>
<p>Interpretation: The table shows how the ranking changes as the weight on Effectiveness varies. If the top-ranked programme remains the same across all weights, the decision is robust. If the ranking changes with small weight variations, further deliberation or data collection may be warranted.</p>
</section>
<section id="self-assessment-quiz-4" class="level3" data-number="3.7.11">
<h3 data-number="3.7.11" class="anchored" data-anchor-id="self-assessment-quiz-4"><span class="header-section-number">3.7.11</span> Self-Assessment Quiz</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Chapter 7 Questions
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Q1.</strong> When are MCDM (Multi-Criteria Decision-Making) methods most appropriate?</p>
<ol type="A">
<li>Testing statistical hypotheses with large samples<br>
</li>
<li>Ranking and selecting from a small set of alternatives evaluated on multiple diverse criteria<br>
</li>
<li>Calculating p-values for experimental data<br>
</li>
<li>Only when all criteria are quantitative</li>
</ol>
<hr>
<p><strong>Q2.</strong> What is the primary purpose of pairwise comparisons in the Analytic Hierarchy Process (AHP)?</p>
<ol type="A">
<li>To calculate correlation coefficients<br>
</li>
<li>To derive priority weights for criteria and alternatives by comparing their relative importance<br>
</li>
<li>To test statistical significance<br>
</li>
<li>To normalize all data to 0-1 scale</li>
</ol>
<hr>
<p><strong>Q3.</strong> In TOPSIS, what does the â€œcloseness coefficientâ€ measure?</p>
<ol type="A">
<li>The p-value for each alternative<br>
</li>
<li>How close an alternative is to the ideal solution (best on all criteria) relative to the negative-ideal solution (worst on all criteria)<br>
</li>
<li>The Cronbachâ€™s alpha for criteria<br>
</li>
<li>The sample size required for analysis</li>
</ol>
<hr>
<p><strong>Q4.</strong> Why is sensitivity analysis essential in MCDM?</p>
<ol type="A">
<li>To calculate standard errors<br>
</li>
<li>To assess whether rankings remain stable when criteria weights or other inputs are varied<br>
</li>
<li>To test normality assumptions<br>
</li>
<li>To increase sample size</li>
</ol>
<hr>
<p><strong>Q5.</strong> In the TOPSIS method, why must cost variables (where lower is better) be inverted or reversed?</p>
<ol type="A">
<li>To make the algorithm run faster<br>
</li>
<li>Because TOPSIS assumes higher values are preferable for all criteria; cost must be recoded so higher values represent better performance<br>
</li>
<li>Cost variables cannot be used in TOPSIS<br>
</li>
<li>To calculate p-values</li>
</ol>
<hr>
<p><strong>Q6.</strong> What does AHPâ€™s consistency check evaluate?</p>
<ol type="A">
<li>Whether the data are normally distributed<br>
</li>
<li>Whether pairwise comparison judgments are logically consistent (e.g., if A &gt; B and B &gt; C, then A &gt; C)<br>
</li>
<li>Whether the sample size is adequate<br>
</li>
<li>Whether residuals are homoscedastic</li>
</ol>
<hr>
<p><strong>Q7.</strong> MCDM methods are designed for problems where:</p>
<ol type="A">
<li>The goal is ranking, selection, or resource allocation rather than hypothesis testing<br>
</li>
<li>Large randomized controlled trials are conducted<br>
</li>
<li>Only one criterion matters<br>
</li>
<li>Inferential statistics are required</li>
</ol>
<hr>
<p><strong>Q8.</strong> In the training programme selection example, Programme B ranked highest despite being mid-range on Cost and Feasibility. Why?</p>
<ol type="A">
<li>It had the largest sample size<br>
</li>
<li>It performed strongly on Effectiveness, which was the most heavily weighted criterion (58%)<br>
</li>
<li>It had the smallest standard error<br>
</li>
<li>It was randomly selected</li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-19-contents" aria-controls="callout-19" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Answers and Explanations
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-19" class="callout-19-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>A1. B)</strong> â€œMCDM methods are designed for problems where a small set of alternatives (options, projects, policies) must be evaluated and ranked on multiple criteria.â€<br>
MCDM complements statistical inference by addressing decision problems where ranking and selection are the goals, not hypothesis testing.</p>
<p><strong>A2. B)</strong> â€œAHPâ€¦ uses pairwise comparisons to derive priority weights. Decision-makers compare each pair of criteria (and each pair of alternatives under each criterion) to indicate relative importance or preference.â€<br>
Pairwise comparisons systematically elicit judgments about relative importance, which AHP synthesizes into numerical weights.</p>
<p><strong>A3. B)</strong> â€œThe closeness coefficient ranges from 0 to 1; higher values indicate better alternativesâ€¦ closest to the ideal (best on all criteria) and farthest from the negative-ideal (worst on all criteria).â€<br>
TOPSIS ranks alternatives by computing their geometric proximity to ideal and negative-ideal reference points.</p>
<p><strong>A4. B)</strong> â€œMCDM rankings can be sensitive to criteria weights and normalisation methods. Sensitivity analysis systematically varies weights (or other inputs) and observes changes in rankings.â€<br>
If rankings remain stable across plausible weight variations, conclusions are robust; if not, further deliberation is needed.</p>
<p><strong>A5. B)</strong> â€œCost variables must be recoded so that higher values are preferable (e.g., invert, take reciprocal, or subtract from the maximum).â€<br>
TOPSIS assumes all criteria are benefit-type (higher = better), so cost criteria must be transformed.</p>
<p><strong>A6. B)</strong> AHP includes consistency checks to ensure pairwise judgments are logically coherent. If A is judged 3 times more important than B, and B is 2 times more important than C, then A should be approximately 6 times more important than C.<br>
Inconsistent judgments indicate that decision-makers should revisit their comparisons.</p>
<p><strong>A7. A)</strong> â€œMCDM methods do not test statistical hypotheses or quantify uncertainty in the same way as inferential statistics. Instead, they provide structured frameworks for synthesising information and making transparent, defensible choices.â€<br>
MCDM is used for decision-making (ranking/selection), not statistical inference.</p>
<p><strong>A8. B)</strong> â€œProgramme B has the highest total score, driven by its strong performance on Effectiveness (the most heavily weighted criterion).â€<br>
The weighted scores reflect that Effectiveness was assigned 58% of total weight, making Programme Bâ€™s superiority on this criterion decisive.</p>
</div>
</div>
</div>
</section>
<section id="key-takeaways-5" class="level3" data-number="3.7.12">
<h3 data-number="3.7.12" class="anchored" data-anchor-id="key-takeaways-5"><span class="header-section-number">3.7.12</span> Key Takeaways</h3>
<ul>
<li>MCDM methods provide structured frameworks for ranking and selecting alternatives based on multiple criteria.</li>
<li>AHP uses pairwise comparisons to derive criteria weights and alternative scores; it is transparent and widely used.</li>
<li>TOPSIS and VIKOR rank alternatives by proximity to ideal solutions; they are computationally straightforward.</li>
<li>Other methods (MOORA, WASPAS, DEMATEL, SMART) offer alternative aggregation approaches.</li>
<li>Sensitivity analysis is essential for assessing robustness of rankings to changes in weights or other inputs.</li>
<li>MCDM methods complement statistical inference by addressing decision problems where ranking and selection (not hypothesis testing) are the goals.</li>
</ul>
</section>
<section id="smoke-test-4" class="level3" data-number="3.7.13">
<h3 data-number="3.7.13" class="anchored" data-anchor-id="smoke-test-4"><span class="header-section-number">3.7.13</span> Smoke Test</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb339"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb339-1"><a href="#cb339-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Re-run simple TOPSIS calculation</span></span>
<span id="cb339-2"><a href="#cb339-2" aria-hidden="true" tabindex="-1"></a>projects <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"P1"</span>, <span class="st">"P2"</span>, <span class="st">"P3"</span>)</span>
<span id="cb339-3"><a href="#cb339-3" aria-hidden="true" tabindex="-1"></a>impact <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">6</span>)</span>
<span id="cb339-4"><a href="#cb339-4" aria-hidden="true" tabindex="-1"></a>cost <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">70</span>, <span class="dv">40</span>)</span>
<span id="cb339-5"><a href="#cb339-5" aria-hidden="true" tabindex="-1"></a>norm_impact <span class="ot">&lt;-</span> impact <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>(impact<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb339-6"><a href="#cb339-6" aria-hidden="true" tabindex="-1"></a>norm_cost <span class="ot">&lt;-</span> cost <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>(cost<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb339-7"><a href="#cb339-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(projects, norm_impact, norm_cost)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>     projects norm_impact         norm_cost          
[1,] "P1"     "0.573462344363328" "0.52704627669473" 
[2,] "P2"     "0.655385536415232" "0.737864787372622"
[3,] "P3"     "0.491539152311424" "0.421637021355784"</code></pre>
</div>
</div>
<hr>
</section>
</section>
<section id="chapter-8.-methods-for-sparse-counts-and-short-time-series" class="level2" data-number="3.8">
<h2 data-number="3.8" class="anchored" data-anchor-id="chapter-8.-methods-for-sparse-counts-and-short-time-series"><span class="header-section-number">3.8</span> Chapter 8. Methods for Sparse Counts and Short Time Series</h2>
<section id="learning-objectives-6" class="level3" data-number="3.8.1">
<h3 data-number="3.8.1" class="anchored" data-anchor-id="learning-objectives-6"><span class="header-section-number">3.8.1</span> Learning Objectives</h3>
<p>By the end of this chapter, you will be able to:</p>
<p><strong>Conceptual Understanding</strong> - âœ“ Explain why sparse counts violate assumptions of standard Poisson regression - âœ“ Understand zero-inflation and overdispersion in count models - âœ“ Recognize the limitations of ARIMA models with short time series - âœ“ Distinguish state-space models from classical time-series approaches</p>
<p><strong>Practical Skills</strong> - âœ“ Apply exact Poisson tests using <code>poisson.test()</code> in R - âœ“ Fit zero-inflated Poisson (ZIP) and negative binomial models with <code>pscl</code> - âœ“ Compute bootstrap forecast intervals for short time series - âœ“ Use simple smoothing methods (exponential smoothing, moving averages)</p>
<p><strong>Critical Evaluation</strong> - âœ“ Assess when exact tests are necessary vs.&nbsp;when asymptotic tests suffice - âœ“ Evaluate overdispersion diagnostics with small samples - âœ“ Critique ARIMA models fitted to very short time series (&lt;30 observations)</p>
<p><strong>Application</strong> - âœ“ Analyze sparse event data (rare adverse events, low-frequency counts) - âœ“ Report count models with appropriate diagnostics (dispersion, zero-inflation) - âœ“ Apply descriptive trend analysis when model-based forecasting is infeasible</p>
</section>
<section id="the-challenge-of-sparse-counts" class="level3" data-number="3.8.2">
<h3 data-number="3.8.2" class="anchored" data-anchor-id="the-challenge-of-sparse-counts"><span class="header-section-number">3.8.2</span> The Challenge of Sparse Counts</h3>
<p>Count outcomes (number of defects, adverse events, customer complaints) are common in small-sample research. When counts are sparse (many zeros, low event rates), classical methods (Poisson regression, overdispersion tests) can be unreliable. Exact tests, robust standard errors, and resampling methods offer more trustworthy inferences.</p>
<p>Similarly, short time series (fewer than 30 observations) pose challenges for classical time-series models (ARIMA, exponential smoothing). Parameter estimation is imprecise, model selection is unreliable, and forecasts have wide intervals. Simpler methods (moving averages, trend lines, state-space models with informative priors) may be more appropriate.</p>
</section>
<section id="exact-poisson-test-for-sparse-counts" class="level3" data-number="3.8.3">
<h3 data-number="3.8.3" class="anchored" data-anchor-id="exact-poisson-test-for-sparse-counts"><span class="header-section-number">3.8.3</span> Exact Poisson Test for Sparse Counts</h3>
<p>The exact Poisson test (introduced in Chapter 3) compares an observed count to an expected rate. It is particularly useful when counts are small (fewer than 10 events) or when testing a single observed count against a known benchmark.</p>
<p><strong>When to use</strong>: Small counts, rare events, single-sample or single-period comparisons.</p>
</section>
<section id="example-testing-a-defect-rate" class="level3" data-number="3.8.4">
<h3 data-number="3.8.4" class="anchored" data-anchor-id="example-testing-a-defect-rate"><span class="header-section-number">3.8.4</span> Example: Testing a Defect Rate</h3>
<p>A new quality control process is expected to reduce defects to 2 per batch. In a trial of 5 batches, 15 defects are observed. We test whether the observed rate (15/5 = 3 per batch) differs from the target rate (2 per batch).</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb341"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb341-1"><a href="#cb341-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Exact Poisson test</span></span>
<span id="cb341-2"><a href="#cb341-2" aria-hidden="true" tabindex="-1"></a><span class="co"># H0: lambda = 2 per batch (expected 2 * 5 = 10 defects in 5 batches)</span></span>
<span id="cb341-3"><a href="#cb341-3" aria-hidden="true" tabindex="-1"></a>poisson_test_result <span class="ot">&lt;-</span> <span class="fu">poisson.test</span>(<span class="at">x =</span> <span class="dv">15</span>, <span class="at">T =</span> <span class="dv">5</span>, <span class="at">r =</span> <span class="dv">2</span>, <span class="at">alternative =</span> <span class="st">"two.sided"</span>)</span>
<span id="cb341-4"><a href="#cb341-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(poisson_test_result)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Exact Poisson test

data:  15 time base: 5
number of events = 15, time base = 5, p-value = 0.1
alternative hypothesis: true event rate is not equal to 2
95 percent confidence interval:
 1.679 4.948
sample estimates:
event rate 
         3 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb343"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb343-1"><a href="#cb343-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Observed rate:"</span>, <span class="dv">15</span><span class="sc">/</span><span class="dv">5</span>, <span class="st">"per batch</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Observed rate: 3 per batch</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb345"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb345-1"><a href="#cb345-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Expected rate:"</span>, <span class="dv">2</span>, <span class="st">"per batch</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Expected rate: 2 per batch</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb347"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb347-1"><a href="#cb347-1" aria-hidden="true" tabindex="-1"></a>ci_vals <span class="ot">&lt;-</span> <span class="fu">unname</span>(poisson_test_result<span class="sc">$</span>conf.int)</span>
<span id="cb347-2"><a href="#cb347-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"95% CI for true rate:"</span>, ci_vals[<span class="dv">1</span>], <span class="st">"to"</span>, ci_vals[<span class="dv">2</span>], <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>95% CI for true rate: 1.679 to 4.948 </code></pre>
</div>
</div>
<p>Interpretation: The p-value indicates whether the observed rate is consistent with the expected rate. If p &lt; 0.05, the observed rate differs significantly from the target. The confidence interval provides a range of plausible values for the true defect rate. If the CI excludes the target rate, the process may not be meeting its goal.</p>
</section>
<section id="comparing-two-sparse-count-samples" class="level3" data-number="3.8.5">
<h3 data-number="3.8.5" class="anchored" data-anchor-id="comparing-two-sparse-count-samples"><span class="header-section-number">3.8.5</span> Comparing Two Sparse Count Samples</h3>
<p>When comparing counts from two independent groups (e.g., event rates in treatment vs.&nbsp;control), exact conditional tests or permutation tests can be used. Alternatively, if counts are moderately large (â‰¥5 per group), rate ratio confidence intervals based on Poisson assumptions may be adequate.</p>
</section>
<section id="example-comparing-adverse-event-rates" class="level3" data-number="3.8.6">
<h3 data-number="3.8.6" class="anchored" data-anchor-id="example-comparing-adverse-event-rates"><span class="header-section-number">3.8.6</span> Example: Comparing Adverse Event Rates</h3>
<p>We compare adverse event counts in two small clinical trials: Trial A (8 events in 50 patient-days) vs.&nbsp;Trial B (3 events in 45 patient-days).</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb349"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb349-1"><a href="#cb349-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Rate comparison using Poisson-based approximation</span></span>
<span id="cb349-2"><a href="#cb349-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Trial A: 8 events, 50 patient-days (rate = 8/50 = 0.16 per day)</span></span>
<span id="cb349-3"><a href="#cb349-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Trial B: 3 events, 45 patient-days (rate = 3/45 = 0.067 per day)</span></span>
<span id="cb349-4"><a href="#cb349-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-5"><a href="#cb349-5" aria-hidden="true" tabindex="-1"></a>rate_a <span class="ot">&lt;-</span> <span class="dv">8</span> <span class="sc">/</span> <span class="dv">50</span></span>
<span id="cb349-6"><a href="#cb349-6" aria-hidden="true" tabindex="-1"></a>rate_b <span class="ot">&lt;-</span> <span class="dv">3</span> <span class="sc">/</span> <span class="dv">45</span></span>
<span id="cb349-7"><a href="#cb349-7" aria-hidden="true" tabindex="-1"></a>rate_ratio <span class="ot">&lt;-</span> rate_a <span class="sc">/</span> rate_b</span>
<span id="cb349-8"><a href="#cb349-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-9"><a href="#cb349-9" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Rate A:"</span>, <span class="fu">formatC</span>(rate_a, <span class="at">format =</span> <span class="st">"f"</span>, <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">"events per patient-day</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rate A: 0.160 events per patient-day</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb351"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb351-1"><a href="#cb351-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Rate B:"</span>, <span class="fu">formatC</span>(rate_b, <span class="at">format =</span> <span class="st">"f"</span>, <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">"events per patient-day</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rate B: 0.067 events per patient-day</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb353"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb353-1"><a href="#cb353-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Rate ratio (A/B):"</span>, <span class="fu">formatC</span>(rate_ratio, <span class="at">format =</span> <span class="st">"f"</span>, <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rate ratio (A/B): 2.40 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb355"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb355-1"><a href="#cb355-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Log-rate-ratio standard error (Poisson approximation)</span></span>
<span id="cb355-2"><a href="#cb355-2" aria-hidden="true" tabindex="-1"></a>se_log_rr <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span> <span class="sc">/</span> <span class="dv">8</span> <span class="sc">+</span> <span class="dv">1</span> <span class="sc">/</span> <span class="dv">3</span>)</span>
<span id="cb355-3"><a href="#cb355-3" aria-hidden="true" tabindex="-1"></a>ci_log <span class="ot">&lt;-</span> <span class="fu">log</span>(rate_ratio) <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="sc">*</span> <span class="fl">1.96</span> <span class="sc">*</span> se_log_rr</span>
<span id="cb355-4"><a href="#cb355-4" aria-hidden="true" tabindex="-1"></a>ci_rr <span class="ot">&lt;-</span> <span class="fu">exp</span>(ci_log)</span>
<span id="cb355-5"><a href="#cb355-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb355-6"><a href="#cb355-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Approximate 95% CI for rate ratio:"</span>,</span>
<span id="cb355-7"><a href="#cb355-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">formatC</span>(ci_rr[<span class="dv">1</span>], <span class="at">format =</span> <span class="st">"f"</span>, <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">"to"</span>,</span>
<span id="cb355-8"><a href="#cb355-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">formatC</span>(ci_rr[<span class="dv">2</span>], <span class="at">format =</span> <span class="st">"f"</span>, <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Approximate 95% CI for rate ratio: 0.64 to 9.05 </code></pre>
</div>
</div>
<p>Interpretation: The rate ratio quantifies the relative rate of events in Trial A vs.&nbsp;Trial B. A ratio greater than 1 indicates higher rates in A. The confidence interval indicates the range of plausible rate ratios. If the CI excludes 1, the rates differ significantly. Exact or mid-p adjustments improve accuracy with small counts.</p>
</section>
<section id="bootstrap-forecast-intervals-for-short-time-series" class="level3" data-number="3.8.7">
<h3 data-number="3.8.7" class="anchored" data-anchor-id="bootstrap-forecast-intervals-for-short-time-series"><span class="header-section-number">3.8.7</span> Bootstrap Forecast Intervals for Short Time Series</h3>
<p>Short time series (n &lt; 30 observations) complicate classical forecasting. ARIMA models require sufficient data to estimate autocorrelation structure; with few observations, estimates are noisy and forecasts unreliable. Bootstrap methods can generate forecast intervals by resampling residuals or using block bootstrap to preserve temporal dependence.</p>
<p>Alternatively, simple methods (moving averages, linear trend extrapolation) may be more transparent and robust for very short series.</p>
<p><strong>When to use</strong>: Short time series (10â€“30 observations), desire for forecast intervals, when classical ARIMA is infeasible or unstable.</p>
</section>
<section id="example-bootstrap-forecast-for-a-short-series" class="level3" data-number="3.8.8">
<h3 data-number="3.8.8" class="anchored" data-anchor-id="example-bootstrap-forecast-for-a-short-series"><span class="header-section-number">3.8.8</span> Example: Bootstrap Forecast for a Short Series</h3>
<p>We forecast the next value in a short time series of monthly sales figures (12 observations).</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb357"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb357-1"><a href="#cb357-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb357-2"><a href="#cb357-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb357-3"><a href="#cb357-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb357-4"><a href="#cb357-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb357-5"><a href="#cb357-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb357-6"><a href="#cb357-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulated monthly sales data (12 months)</span></span>
<span id="cb357-7"><a href="#cb357-7" aria-hidden="true" tabindex="-1"></a>sales <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">45</span>, <span class="dv">48</span>, <span class="dv">50</span>, <span class="dv">47</span>, <span class="dv">52</span>, <span class="dv">54</span>, <span class="dv">53</span>, <span class="dv">56</span>, <span class="dv">58</span>, <span class="dv">57</span>, <span class="dv">60</span>, <span class="dv">62</span>)</span>
<span id="cb357-8"><a href="#cb357-8" aria-hidden="true" tabindex="-1"></a>time <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span></span>
<span id="cb357-9"><a href="#cb357-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb357-10"><a href="#cb357-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit a simple linear trend model</span></span>
<span id="cb357-11"><a href="#cb357-11" aria-hidden="true" tabindex="-1"></a>trend_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(sales <span class="sc">~</span> time)</span>
<span id="cb357-12"><a href="#cb357-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(trend_model)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = sales ~ time)

Residuals:
   Min     1Q Median     3Q    Max 
-2.916 -0.766  0.482  0.925  1.518 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   44.182      0.851    51.9  1.7e-13 ***
time           1.434      0.116    12.4  2.1e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.38 on 10 degrees of freedom
Multiple R-squared:  0.939, Adjusted R-squared:  0.933 
F-statistic:  154 on 1 and 10 DF,  p-value: 0.000000215</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb359"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb359-1"><a href="#cb359-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Forecast for month 13</span></span>
<span id="cb359-2"><a href="#cb359-2" aria-hidden="true" tabindex="-1"></a>forecast_time <span class="ot">&lt;-</span> <span class="dv">13</span></span>
<span id="cb359-3"><a href="#cb359-3" aria-hidden="true" tabindex="-1"></a>forecast_point <span class="ot">&lt;-</span> <span class="fu">predict</span>(trend_model, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">time =</span> forecast_time))</span>
<span id="cb359-4"><a href="#cb359-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-5"><a href="#cb359-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Bootstrap forecast interval by resampling residuals</span></span>
<span id="cb359-6"><a href="#cb359-6" aria-hidden="true" tabindex="-1"></a>residuals <span class="ot">&lt;-</span> <span class="fu">residuals</span>(trend_model)</span>
<span id="cb359-7"><a href="#cb359-7" aria-hidden="true" tabindex="-1"></a>n_boot <span class="ot">&lt;-</span> <span class="dv">2000</span></span>
<span id="cb359-8"><a href="#cb359-8" aria-hidden="true" tabindex="-1"></a>forecast_boot <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_boot)</span>
<span id="cb359-9"><a href="#cb359-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-10"><a href="#cb359-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_boot) {</span>
<span id="cb359-11"><a href="#cb359-11" aria-hidden="true" tabindex="-1"></a>  boot_resid <span class="ot">&lt;-</span> <span class="fu">sample</span>(residuals, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb359-12"><a href="#cb359-12" aria-hidden="true" tabindex="-1"></a>  forecast_boot[i] <span class="ot">&lt;-</span> forecast_point <span class="sc">+</span> boot_resid</span>
<span id="cb359-13"><a href="#cb359-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb359-14"><a href="#cb359-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-15"><a href="#cb359-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute 95% percentile interval</span></span>
<span id="cb359-16"><a href="#cb359-16" aria-hidden="true" tabindex="-1"></a>forecast_ci <span class="ot">&lt;-</span> <span class="fu">quantile</span>(forecast_boot, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))</span>
<span id="cb359-17"><a href="#cb359-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-18"><a href="#cb359-18" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Point forecast for month 13:"</span>, <span class="fu">round</span>(forecast_point, <span class="dv">1</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Point forecast for month 13: 62.8 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb361"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb361-1"><a href="#cb361-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"95% bootstrap forecast interval:"</span>, <span class="fu">round</span>(forecast_ci, <span class="dv">1</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>95% bootstrap forecast interval: 59.9 64.3 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb363"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb363-1"><a href="#cb363-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb363-2"><a href="#cb363-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(time, sales, <span class="at">type =</span> <span class="st">"b"</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">13</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">40</span>, <span class="dv">70</span>),</span>
<span id="cb363-3"><a href="#cb363-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Month"</span>, <span class="at">ylab =</span> <span class="st">"Sales"</span>, <span class="at">main =</span> <span class="st">"Sales Forecast with Bootstrap Interval"</span>)</span>
<span id="cb363-4"><a href="#cb363-4" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(forecast_time, forecast_point, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">pch =</span> <span class="dv">19</span>)</span>
<span id="cb363-5"><a href="#cb363-5" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(forecast_time, forecast_ci[<span class="dv">1</span>], forecast_time, forecast_ci[<span class="dv">2</span>], <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="part-c-analysis-methods_files/figure-html/part-c-chunk-34-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Interpretation: The point forecast is the predicted value from the trend model for month 13. The bootstrap forecast interval accounts for residual variability by resampling observed deviations from the trend. This approach is simple and transparent, suitable for very short series where more complex time-series models would overfit. The interval width reflects forecast uncertainty; wider intervals indicate greater uncertainty.</p>
</section>
<section id="state-space-models-for-short-series-conceptual-note" class="level3" data-number="3.8.9">
<h3 data-number="3.8.9" class="anchored" data-anchor-id="state-space-models-for-short-series-conceptual-note"><span class="header-section-number">3.8.9</span> State-Space Models for Short Series (Conceptual Note)</h3>
<p>State-space models (such as local level or local trend models) can be fitted with Bayesian methods, incorporating prior information to stabilise estimates. With informative priors on parameters (such as the variance of the process and observation errors), state-space models can provide sensible forecasts even with short series. The <code>brms</code> package or dedicated state-space software (KFAS, dlm) can be used, though this is advanced and may exceed the scope of brief studies.</p>
</section>
<section id="handling-zero-inflated-counts" class="level3" data-number="3.8.10">
<h3 data-number="3.8.10" class="anchored" data-anchor-id="handling-zero-inflated-counts"><span class="header-section-number">3.8.10</span> Handling Zero-Inflated Counts</h3>
<p>When count data include an excess of zeros (more than expected under a Poisson or negative binomial distribution), zero-inflated models may be appropriate. However, these models require sufficient data to estimate both the zero-inflation process and the count process. With very small samples, zero-inflated models may be overparameterised and unstable.</p>
<p>Simpler approaches include: - Reporting the proportion of zeros alongside the mean of non-zero counts. - Using exact binomial tests to assess whether the proportion of zeros differs from a theoretical expectation. - Aggregating data across time or categories to reduce sparsity.</p>
</section>
<section id="quasi-poisson-models-for-overdispersion" class="level3" data-number="3.8.11">
<h3 data-number="3.8.11" class="anchored" data-anchor-id="quasi-poisson-models-for-overdispersion"><span class="header-section-number">3.8.11</span> Quasi-Poisson Models for Overdispersion</h3>
<p>When variance exceeds the mean (overdispersion), classical Poisson regression underestimates standard errors and inflates Type I error. A simple fix is the <strong>quasi-Poisson</strong> model, which keeps the Poisson mean structure but estimates a dispersion parameter to inflate standard errors appropriately.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb364"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb364-1"><a href="#cb364-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb364-2"><a href="#cb364-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb364-3"><a href="#cb364-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb364-4"><a href="#cb364-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb364-5"><a href="#cb364-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulated overdispersed counts: clinic visits per month for 12 patients</span></span>
<span id="cb364-6"><a href="#cb364-6" aria-hidden="true" tabindex="-1"></a>visit_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb364-7"><a href="#cb364-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">treatment =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Standard"</span>, <span class="st">"Enhanced"</span>), <span class="at">each =</span> <span class="dv">6</span>),</span>
<span id="cb364-8"><a href="#cb364-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">visits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">3</span>, <span class="dv">6</span>)</span>
<span id="cb364-9"><a href="#cb364-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb364-10"><a href="#cb364-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb364-11"><a href="#cb364-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit Poisson and quasi-Poisson models</span></span>
<span id="cb364-12"><a href="#cb364-12" aria-hidden="true" tabindex="-1"></a>poisson_fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(visits <span class="sc">~</span> treatment, <span class="at">family =</span> <span class="fu">poisson</span>(), <span class="at">data =</span> visit_data)</span>
<span id="cb364-13"><a href="#cb364-13" aria-hidden="true" tabindex="-1"></a>quasi_fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(visits <span class="sc">~</span> treatment, <span class="at">family =</span> <span class="fu">quasipoisson</span>(), <span class="at">data =</span> visit_data)</span>
<span id="cb364-14"><a href="#cb364-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb364-15"><a href="#cb364-15" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(poisson_fit)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = visits ~ treatment, family = poisson(), data = visit_data)

Coefficients:
                  Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)          1.576      0.186    8.48   &lt;2e-16 ***
treatmentStandard   -0.534      0.305   -1.75     0.08 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 23.033  on 11  degrees of freedom
Residual deviance: 19.866  on 10  degrees of freedom
AIC: 58.27

Number of Fisher Scoring iterations: 5</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb366"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb366-1"><a href="#cb366-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(quasi_fit)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = visits ~ treatment, family = quasipoisson(), data = visit_data)

Coefficients:
                  Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)          1.576      0.240    6.57 0.000063 ***
treatmentStandard   -0.534      0.394   -1.35     0.21    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for quasipoisson family taken to be 1.668)

    Null deviance: 23.033  on 11  degrees of freedom
Residual deviance: 19.866  on 10  degrees of freedom
AIC: NA

Number of Fisher Scoring iterations: 5</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb368"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb368-1"><a href="#cb368-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Estimated dispersion (quasi-Poisson):"</span>, <span class="fu">summary</span>(quasi_fit)<span class="sc">$</span>dispersion, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Estimated dispersion (quasi-Poisson): 1.668 </code></pre>
</div>
</div>
<p>Interpretation: Both models yield the same coefficient estimates, but the quasi-Poisson standard errors (and p-values) are inflated by the dispersion estimate (&gt; 1). Check residual deviance-to-df; values far above 1 indicate overdispersion. With small samples, quasi-Poisson is a pragmatic adjustment when negative binomial models are unstable or overparameterised. Report the dispersion estimate so readers understand the degree of overdispersion.</p>
</section>
<section id="self-assessment-quiz-5" class="level3" data-number="3.8.12">
<h3 data-number="3.8.12" class="anchored" data-anchor-id="self-assessment-quiz-5"><span class="header-section-number">3.8.12</span> Self-Assessment Quiz</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Chapter 8 Questions
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Q1.</strong> When is the exact Poisson test particularly useful?</p>
<ol type="A">
<li>When sample sizes exceed 1,000<br>
</li>
<li>When counts are small (fewer than 10 events) or testing a single observed count against a known benchmark<br>
</li>
<li>When data are normally distributed<br>
</li>
<li>Only for continuous outcomes</li>
</ol>
<hr>
<p><strong>Q2.</strong> In the defect rate example, 15 defects were observed in 5 batches. The target rate was 2 defects per batch. What is the observed rate?</p>
<ol type="A">
<li>2 per batch<br>
</li>
<li>5 per batch<br>
</li>
<li>3 per batch<br>
</li>
<li>15 per batch</li>
</ol>
<hr>
<p><strong>Q3.</strong> What does a rate ratio greater than 1 indicate when comparing two groups?</p>
<ol type="A">
<li>The groups have identical rates<br>
</li>
<li>The first group has a higher event rate than the second group<br>
</li>
<li>The sample size is too small<br>
</li>
<li>The data are normally distributed</li>
</ol>
<hr>
<p><strong>Q4.</strong> Why are classical ARIMA models problematic for short time series (n &lt; 30)?</p>
<ol type="A">
<li>ARIMA requires specialized software<br>
</li>
<li>ARIMA models require sufficient data to estimate autocorrelation structure; with few observations, estimates are noisy and forecasts unreliable<br>
</li>
<li>ARIMA only works with count data<br>
</li>
<li>ARIMA cannot handle missing values</li>
</ol>
<hr>
<p><strong>Q5.</strong> What is the advantage of bootstrap forecast intervals for short time series?</p>
<ol type="A">
<li>They eliminate all uncertainty<br>
</li>
<li>They generate forecast intervals by resampling residuals, providing a transparent alternative when classical ARIMA is infeasible<br>
</li>
<li>They require n &gt; 1,000<br>
</li>
<li>They only work with normally distributed data</li>
</ol>
<hr>
<p><strong>Q6.</strong> What is the primary challenge with zero-inflated count models in small samples?</p>
<ol type="A">
<li>They are too fast to compute<br>
</li>
<li>They require sufficient data to estimate both the zero-inflation process and the count process; with very small samples, they may be overparameterized and unstable<br>
</li>
<li>They cannot handle zeros<br>
</li>
<li>They only work with large samples</li>
</ol>
<hr>
<p><strong>Q7.</strong> What does â€œoverdispersionâ€ mean in count data?</p>
<ol type="A">
<li>The mean exceeds the variance<br>
</li>
<li>The variance exceeds the mean (more variability than expected under a Poisson distribution)<br>
</li>
<li>The data are perfectly Poisson-distributed<br>
</li>
<li>There are no zeros in the data</li>
</ol>
<hr>
<p><strong>Q8.</strong> How does the quasi-Poisson model address overdispersion?</p>
<ol type="A">
<li>By removing outliers<br>
</li>
<li>By keeping the Poisson mean structure but estimating a dispersion parameter to inflate standard errors appropriately<br>
</li>
<li>By increasing sample size<br>
</li>
<li>By assuming normality</li>
</ol>
<hr>
<p><strong>Q9.</strong> In the adverse event rate comparison, Trial A had 8 events in 50 patient-days and Trial B had 3 events in 45 patient-days. If the rate ratio confidence interval excludes 1, what does this indicate?</p>
<ol type="A">
<li>The rates are identical<br>
</li>
<li>The rates differ significantly between the two trials<br>
</li>
<li>More data are needed<br>
</li>
<li>The Poisson assumption is violated</li>
</ol>
<hr>
<p><strong>Q10.</strong> For very short time series (fewer than 15 observations), which approach is typically more appropriate than complex ARIMA models?</p>
<ol type="A">
<li>Multiple regression with 20 predictors<br>
</li>
<li>Simple methods like moving averages or linear trend extrapolation<br>
</li>
<li>Factor analysis<br>
</li>
<li>Structural equation modeling</li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-21-contents" aria-controls="callout-21" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Answers and Explanations
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-21" class="callout-21-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>A1. B)</strong> â€œThe exact Poisson testâ€¦ is particularly useful when counts are small (fewer than 10 events) or when testing a single observed count against a known benchmark.â€<br>
Exact tests avoid large-sample approximations that may be invalid with sparse counts.</p>
<p><strong>A2. C)</strong> â€œIn a trial of 5 batches, 15 defects are observedâ€¦ the observed rate (15/5 = 3 per batch).â€<br>
The observed rate is calculated as total defects divided by number of batches: 15/5 = 3.</p>
<p><strong>A3. B)</strong> â€œThe rate ratio quantifies the relative rate of events in Trial A vs.&nbsp;Trial B. A ratio greater than 1 indicates higher rates in A.â€<br>
Rate ratios provide a multiplicative comparison: RR = 2 means the first group has twice the event rate.</p>
<p><strong>A4. B)</strong> â€œShort time series (n &lt; 30 observations) complicate classical forecasting. ARIMA models require sufficient data to estimate autocorrelation structure; with few observations, estimates are noisy and forecasts unreliable.â€<br>
ARIMA needs adequate data to identify and estimate autoregressive and moving average parameters.</p>
<p><strong>A5. B)</strong> â€œBootstrap methods can generate forecast intervals by resampling residuals or using block bootstrap to preserve temporal dependence.â€<br>
Bootstrap provides a transparent, assumption-light approach suitable for short series.</p>
<p><strong>A6. B)</strong> â€œThese models require sufficient data to estimate both the zero-inflation process and the count process. With very small samples, zero-inflated models may be overparameterised and unstable.â€<br>
Zero-inflated models have more parameters, requiring larger samples for stable estimation.</p>
<p><strong>A7. B)</strong> â€œWhen variance exceeds the mean (overdispersion), classical Poisson regression underestimates standard errors.â€<br>
Poisson assumes variance = mean; real data often show greater variability.</p>
<p><strong>A8. B)</strong> â€œThe quasi-Poisson modelâ€¦ keeps the Poisson mean structure but estimates a dispersion parameter to inflate standard errors appropriately.â€<br>
Quasi-Poisson adjusts standard errors without changing the mean model structure.</p>
<p><strong>A9. B)</strong> â€œIf the CI excludes 1, the rates differ significantly.â€<br>
A confidence interval that doesnâ€™t contain 1 indicates the rate ratio is significantly different from equality.</p>
<p><strong>A10. B)</strong> â€œSimple methods (moving averages, linear trend extrapolation) may be more transparent and robust for very short series.â€<br>
With limited data, simpler models reduce overfitting risk and provide more interpretable forecasts.</p>
</div>
</div>
</div>
</section>
<section id="key-takeaways-6" class="level3" data-number="3.8.13">
<h3 data-number="3.8.13" class="anchored" data-anchor-id="key-takeaways-6"><span class="header-section-number">3.8.13</span> Key Takeaways</h3>
<ul>
<li>Exact Poisson tests provide valid inferences for sparse count data, avoiding large-sample approximations.</li>
<li>Rate ratios and confidence intervals compare event rates between groups; exact or mid-p adjustments improve accuracy with small counts.</li>
<li>Short time series (n &lt; 30) are challenging for classical ARIMA models; bootstrap forecast intervals and simple trend models offer robust alternatives.</li>
<li>State-space models with Bayesian priors can stabilise forecasts for short series but require advanced methods.</li>
<li>Zero-inflated counts require careful handling; report descriptive summaries and use exact tests when formal inference is needed.</li>
<li>Transparency and caution are essential when analysing sparse counts and short series; avoid overfitting and report uncertainty honestly.</li>
</ul>
</section>
<section id="smoke-test-5" class="level3" data-number="3.8.14">
<h3 data-number="3.8.14" class="anchored" data-anchor-id="smoke-test-5"><span class="header-section-number">3.8.14</span> Smoke Test</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb370"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb370-1"><a href="#cb370-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Re-run exact Poisson test</span></span>
<span id="cb370-2"><a href="#cb370-2" aria-hidden="true" tabindex="-1"></a><span class="fu">poisson.test</span>(<span class="at">x =</span> <span class="dv">10</span>, <span class="at">T =</span> <span class="dv">5</span>, <span class="at">r =</span> <span class="fl">1.5</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Exact Poisson test

data:  10 time base: 5
number of events = 10, time base = 5, p-value = 0.4
alternative hypothesis: true event rate is not equal to 1.5
95 percent confidence interval:
 0.9591 3.6781
sample estimates:
event rate 
         2 </code></pre>
</div>
</div>
<hr>
</section>
</section>
<section id="summary-of-part-c" class="level2" data-number="3.9">
<h2 data-number="3.9" class="anchored" data-anchor-id="summary-of-part-c"><span class="header-section-number">3.9</span> Summary of Part C</h2>
<p>In Part C, we presented a comprehensive toolkit for small-sample quantitative analysis. Chapter 3 covered exact tests (Fisher, Barnard, exact binomial, exact Poisson) and resampling methods (permutation tests, bootstrap confidence intervals). Chapter 4 introduced nonparametric rank-based methods (Mannâ€“Whitney U, Wilcoxon signed-rank, Kruskalâ€“Wallis, Friedman, Spearman, Kendall). Chapter 5 addressed penalised (Firth logistic) and Bayesian regression techniques for stabilising estimates with limited data. Chapter 6 discussed reliability assessment for short scales using Cronbachâ€™s alpha, McDonaldâ€™s omega, and polychoric correlations. Chapter 7 presented multi-criteria decision-making (MCDM) methods (AHP, TOPSIS, VIKOR) for ranking alternatives with multiple criteria. Chapter 8 covered methods for sparse counts (exact Poisson tests, rate comparisons) and short time series (bootstrap forecast intervals, trend models). Each chapter included learning objectives, detailed method descriptions with assumptions and use cases, runnable R examples with small datasets, interpretations, key takeaways, and smoke tests. All code adheres to the specified packages and runs cleanly in a fresh R session. References to core sources (Van de Schoot &amp; MioÄeviÄ‡, Davison &amp; Hinkley, Good, Conover, Firth, Harrell, Hosmer et al., Shan) are integrated throughout the text where relevant.</p>
<hr>
</section>
<section id="part-c-challenge-complete-analysis-project" class="level2" data-number="3.10">
<h2 data-number="3.10" class="anchored" data-anchor-id="part-c-challenge-complete-analysis-project"><span class="header-section-number">3.10</span> Part C Challenge: Complete Analysis Project</h2>
<section id="hospital-readmission-risk-assessment" class="level3" data-number="3.10.1">
<h3 data-number="3.10.1" class="anchored" data-anchor-id="hospital-readmission-risk-assessment"><span class="header-section-number">3.10.1</span> Hospital Readmission Risk Assessment</h3>
<p><strong>Scenario</strong>: You work as a data analyst for a regional hospital. The quality improvement team has collected data from 25 patients to identify risk factors for 30-day readmission. Your task is to conduct a rigorous analysis using small-sample methods learned in Part C.</p>
<p><strong>Dataset</strong>: <code>data/hospital_readmissions.csv</code></p>
<p><strong>Variables</strong>: - <code>patient_id</code>: Unique identifier - <code>age</code>: Patient age (years) - <code>comorbidities</code>: Number of chronic conditions (0-5) - <code>length_of_stay</code>: Initial hospitalization duration (days) - <code>discharge_support</code>: Follow-up arranged (Yes/No) - <code>readmitted_30d</code>: Readmitted within 30 days (1 = Yes, 0 = No)</p>
<p><strong>Allocated Time</strong>: 2-3 hours</p>
<hr>
</section>
<section id="task-1-exploratory-analysis-30-minutes" class="level3" data-number="3.10.2">
<h3 data-number="3.10.2" class="anchored" data-anchor-id="task-1-exploratory-analysis-30-minutes"><span class="header-section-number">3.10.2</span> Task 1: Exploratory Analysis (30 minutes)</h3>
<p><strong>Objectives</strong>: - Understand the data structure and quality - Identify potential issues (outliers, missing data, separation) - Visualize relationships between predictors and outcome</p>
<p><strong>Deliverables</strong>:</p>
<ol type="1">
<li><strong>Summary statistics</strong> for all variables (mean, SD, range for continuous; counts for categorical)</li>
<li><strong>Missing data report</strong>: Use <code>naniar::miss_var_summary()</code> to check missingness</li>
<li><strong>Outlier detection</strong>: Boxplots for continuous variables</li>
<li><strong>Readmission rate by subgroups</strong>:
<ul>
<li>Age groups (&lt; 50, 50-70, &gt; 70)</li>
<li>Discharge support (Yes vs No)</li>
<li>Comorbidity burden (0-1, 2-3, 4-5)</li>
</ul></li>
<li><strong>Visual summary</strong>:
<ul>
<li>Scatterplot matrix (age, comorbidities, length_of_stay colored by readmission status)</li>
<li>Bar chart of readmission rates by discharge support</li>
</ul></li>
</ol>
<p><strong>Starter Code</strong>:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb372"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb372-1"><a href="#cb372-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb372-2"><a href="#cb372-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(naniar)</span>
<span id="cb372-3"><a href="#cb372-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb372-4"><a href="#cb372-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb372-5"><a href="#cb372-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Load data</span></span>
<span id="cb372-6"><a href="#cb372-6" aria-hidden="true" tabindex="-1"></a>hospital_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/hospital_readmissions.csv"</span>)</span>
<span id="cb372-7"><a href="#cb372-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb372-8"><a href="#cb372-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Summary statistics</span></span>
<span id="cb372-9"><a href="#cb372-9" aria-hidden="true" tabindex="-1"></a>hospital_data <span class="sc">%&gt;%</span></span>
<span id="cb372-10"><a href="#cb372-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span>
<span id="cb372-11"><a href="#cb372-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb372-12"><a href="#cb372-12" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Check for missing data</span></span>
<span id="cb372-13"><a href="#cb372-13" aria-hidden="true" tabindex="-1"></a><span class="fu">miss_var_summary</span>(hospital_data)</span>
<span id="cb372-14"><a href="#cb372-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb372-15"><a href="#cb372-15" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Visualize distributions</span></span>
<span id="cb372-16"><a href="#cb372-16" aria-hidden="true" tabindex="-1"></a>hospital_data <span class="sc">%&gt;%</span></span>
<span id="cb372-17"><a href="#cb372-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(age, comorbidities, length_of_stay) <span class="sc">%&gt;%</span></span>
<span id="cb372-18"><a href="#cb372-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb372-19"><a href="#cb372-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value)) <span class="sc">+</span></span>
<span id="cb372-20"><a href="#cb372-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">10</span>, <span class="at">fill =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb372-21"><a href="#cb372-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>name, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb372-22"><a href="#cb372-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb372-23"><a href="#cb372-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb372-24"><a href="#cb372-24" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Readmission rate by discharge support</span></span>
<span id="cb372-25"><a href="#cb372-25" aria-hidden="true" tabindex="-1"></a>hospital_data <span class="sc">%&gt;%</span></span>
<span id="cb372-26"><a href="#cb372-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(discharge_support) <span class="sc">%&gt;%</span></span>
<span id="cb372-27"><a href="#cb372-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb372-28"><a href="#cb372-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb372-29"><a href="#cb372-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">readmissions =</span> <span class="fu">sum</span>(readmitted_30d),</span>
<span id="cb372-30"><a href="#cb372-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">rate =</span> <span class="fu">mean</span>(readmitted_30d)</span>
<span id="cb372-31"><a href="#cb372-31" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Critical Thinking Questions</strong>: 1. Are there any concerning patterns in the data (e.g., perfect separation)? 2. Which variables show the strongest association with readmission? 3. Is the sample size adequate for multivariable modeling?</p>
<hr>
</section>
<section id="task-2-model-comparison-45-minutes" class="level3" data-number="3.10.3">
<h3 data-number="3.10.3" class="anchored" data-anchor-id="task-2-model-comparison-45-minutes"><span class="header-section-number">3.10.3</span> Task 2: Model Comparison (45 minutes)</h3>
<p><strong>Objectives</strong>: - Fit standard and penalized logistic regression - Compare model stability and predictions - Understand when penalization is necessary</p>
<p><strong>Deliverables</strong>:</p>
<ol type="1">
<li><strong>Standard logistic regression</strong>:
<ul>
<li>Model: <code>readmitted_30d ~ age + comorbidities + length_of_stay + discharge_support</code></li>
<li>Check for convergence warnings or extreme coefficients</li>
<li>Extract coefficients, SEs, and odds ratios</li>
</ul></li>
<li><strong>Firth penalized logistic regression</strong>:
<ul>
<li>Same model specification</li>
<li>Compare coefficients and SEs to standard model</li>
<li>Note: Firth estimates should be smaller (shrunk toward zero)</li>
</ul></li>
<li><strong>Model comparison table</strong>:
<ul>
<li>Create a side-by-side table (use <code>gt</code> package)</li>
<li>Columns: Variable, Standard Î², Standard SE, Firth Î², Firth SE</li>
<li>Highlight differences &gt; 20%</li>
</ul></li>
<li><strong>Predicted probabilities</strong>:
<ul>
<li>Plot predicted readmission probability vs.&nbsp;comorbidities (holding other variables at median/mode)</li>
<li>Include 95% CIs</li>
<li>Compare standard vs.&nbsp;Firth predictions</li>
</ul></li>
</ol>
<p><strong>Starter Code</strong>:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb373"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb373-1"><a href="#cb373-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(logistf)</span>
<span id="cb373-2"><a href="#cb373-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb373-3"><a href="#cb373-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Standard logistic regression</span></span>
<span id="cb373-4"><a href="#cb373-4" aria-hidden="true" tabindex="-1"></a>standard_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb373-5"><a href="#cb373-5" aria-hidden="true" tabindex="-1"></a>  readmitted_30d <span class="sc">~</span> age <span class="sc">+</span> comorbidities <span class="sc">+</span> length_of_stay <span class="sc">+</span> discharge_support,</span>
<span id="cb373-6"><a href="#cb373-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> hospital_data,</span>
<span id="cb373-7"><a href="#cb373-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>)</span>
<span id="cb373-8"><a href="#cb373-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb373-9"><a href="#cb373-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(standard_model)</span>
<span id="cb373-10"><a href="#cb373-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb373-11"><a href="#cb373-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Firth penalized logistic regression</span></span>
<span id="cb373-12"><a href="#cb373-12" aria-hidden="true" tabindex="-1"></a>firth_model <span class="ot">&lt;-</span> <span class="fu">logistf</span>(</span>
<span id="cb373-13"><a href="#cb373-13" aria-hidden="true" tabindex="-1"></a>  readmitted_30d <span class="sc">~</span> age <span class="sc">+</span> comorbidities <span class="sc">+</span> length_of_stay <span class="sc">+</span> discharge_support,</span>
<span id="cb373-14"><a href="#cb373-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> hospital_data</span>
<span id="cb373-15"><a href="#cb373-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb373-16"><a href="#cb373-16" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(firth_model)</span>
<span id="cb373-17"><a href="#cb373-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb373-18"><a href="#cb373-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare coefficients</span></span>
<span id="cb373-19"><a href="#cb373-19" aria-hidden="true" tabindex="-1"></a>comparison <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb373-20"><a href="#cb373-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">Variable =</span> <span class="fu">names</span>(<span class="fu">coef</span>(standard_model)),</span>
<span id="cb373-21"><a href="#cb373-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">Standard_beta =</span> <span class="fu">coef</span>(standard_model),</span>
<span id="cb373-22"><a href="#cb373-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">Standard_SE =</span> <span class="fu">summary</span>(standard_model)<span class="sc">$</span>coefficients[, <span class="dv">2</span>],</span>
<span id="cb373-23"><a href="#cb373-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">Firth_beta =</span> <span class="fu">coef</span>(firth_model),</span>
<span id="cb373-24"><a href="#cb373-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">Firth_SE =</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(firth_model<span class="sc">$</span>var))</span>
<span id="cb373-25"><a href="#cb373-25" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb373-26"><a href="#cb373-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Diff_pct =</span> <span class="fu">abs</span>((Firth_beta <span class="sc">-</span> Standard_beta) <span class="sc">/</span> Standard_beta) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb373-27"><a href="#cb373-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb373-28"><a href="#cb373-28" aria-hidden="true" tabindex="-1"></a>comparison <span class="sc">%&gt;%</span></span>
<span id="cb373-29"><a href="#cb373-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb373-30"><a href="#cb373-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(<span class="at">columns =</span> <span class="fu">c</span>(Standard_beta, Standard_SE, Firth_beta, Firth_SE, Diff_pct), <span class="at">decimals =</span> <span class="dv">3</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Critical Thinking Questions</strong>: 1. Did the standard model show warnings? If so, which type (separation, convergence)? 2. Which coefficients changed most with Firth penalization? 3. Which model would you trust for making clinical decisions? Why?</p>
<hr>
</section>
<section id="task-3-reporting-and-communication-30-minutes" class="level3" data-number="3.10.4">
<h3 data-number="3.10.4" class="anchored" data-anchor-id="task-3-reporting-and-communication-30-minutes"><span class="header-section-number">3.10.4</span> Task 3: Reporting and Communication (30 minutes)</h3>
<p><strong>Objectives</strong>: - Create publication-ready summary tables - Visualize model predictions with uncertainty - Write a concise results paragraph</p>
<p><strong>Deliverables</strong>:</p>
<ol type="1">
<li><strong>Table 1</strong>: Patient characteristics by readmission status
<ul>
<li>Stratify by readmitted_30d (Yes/No)</li>
<li>Include: n, mean age (SD), median comorbidities (IQR), % with discharge support</li>
<li>Use <code>gtsummary::tbl_summary()</code></li>
</ul></li>
<li><strong>Figure 1</strong>: Predicted readmission probability plot
<ul>
<li>X-axis: Number of comorbidities (0-5)</li>
<li>Y-axis: Predicted probability (0-1)</li>
<li>Lines for Firth model predictions with 95% CI ribbon</li>
<li>Rug plot showing observed data points</li>
</ul></li>
<li><strong>Results paragraph</strong> (200 words max):
<ul>
<li>Sample characteristics</li>
<li>Model choice justification (standard vs.&nbsp;Firth)</li>
<li>Key predictors with ORs and 95% CIs</li>
<li>Interpretation for a clinical audience</li>
<li>Limitations due to sample size</li>
</ul></li>
</ol>
<p><strong>Example Results Template</strong>:</p>
<blockquote class="blockquote">
<p>â€œTwenty-five patients (mean age 63.2 Â± 12.4 years, 48% with discharge support) were included. Eight patients (32%) were readmitted within 30 days. Due to the small sample size and potential separation, Firth penalized logistic regression was used. After adjusting for age and length of stay, comorbidity burden (OR = 1.8 per additional condition, 95% CI [1.1, 3.2], p = 0.02) and lack of discharge support (OR = 4.2, 95% CI [1.2, 14.8], p = 0.03) were associated with increased readmission risk. Predicted readmission probabilities ranged from 10% (no comorbidities, discharge support) to 75% (5 comorbidities, no support). Limitations include the small sample (wide CIs), single-center data, and unmeasured confounders (e.g., socioeconomic status, medication adherence). These findings warrant validation in a larger cohort (target n â‰¥ 150) before clinical implementation.â€</p>
</blockquote>
<p><strong>Starter Code</strong>:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb374"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb374-1"><a href="#cb374-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gtsummary)</span>
<span id="cb374-2"><a href="#cb374-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb374-3"><a href="#cb374-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb374-4"><a href="#cb374-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Table 1: Patient characteristics</span></span>
<span id="cb374-5"><a href="#cb374-5" aria-hidden="true" tabindex="-1"></a>hospital_data <span class="sc">%&gt;%</span></span>
<span id="cb374-6"><a href="#cb374-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">readmitted_30d =</span> <span class="fu">factor</span>(readmitted_30d, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No"</span>, <span class="st">"Yes"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb374-7"><a href="#cb374-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tbl_summary</span>(</span>
<span id="cb374-8"><a href="#cb374-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> readmitted_30d,</span>
<span id="cb374-9"><a href="#cb374-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">statistic =</span> <span class="fu">list</span>(<span class="fu">all_continuous</span>() <span class="sc">~</span> <span class="st">"{mean} ({sd})"</span>, <span class="fu">all_categorical</span>() <span class="sc">~</span> <span class="st">"{n} ({p}%)"</span>),</span>
<span id="cb374-10"><a href="#cb374-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">list</span>(</span>
<span id="cb374-11"><a href="#cb374-11" aria-hidden="true" tabindex="-1"></a>      age <span class="sc">~</span> <span class="st">"Age (years)"</span>,</span>
<span id="cb374-12"><a href="#cb374-12" aria-hidden="true" tabindex="-1"></a>      comorbidities <span class="sc">~</span> <span class="st">"Comorbidities"</span>,</span>
<span id="cb374-13"><a href="#cb374-13" aria-hidden="true" tabindex="-1"></a>      length_of_stay <span class="sc">~</span> <span class="st">"Length of Stay (days)"</span>,</span>
<span id="cb374-14"><a href="#cb374-14" aria-hidden="true" tabindex="-1"></a>      discharge_support <span class="sc">~</span> <span class="st">"Discharge Support"</span></span>
<span id="cb374-15"><a href="#cb374-15" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb374-16"><a href="#cb374-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb374-17"><a href="#cb374-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_overall</span>()</span>
<span id="cb374-18"><a href="#cb374-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb374-19"><a href="#cb374-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Figure 1: Predicted probabilities</span></span>
<span id="cb374-20"><a href="#cb374-20" aria-hidden="true" tabindex="-1"></a>pred_data <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb374-21"><a href="#cb374-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">comorbidities =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">5</span>,</span>
<span id="cb374-22"><a href="#cb374-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">age =</span> <span class="fu">median</span>(hospital_data<span class="sc">$</span>age),</span>
<span id="cb374-23"><a href="#cb374-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">length_of_stay =</span> <span class="fu">median</span>(hospital_data<span class="sc">$</span>length_of_stay),</span>
<span id="cb374-24"><a href="#cb374-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">discharge_support =</span> <span class="st">"Yes"</span></span>
<span id="cb374-25"><a href="#cb374-25" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb374-26"><a href="#cb374-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb374-27"><a href="#cb374-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Get predictions from Firth model</span></span>
<span id="cb374-28"><a href="#cb374-28" aria-hidden="true" tabindex="-1"></a>pred_data<span class="sc">$</span>predicted <span class="ot">&lt;-</span> <span class="fu">predict</span>(firth_model, <span class="at">newdata =</span> pred_data, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb374-29"><a href="#cb374-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb374-30"><a href="#cb374-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb374-31"><a href="#cb374-31" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pred_data, <span class="fu">aes</span>(<span class="at">x =</span> comorbidities, <span class="at">y =</span> predicted)) <span class="sc">+</span></span>
<span id="cb374-32"><a href="#cb374-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb374-33"><a href="#cb374-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> hospital_data, <span class="fu">aes</span>(<span class="at">y =</span> readmitted_30d), <span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">height =</span> <span class="fl">0.02</span>)) <span class="sc">+</span></span>
<span id="cb374-34"><a href="#cb374-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb374-35"><a href="#cb374-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Predicted 30-Day Readmission Probability"</span>,</span>
<span id="cb374-36"><a href="#cb374-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Number of Comorbidities"</span>,</span>
<span id="cb374-37"><a href="#cb374-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Predicted Probability"</span>,</span>
<span id="cb374-38"><a href="#cb374-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"Model: Firth penalized logistic regression, adjusted for age and length of stay"</span></span>
<span id="cb374-39"><a href="#cb374-39" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb374-40"><a href="#cb374-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">labels =</span> scales<span class="sc">::</span>percent) <span class="sc">+</span></span>
<span id="cb374-41"><a href="#cb374-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
</section>
<section id="task-4-critical-reflection-15-minutes" class="level3" data-number="3.10.5">
<h3 data-number="3.10.5" class="anchored" data-anchor-id="task-4-critical-reflection-15-minutes"><span class="header-section-number">3.10.5</span> Task 4: Critical Reflection (15 minutes)</h3>
<p>Answer these questions in your report:</p>
<ol type="1">
<li><p><strong>Main Limitation</strong>: What is the single biggest limitation of your analysis? How does it affect your conclusions?</p></li>
<li><p><strong>Additional Data</strong>: If you could collect 10 more variables on these same 25 patients, what would they be? Why?</p>
<ul>
<li>Consider: socioeconomic factors, medication adherence, social support, disease severity markers, provider characteristics</li>
</ul></li>
<li><p><strong>Prospective Validation</strong>: How would you validate this model before implementing it clinically?</p>
<ul>
<li>Sample size calculation (how many patients needed?)</li>
<li>Calibration and discrimination metrics (Brier score, C-statistic)</li>
<li>External validation (different hospital/region)</li>
</ul></li>
<li><p><strong>Ethical Considerations</strong>: If this model were used to allocate discharge support resources, what could go wrong?</p>
<ul>
<li>False positives (wasted resources)</li>
<li>False negatives (missed high-risk patients)</li>
<li>Algorithmic bias (if training data not representative)</li>
</ul></li>
</ol>
<hr>
</section>
<section id="evaluation-rubric" class="level3" data-number="3.10.6">
<h3 data-number="3.10.6" class="anchored" data-anchor-id="evaluation-rubric"><span class="header-section-number">3.10.6</span> Evaluation Rubric</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 14%">
<col style="width: 19%">
<col style="width: 12%">
<col style="width: 23%">
<col style="width: 29%">
</colgroup>
<thead>
<tr class="header">
<th>Criterion</th>
<th>Excellent (4)</th>
<th>Good (3)</th>
<th>Satisfactory (2)</th>
<th>Needs Improvement (1)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Code Quality</strong></td>
<td>All code runs without errors; well-commented; efficient</td>
<td>Code runs with minor tweaks; some comments</td>
<td>Code has errors but approach is sound</td>
<td>Code doesnâ€™t run or approach is flawed</td>
</tr>
<tr class="even">
<td><strong>Statistical Rigor</strong></td>
<td>Appropriate methods; checks assumptions; reports uncertainties</td>
<td>Mostly appropriate; minor omissions</td>
<td>Some questionable choices; incomplete checks</td>
<td>Major methodological errors</td>
</tr>
<tr class="odd">
<td><strong>Communication</strong></td>
<td>Clear, concise, audience-appropriate; publication-ready</td>
<td>Clear but could be more concise</td>
<td>Understandable but jargon-heavy</td>
<td>Unclear or incomplete</td>
</tr>
<tr class="even">
<td><strong>Critical Thinking</strong></td>
<td>Insightful limitations; creative solutions; anticipates questions</td>
<td>Identifies key limitations; standard solutions</td>
<td>Basic limitations noted</td>
<td>Limitations not addressed</td>
</tr>
<tr class="odd">
<td><strong>Visualization</strong></td>
<td>Publication-ready figures; clear labels; appropriate scales</td>
<td>Good figures with minor issues</td>
<td>Adequate but could be clearer</td>
<td>Poor or missing figures</td>
</tr>
</tbody>
</table>
<p><strong>Passing Standard</strong>: Score â‰¥ 10/20 (Average of 2 per criterion)</p>
<p><strong>Excellence Standard</strong>: Score â‰¥ 16/20 (Average of 3.2 per criterion)</p>
<hr>
</section>
<section id="extension-challenges-optional" class="level3" data-number="3.10.7">
<h3 data-number="3.10.7" class="anchored" data-anchor-id="extension-challenges-optional"><span class="header-section-number">3.10.7</span> Extension Challenges (Optional)</h3>
<p>For advanced students:</p>
<ol type="1">
<li><p><strong>Bayesian Logistic Regression</strong>: Fit the model using <code>rstanarm::stan_glm()</code> with weakly informative priors. Compare posterior intervals to Firth CIs.</p></li>
<li><p><strong>Cross-Validation</strong>: Perform leave-one-out cross-validation to assess predictive accuracy. Report the C-statistic (AUC).</p></li>
<li><p><strong>Nonparametric Approach</strong>: Use Mann-Whitney U tests to compare continuous predictors by readmission status. Compute Cliffâ€™s Delta effect sizes.</p></li>
<li><p><strong>Sensitivity Analysis</strong>: How do results change if you exclude patients with age &gt; 80 or comorbidities = 0?</p></li>
<li><p><strong>Sample Size Calculation</strong>: Using your effect size estimates, calculate the sample size needed to achieve 80% power to detect the effect of discharge support (Î± = 0.05).</p></li>
</ol>
<hr>
</section>
<section id="submission-format" class="level3" data-number="3.10.8">
<h3 data-number="3.10.8" class="anchored" data-anchor-id="submission-format"><span class="header-section-number">3.10.8</span> Submission Format</h3>
<p>Create a Quarto document (.qmd) with:</p>
<ol type="1">
<li><strong>Title and Author</strong>: â€œHospital Readmission Risk Assessmentâ€ + your name</li>
<li><strong>Sections</strong>: Introduction, Methods, Results, Discussion, References</li>
<li><strong>Code chunks</strong>: Labeled and with <code>echo=TRUE</code> so the instructor can see your code</li>
<li><strong>Outputs</strong>: Tables and figures embedded in the document</li>
<li><strong>Narrative</strong>: Connecting paragraphs explaining your choices and interpretations</li>
<li><strong>Appendix</strong>: Critical reflection answers (Task 4)</li>
</ol>
<p>Render to HTML or PDF and submit via your learning management system.</p>
<p><strong>Expected length</strong>: 5-8 pages (including figures and code)</p>
<p><strong>Deadline</strong>: [Set by instructor]</p>
<hr>
<p>This challenge integrates concepts from Chapters 3-8 and requires students to make methodological decisions, interpret results, and communicate findingsâ€”core skills for small-sample research.</p>


<!-- -->

</section>
</section>
</div>
</div>
</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "î§‹";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../chapters/part-b-data-collection.html" class="pagination-link" aria-label="Part B: Data Collection and Preparation">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Part B: Data Collection and Preparation</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../chapters/part-d-reporting.html" class="pagination-link" aria-label="Part D: Reporting and Interpretation">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Part D: Reporting and Interpretation</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb375" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb375-1"><a href="#cb375-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># Part C: Analysis Methods</span></span>
<span id="cb375-2"><a href="#cb375-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3"><a href="#cb375-3" aria-hidden="true" tabindex="-1"></a>This part presents the core toolkit for small-sample quantitative analysis. We cover exact and resampling tests, nonparametric rank-based methods, penalised and Bayesian regression, reliability analysis for short scales, multi-criteria decision-making (MCDM) techniques, and methods for sparse counts.</span>
<span id="cb375-4"><a href="#cb375-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5"><a href="#cb375-5" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-6"><a href="#cb375-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7"><a href="#cb375-7" aria-hidden="true" tabindex="-1"></a><span class="fu">## Chapter 3. Exact Tests and Resampling Methods</span></span>
<span id="cb375-8"><a href="#cb375-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9"><a href="#cb375-9" aria-hidden="true" tabindex="-1"></a><span class="fu">### Learning Objectives</span></span>
<span id="cb375-10"><a href="#cb375-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11"><a href="#cb375-11" aria-hidden="true" tabindex="-1"></a>By the end of this chapter, you will be able to:</span>
<span id="cb375-12"><a href="#cb375-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-13"><a href="#cb375-13" aria-hidden="true" tabindex="-1"></a>**Conceptual Understanding**</span>
<span id="cb375-14"><a href="#cb375-14" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Explain when exact tests are necessary vs. when asymptotic approximations suffice</span>
<span id="cb375-15"><a href="#cb375-15" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Understand the theoretical basis of permutation and bootstrap resampling</span>
<span id="cb375-16"><a href="#cb375-16" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Recognize the assumptions underlying Fisher's exact, Barnard's, and binomial tests</span>
<span id="cb375-17"><a href="#cb375-17" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Distinguish parametric bootstrap from nonparametric bootstrap</span>
<span id="cb375-18"><a href="#cb375-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-19"><a href="#cb375-19" aria-hidden="true" tabindex="-1"></a>**Practical Skills**</span>
<span id="cb375-20"><a href="#cb375-20" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Conduct Fisher's exact test in R using <span class="in">`fisher.test()`</span></span>
<span id="cb375-21"><a href="#cb375-21" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Implement permutation tests for group comparisons using <span class="in">`coin`</span> package</span>
<span id="cb375-22"><a href="#cb375-22" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Generate bootstrap confidence intervals with <span class="in">`boot`</span> package</span>
<span id="cb375-23"><a href="#cb375-23" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Apply exact binomial and Poisson tests for count data</span>
<span id="cb375-24"><a href="#cb375-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-25"><a href="#cb375-25" aria-hidden="true" tabindex="-1"></a>**Critical Evaluation**</span>
<span id="cb375-26"><a href="#cb375-26" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Assess when exact tests are overly conservative vs. appropriately cautious</span>
<span id="cb375-27"><a href="#cb375-27" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Evaluate the trade-off between computational cost and precision</span>
<span id="cb375-28"><a href="#cb375-28" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Critique inappropriate use of asymptotic tests in small-sample contexts</span>
<span id="cb375-29"><a href="#cb375-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-30"><a href="#cb375-30" aria-hidden="true" tabindex="-1"></a>**Application**</span>
<span id="cb375-31"><a href="#cb375-31" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Select the appropriate exact/resampling method for research questions</span>
<span id="cb375-32"><a href="#cb375-32" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Report resampling procedures transparently (iterations, seed, method)</span>
<span id="cb375-33"><a href="#cb375-33" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Construct bootstrap CIs for custom effect sizes not available in packages</span>
<span id="cb375-34"><a href="#cb375-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-35"><a href="#cb375-35" aria-hidden="true" tabindex="-1"></a><span class="fu">### When to Use Exact and Resampling Methods</span></span>
<span id="cb375-36"><a href="#cb375-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-37"><a href="#cb375-37" aria-hidden="true" tabindex="-1"></a>Exact tests compute p-values directly from the probability distribution of the test statistic under the null hypothesis, without relying on large-sample approximations. They are particularly useful when sample sizes are small, when distributional assumptions (such as normality) are questionable, or when the outcome is discrete (binary, count, or ordinal).</span>
<span id="cb375-38"><a href="#cb375-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-39"><a href="#cb375-39" aria-hidden="true" tabindex="-1"></a>Resampling methods (permutation tests and bootstrap) use the observed data to approximate the sampling distribution of a statistic. Permutation tests shuffle group labels or treatment assignments to generate a reference distribution under the null hypothesis. Bootstrap resampling draws repeated samples (with replacement) from the observed data to estimate the variability of an estimator and construct confidence intervals.</span>
<span id="cb375-40"><a href="#cb375-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-41"><a href="#cb375-41" aria-hidden="true" tabindex="-1"></a>Both approaches are computationally intensive but feasible with modern computing. They often provide more accurate inferences than classical parametric tests when samples are small or assumptions are violated.</span>
<span id="cb375-42"><a href="#cb375-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-43"><a href="#cb375-43" aria-hidden="true" tabindex="-1"></a><span class="fu">### Fisher's Exact Test for 2Ã—2 Tables</span></span>
<span id="cb375-44"><a href="#cb375-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-45"><a href="#cb375-45" aria-hidden="true" tabindex="-1"></a>Fisher's exact test is the standard method for testing independence in a 2Ã—2 contingency table when cell counts are small. It conditions on the row and column totals and computes the exact probability of observing the data (or more extreme) under the null hypothesis of no association.</span>
<span id="cb375-46"><a href="#cb375-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-47"><a href="#cb375-47" aria-hidden="true" tabindex="-1"></a>The test is conservative (tends to yield p-values that are too large) in some settings, but remains widely used because it guarantees correct Type I error control. It is most appropriate for fixed-margin designs (such as retrospective case-control studies) but is often applied more broadly.</span>
<span id="cb375-48"><a href="#cb375-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-49"><a href="#cb375-49" aria-hidden="true" tabindex="-1"></a>**Assumptions**: None regarding distributional form. Observations must be independent. The test conditions on marginal totals.</span>
<span id="cb375-50"><a href="#cb375-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-51"><a href="#cb375-51" aria-hidden="true" tabindex="-1"></a>**When to use**: Small cell counts (any cell &lt; 5), binary outcomes crossed with binary exposures, exact inference required.</span>
<span id="cb375-52"><a href="#cb375-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-53"><a href="#cb375-53" aria-hidden="true" tabindex="-1"></a><span class="fu">### Example: Fisher's Exact Test</span></span>
<span id="cb375-54"><a href="#cb375-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-55"><a href="#cb375-55" aria-hidden="true" tabindex="-1"></a>Suppose we are evaluating a new training intervention. Of 10 employees who received training, 8 met their performance target; of 10 who did not receive training, 3 met the target. We test whether training is associated with meeting the target.</span>
<span id="cb375-56"><a href="#cb375-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-59"><a href="#cb375-59" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb375-60"><a href="#cb375-60" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: part-c-chunk-01</span></span>
<span id="cb375-61"><a href="#cb375-61" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb375-62"><a href="#cb375-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-63"><a href="#cb375-63" aria-hidden="true" tabindex="-1"></a><span class="co"># ðŸ’¡ TEACHING POINT 1: Build the table carefully</span></span>
<span id="cb375-64"><a href="#cb375-64" aria-hidden="true" tabindex="-1"></a><span class="co"># Create 2x2 table: rows = training (Yes, No), columns = target met (Yes, No)</span></span>
<span id="cb375-65"><a href="#cb375-65" aria-hidden="true" tabindex="-1"></a>training_yes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">8</span>, <span class="dv">2</span>)  <span class="co"># 8 met target, 2 did not</span></span>
<span id="cb375-66"><a href="#cb375-66" aria-hidden="true" tabindex="-1"></a>training_no <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">7</span>)   <span class="co"># 3 met target, 7 did not</span></span>
<span id="cb375-67"><a href="#cb375-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-68"><a href="#cb375-68" aria-hidden="true" tabindex="-1"></a>table_data <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">8</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">7</span>), <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>,</span>
<span id="cb375-69"><a href="#cb375-69" aria-hidden="true" tabindex="-1"></a>                     <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="at">Training =</span> <span class="fu">c</span>(<span class="st">"Yes"</span>, <span class="st">"No"</span>),</span>
<span id="cb375-70"><a href="#cb375-70" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">Target =</span> <span class="fu">c</span>(<span class="st">"Met"</span>, <span class="st">"Not Met"</span>)))</span>
<span id="cb375-71"><a href="#cb375-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-72"><a href="#cb375-72" aria-hidden="true" tabindex="-1"></a><span class="co"># ðŸ’¡ TEACHING POINT 2: Always print the table first!</span></span>
<span id="cb375-73"><a href="#cb375-73" aria-hidden="true" tabindex="-1"></a><span class="co"># Students should verify the layout matches their research question</span></span>
<span id="cb375-74"><a href="#cb375-74" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Contingency Table:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-75"><a href="#cb375-75" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(table_data)</span>
<span id="cb375-76"><a href="#cb375-76" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-77"><a href="#cb375-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-78"><a href="#cb375-78" aria-hidden="true" tabindex="-1"></a><span class="co"># ðŸ’¡ TEACHING POINT 3: Check expected cell counts</span></span>
<span id="cb375-79"><a href="#cb375-79" aria-hidden="true" tabindex="-1"></a><span class="co"># If all â‰¥5, chi-square is an alternative; if any &lt;5, Fisher's is mandatory</span></span>
<span id="cb375-80"><a href="#cb375-80" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Expected cell counts under independence:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-81"><a href="#cb375-81" aria-hidden="true" tabindex="-1"></a>expected <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(table_data)<span class="sc">$</span>expected</span>
<span id="cb375-82"><a href="#cb375-82" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(expected, <span class="dv">2</span>))</span>
<span id="cb375-83"><a href="#cb375-83" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"â†’ All cells &lt; 5, so Fisher's exact test is required</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb375-84"><a href="#cb375-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-85"><a href="#cb375-85" aria-hidden="true" tabindex="-1"></a><span class="co"># ðŸ’¡ TEACHING POINT 4: Run Fisher's exact test</span></span>
<span id="cb375-86"><a href="#cb375-86" aria-hidden="true" tabindex="-1"></a>fisher_result <span class="ot">&lt;-</span> <span class="fu">fisher.test</span>(table_data)</span>
<span id="cb375-87"><a href="#cb375-87" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fisher_result)</span>
<span id="cb375-88"><a href="#cb375-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-89"><a href="#cb375-89" aria-hidden="true" tabindex="-1"></a><span class="co"># ðŸ’¡ TEACHING POINT 5: Interpret systematically</span></span>
<span id="cb375-90"><a href="#cb375-90" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== INTERPRETATION GUIDE ===</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-91"><a href="#cb375-91" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"1. Odds Ratio ="</span>, <span class="fu">round</span>(fisher_result<span class="sc">$</span>estimate, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-92"><a href="#cb375-92" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"   â†’ Trained employees have"</span>, <span class="fu">round</span>(fisher_result<span class="sc">$</span>estimate, <span class="dv">1</span>), </span>
<span id="cb375-93"><a href="#cb375-93" aria-hidden="true" tabindex="-1"></a>    <span class="st">"times higher odds of meeting target</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb375-94"><a href="#cb375-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-95"><a href="#cb375-95" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"2. 95% CI = ["</span>, <span class="fu">round</span>(fisher_result<span class="sc">$</span>conf.int[<span class="dv">1</span>], <span class="dv">2</span>), <span class="st">","</span>, </span>
<span id="cb375-96"><a href="#cb375-96" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(fisher_result<span class="sc">$</span>conf.int[<span class="dv">2</span>], <span class="dv">2</span>), <span class="st">"]</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-97"><a href="#cb375-97" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"   â†’ Plausible range for OR. Does it include 1 (no effect)?</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-98"><a href="#cb375-98" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(fisher_result<span class="sc">$</span>conf.int[<span class="dv">1</span>] <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb375-99"><a href="#cb375-99" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"   â†’ No! The entire CI is &gt; 1, suggesting a real effect</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb375-100"><a href="#cb375-100" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb375-101"><a href="#cb375-101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"   â†’ Yes. CI includes 1, so effect is uncertain</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb375-102"><a href="#cb375-102" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb375-103"><a href="#cb375-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-104"><a href="#cb375-104" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"3. p-value ="</span>, <span class="fu">round</span>(fisher_result<span class="sc">$</span>p.value, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-105"><a href="#cb375-105" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(fisher_result<span class="sc">$</span>p.value <span class="sc">&lt;</span> <span class="fl">0.05</span>) {</span>
<span id="cb375-106"><a href="#cb375-106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"   â†’ Significant at Î± = 0.05</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb375-107"><a href="#cb375-107" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb375-108"><a href="#cb375-108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"   â†’ Not significant at Î± = 0.05</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb375-109"><a href="#cb375-109" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb375-110"><a href="#cb375-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-111"><a href="#cb375-111" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"4. Conclusion:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-112"><a href="#cb375-112" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(fisher_result<span class="sc">$</span>p.value <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> fisher_result<span class="sc">$</span>estimate <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb375-113"><a href="#cb375-113" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"   Training shows a significant positive effect (OR ="</span>, </span>
<span id="cb375-114"><a href="#cb375-114" aria-hidden="true" tabindex="-1"></a>      <span class="fu">round</span>(fisher_result<span class="sc">$</span>estimate, <span class="dv">1</span>), <span class="st">", p ="</span>, <span class="fu">round</span>(fisher_result<span class="sc">$</span>p.value, <span class="dv">3</span>), <span class="st">")</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-115"><a href="#cb375-115" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb375-116"><a href="#cb375-116" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"   Training shows promise (OR ="</span>, <span class="fu">round</span>(fisher_result<span class="sc">$</span>estimate, <span class="dv">1</span>), </span>
<span id="cb375-117"><a href="#cb375-117" aria-hidden="true" tabindex="-1"></a>      <span class="st">"), but n ="</span>, <span class="fu">sum</span>(table_data), <span class="st">"is small.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-118"><a href="#cb375-118" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"   Cannot rule out chance. A larger study is warranted.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-119"><a href="#cb375-119" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb375-120"><a href="#cb375-120" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-121"><a href="#cb375-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-122"><a href="#cb375-122" aria-hidden="true" tabindex="-1"></a>**Interpretation Summary**: The p-value indicates the probability of observing this degree of association (or stronger) if training had no effect. The odds ratio quantifies the strength of association: an odds ratio greater than 1 indicates higher odds of meeting the target among trained employees. The confidence interval for the odds ratio provides a range of plausible values. With small samples, pay close attention to the CI widthâ€”a wide CI indicates high uncertainty.</span>
<span id="cb375-123"><a href="#cb375-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-124"><a href="#cb375-124" aria-hidden="true" tabindex="-1"></a><span class="fu">### When Fisher's Exact Test Is Overly Conservative</span></span>
<span id="cb375-125"><a href="#cb375-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-126"><a href="#cb375-126" aria-hidden="true" tabindex="-1"></a>Fisher's test conditions on *both* margins, which can be unnecessarily conservative when only one margin is fixed by design. Consider:</span>
<span id="cb375-127"><a href="#cb375-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-128"><a href="#cb375-128" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Prospective study** (e.g., RCT): Row totals (group sizes) fixed, column totals random â†’ Fisher's appropriate</span>
<span id="cb375-129"><a href="#cb375-129" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Case-control study**: Column totals (cases/controls) fixed, row totals random â†’ Fisher's appropriate  </span>
<span id="cb375-130"><a href="#cb375-130" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Cross-sectional survey**: Both margins random â†’ Fisher's may be conservative; consider Barnard's test or chi-square with continuity correction</span>
<span id="cb375-131"><a href="#cb375-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-132"><a href="#cb375-132" aria-hidden="true" tabindex="-1"></a>**Rule of thumb**: If expected cell counts exceed 5, compare Fisher's p-value with Pearson's chi-square (with Yates correction). If similar, Fisher's conservatism is acceptable.</span>
<span id="cb375-133"><a href="#cb375-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-134"><a href="#cb375-134" aria-hidden="true" tabindex="-1"></a>**Why this matters with small samples**: The conditioning on both margins restricts the possible tables considered in the exact calculation, making it harder to reject the null hypothesis even when a true effect exists. This conservatism is a trade-off for guaranteed Type I error control, but can reduce power unnecessarily when the study design doesn't justify fixing both margins.</span>
<span id="cb375-135"><a href="#cb375-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-136"><a href="#cb375-136" aria-hidden="true" tabindex="-1"></a><span class="fu">### Barnard's Exact Test</span></span>
<span id="cb375-137"><a href="#cb375-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-138"><a href="#cb375-138" aria-hidden="true" tabindex="-1"></a>Barnard's exact test is an alternative to Fisher's test that does not condition on both margins. It tends to have higher power than Fisher's test, particularly when the null hypothesis is false. However, it is computationally more demanding and less commonly implemented.</span>
<span id="cb375-139"><a href="#cb375-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-140"><a href="#cb375-140" aria-hidden="true" tabindex="-1"></a>When both tests are available, Barnard's test may be preferred for exploratory analyses where power is a concern. For confirmatory analyses, Fisher's test remains the conventional choice.</span>
<span id="cb375-141"><a href="#cb375-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-144"><a href="#cb375-144" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb375-145"><a href="#cb375-145" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: part-c-chunk-02</span></span>
<span id="cb375-146"><a href="#cb375-146" aria-hidden="true" tabindex="-1"></a><span class="co"># Note: Barnard's exact test is not readily available in standard R packages</span></span>
<span id="cb375-147"><a href="#cb375-147" aria-hidden="true" tabindex="-1"></a><span class="co"># For this example, we'll demonstrate the concept using Fisher's exact test</span></span>
<span id="cb375-148"><a href="#cb375-148" aria-hidden="true" tabindex="-1"></a><span class="co"># which is more commonly available and serves a similar purpose</span></span>
<span id="cb375-149"><a href="#cb375-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-150"><a href="#cb375-150" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(exact2x2)</span>
<span id="cb375-151"><a href="#cb375-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-152"><a href="#cb375-152" aria-hidden="true" tabindex="-1"></a><span class="co"># Using exact2x2 function which provides exact tests for 2x2 tables</span></span>
<span id="cb375-153"><a href="#cb375-153" aria-hidden="true" tabindex="-1"></a><span class="co"># This will give similar results to what Barnard's test would provide</span></span>
<span id="cb375-154"><a href="#cb375-154" aria-hidden="true" tabindex="-1"></a>barnard_result <span class="ot">&lt;-</span> <span class="fu">exact2x2</span>(table_data, <span class="at">alternative =</span> <span class="st">"two.sided"</span>)</span>
<span id="cb375-155"><a href="#cb375-155" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(barnard_result)</span>
<span id="cb375-156"><a href="#cb375-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-157"><a href="#cb375-157" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternative: You could also use Fisher's test as a comparison</span></span>
<span id="cb375-158"><a href="#cb375-158" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">For comparison, Fisher's exact test:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-159"><a href="#cb375-159" aria-hidden="true" tabindex="-1"></a>fisher_comparison <span class="ot">&lt;-</span> <span class="fu">fisher.test</span>(table_data)</span>
<span id="cb375-160"><a href="#cb375-160" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fisher_comparison)</span>
<span id="cb375-161"><a href="#cb375-161" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-162"><a href="#cb375-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-163"><a href="#cb375-163" aria-hidden="true" tabindex="-1"></a>Interpretation: The exact2x2 function provides exact inference for 2Ã—2 tables, similar to what Barnard's test would provide. Compare the p-value to Fisher's result. The exact2x2 approach may have different power characteristics than Fisher's exact test. Both tests provide confidence intervals for the odds ratio to help interpret the strength of association.</span>
<span id="cb375-164"><a href="#cb375-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-165"><a href="#cb375-165" aria-hidden="true" tabindex="-1"></a><span class="fu">### Mid-p Corrections for Exact Tests</span></span>
<span id="cb375-166"><a href="#cb375-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-167"><a href="#cb375-167" aria-hidden="true" tabindex="-1"></a>Classical exact tests (such as Fisher's) can be conservative, especially with very small margins. A common compromise is the **mid-p correction**, which subtracts half the probability of the observed table from the tail probability. Mid-p values sit between the conservative Fisher p-value and the more powerful Barnard p-value, providing a better balance of Type I error control and power for exploratory work.</span>
<span id="cb375-168"><a href="#cb375-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-171"><a href="#cb375-171" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb375-172"><a href="#cb375-172" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: part-c-chunk-03</span></span>
<span id="cb375-173"><a href="#cb375-173" aria-hidden="true" tabindex="-1"></a><span class="co"># Mid-p adjustment using exact2x2</span></span>
<span id="cb375-174"><a href="#cb375-174" aria-hidden="true" tabindex="-1"></a>midp_result <span class="ot">&lt;-</span> <span class="fu">exact2x2</span>(table_data, <span class="at">alternative =</span> <span class="st">"two.sided"</span>, <span class="at">midp =</span> <span class="cn">TRUE</span>)</span>
<span id="cb375-175"><a href="#cb375-175" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(midp_result)</span>
<span id="cb375-176"><a href="#cb375-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-177"><a href="#cb375-177" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Comparing p-values:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-178"><a href="#cb375-178" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Fisher (two-sided):"</span>, <span class="fu">signif</span>(fisher_result<span class="sc">$</span>p.value, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-179"><a href="#cb375-179" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Fisher mid-p:"</span>, <span class="fu">signif</span>(midp_result<span class="sc">$</span>p.value, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-180"><a href="#cb375-180" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Barnard (Score test):"</span>, <span class="fu">signif</span>(barnard_result<span class="sc">$</span>p.value, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-181"><a href="#cb375-181" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-182"><a href="#cb375-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-183"><a href="#cb375-183" aria-hidden="true" tabindex="-1"></a>Interpretation: The mid-p value typically lies between Fisher's and Barnard's results. Use mid-p corrections when exact control of the Type I error is less critical than avoiding overly conservative decisions. For confirmatory analyses, report the standard exact p-value as the primary result and consider the mid-p value as a sensitivity check.</span>
<span id="cb375-184"><a href="#cb375-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-185"><a href="#cb375-185" aria-hidden="true" tabindex="-1"></a>::: {.callout-warning}</span>
<span id="cb375-186"><a href="#cb375-186" aria-hidden="true" tabindex="-1"></a><span class="fu">## âš ï¸ Common Misconception: "Exact Tests Always Give Exact P-Values"</span></span>
<span id="cb375-187"><a href="#cb375-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-188"><a href="#cb375-188" aria-hidden="true" tabindex="-1"></a>**Myth**: "Fisher's exact test gives the exact p-value, so it's always the right answer."</span>
<span id="cb375-189"><a href="#cb375-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-190"><a href="#cb375-190" aria-hidden="true" tabindex="-1"></a>**Reality**: Fisher's exact test computes probabilities *exactly* under the null hypothesis, but this doesn't mean the p-value perfectly represents the evidence against Hâ‚€. The test can be **overly conservative**, especially with small samples or unbalanced margins.</span>
<span id="cb375-191"><a href="#cb375-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-192"><a href="#cb375-192" aria-hidden="true" tabindex="-1"></a>**Example**:</span>
<span id="cb375-195"><a href="#cb375-195" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb375-196"><a href="#cb375-196" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: part-c-misconception-1</span></span>
<span id="cb375-197"><a href="#cb375-197" aria-hidden="true" tabindex="-1"></a><span class="co"># Extreme case: 2x2 table with small cells</span></span>
<span id="cb375-198"><a href="#cb375-198" aria-hidden="true" tabindex="-1"></a>conservative_table <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">5</span>), <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb375-199"><a href="#cb375-199" aria-hidden="true" tabindex="-1"></a><span class="fu">fisher.test</span>(conservative_table)<span class="sc">$</span>p.value</span>
<span id="cb375-200"><a href="#cb375-200" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-201"><a href="#cb375-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-202"><a href="#cb375-202" aria-hidden="true" tabindex="-1"></a>With such sparse data, Fisher's exact test may give p = 1.0 even when the pattern looks strong. The test conditions on marginal totals, which makes it conservative.</span>
<span id="cb375-203"><a href="#cb375-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-204"><a href="#cb375-204" aria-hidden="true" tabindex="-1"></a>**Lesson**: </span>
<span id="cb375-205"><a href="#cb375-205" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**"Exact" refers to the computation**, not the appropriateness of the test</span>
<span id="cb375-206"><a href="#cb375-206" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Consider **mid-p adjustments** for exploratory analyses (less conservative)</span>
<span id="cb375-207"><a href="#cb375-207" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Use **Barnard's test** when margins aren't fixed by design</span>
<span id="cb375-208"><a href="#cb375-208" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>With very small samples, **descriptive reporting** (e.g., "5/5 vs 0/5") may be more informative than p-values</span>
<span id="cb375-209"><a href="#cb375-209" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb375-210"><a href="#cb375-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-211"><a href="#cb375-211" aria-hidden="true" tabindex="-1"></a><span class="fu">### Exact Binomial Test</span></span>
<span id="cb375-212"><a href="#cb375-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-213"><a href="#cb375-213" aria-hidden="true" tabindex="-1"></a>The exact binomial test assesses whether the observed proportion of successes differs from a hypothesised proportion. It is appropriate when the outcome is binary and you have a single sample or wish to compare an observed proportion to a fixed value.</span>
<span id="cb375-214"><a href="#cb375-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-215"><a href="#cb375-215" aria-hidden="true" tabindex="-1"></a>**Assumptions**: Observations are independent Bernoulli trials with constant success probability.</span>
<span id="cb375-216"><a href="#cb375-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-217"><a href="#cb375-217" aria-hidden="true" tabindex="-1"></a>**When to use**: Small samples, binary outcomes, testing a proportion against a known or hypothesised value.</span>
<span id="cb375-218"><a href="#cb375-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-219"><a href="#cb375-219" aria-hidden="true" tabindex="-1"></a><span class="fu">### Example: Exact Binomial Test</span></span>
<span id="cb375-220"><a href="#cb375-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-221"><a href="#cb375-221" aria-hidden="true" tabindex="-1"></a>A clinic claims that 70% of patients improve with standard care. In a small audit of 15 patients, 13 improved. We test whether the observed proportion is consistent with the clinic's claim.</span>
<span id="cb375-222"><a href="#cb375-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-225"><a href="#cb375-225" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb375-226"><a href="#cb375-226" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: part-c-chunk-04</span></span>
<span id="cb375-227"><a href="#cb375-227" aria-hidden="true" tabindex="-1"></a><span class="co"># Exact binomial test</span></span>
<span id="cb375-228"><a href="#cb375-228" aria-hidden="true" tabindex="-1"></a><span class="co"># H0: p = 0.70</span></span>
<span id="cb375-229"><a href="#cb375-229" aria-hidden="true" tabindex="-1"></a>binom_result <span class="ot">&lt;-</span> <span class="fu">binom.test</span>(<span class="at">x =</span> <span class="dv">13</span>, <span class="at">n =</span> <span class="dv">15</span>, <span class="at">p =</span> <span class="fl">0.70</span>, <span class="at">alternative =</span> <span class="st">"two.sided"</span>)</span>
<span id="cb375-230"><a href="#cb375-230" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(binom_result)</span>
<span id="cb375-231"><a href="#cb375-231" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-232"><a href="#cb375-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-233"><a href="#cb375-233" aria-hidden="true" tabindex="-1"></a>Interpretation: The p-value indicates whether the observed proportion (13/15 = 0.867) is compatible with the null hypothesis (p = 0.70). A large p-value suggests consistency; a small p-value suggests the true proportion may differ from 0.70. The confidence interval provides a range of plausible values for the true proportion.</span>
<span id="cb375-234"><a href="#cb375-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-235"><a href="#cb375-235" aria-hidden="true" tabindex="-1"></a><span class="fu">### Exact Poisson Test</span></span>
<span id="cb375-236"><a href="#cb375-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-237"><a href="#cb375-237" aria-hidden="true" tabindex="-1"></a>The exact Poisson test is used for count data when the outcome is the number of events in a fixed period or space. It tests whether the observed count is consistent with a specified rate.</span>
<span id="cb375-238"><a href="#cb375-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-239"><a href="#cb375-239" aria-hidden="true" tabindex="-1"></a>**Assumptions**: Events occur independently at a constant rate. Count data follow a Poisson distribution.</span>
<span id="cb375-240"><a href="#cb375-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-241"><a href="#cb375-241" aria-hidden="true" tabindex="-1"></a>**When to use**: Small counts, rare events, testing an observed rate against a known or expected rate.</span>
<span id="cb375-242"><a href="#cb375-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-243"><a href="#cb375-243" aria-hidden="true" tabindex="-1"></a><span class="fu">### Example: Exact Poisson Test</span></span>
<span id="cb375-244"><a href="#cb375-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-245"><a href="#cb375-245" aria-hidden="true" tabindex="-1"></a>A manufacturing process is expected to produce 3 defects per batch on average. In a random sample of 8 batches, we observe 32 total defects. We test whether the observed rate is consistent with the expected rate of 3 per batch.</span>
<span id="cb375-246"><a href="#cb375-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-249"><a href="#cb375-249" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb375-250"><a href="#cb375-250" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: part-c-chunk-05</span></span>
<span id="cb375-251"><a href="#cb375-251" aria-hidden="true" tabindex="-1"></a><span class="co"># Exact Poisson test</span></span>
<span id="cb375-252"><a href="#cb375-252" aria-hidden="true" tabindex="-1"></a><span class="co"># H0: lambda = 3 per batch (expected 3 * 8 = 24 defects in 8 batches)</span></span>
<span id="cb375-253"><a href="#cb375-253" aria-hidden="true" tabindex="-1"></a>poisson_result <span class="ot">&lt;-</span> <span class="fu">poisson.test</span>(<span class="at">x =</span> <span class="dv">32</span>, <span class="at">T =</span> <span class="dv">8</span>, <span class="at">r =</span> <span class="dv">3</span>, <span class="at">alternative =</span> <span class="st">"two.sided"</span>)</span>
<span id="cb375-254"><a href="#cb375-254" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(poisson_result)</span>
<span id="cb375-255"><a href="#cb375-255" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-256"><a href="#cb375-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-257"><a href="#cb375-257" aria-hidden="true" tabindex="-1"></a>Interpretation: The p-value indicates whether the observed rate (32/8 = 4 per batch) differs significantly from the expected rate (3 per batch). The confidence interval provides a range for the true rate. If the interval excludes 3, the observed rate is inconsistent with the null hypothesis at the chosen confidence level.</span>
<span id="cb375-258"><a href="#cb375-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-259"><a href="#cb375-259" aria-hidden="true" tabindex="-1"></a><span class="fu">### Permutation Tests</span></span>
<span id="cb375-260"><a href="#cb375-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-261"><a href="#cb375-261" aria-hidden="true" tabindex="-1"></a>Permutation tests compare groups by randomly shuffling group labels many times and computing the test statistic for each permutation. The observed test statistic is then compared to the permutation distribution to obtain a p-value.</span>
<span id="cb375-262"><a href="#cb375-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-263"><a href="#cb375-263" aria-hidden="true" tabindex="-1"></a>Permutation tests are exact (given enough permutations) and make no distributional assumptions beyond exchangeability under the null hypothesis. They can be applied to any test statistic, including differences in means, medians, or more complex measures.</span>
<span id="cb375-264"><a href="#cb375-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-265"><a href="#cb375-265" aria-hidden="true" tabindex="-1"></a>**When to use**: Small samples, non-normal distributions, custom test statistics, desire for exact inference.</span>
<span id="cb375-266"><a href="#cb375-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-267"><a href="#cb375-267" aria-hidden="true" tabindex="-1"></a><span class="fu">### Example: Permutation Test for Difference in Means</span></span>
<span id="cb375-268"><a href="#cb375-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-269"><a href="#cb375-269" aria-hidden="true" tabindex="-1"></a>We compare test scores between two teaching methods with small groups (n = 8 per group). Scores may not be normally distributed.</span>
<span id="cb375-270"><a href="#cb375-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-273"><a href="#cb375-273" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb375-274"><a href="#cb375-274" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: part-c-chunk-06</span></span>
<span id="cb375-275"><a href="#cb375-275" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb375-276"><a href="#cb375-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-277"><a href="#cb375-277" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb375-278"><a href="#cb375-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-279"><a href="#cb375-279" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulated test scores</span></span>
<span id="cb375-280"><a href="#cb375-280" aria-hidden="true" tabindex="-1"></a>method_a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">78</span>, <span class="dv">82</span>, <span class="dv">75</span>, <span class="dv">88</span>, <span class="dv">79</span>, <span class="dv">85</span>, <span class="dv">80</span>, <span class="dv">83</span>)</span>
<span id="cb375-281"><a href="#cb375-281" aria-hidden="true" tabindex="-1"></a>method_b <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">68</span>, <span class="dv">72</span>, <span class="dv">70</span>, <span class="dv">75</span>, <span class="dv">71</span>, <span class="dv">69</span>, <span class="dv">73</span>, <span class="dv">74</span>)</span>
<span id="cb375-282"><a href="#cb375-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-283"><a href="#cb375-283" aria-hidden="true" tabindex="-1"></a>scores_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb375-284"><a href="#cb375-284" aria-hidden="true" tabindex="-1"></a>  <span class="at">score =</span> <span class="fu">c</span>(method_a, method_b),</span>
<span id="cb375-285"><a href="#cb375-285" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>), <span class="at">each =</span> <span class="dv">8</span>)</span>
<span id="cb375-286"><a href="#cb375-286" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb375-287"><a href="#cb375-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-288"><a href="#cb375-288" aria-hidden="true" tabindex="-1"></a><span class="co"># Observed difference in means</span></span>
<span id="cb375-289"><a href="#cb375-289" aria-hidden="true" tabindex="-1"></a>obs_diff <span class="ot">&lt;-</span> <span class="fu">mean</span>(method_a) <span class="sc">-</span> <span class="fu">mean</span>(method_b)</span>
<span id="cb375-290"><a href="#cb375-290" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Observed difference in means:"</span>, <span class="fu">round</span>(obs_diff, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-291"><a href="#cb375-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-292"><a href="#cb375-292" aria-hidden="true" tabindex="-1"></a><span class="co"># Permutation test (manual implementation)</span></span>
<span id="cb375-293"><a href="#cb375-293" aria-hidden="true" tabindex="-1"></a>n_perm <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb375-294"><a href="#cb375-294" aria-hidden="true" tabindex="-1"></a>all_scores <span class="ot">&lt;-</span> scores_data<span class="sc">$</span>score</span>
<span id="cb375-295"><a href="#cb375-295" aria-hidden="true" tabindex="-1"></a>perm_diffs <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_perm)</span>
<span id="cb375-296"><a href="#cb375-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-297"><a href="#cb375-297" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_perm) {</span>
<span id="cb375-298"><a href="#cb375-298" aria-hidden="true" tabindex="-1"></a>  perm_labels <span class="ot">&lt;-</span> <span class="fu">sample</span>(scores_data<span class="sc">$</span>method)</span>
<span id="cb375-299"><a href="#cb375-299" aria-hidden="true" tabindex="-1"></a>  perm_mean_a <span class="ot">&lt;-</span> <span class="fu">mean</span>(all_scores[perm_labels <span class="sc">==</span> <span class="st">"A"</span>])</span>
<span id="cb375-300"><a href="#cb375-300" aria-hidden="true" tabindex="-1"></a>  perm_mean_b <span class="ot">&lt;-</span> <span class="fu">mean</span>(all_scores[perm_labels <span class="sc">==</span> <span class="st">"B"</span>])</span>
<span id="cb375-301"><a href="#cb375-301" aria-hidden="true" tabindex="-1"></a>  perm_diffs[i] <span class="ot">&lt;-</span> perm_mean_a <span class="sc">-</span> perm_mean_b</span>
<span id="cb375-302"><a href="#cb375-302" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb375-303"><a href="#cb375-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-304"><a href="#cb375-304" aria-hidden="true" tabindex="-1"></a><span class="co"># Two-sided p-value</span></span>
<span id="cb375-305"><a href="#cb375-305" aria-hidden="true" tabindex="-1"></a>p_value <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(perm_diffs) <span class="sc">&gt;=</span> <span class="fu">abs</span>(obs_diff))</span>
<span id="cb375-306"><a href="#cb375-306" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Permutation p-value:"</span>, <span class="fu">round</span>(p_value, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-307"><a href="#cb375-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-308"><a href="#cb375-308" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualise permutation distribution</span></span>
<span id="cb375-309"><a href="#cb375-309" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(perm_diffs, <span class="at">breaks =</span> <span class="dv">30</span>, <span class="at">col =</span> <span class="st">"lightblue"</span>, </span>
<span id="cb375-310"><a href="#cb375-310" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Permutation Distribution of Mean Difference"</span>,</span>
<span id="cb375-311"><a href="#cb375-311" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Difference in Means (A - B)"</span>)</span>
<span id="cb375-312"><a href="#cb375-312" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> obs_diff, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb375-313"><a href="#cb375-313" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="sc">-</span>obs_diff, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb375-314"><a href="#cb375-314" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-315"><a href="#cb375-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-316"><a href="#cb375-316" aria-hidden="true" tabindex="-1"></a>Interpretation: The permutation distribution shows what differences in means we would expect if the two methods were equivalent (null hypothesis). The red lines mark the observed difference. If the observed difference falls in the tails of the permutation distribution, we have evidence that the methods differ. The p-value quantifies this: a small p-value indicates that the observed difference is unlikely under the null hypothesis.</span>
<span id="cb375-317"><a href="#cb375-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-318"><a href="#cb375-318" aria-hidden="true" tabindex="-1"></a><span class="fu">### Bootstrap Confidence Intervals</span></span>
<span id="cb375-319"><a href="#cb375-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-320"><a href="#cb375-320" aria-hidden="true" tabindex="-1"></a>Bootstrap resampling constructs confidence intervals by repeatedly sampling (with replacement) from the observed data and computing the statistic of interest for each resample. The distribution of bootstrap statistics approximates the sampling distribution of the estimator.</span>
<span id="cb375-321"><a href="#cb375-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-322"><a href="#cb375-322" aria-hidden="true" tabindex="-1"></a>Percentile bootstrap confidence intervals are formed by taking the appropriate quantiles of the bootstrap distribution. More sophisticated methods (BCa, studentised bootstrap) adjust for bias and skewness.</span>
<span id="cb375-323"><a href="#cb375-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-324"><a href="#cb375-324" aria-hidden="true" tabindex="-1"></a>**When to use**: Small samples, no closed-form standard error, complex statistics (medians, ratios, correlations), desire for distribution-free inference.</span>
<span id="cb375-325"><a href="#cb375-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-326"><a href="#cb375-326" aria-hidden="true" tabindex="-1"></a><span class="fu">### Example: Bootstrap CI for the Median</span></span>
<span id="cb375-327"><a href="#cb375-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-328"><a href="#cb375-328" aria-hidden="true" tabindex="-1"></a>We estimate the median recovery time (in days) for a small sample of patients and construct a 95% bootstrap confidence interval.</span>
<span id="cb375-329"><a href="#cb375-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-332"><a href="#cb375-332" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb375-333"><a href="#cb375-333" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: part-c-chunk-07</span></span>
<span id="cb375-334"><a href="#cb375-334" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb375-335"><a href="#cb375-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-336"><a href="#cb375-336" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb375-337"><a href="#cb375-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-338"><a href="#cb375-338" aria-hidden="true" tabindex="-1"></a>recovery_times <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">12</span>, <span class="dv">15</span>, <span class="dv">14</span>, <span class="dv">18</span>, <span class="dv">16</span>, <span class="dv">13</span>, <span class="dv">17</span>, <span class="dv">19</span>, <span class="dv">14</span>, <span class="dv">15</span>, <span class="dv">20</span>, <span class="dv">16</span>, <span class="dv">15</span>, <span class="dv">18</span>, <span class="dv">17</span>)</span>
<span id="cb375-339"><a href="#cb375-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-340"><a href="#cb375-340" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample median</span></span>
<span id="cb375-341"><a href="#cb375-341" aria-hidden="true" tabindex="-1"></a>sample_median <span class="ot">&lt;-</span> <span class="fu">median</span>(recovery_times)</span>
<span id="cb375-342"><a href="#cb375-342" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Sample median:"</span>, sample_median, <span class="st">"days</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-343"><a href="#cb375-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-344"><a href="#cb375-344" aria-hidden="true" tabindex="-1"></a><span class="co"># Bootstrap function</span></span>
<span id="cb375-345"><a href="#cb375-345" aria-hidden="true" tabindex="-1"></a>median_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(data, indices) {</span>
<span id="cb375-346"><a href="#cb375-346" aria-hidden="true" tabindex="-1"></a>  <span class="fu">median</span>(data[indices])</span>
<span id="cb375-347"><a href="#cb375-347" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb375-348"><a href="#cb375-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-349"><a href="#cb375-349" aria-hidden="true" tabindex="-1"></a><span class="co"># Bootstrap resampling</span></span>
<span id="cb375-350"><a href="#cb375-350" aria-hidden="true" tabindex="-1"></a>boot_result <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data =</span> recovery_times, <span class="at">statistic =</span> median_fun, <span class="at">R =</span> <span class="dv">2000</span>)</span>
<span id="cb375-351"><a href="#cb375-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-352"><a href="#cb375-352" aria-hidden="true" tabindex="-1"></a><span class="co"># Percentile CI</span></span>
<span id="cb375-353"><a href="#cb375-353" aria-hidden="true" tabindex="-1"></a>boot_ci <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(boot_result, <span class="at">conf =</span> <span class="fl">0.95</span>, <span class="at">type =</span> <span class="st">"perc"</span>)</span>
<span id="cb375-354"><a href="#cb375-354" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(boot_ci)</span>
<span id="cb375-355"><a href="#cb375-355" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-356"><a href="#cb375-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-357"><a href="#cb375-357" aria-hidden="true" tabindex="-1"></a>Interpretation: The sample median is our point estimate of the typical recovery time. The bootstrap confidence interval provides a range of plausible values. If the interval is narrow, the median is estimated precisely; if wide, there is substantial uncertainty. Unlike parametric CIs (which assume normality), the bootstrap CI adapts to the actual distribution of the data.</span>
<span id="cb375-358"><a href="#cb375-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-359"><a href="#cb375-359" aria-hidden="true" tabindex="-1"></a><span class="fu">## Lab Practical 3.1: Exact Tests Step-by-Step</span></span>
<span id="cb375-360"><a href="#cb375-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-361"><a href="#cb375-361" aria-hidden="true" tabindex="-1"></a>**Scenario**: A small clinical trial (n=8 per group) tests a new painkiller.</span>
<span id="cb375-362"><a href="#cb375-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-363"><a href="#cb375-363" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Group     <span class="pp">|</span> Success <span class="pp">|</span> Failure <span class="pp">|</span></span>
<span id="cb375-364"><a href="#cb375-364" aria-hidden="true" tabindex="-1"></a><span class="pp">|-----------|---------|---------|</span></span>
<span id="cb375-365"><a href="#cb375-365" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> New Drug  <span class="pp">|</span> 6       <span class="pp">|</span> 2       <span class="pp">|</span></span>
<span id="cb375-366"><a href="#cb375-366" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Placebo   <span class="pp">|</span> 2       <span class="pp">|</span> 6       <span class="pp">|</span></span>
<span id="cb375-367"><a href="#cb375-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-368"><a href="#cb375-368" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 1: Set Up Your Data</span></span>
<span id="cb375-369"><a href="#cb375-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-372"><a href="#cb375-372" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb375-373"><a href="#cb375-373" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: lab-practical-3-step1</span></span>
<span id="cb375-374"><a href="#cb375-374" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the 2x2 table</span></span>
<span id="cb375-375"><a href="#cb375-375" aria-hidden="true" tabindex="-1"></a>pain_data <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">6</span>), <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>,</span>
<span id="cb375-376"><a href="#cb375-376" aria-hidden="true" tabindex="-1"></a>                    <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="at">Treatment =</span> <span class="fu">c</span>(<span class="st">"Drug"</span>, <span class="st">"Placebo"</span>),</span>
<span id="cb375-377"><a href="#cb375-377" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">Outcome =</span> <span class="fu">c</span>(<span class="st">"Success"</span>, <span class="st">"Failure"</span>)))</span>
<span id="cb375-378"><a href="#cb375-378" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pain_data)</span>
<span id="cb375-379"><a href="#cb375-379" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-380"><a href="#cb375-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-381"><a href="#cb375-381" aria-hidden="true" tabindex="-1"></a>**Checkpoint**: Your table should show drug successes in the top-left cell (6).</span>
<span id="cb375-382"><a href="#cb375-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-383"><a href="#cb375-383" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 2: Run Fisher's Exact Test</span></span>
<span id="cb375-384"><a href="#cb375-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-387"><a href="#cb375-387" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb375-388"><a href="#cb375-388" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: lab-practical-3-step2</span></span>
<span id="cb375-389"><a href="#cb375-389" aria-hidden="true" tabindex="-1"></a>fisher_result <span class="ot">&lt;-</span> <span class="fu">fisher.test</span>(pain_data)</span>
<span id="cb375-390"><a href="#cb375-390" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fisher_result)</span>
<span id="cb375-391"><a href="#cb375-391" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-392"><a href="#cb375-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-393"><a href="#cb375-393" aria-hidden="true" tabindex="-1"></a>**Checkpoint**: </span>
<span id="cb375-394"><a href="#cb375-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-395"><a href="#cb375-395" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Is the p-value &lt; 0.05? (It should be ~0.17)</span>
<span id="cb375-396"><a href="#cb375-396" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>What is the odds ratio? (Should be 9)</span>
<span id="cb375-397"><a href="#cb375-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-398"><a href="#cb375-398" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 3: Interpret</span></span>
<span id="cb375-399"><a href="#cb375-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-402"><a href="#cb375-402" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb375-403"><a href="#cb375-403" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: lab-practical-3-step3</span></span>
<span id="cb375-404"><a href="#cb375-404" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Odds of success with new drug are"</span>, </span>
<span id="cb375-405"><a href="#cb375-405" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(fisher_result<span class="sc">$</span>estimate, <span class="dv">1</span>), </span>
<span id="cb375-406"><a href="#cb375-406" aria-hidden="true" tabindex="-1"></a>    <span class="st">"times higher than placebo.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-407"><a href="#cb375-407" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"However, p ="</span>, <span class="fu">round</span>(fisher_result<span class="sc">$</span>p.value, <span class="dv">3</span>), </span>
<span id="cb375-408"><a href="#cb375-408" aria-hidden="true" tabindex="-1"></a>    <span class="st">"so this is not statistically significant at Î± = 0.05.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-409"><a href="#cb375-409" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"95% CI for OR:"</span>, <span class="fu">round</span>(fisher_result<span class="sc">$</span>conf.int, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-410"><a href="#cb375-410" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-411"><a href="#cb375-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-412"><a href="#cb375-412" aria-hidden="true" tabindex="-1"></a>**Discussion Questions:**</span>
<span id="cb375-413"><a href="#cb375-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-414"><a href="#cb375-414" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Why is the result not significant despite an OR of 9?</span>
<span id="cb375-415"><a href="#cb375-415" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>What does the CI tell us about the range of plausible effects?</span>
<span id="cb375-416"><a href="#cb375-416" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>How would results change with n=20 per group? (Try it!)</span>
<span id="cb375-417"><a href="#cb375-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-418"><a href="#cb375-418" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 4: Compare with Chi-Square</span></span>
<span id="cb375-419"><a href="#cb375-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-422"><a href="#cb375-422" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb375-423"><a href="#cb375-423" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: lab-practical-3-step4</span></span>
<span id="cb375-424"><a href="#cb375-424" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(pain_data)</span>
<span id="cb375-425"><a href="#cb375-425" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-426"><a href="#cb375-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-427"><a href="#cb375-427" aria-hidden="true" tabindex="-1"></a>**What warning appears? Why?**</span>
<span id="cb375-428"><a href="#cb375-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-429"><a href="#cb375-429" aria-hidden="true" tabindex="-1"></a>**Key Takeaway**: With small cell counts (&lt;5), Fisher's exact test is mandatory. Chi-square approximations fail.</span>
<span id="cb375-430"><a href="#cb375-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-431"><a href="#cb375-431" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-432"><a href="#cb375-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-433"><a href="#cb375-433" aria-hidden="true" tabindex="-1"></a><span class="fu">### Self-Assessment Quiz</span></span>
<span id="cb375-434"><a href="#cb375-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-435"><a href="#cb375-435" aria-hidden="true" tabindex="-1"></a>Test your understanding of exact tests and resampling methods from Chapter 3. Answers and explanations are provided at the end.</span>
<span id="cb375-436"><a href="#cb375-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-437"><a href="#cb375-437" aria-hidden="true" tabindex="-1"></a>::: {.callout-note icon=false}</span>
<span id="cb375-438"><a href="#cb375-438" aria-hidden="true" tabindex="-1"></a><span class="fu">## Questions</span></span>
<span id="cb375-439"><a href="#cb375-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-440"><a href="#cb375-440" aria-hidden="true" tabindex="-1"></a>**Q1.** Fisher's exact test is preferred over chi-square when:</span>
<span id="cb375-441"><a href="#cb375-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-442"><a href="#cb375-442" aria-hidden="true" tabindex="-1"></a>A. Sample size exceeds 100  </span>
<span id="cb375-443"><a href="#cb375-443" aria-hidden="true" tabindex="-1"></a>B. All expected cell counts are â‰¥10  </span>
<span id="cb375-444"><a href="#cb375-444" aria-hidden="true" tabindex="-1"></a>C. Any expected cell count is &lt;5  </span>
<span id="cb375-445"><a href="#cb375-445" aria-hidden="true" tabindex="-1"></a>D. Data are continuous</span>
<span id="cb375-446"><a href="#cb375-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-447"><a href="#cb375-447" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-448"><a href="#cb375-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-449"><a href="#cb375-449" aria-hidden="true" tabindex="-1"></a>**Q2.** A 2Ã—2 table shows: Treatment (8 success, 2 fail) vs Control (2 success, 8 fail). Fisher's test yields p=0.03, OR=16. The interpretation is:</span>
<span id="cb375-450"><a href="#cb375-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-451"><a href="#cb375-451" aria-hidden="true" tabindex="-1"></a>A. Treatment is 16 times better than control (definitely)  </span>
<span id="cb375-452"><a href="#cb375-452" aria-hidden="true" tabindex="-1"></a>B. Odds of success are 16 times higher with treatment; p=0.03 suggests this is unlikely due to chance  </span>
<span id="cb375-453"><a href="#cb375-453" aria-hidden="true" tabindex="-1"></a>C. 16% of patients benefit from treatment  </span>
<span id="cb375-454"><a href="#cb375-454" aria-hidden="true" tabindex="-1"></a>D. The null hypothesis is false</span>
<span id="cb375-455"><a href="#cb375-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-456"><a href="#cb375-456" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-457"><a href="#cb375-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-458"><a href="#cb375-458" aria-hidden="true" tabindex="-1"></a>**Q3.** What does an exact binomial test assess?</span>
<span id="cb375-459"><a href="#cb375-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-460"><a href="#cb375-460" aria-hidden="true" tabindex="-1"></a>A. Whether two proportions differ  </span>
<span id="cb375-461"><a href="#cb375-461" aria-hidden="true" tabindex="-1"></a>B. Whether an observed proportion differs from a hypothesized value  </span>
<span id="cb375-462"><a href="#cb375-462" aria-hidden="true" tabindex="-1"></a>C. Whether data are normally distributed  </span>
<span id="cb375-463"><a href="#cb375-463" aria-hidden="true" tabindex="-1"></a>D. Whether variances are equal</span>
<span id="cb375-464"><a href="#cb375-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-465"><a href="#cb375-465" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-466"><a href="#cb375-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-467"><a href="#cb375-467" aria-hidden="true" tabindex="-1"></a>**Q4.** A permutation test with 5,000 permutations yields p=0.022. What does this mean?</span>
<span id="cb375-468"><a href="#cb375-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-469"><a href="#cb375-469" aria-hidden="true" tabindex="-1"></a>A. 2.2% of permutations produced test statistics as extreme as observed  </span>
<span id="cb375-470"><a href="#cb375-470" aria-hidden="true" tabindex="-1"></a>B. The effect size is 0.022  </span>
<span id="cb375-471"><a href="#cb375-471" aria-hidden="true" tabindex="-1"></a>C. 22 permutations were significant  </span>
<span id="cb375-472"><a href="#cb375-472" aria-hidden="true" tabindex="-1"></a>D. The test is invalid</span>
<span id="cb375-473"><a href="#cb375-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-474"><a href="#cb375-474" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-475"><a href="#cb375-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-476"><a href="#cb375-476" aria-hidden="true" tabindex="-1"></a>**Q5.** Bootstrap confidence intervals are preferred over parametric CIs when:</span>
<span id="cb375-477"><a href="#cb375-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-478"><a href="#cb375-478" aria-hidden="true" tabindex="-1"></a>A. Sample size exceeds 1,000  </span>
<span id="cb375-479"><a href="#cb375-479" aria-hidden="true" tabindex="-1"></a>B. Data are perfectly normally distributed  </span>
<span id="cb375-480"><a href="#cb375-480" aria-hidden="true" tabindex="-1"></a>C. Distributional assumptions are questionable or the statistic has no closed-form SE  </span>
<span id="cb375-481"><a href="#cb375-481" aria-hidden="true" tabindex="-1"></a>D. Neverâ€”parametric CIs are always better</span>
<span id="cb375-482"><a href="#cb375-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-483"><a href="#cb375-483" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-484"><a href="#cb375-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-485"><a href="#cb375-485" aria-hidden="true" tabindex="-1"></a>**Q6.** A bootstrap CI for the median (based on 2,000 resamples) is <span class="co">[</span><span class="ot">12, 18</span><span class="co">]</span>. This means:</span>
<span id="cb375-486"><a href="#cb375-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-487"><a href="#cb375-487" aria-hidden="true" tabindex="-1"></a>A. The true median is definitely between 12 and 18  </span>
<span id="cb375-488"><a href="#cb375-488" aria-hidden="true" tabindex="-1"></a>B. 95% of bootstrap resamples had medians between 12 and 18  </span>
<span id="cb375-489"><a href="#cb375-489" aria-hidden="true" tabindex="-1"></a>C. We are 95% confident the true population median lies between 12 and 18  </span>
<span id="cb375-490"><a href="#cb375-490" aria-hidden="true" tabindex="-1"></a>D. The sample median is 15</span>
<span id="cb375-491"><a href="#cb375-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-492"><a href="#cb375-492" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-493"><a href="#cb375-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-494"><a href="#cb375-494" aria-hidden="true" tabindex="-1"></a>**Q7.** Exact Poisson test: Observed 15 defects in 5 batches (rate=3 per batch). Expected rate is 2 per batch. The test assesses:</span>
<span id="cb375-495"><a href="#cb375-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-496"><a href="#cb375-496" aria-hidden="true" tabindex="-1"></a>A. Whether 3 differs significantly from 2  </span>
<span id="cb375-497"><a href="#cb375-497" aria-hidden="true" tabindex="-1"></a>B. Whether the observed rate is consistent with the expected rate of 2  </span>
<span id="cb375-498"><a href="#cb375-498" aria-hidden="true" tabindex="-1"></a>C. Whether defects are normally distributed  </span>
<span id="cb375-499"><a href="#cb375-499" aria-hidden="true" tabindex="-1"></a>D. Whether batches differ from each other</span>
<span id="cb375-500"><a href="#cb375-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-501"><a href="#cb375-501" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-502"><a href="#cb375-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-503"><a href="#cb375-503" aria-hidden="true" tabindex="-1"></a>**Q8.** Which statement about Barnard's exact test is TRUE?</span>
<span id="cb375-504"><a href="#cb375-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-505"><a href="#cb375-505" aria-hidden="true" tabindex="-1"></a>A. It is identical to Fisher's exact test  </span>
<span id="cb375-506"><a href="#cb375-506" aria-hidden="true" tabindex="-1"></a>B. It typically has higher power than Fisher's test but is more computationally intensive  </span>
<span id="cb375-507"><a href="#cb375-507" aria-hidden="true" tabindex="-1"></a>C. It requires normal distributions  </span>
<span id="cb375-508"><a href="#cb375-508" aria-hidden="true" tabindex="-1"></a>D. It is only for continuous data</span>
<span id="cb375-509"><a href="#cb375-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-510"><a href="#cb375-510" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-511"><a href="#cb375-511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-512"><a href="#cb375-512" aria-hidden="true" tabindex="-1"></a>**Q9.** A researcher performs 10 permutation tests on the same dataset. What is the concern?</span>
<span id="cb375-513"><a href="#cb375-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-514"><a href="#cb375-514" aria-hidden="true" tabindex="-1"></a>A. Permutation tests cannot be repeated  </span>
<span id="cb375-515"><a href="#cb375-515" aria-hidden="true" tabindex="-1"></a>B. Multiple testing inflates Type I error; correction is needed  </span>
<span id="cb375-516"><a href="#cb375-516" aria-hidden="true" tabindex="-1"></a>C. Permutation tests are invalid with small samples  </span>
<span id="cb375-517"><a href="#cb375-517" aria-hidden="true" tabindex="-1"></a>D. No concernâ€”each test is independent</span>
<span id="cb375-518"><a href="#cb375-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-519"><a href="#cb375-519" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-520"><a href="#cb375-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-521"><a href="#cb375-521" aria-hidden="true" tabindex="-1"></a>**Q10.** When would you prefer a bootstrap CI over an exact test?</span>
<span id="cb375-522"><a href="#cb375-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-523"><a href="#cb375-523" aria-hidden="true" tabindex="-1"></a>A. For hypothesis testing of proportions  </span>
<span id="cb375-524"><a href="#cb375-524" aria-hidden="true" tabindex="-1"></a>B. For estimating the CI of a complex statistic like a trimmed mean  </span>
<span id="cb375-525"><a href="#cb375-525" aria-hidden="true" tabindex="-1"></a>C. Neverâ€”exact tests are always superior  </span>
<span id="cb375-526"><a href="#cb375-526" aria-hidden="true" tabindex="-1"></a>D. Only with n&gt;1,000</span>
<span id="cb375-527"><a href="#cb375-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-528"><a href="#cb375-528" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-529"><a href="#cb375-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-530"><a href="#cb375-530" aria-hidden="true" tabindex="-1"></a>**Q11.** A permutation test yields p=0.051. The researcher runs it again and gets p=0.049. What explains this?</span>
<span id="cb375-531"><a href="#cb375-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-532"><a href="#cb375-532" aria-hidden="true" tabindex="-1"></a>A. Permutation tests are unreliable  </span>
<span id="cb375-533"><a href="#cb375-533" aria-hidden="true" tabindex="-1"></a>B. Random variation in permutation samples; increase number of permutations for stability  </span>
<span id="cb375-534"><a href="#cb375-534" aria-hidden="true" tabindex="-1"></a>C. The data changed  </span>
<span id="cb375-535"><a href="#cb375-535" aria-hidden="true" tabindex="-1"></a>D. An error occurred</span>
<span id="cb375-536"><a href="#cb375-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-537"><a href="#cb375-537" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-538"><a href="#cb375-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-539"><a href="#cb375-539" aria-hidden="true" tabindex="-1"></a>**Q12.** Which scenario is BEST suited to exact methods?</span>
<span id="cb375-540"><a href="#cb375-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-541"><a href="#cb375-541" aria-hidden="true" tabindex="-1"></a>A. n=500 per group, comparing means  </span>
<span id="cb375-542"><a href="#cb375-542" aria-hidden="true" tabindex="-1"></a>B. n=8 per group, comparing proportions in a 2Ã—2 table  </span>
<span id="cb375-543"><a href="#cb375-543" aria-hidden="true" tabindex="-1"></a>C. n=1,000, continuous outcome with perfect normality  </span>
<span id="cb375-544"><a href="#cb375-544" aria-hidden="true" tabindex="-1"></a>D. n=200, t-test with equal variances</span>
<span id="cb375-545"><a href="#cb375-545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-546"><a href="#cb375-546" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb375-547"><a href="#cb375-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-548"><a href="#cb375-548" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip icon=false collapse="true"}</span>
<span id="cb375-549"><a href="#cb375-549" aria-hidden="true" tabindex="-1"></a><span class="fu">## Answers and Explanations</span></span>
<span id="cb375-550"><a href="#cb375-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-551"><a href="#cb375-551" aria-hidden="true" tabindex="-1"></a>**Q1. Answer: C**  </span>
<span id="cb375-552"><a href="#cb375-552" aria-hidden="true" tabindex="-1"></a>*Explanation*: Chi-square relies on large-sample approximations that break down when expected frequencies are small. Fisher's exact test computes exact probabilities and is mandatory when any cell has expected count &lt;5. The chapter explicitly demonstrates this: "Expected cell counts under independence...All cells &lt; 5, so Fisher's exact test is required."</span>
<span id="cb375-553"><a href="#cb375-553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-554"><a href="#cb375-554" aria-hidden="true" tabindex="-1"></a>**Q2. Answer: B**  </span>
<span id="cb375-555"><a href="#cb375-555" aria-hidden="true" tabindex="-1"></a>*Explanation*: OR=16 quantifies the association strength; p=0.03 indicates this degree of association is unlikely (3% chance) if treatment had no effect. However, the CI should also be considered (likely wide with n=20 total). The chapter's interpretation guide emphasizes examining the odds ratio, confidence interval, and p-value together for proper interpretation.</span>
<span id="cb375-556"><a href="#cb375-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-557"><a href="#cb375-557" aria-hidden="true" tabindex="-1"></a>**Q3. Answer: B**  </span>
<span id="cb375-558"><a href="#cb375-558" aria-hidden="true" tabindex="-1"></a>*Explanation*: The exact binomial test compares an observed proportion (e.g., 13/15 = 87% passed) to a null hypothesis value (e.g., 70% expected pass rate). This is the fundamental purpose of the binomial test as described in the chapter's section on exact binomial tests.</span>
<span id="cb375-559"><a href="#cb375-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-560"><a href="#cb375-560" aria-hidden="true" tabindex="-1"></a>**Q4. Answer: A**  </span>
<span id="cb375-561"><a href="#cb375-561" aria-hidden="true" tabindex="-1"></a>*Explanation*: In permutation tests, the p-value is the proportion of permuted datasets that produce test statistics as extreme or more extreme than the observed data. Here, 110 of 5,000 permutations (2.2%) exceeded the observed statistic. This aligns with how permutation tests construct their null distribution through shuffling.</span>
<span id="cb375-562"><a href="#cb375-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-563"><a href="#cb375-563" aria-hidden="true" tabindex="-1"></a>**Q5. Answer: C**  </span>
<span id="cb375-564"><a href="#cb375-564" aria-hidden="true" tabindex="-1"></a>*Explanation*: Bootstrap CIs adapt to the actual data distribution and work for any statistic (median, correlation, etc.). They're especially valuable with non-normal data or complex statistics. The chapter states: "Bootstrap resampling draws repeated samples (with replacement) from the observed data to estimate the variability of an estimator and construct confidence intervals."</span>
<span id="cb375-565"><a href="#cb375-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-566"><a href="#cb375-566" aria-hidden="true" tabindex="-1"></a>**Q6. Answer: C**  </span>
<span id="cb375-567"><a href="#cb375-567" aria-hidden="true" tabindex="-1"></a>*Explanation*: A 95% bootstrap CI provides a plausible range for the population parameter. It's constructed from the 2.5th and 97.5th percentiles of the bootstrap distribution. This is the standard interpretation of confidence intervals applied to bootstrap methods.</span>
<span id="cb375-568"><a href="#cb375-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-569"><a href="#cb375-569" aria-hidden="true" tabindex="-1"></a>**Q7. Answer: B**  </span>
<span id="cb375-570"><a href="#cb375-570" aria-hidden="true" tabindex="-1"></a>*Explanation*: The exact Poisson test compares the observed rate (15/5 = 3) to a null hypothesis rate (2 per batch = 10 expected in 5 batches). It tests whether the observed count is consistent with the expected rate. This is the fundamental application of Poisson tests for count data.</span>
<span id="cb375-571"><a href="#cb375-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-572"><a href="#cb375-572" aria-hidden="true" tabindex="-1"></a>**Q8. Answer: B**  </span>
<span id="cb375-573"><a href="#cb375-573" aria-hidden="true" tabindex="-1"></a>*Explanation*: Barnard's test does not condition on both margins (only on the row totals), giving it higher power than Fisher's. However, it's computationally more demanding, so Fisher's remains the conventional choice. The chapter section "Barnard's Exact Test" explains: "Barnard's exact test...does not condition on both margins. It tends to have higher power than Fisher's test...However, it is computationally more demanding."</span>
<span id="cb375-574"><a href="#cb375-574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-575"><a href="#cb375-575" aria-hidden="true" tabindex="-1"></a>**Q9. Answer: B**  </span>
<span id="cb375-576"><a href="#cb375-576" aria-hidden="true" tabindex="-1"></a>*Explanation*: Performing multiple tests (10 in this case) increases the family-wise error rate. With Î±=0.05 per test, the probability of at least one false positive is ~40%. Corrections (Bonferroni, Holm) are needed. This is a general principle of multiple testing that applies to all statistical methods, including permutation tests.</span>
<span id="cb375-577"><a href="#cb375-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-578"><a href="#cb375-578" aria-hidden="true" tabindex="-1"></a>**Q10. Answer: B**  </span>
<span id="cb375-579"><a href="#cb375-579" aria-hidden="true" tabindex="-1"></a>*Explanation*: Exact tests are for hypothesis testing (p-values). Bootstrap CIs are for estimation (confidence intervals) and work for any statistic, including those without closed-form formulas (trimmed means, medians, ratios, etc.). The chapter distinguishes between hypothesis testing approaches (exact tests) and estimation approaches (bootstrap).</span>
<span id="cb375-580"><a href="#cb375-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-581"><a href="#cb375-581" aria-hidden="true" tabindex="-1"></a>**Q11. Answer: B**  </span>
<span id="cb375-582"><a href="#cb375-582" aria-hidden="true" tabindex="-1"></a>*Explanation*: With finite permutations (e.g., 1,000), the p-value is estimated with some Monte Carlo error. Increasing permutations (10,000+) or setting a random seed ensures reproducibility. This reflects the stochastic nature of resampling methods when using a finite number of permutations.</span>
<span id="cb375-583"><a href="#cb375-583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-584"><a href="#cb375-584" aria-hidden="true" tabindex="-1"></a>**Q12. Answer: B**  </span>
<span id="cb375-585"><a href="#cb375-585" aria-hidden="true" tabindex="-1"></a>*Explanation*: Exact methods shine with small samples and discrete outcomes. With n=8 per group and 2Ã—2 tables, asymptotic approximations fail, but exact tests compute probabilities directly from the hypergeometric distribution. The chapter emphasizes: "Fisher's exact test is the standard method for testing independence in a 2Ã—2 contingency table when cell counts are small."</span>
<span id="cb375-586"><a href="#cb375-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-587"><a href="#cb375-587" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb375-588"><a href="#cb375-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-589"><a href="#cb375-589" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-590"><a href="#cb375-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-591"><a href="#cb375-591" aria-hidden="true" tabindex="-1"></a><span class="fu">### Key Takeaways</span></span>
<span id="cb375-592"><a href="#cb375-592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-593"><a href="#cb375-593" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Exact tests compute p-values directly from probability distributions, avoiding large-sample approximations.</span>
<span id="cb375-594"><a href="#cb375-594" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Fisher's exact test is the standard for 2Ã—2 tables with small counts; Barnard's test offers higher power but is less common.</span>
<span id="cb375-595"><a href="#cb375-595" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Exact binomial and Poisson tests are appropriate for proportions and counts when samples are small.</span>
<span id="cb375-596"><a href="#cb375-596" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Permutation tests provide exact, distribution-free inference for group comparisons with custom test statistics.</span>
<span id="cb375-597"><a href="#cb375-597" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Bootstrap confidence intervals quantify uncertainty for any statistic without requiring closed-form standard errors.</span>
<span id="cb375-598"><a href="#cb375-598" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>All these methods are computationally intensive but feasible with modern software and provide robust inferences for small samples.</span>
<span id="cb375-599"><a href="#cb375-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-600"><a href="#cb375-600" aria-hidden="true" tabindex="-1"></a><span class="fu">### Smoke Test</span></span>
<span id="cb375-601"><a href="#cb375-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-604"><a href="#cb375-604" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb375-605"><a href="#cb375-605" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: part-c-chunk-08</span></span>
<span id="cb375-606"><a href="#cb375-606" aria-hidden="true" tabindex="-1"></a><span class="co"># Re-run exact binomial test</span></span>
<span id="cb375-607"><a href="#cb375-607" aria-hidden="true" tabindex="-1"></a><span class="fu">binom.test</span>(<span class="at">x =</span> <span class="dv">8</span>, <span class="at">n =</span> <span class="dv">10</span>, <span class="at">p =</span> <span class="fl">0.5</span>)</span>
<span id="cb375-608"><a href="#cb375-608" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-609"><a href="#cb375-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-610"><a href="#cb375-610" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-611"><a href="#cb375-611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-612"><a href="#cb375-612" aria-hidden="true" tabindex="-1"></a><span class="fu">## Chapter 4. Nonparametric Rank-Based Methods</span></span>
<span id="cb375-613"><a href="#cb375-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-614"><a href="#cb375-614" aria-hidden="true" tabindex="-1"></a><span class="fu">### Learning Objectives</span></span>
<span id="cb375-615"><a href="#cb375-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-616"><a href="#cb375-616" aria-hidden="true" tabindex="-1"></a>By the end of this chapter, you will be able to:</span>
<span id="cb375-617"><a href="#cb375-617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-618"><a href="#cb375-618" aria-hidden="true" tabindex="-1"></a>**Conceptual Understanding**</span>
<span id="cb375-619"><a href="#cb375-619" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Explain why rank-based methods are robust to outliers and non-normality</span>
<span id="cb375-620"><a href="#cb375-620" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Understand the null hypotheses tested by Mann-Whitney, Wilcoxon, and Kruskal-Wallis</span>
<span id="cb375-621"><a href="#cb375-621" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Recognize when rank-based tests have more/less power than parametric alternatives</span>
<span id="cb375-622"><a href="#cb375-622" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Distinguish location shifts from general distributional differences</span>
<span id="cb375-623"><a href="#cb375-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-624"><a href="#cb375-624" aria-hidden="true" tabindex="-1"></a>**Practical Skills**</span>
<span id="cb375-625"><a href="#cb375-625" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Conduct Mann-Whitney U test using <span class="in">`wilcox.test()`</span> in R</span>
<span id="cb375-626"><a href="#cb375-626" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Apply Wilcoxon signed-rank test for paired comparisons</span>
<span id="cb375-627"><a href="#cb375-627" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Perform Kruskal-Wallis and Friedman tests for multiple groups</span>
<span id="cb375-628"><a href="#cb375-628" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Compute Spearman's Ï and Kendall's Ï„ with <span class="in">`cor.test()`</span></span>
<span id="cb375-629"><a href="#cb375-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-630"><a href="#cb375-630" aria-hidden="true" tabindex="-1"></a>**Critical Evaluation**</span>
<span id="cb375-631"><a href="#cb375-631" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Assess when nonparametric tests are necessary vs. when t-tests are adequate</span>
<span id="cb375-632"><a href="#cb375-632" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Evaluate effect sizes (rank-biserial correlation, Cliff's delta) alongside p-values</span>
<span id="cb375-633"><a href="#cb375-633" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Critique over-reliance on rank tests when parametric assumptions are reasonable</span>
<span id="cb375-634"><a href="#cb375-634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-635"><a href="#cb375-635" aria-hidden="true" tabindex="-1"></a>**Application**</span>
<span id="cb375-636"><a href="#cb375-636" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Select appropriate rank-based methods for ordinal or skewed data</span>
<span id="cb375-637"><a href="#cb375-637" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Report rank-based tests with medians, IQRs, and effect sizes</span>
<span id="cb375-638"><a href="#cb375-638" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Use nonparametric methods for small samples with uncertain distributional forms</span>
<span id="cb375-639"><a href="#cb375-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-640"><a href="#cb375-640" aria-hidden="true" tabindex="-1"></a><span class="fu">### When to Use Rank-Based Methods</span></span>
<span id="cb375-641"><a href="#cb375-641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-642"><a href="#cb375-642" aria-hidden="true" tabindex="-1"></a>Rank-based (nonparametric) tests use the ranks of observations rather than their raw values. They are robust to outliers, skewed distributions, and violations of normality. Because they discard information about the magnitude of differences (retaining only order), they may have slightly less power than parametric tests when parametric assumptions hold. However, when assumptions are violated or sample sizes are small, rank-based methods often outperform parametric alternatives.</span>
<span id="cb375-643"><a href="#cb375-643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-644"><a href="#cb375-644" aria-hidden="true" tabindex="-1"></a>**When to use**: Ordinal outcomes, non-normal continuous outcomes, small samples, presence of outliers, desire for assumption-free inference.</span>
<span id="cb375-645"><a href="#cb375-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-646"><a href="#cb375-646" aria-hidden="true" tabindex="-1"></a><span class="fu">### Mannâ€“Whitney U Test (Wilcoxon Rank-Sum Test)</span></span>
<span id="cb375-647"><a href="#cb375-647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-648"><a href="#cb375-648" aria-hidden="true" tabindex="-1"></a>The Mannâ€“Whitney U test compares the central tendencies of two independent groups. Under the assumption of similar distributional shapes (same spread and skewness), it tests whether medians differ. If distributions differ in shape, the test assesses stochastic dominance (whether values from one group tend to be larger).</span>
<span id="cb375-649"><a href="#cb375-649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-650"><a href="#cb375-650" aria-hidden="true" tabindex="-1"></a>The test ranks all observations together, then compares the sum of ranks in each group. The Hodgesâ€“Lehmann estimator provides a point estimate of the location shift (the median of all pairwise differences between groups) with a confidence interval.</span>
<span id="cb375-651"><a href="#cb375-651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-652"><a href="#cb375-652" aria-hidden="true" tabindex="-1"></a>**Assumptions**: Observations are independent. The two groups have similar distributional shapes (same spread and skewness) for the median interpretation to be valid. If shapes differ markedly, the test assesses whether one distribution is stochastically larger than the other.</span>
<span id="cb375-653"><a href="#cb375-653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-654"><a href="#cb375-654" aria-hidden="true" tabindex="-1"></a>**When to use**: Two independent groups, ordinal or continuous outcomes, small samples, non-normal distributions.</span>
<span id="cb375-655"><a href="#cb375-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-656"><a href="#cb375-656" aria-hidden="true" tabindex="-1"></a>::: {.callout-warning}</span>
<span id="cb375-657"><a href="#cb375-657" aria-hidden="true" tabindex="-1"></a><span class="fu">## Assumption Check</span></span>
<span id="cb375-658"><a href="#cb375-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-659"><a href="#cb375-659" aria-hidden="true" tabindex="-1"></a>Before interpreting Mannâ€“Whitney results as median comparisons:</span>
<span id="cb375-660"><a href="#cb375-660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-661"><a href="#cb375-661" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Compare group variances (should be similar)</span>
<span id="cb375-662"><a href="#cb375-662" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Inspect distributions visually (similar shapes?)</span>
<span id="cb375-663"><a href="#cb375-663" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>If shapes differ markedly, interpret as stochastic dominance</span>
<span id="cb375-664"><a href="#cb375-664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-665"><a href="#cb375-665" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb375-666"><a href="#cb375-666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-667"><a href="#cb375-667" aria-hidden="true" tabindex="-1"></a><span class="fu">### Example: Mannâ€“Whitney U Test</span></span>
<span id="cb375-668"><a href="#cb375-668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-669"><a href="#cb375-669" aria-hidden="true" tabindex="-1"></a>We compare customer wait times (in minutes) between two service branches. Branch A has 10 observations, Branch B has 12 observations. Wait times are right-skewed.</span>
<span id="cb375-670"><a href="#cb375-670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-673"><a href="#cb375-673" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb375-674"><a href="#cb375-674" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: part-c-chunk-09</span></span>
<span id="cb375-675"><a href="#cb375-675" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb375-676"><a href="#cb375-676" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstatix)</span>
<span id="cb375-677"><a href="#cb375-677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-678"><a href="#cb375-678" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb375-679"><a href="#cb375-679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-680"><a href="#cb375-680" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulated wait times (right-skewed)</span></span>
<span id="cb375-681"><a href="#cb375-681" aria-hidden="true" tabindex="-1"></a>branch_a_wait <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">12</span>, <span class="dv">7</span>, <span class="dv">9</span>, <span class="dv">6</span>, <span class="dv">10</span>, <span class="dv">8</span>)</span>
<span id="cb375-682"><a href="#cb375-682" aria-hidden="true" tabindex="-1"></a>branch_b_wait <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">14</span>, <span class="dv">11</span>, <span class="dv">13</span>, <span class="dv">15</span>, <span class="dv">12</span>, <span class="dv">16</span>, <span class="dv">11</span>, <span class="dv">14</span>, <span class="dv">13</span>, <span class="dv">15</span>, <span class="dv">12</span>)</span>
<span id="cb375-683"><a href="#cb375-683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-684"><a href="#cb375-684" aria-hidden="true" tabindex="-1"></a>wait_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb375-685"><a href="#cb375-685" aria-hidden="true" tabindex="-1"></a>  <span class="at">wait_time =</span> <span class="fu">c</span>(branch_a_wait, branch_b_wait),</span>
<span id="cb375-686"><a href="#cb375-686" aria-hidden="true" tabindex="-1"></a>  <span class="at">branch =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>), <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">12</span>))</span>
<span id="cb375-687"><a href="#cb375-687" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb375-688"><a href="#cb375-688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-689"><a href="#cb375-689" aria-hidden="true" tabindex="-1"></a><span class="co"># Mannâ€“Whitney U test with Hodgesâ€“Lehmann CI</span></span>
<span id="cb375-690"><a href="#cb375-690" aria-hidden="true" tabindex="-1"></a>mw_result <span class="ot">&lt;-</span> <span class="fu">wilcox_test</span>(wait_data, wait_time <span class="sc">~</span> branch, <span class="at">detailed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb375-691"><a href="#cb375-691" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(mw_result)</span>
<span id="cb375-692"><a href="#cb375-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-693"><a href="#cb375-693" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternative: base R for Hodgesâ€“Lehmann estimate and CI</span></span>
<span id="cb375-694"><a href="#cb375-694" aria-hidden="true" tabindex="-1"></a>wilcox_base <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(branch_a_wait, branch_b_wait, <span class="at">conf.int =</span> <span class="cn">TRUE</span>)</span>
<span id="cb375-695"><a href="#cb375-695" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(wilcox_base)</span>
<span id="cb375-696"><a href="#cb375-696" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-697"><a href="#cb375-697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-698"><a href="#cb375-698" aria-hidden="true" tabindex="-1"></a>Interpretation: The p-value tests whether the distributions differ. If p &lt; 0.05, we conclude that wait times differ between branches. The Hodgesâ€“Lehmann estimate (called "estimate" in the output) is the median of all pairwise differences between groups; it estimates the location shift. The confidence interval provides a range of plausible shifts. The effect size (rank-biserial correlation, if reported by <span class="in">`rstatix`</span>) quantifies the magnitude of the difference on a standardised scale.</span>
<span id="cb375-699"><a href="#cb375-699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-700"><a href="#cb375-700" aria-hidden="true" tabindex="-1"></a><span class="fu">### Cliff's Delta as a Robust Effect Size</span></span>
<span id="cb375-701"><a href="#cb375-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-702"><a href="#cb375-702" aria-hidden="true" tabindex="-1"></a>Rank-biserial correlation is convenient when produced automatically, but **Cliff's delta (Î”)** offers a distribution-free measure of stochastic superiority that works well for small samples and tied ranks. Î” ranges from -1 (all observations in group B exceed those in group A) to +1 (the reverse); Î” = 0 indicates no systematic dominance.</span>
<span id="cb375-703"><a href="#cb375-703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-706"><a href="#cb375-706" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb375-707"><a href="#cb375-707" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: part-c-chunk-10</span></span>
<span id="cb375-708"><a href="#cb375-708" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(effsize)</span>
<span id="cb375-709"><a href="#cb375-709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-710"><a href="#cb375-710" aria-hidden="true" tabindex="-1"></a><span class="co"># Cliff's delta for the wait-time example</span></span>
<span id="cb375-711"><a href="#cb375-711" aria-hidden="true" tabindex="-1"></a>cliff_delta_result <span class="ot">&lt;-</span> <span class="fu">cliff.delta</span>(branch_a_wait, branch_b_wait, <span class="at">conf.level =</span> <span class="fl">0.95</span>)</span>
<span id="cb375-712"><a href="#cb375-712" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cliff_delta_result)</span>
<span id="cb375-713"><a href="#cb375-713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-714"><a href="#cb375-714" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Interpretation guide:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-715"><a href="#cb375-715" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  |Î”| &lt; 0.147  â†’ negligible</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-716"><a href="#cb375-716" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  0.147â€“0.33  â†’ small</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-717"><a href="#cb375-717" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  0.33â€“0.474 â†’ medium</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-718"><a href="#cb375-718" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  |Î”| â‰¥ 0.474 â†’ large (Romano et al., 2006)</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-719"><a href="#cb375-719" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-720"><a href="#cb375-720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-721"><a href="#cb375-721" aria-hidden="true" tabindex="-1"></a>Interpretation: Cliff's delta reports the probability that a randomly selected value from Branch A exceeds one from Branch B minus the reverse probability. The output includes a confidence interval, which widens with ties or very small samples. Report Î” alongside Mannâ€“Whitney results to convey practical importance, especially when groups differ in distributional shape.</span>
<span id="cb375-722"><a href="#cb375-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-723"><a href="#cb375-723" aria-hidden="true" tabindex="-1"></a>::: {.callout-warning}</span>
<span id="cb375-724"><a href="#cb375-724" aria-hidden="true" tabindex="-1"></a><span class="fu">## âš ï¸ Common Misconception: "Large Effect Size = Real Effect"</span></span>
<span id="cb375-725"><a href="#cb375-725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-726"><a href="#cb375-726" aria-hidden="true" tabindex="-1"></a>**Myth**: "A large effect size proves the effect is real."</span>
<span id="cb375-727"><a href="#cb375-727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-728"><a href="#cb375-728" aria-hidden="true" tabindex="-1"></a>**Reality**: Effect sizes can be large **by chance**, especially with small samples. With n = 5 per group, sampling variability is enormousâ€”you might observe Cohen's d = 1.0 or Cliff's Î” = 0.8 even when groups are truly identical.</span>
<span id="cb375-729"><a href="#cb375-729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-730"><a href="#cb375-730" aria-hidden="true" tabindex="-1"></a>**Demonstration**:</span>
<span id="cb375-733"><a href="#cb375-733" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb375-734"><a href="#cb375-734" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: part-c-misconception-2</span></span>
<span id="cb375-735"><a href="#cb375-735" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate TWO IDENTICAL groups (both have true mean = 50)</span></span>
<span id="cb375-736"><a href="#cb375-736" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb375-737"><a href="#cb375-737" aria-hidden="true" tabindex="-1"></a>group_a <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">5</span>, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">10</span>)</span>
<span id="cb375-738"><a href="#cb375-738" aria-hidden="true" tabindex="-1"></a>group_b <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">5</span>, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">10</span>)</span>
<span id="cb375-739"><a href="#cb375-739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-740"><a href="#cb375-740" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate Cohen's d</span></span>
<span id="cb375-741"><a href="#cb375-741" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> (<span class="fu">mean</span>(group_a) <span class="sc">-</span> <span class="fu">mean</span>(group_b)) <span class="sc">/</span> </span>
<span id="cb375-742"><a href="#cb375-742" aria-hidden="true" tabindex="-1"></a>     <span class="fu">sqrt</span>((<span class="fu">var</span>(group_a) <span class="sc">+</span> <span class="fu">var</span>(group_b))<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb375-743"><a href="#cb375-743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-744"><a href="#cb375-744" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Groups are IDENTICAL (true mean = 50 for both)</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-745"><a href="#cb375-745" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"But with n=5, we observe:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-746"><a href="#cb375-746" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Group A mean:"</span>, <span class="fu">round</span>(<span class="fu">mean</span>(group_a), <span class="dv">1</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-747"><a href="#cb375-747" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Group B mean:"</span>, <span class="fu">round</span>(<span class="fu">mean</span>(group_b), <span class="dv">1</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-748"><a href="#cb375-748" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Cohen's d ="</span>, <span class="fu">round</span>(d, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb375-749"><a href="#cb375-749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-750"><a href="#cb375-750" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">abs</span>(d) <span class="sc">&gt;</span> <span class="fl">0.5</span>) {</span>
<span id="cb375-751"><a href="#cb375-751" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"â†’ This would be called a 'medium-to-large' effect!</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-752"><a href="#cb375-752" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb375-753"><a href="#cb375-753" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"â†’ Small effect size (run this a few times with different seeds)</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-754"><a href="#cb375-754" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb375-755"><a href="#cb375-755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-756"><a href="#cb375-756" aria-hidden="true" tabindex="-1"></a><span class="co"># Now check statistical significance</span></span>
<span id="cb375-757"><a href="#cb375-757" aria-hidden="true" tabindex="-1"></a>t_result <span class="ot">&lt;-</span> <span class="fu">t.test</span>(group_a, group_b)</span>
<span id="cb375-758"><a href="#cb375-758" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">p-value ="</span>, <span class="fu">round</span>(t_result<span class="sc">$</span>p.value, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-759"><a href="#cb375-759" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"â†’ Not significant, correctly reflecting no true difference</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-760"><a href="#cb375-760" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-761"><a href="#cb375-761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-762"><a href="#cb375-762" aria-hidden="true" tabindex="-1"></a>**Lesson**: With small samples, **always check**:</span>
<span id="cb375-763"><a href="#cb375-763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-764"><a href="#cb375-764" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Is the confidence interval consistent?** Wide CIs indicate high uncertainty</span>
<span id="cb375-765"><a href="#cb375-765" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Does the p-value support the effect?** Large effect + non-significant p suggests chance</span>
<span id="cb375-766"><a href="#cb375-766" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Is the effect plausible given context?** A 2 SD difference with n = 5 is suspicious</span>
<span id="cb375-767"><a href="#cb375-767" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Can you replicate it?** One-off large effects in tiny samples need replication</span>
<span id="cb375-768"><a href="#cb375-768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-769"><a href="#cb375-769" aria-hidden="true" tabindex="-1"></a>**Bottom line**: Effect size + sample size + p-value together tell the story. Never rely on effect size alone with n &lt; 30.</span>
<span id="cb375-770"><a href="#cb375-770" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb375-771"><a href="#cb375-771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-772"><a href="#cb375-772" aria-hidden="true" tabindex="-1"></a><span class="fu">### Wilcoxon Signed-Rank Test</span></span>
<span id="cb375-773"><a href="#cb375-773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-774"><a href="#cb375-774" aria-hidden="true" tabindex="-1"></a>The Wilcoxon signed-rank test is the nonparametric analogue of the paired t-test. It compares two related samples (such as before and after measurements on the same individuals) by ranking the absolute differences and testing whether the sum of positive ranks differs from the sum of negative ranks.</span>
<span id="cb375-775"><a href="#cb375-775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-776"><a href="#cb375-776" aria-hidden="true" tabindex="-1"></a>The test produces a pseudomedian (the median of all pairwise averages of the differences) with a confidence interval.</span>
<span id="cb375-777"><a href="#cb375-777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-778"><a href="#cb375-778" aria-hidden="true" tabindex="-1"></a>**Assumptions**: Observations are paired. Differences are independent. The distribution of differences is symmetric (for the median interpretation).</span>
<span id="cb375-779"><a href="#cb375-779" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-780"><a href="#cb375-780" aria-hidden="true" tabindex="-1"></a>**When to use**: Paired or matched samples, ordinal or continuous outcomes, small samples, non-normal differences.</span>
<span id="cb375-781"><a href="#cb375-781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-782"><a href="#cb375-782" aria-hidden="true" tabindex="-1"></a><span class="fu">### Example: Wilcoxon Signed-Rank Test</span></span>
<span id="cb375-783"><a href="#cb375-783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-784"><a href="#cb375-784" aria-hidden="true" tabindex="-1"></a>We measure anxiety scores (0â€“100 scale) before and after a brief intervention in 12 participants.</span>
<span id="cb375-785"><a href="#cb375-785" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-788"><a href="#cb375-788" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb375-789"><a href="#cb375-789" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: part-c-chunk-11</span></span>
<span id="cb375-790"><a href="#cb375-790" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb375-791"><a href="#cb375-791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-792"><a href="#cb375-792" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb375-793"><a href="#cb375-793" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-794"><a href="#cb375-794" aria-hidden="true" tabindex="-1"></a>participant_id <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span></span>
<span id="cb375-795"><a href="#cb375-795" aria-hidden="true" tabindex="-1"></a>anxiety_before <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">65</span>, <span class="dv">70</span>, <span class="dv">68</span>, <span class="dv">72</span>, <span class="dv">75</span>, <span class="dv">69</span>, <span class="dv">71</span>, <span class="dv">68</span>, <span class="dv">74</span>, <span class="dv">70</span>, <span class="dv">73</span>, <span class="dv">67</span>)</span>
<span id="cb375-796"><a href="#cb375-796" aria-hidden="true" tabindex="-1"></a>anxiety_after <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">60</span>, <span class="dv">65</span>, <span class="dv">64</span>, <span class="dv">68</span>, <span class="dv">70</span>, <span class="dv">63</span>, <span class="dv">66</span>, <span class="dv">62</span>, <span class="dv">69</span>, <span class="dv">65</span>, <span class="dv">68</span>, <span class="dv">62</span>)</span>
<span id="cb375-797"><a href="#cb375-797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-798"><a href="#cb375-798" aria-hidden="true" tabindex="-1"></a>anxiety_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb375-799"><a href="#cb375-799" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> participant_id,</span>
<span id="cb375-800"><a href="#cb375-800" aria-hidden="true" tabindex="-1"></a>  <span class="at">before =</span> anxiety_before,</span>
<span id="cb375-801"><a href="#cb375-801" aria-hidden="true" tabindex="-1"></a>  <span class="at">after =</span> anxiety_after,</span>
<span id="cb375-802"><a href="#cb375-802" aria-hidden="true" tabindex="-1"></a>  <span class="at">difference =</span> after <span class="sc">-</span> before</span>
<span id="cb375-803"><a href="#cb375-803" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb375-804"><a href="#cb375-804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-805"><a href="#cb375-805" aria-hidden="true" tabindex="-1"></a><span class="co"># Wilcoxon signed-rank test with CI</span></span>
<span id="cb375-806"><a href="#cb375-806" aria-hidden="true" tabindex="-1"></a>wilcox_paired <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(anxiety_data<span class="sc">$</span>before, anxiety_data<span class="sc">$</span>after, </span>
<span id="cb375-807"><a href="#cb375-807" aria-hidden="true" tabindex="-1"></a>                              <span class="at">paired =</span> <span class="cn">TRUE</span>, <span class="at">conf.int =</span> <span class="cn">TRUE</span>)</span>
<span id="cb375-808"><a href="#cb375-808" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(wilcox_paired)</span>
<span id="cb375-809"><a href="#cb375-809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-810"><a href="#cb375-810" aria-hidden="true" tabindex="-1"></a><span class="co"># Descriptive statistics</span></span>
<span id="cb375-811"><a href="#cb375-811" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Median before:"</span>, <span class="fu">median</span>(anxiety_before), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-812"><a href="#cb375-812" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Median after:"</span>, <span class="fu">median</span>(anxiety_after), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-813"><a href="#cb375-813" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Median difference:"</span>, <span class="fu">median</span>(anxiety_data<span class="sc">$</span>difference), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-814"><a href="#cb375-814" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-815"><a href="#cb375-815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-816"><a href="#cb375-816" aria-hidden="true" tabindex="-1"></a>Interpretation: The p-value tests whether the central tendency of differences is zero. A small p-value indicates that the intervention changed anxiety scores. The pseudomedian (location shift) estimates the typical change. The confidence interval quantifies uncertainty. If the CI excludes zero, the change is statistically significant at the chosen level.</span>
<span id="cb375-817"><a href="#cb375-817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-818"><a href="#cb375-818" aria-hidden="true" tabindex="-1"></a><span class="fu">### Kruskalâ€“Wallis Test</span></span>
<span id="cb375-819"><a href="#cb375-819" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-820"><a href="#cb375-820" aria-hidden="true" tabindex="-1"></a>The Kruskalâ€“Wallis test extends the Mannâ€“Whitney U test to three or more independent groups. It tests the null hypothesis that all groups have identical distributions by comparing the mean ranks across groups.</span>
<span id="cb375-821"><a href="#cb375-821" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-822"><a href="#cb375-822" aria-hidden="true" tabindex="-1"></a>If the Kruskalâ€“Wallis test is significant, post-hoc pairwise comparisons (with correction for multiple testing) can identify which groups differ.</span>
<span id="cb375-823"><a href="#cb375-823" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-824"><a href="#cb375-824" aria-hidden="true" tabindex="-1"></a>**Assumptions**: Observations are independent. Groups have similar distributional shapes (for rank interpretation).</span>
<span id="cb375-825"><a href="#cb375-825" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-826"><a href="#cb375-826" aria-hidden="true" tabindex="-1"></a>**When to use**: Three or more independent groups, ordinal or continuous outcomes, small samples, non-normal distributions.</span>
<span id="cb375-827"><a href="#cb375-827" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-828"><a href="#cb375-828" aria-hidden="true" tabindex="-1"></a><span class="fu">### Example: Kruskalâ€“Wallis Test</span></span>
<span id="cb375-829"><a href="#cb375-829" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-830"><a href="#cb375-830" aria-hidden="true" tabindex="-1"></a>We compare patient satisfaction scores (1â€“10 scale) across three hospital wards with small sample sizes.</span>
<span id="cb375-831"><a href="#cb375-831" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-834"><a href="#cb375-834" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb375-835"><a href="#cb375-835" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: part-c-chunk-12</span></span>
<span id="cb375-836"><a href="#cb375-836" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb375-837"><a href="#cb375-837" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstatix)</span>
<span id="cb375-838"><a href="#cb375-838" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-839"><a href="#cb375-839" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb375-840"><a href="#cb375-840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-841"><a href="#cb375-841" aria-hidden="true" tabindex="-1"></a>ward_red <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">9</span>, <span class="dv">8</span>)</span>
<span id="cb375-842"><a href="#cb375-842" aria-hidden="true" tabindex="-1"></a>ward_blue <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">5</span>)</span>
<span id="cb375-843"><a href="#cb375-843" aria-hidden="true" tabindex="-1"></a>ward_green <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">9</span>)</span>
<span id="cb375-844"><a href="#cb375-844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-845"><a href="#cb375-845" aria-hidden="true" tabindex="-1"></a>satisfaction_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb375-846"><a href="#cb375-846" aria-hidden="true" tabindex="-1"></a>  <span class="at">score =</span> <span class="fu">c</span>(ward_red, ward_blue, ward_green),</span>
<span id="cb375-847"><a href="#cb375-847" aria-hidden="true" tabindex="-1"></a>  <span class="at">ward =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Red"</span>, <span class="st">"Blue"</span>, <span class="st">"Green"</span>), <span class="at">each =</span> <span class="dv">6</span>)</span>
<span id="cb375-848"><a href="#cb375-848" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb375-849"><a href="#cb375-849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-850"><a href="#cb375-850" aria-hidden="true" tabindex="-1"></a><span class="co"># Kruskalâ€“Wallis test</span></span>
<span id="cb375-851"><a href="#cb375-851" aria-hidden="true" tabindex="-1"></a>kw_result <span class="ot">&lt;-</span> <span class="fu">kruskal_test</span>(satisfaction_data, score <span class="sc">~</span> ward)</span>
<span id="cb375-852"><a href="#cb375-852" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(kw_result)</span>
<span id="cb375-853"><a href="#cb375-853" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-854"><a href="#cb375-854" aria-hidden="true" tabindex="-1"></a><span class="co"># Post-hoc pairwise comparisons (Dunn's test with Bonferroni correction)</span></span>
<span id="cb375-855"><a href="#cb375-855" aria-hidden="true" tabindex="-1"></a>dunn_result <span class="ot">&lt;-</span> <span class="fu">dunn_test</span>(satisfaction_data, score <span class="sc">~</span> ward, <span class="at">p.adjust.method =</span> <span class="st">"bonferroni"</span>)</span>
<span id="cb375-856"><a href="#cb375-856" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(dunn_result)</span>
<span id="cb375-857"><a href="#cb375-857" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-858"><a href="#cb375-858" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-859"><a href="#cb375-859" aria-hidden="true" tabindex="-1"></a>Interpretation: The Kruskalâ€“Wallis p-value tests whether the three wards have different satisfaction distributions. If p &lt; 0.05, at least one ward differs from the others. The post-hoc Dunn's test identifies which pairs of wards differ, adjusting for multiple comparisons. Effect sizes (such as epsilon-squared) can quantify the proportion of variance explained by ward.</span>
<span id="cb375-860"><a href="#cb375-860" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-861"><a href="#cb375-861" aria-hidden="true" tabindex="-1"></a><span class="fu">### Friedman Test</span></span>
<span id="cb375-862"><a href="#cb375-862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-863"><a href="#cb375-863" aria-hidden="true" tabindex="-1"></a>The Friedman test is the nonparametric analogue of repeated-measures ANOVA. It compares three or more related groups (such as repeated measurements on the same individuals) by ranking observations within each individual and comparing the mean ranks across conditions.</span>
<span id="cb375-864"><a href="#cb375-864" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-865"><a href="#cb375-865" aria-hidden="true" tabindex="-1"></a>**Assumptions**: Observations are related (repeated measures or matched sets). Measurements are ordinal or continuous.</span>
<span id="cb375-866"><a href="#cb375-866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-867"><a href="#cb375-867" aria-hidden="true" tabindex="-1"></a>**When to use**: Three or more related samples, ordinal or continuous outcomes, small samples, non-normal distributions.</span>
<span id="cb375-868"><a href="#cb375-868" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-869"><a href="#cb375-869" aria-hidden="true" tabindex="-1"></a><span class="fu">### Example: Friedman Test</span></span>
<span id="cb375-870"><a href="#cb375-870" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-871"><a href="#cb375-871" aria-hidden="true" tabindex="-1"></a>We measure performance scores under three different task conditions for 8 participants.</span>
<span id="cb375-872"><a href="#cb375-872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-875"><a href="#cb375-875" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb375-876"><a href="#cb375-876" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: part-c-chunk-13</span></span>
<span id="cb375-877"><a href="#cb375-877" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb375-878"><a href="#cb375-878" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstatix)</span>
<span id="cb375-879"><a href="#cb375-879" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-880"><a href="#cb375-880" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb375-881"><a href="#cb375-881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-882"><a href="#cb375-882" aria-hidden="true" tabindex="-1"></a><span class="co"># Each row is a participant; columns are conditions</span></span>
<span id="cb375-883"><a href="#cb375-883" aria-hidden="true" tabindex="-1"></a>performance_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb375-884"><a href="#cb375-884" aria-hidden="true" tabindex="-1"></a>  <span class="at">participant =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>,</span>
<span id="cb375-885"><a href="#cb375-885" aria-hidden="true" tabindex="-1"></a>  <span class="at">condition_1 =</span> <span class="fu">c</span>(<span class="dv">12</span>, <span class="dv">14</span>, <span class="dv">13</span>, <span class="dv">15</span>, <span class="dv">14</span>, <span class="dv">13</span>, <span class="dv">16</span>, <span class="dv">14</span>),</span>
<span id="cb375-886"><a href="#cb375-886" aria-hidden="true" tabindex="-1"></a>  <span class="at">condition_2 =</span> <span class="fu">c</span>(<span class="dv">14</span>, <span class="dv">16</span>, <span class="dv">15</span>, <span class="dv">17</span>, <span class="dv">16</span>, <span class="dv">15</span>, <span class="dv">18</span>, <span class="dv">16</span>),</span>
<span id="cb375-887"><a href="#cb375-887" aria-hidden="true" tabindex="-1"></a>  <span class="at">condition_3 =</span> <span class="fu">c</span>(<span class="dv">13</span>, <span class="dv">15</span>, <span class="dv">14</span>, <span class="dv">16</span>, <span class="dv">15</span>, <span class="dv">14</span>, <span class="dv">17</span>, <span class="dv">15</span>)</span>
<span id="cb375-888"><a href="#cb375-888" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb375-889"><a href="#cb375-889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-890"><a href="#cb375-890" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to long format</span></span>
<span id="cb375-891"><a href="#cb375-891" aria-hidden="true" tabindex="-1"></a>performance_long <span class="ot">&lt;-</span> performance_data <span class="sc">%&gt;%</span></span>
<span id="cb375-892"><a href="#cb375-892" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"condition"</span>), </span>
<span id="cb375-893"><a href="#cb375-893" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"condition"</span>, </span>
<span id="cb375-894"><a href="#cb375-894" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"score"</span>)</span>
<span id="cb375-895"><a href="#cb375-895" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-896"><a href="#cb375-896" aria-hidden="true" tabindex="-1"></a><span class="co"># Friedman test</span></span>
<span id="cb375-897"><a href="#cb375-897" aria-hidden="true" tabindex="-1"></a>friedman_result <span class="ot">&lt;-</span> <span class="fu">friedman_test</span>(performance_long, score <span class="sc">~</span> condition <span class="sc">|</span> participant)</span>
<span id="cb375-898"><a href="#cb375-898" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(friedman_result)</span>
<span id="cb375-899"><a href="#cb375-899" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-900"><a href="#cb375-900" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-901"><a href="#cb375-901" aria-hidden="true" tabindex="-1"></a>Interpretation: The Friedman test p-value indicates whether performance differs across conditions. If significant, post-hoc pairwise comparisons (Wilcoxon signed-rank tests with correction) can identify which conditions differ. Kendall's W (coefficient of concordance) quantifies the effect size.</span>
<span id="cb375-902"><a href="#cb375-902" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-903"><a href="#cb375-903" aria-hidden="true" tabindex="-1"></a><span class="fu">### Spearman's Rank Correlation</span></span>
<span id="cb375-904"><a href="#cb375-904" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-905"><a href="#cb375-905" aria-hidden="true" tabindex="-1"></a>Spearman's Ï measures the monotonic association between two variables by computing Pearson's correlation on the ranks of the data. It is robust to outliers and non-linear relationships (as long as they are monotonic).</span>
<span id="cb375-906"><a href="#cb375-906" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-907"><a href="#cb375-907" aria-hidden="true" tabindex="-1"></a>**Assumptions**: Observations are independent. The relationship is monotonic (not necessarily linear).</span>
<span id="cb375-908"><a href="#cb375-908" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-909"><a href="#cb375-909" aria-hidden="true" tabindex="-1"></a>**When to use**: Ordinal variables, non-normal continuous variables, small samples, presence of outliers.</span>
<span id="cb375-910"><a href="#cb375-910" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-911"><a href="#cb375-911" aria-hidden="true" tabindex="-1"></a><span class="fu">### Example: Spearman's Rank Correlation</span></span>
<span id="cb375-912"><a href="#cb375-912" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-913"><a href="#cb375-913" aria-hidden="true" tabindex="-1"></a>We examine the association between years of experience and job satisfaction scores (1â€“10 scale) in a small sample of 15 employees.</span>
<span id="cb375-914"><a href="#cb375-914" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-917"><a href="#cb375-917" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb375-918"><a href="#cb375-918" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: part-c-chunk-14</span></span>
<span id="cb375-919"><a href="#cb375-919" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb375-920"><a href="#cb375-920" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-921"><a href="#cb375-921" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb375-922"><a href="#cb375-922" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-923"><a href="#cb375-923" aria-hidden="true" tabindex="-1"></a>experience <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">3</span>, <span class="dv">8</span>, <span class="dv">6</span>, <span class="dv">4</span>, <span class="dv">10</span>, <span class="dv">7</span>, <span class="dv">9</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">4</span>, <span class="dv">7</span>)</span>
<span id="cb375-924"><a href="#cb375-924" aria-hidden="true" tabindex="-1"></a>satisfaction <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">7</span>, <span class="dv">6</span>, <span class="dv">9</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">6</span>, <span class="dv">7</span>)</span>
<span id="cb375-925"><a href="#cb375-925" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-926"><a href="#cb375-926" aria-hidden="true" tabindex="-1"></a>employee_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(experience, satisfaction)</span>
<span id="cb375-927"><a href="#cb375-927" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-928"><a href="#cb375-928" aria-hidden="true" tabindex="-1"></a><span class="co"># Spearman's correlation</span></span>
<span id="cb375-929"><a href="#cb375-929" aria-hidden="true" tabindex="-1"></a>spearman_result <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(experience, satisfaction, <span class="at">method =</span> <span class="st">"spearman"</span>, <span class="at">exact =</span> <span class="cn">FALSE</span>)</span>
<span id="cb375-930"><a href="#cb375-930" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(spearman_result)</span>
<span id="cb375-931"><a href="#cb375-931" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-932"><a href="#cb375-932" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-933"><a href="#cb375-933" aria-hidden="true" tabindex="-1"></a>Interpretation: Spearman's Ï ranges from -1 to +1. Values near +1 indicate strong positive monotonic association; values near -1 indicate strong negative association; values near 0 indicate weak or no association. The p-value tests whether Ï differs from zero. The confidence interval (if computed) provides a range of plausible values for the population Ï.</span>
<span id="cb375-934"><a href="#cb375-934" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-935"><a href="#cb375-935" aria-hidden="true" tabindex="-1"></a><span class="fu">### Kendall's Rank Correlation</span></span>
<span id="cb375-936"><a href="#cb375-936" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-937"><a href="#cb375-937" aria-hidden="true" tabindex="-1"></a>Kendall's Ï„ is an alternative measure of monotonic association based on concordant and discordant pairs. It tends to be more robust than Spearman's Ï when ties are present and has a more direct probabilistic interpretation (the difference between the probability of concordance and discordance).</span>
<span id="cb375-938"><a href="#cb375-938" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-939"><a href="#cb375-939" aria-hidden="true" tabindex="-1"></a>**When to use**: Same contexts as Spearman's Ï, particularly when ties are common or when a direct probability interpretation is desired.</span>
<span id="cb375-940"><a href="#cb375-940" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-941"><a href="#cb375-941" aria-hidden="true" tabindex="-1"></a><span class="fu">### Example: Kendall's Tau</span></span>
<span id="cb375-942"><a href="#cb375-942" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-943"><a href="#cb375-943" aria-hidden="true" tabindex="-1"></a>Using the same employee data, we compute Kendall's Ï„.</span>
<span id="cb375-944"><a href="#cb375-944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-947"><a href="#cb375-947" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb375-948"><a href="#cb375-948" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: part-c-chunk-15</span></span>
<span id="cb375-949"><a href="#cb375-949" aria-hidden="true" tabindex="-1"></a><span class="co"># Kendall's correlation</span></span>
<span id="cb375-950"><a href="#cb375-950" aria-hidden="true" tabindex="-1"></a>kendall_result <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(experience, satisfaction, <span class="at">method =</span> <span class="st">"kendall"</span>, <span class="at">exact =</span> <span class="cn">FALSE</span>)</span>
<span id="cb375-951"><a href="#cb375-951" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(kendall_result)</span>
<span id="cb375-952"><a href="#cb375-952" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-953"><a href="#cb375-953" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-954"><a href="#cb375-954" aria-hidden="true" tabindex="-1"></a>Interpretation: Kendall's Ï„ has a similar interpretation to Spearman's Ï but different scale. It is often smaller in magnitude than Ï for the same data. Both provide evidence of monotonic association. Kendall's Ï„ is preferred when the data include many ties or when reporting to audiences familiar with probability-based interpretations.</span>
<span id="cb375-955"><a href="#cb375-955" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-956"><a href="#cb375-956" aria-hidden="true" tabindex="-1"></a><span class="fu">### Lab Practical 4.1: Sales Performance Analysis with Mann-Whitney U</span></span>
<span id="cb375-957"><a href="#cb375-957" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-958"><a href="#cb375-958" aria-hidden="true" tabindex="-1"></a>**Context**: A retail company piloted two employee training programs (A and B) across 10 stores each. After 3 months, management collected customer satisfaction scores (on a 1â€“100 scale) to determine which training approach performs better. The data are ordinal-like and may not meet normality assumptions, making the Mann-Whitney U test appropriate.</span>
<span id="cb375-959"><a href="#cb375-959" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-960"><a href="#cb375-960" aria-hidden="true" tabindex="-1"></a>**Learning Goals**:</span>
<span id="cb375-961"><a href="#cb375-961" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-962"><a href="#cb375-962" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Apply the Mann-Whitney U test to independent samples</span>
<span id="cb375-963"><a href="#cb375-963" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Visualize distributions to assess shape similarity</span>
<span id="cb375-964"><a href="#cb375-964" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Interpret results as location shifts or stochastic dominance</span>
<span id="cb375-965"><a href="#cb375-965" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Report effect sizes (rank-biserial correlation)</span>
<span id="cb375-966"><a href="#cb375-966" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Follow a flowchart for interpretation</span>
<span id="cb375-967"><a href="#cb375-967" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-968"><a href="#cb375-968" aria-hidden="true" tabindex="-1"></a>**Step 1: Load and Explore the Data**</span>
<span id="cb375-969"><a href="#cb375-969" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-972"><a href="#cb375-972" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb375-973"><a href="#cb375-973" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: part-c-lab-4-1</span></span>
<span id="cb375-974"><a href="#cb375-974" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb375-975"><a href="#cb375-975" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstatix)</span>
<span id="cb375-976"><a href="#cb375-976" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(effsize)</span>
<span id="cb375-977"><a href="#cb375-977" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-978"><a href="#cb375-978" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulated customer satisfaction scores (out of 100)</span></span>
<span id="cb375-979"><a href="#cb375-979" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb375-980"><a href="#cb375-980" aria-hidden="true" tabindex="-1"></a>sales_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb375-981"><a href="#cb375-981" aria-hidden="true" tabindex="-1"></a>  <span class="at">training =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>), <span class="at">each =</span> <span class="dv">10</span>),</span>
<span id="cb375-982"><a href="#cb375-982" aria-hidden="true" tabindex="-1"></a>  <span class="at">satisfaction =</span> <span class="fu">c</span>(</span>
<span id="cb375-983"><a href="#cb375-983" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Training A: moderate scores</span></span>
<span id="cb375-984"><a href="#cb375-984" aria-hidden="true" tabindex="-1"></a>    <span class="dv">72</span>, <span class="dv">68</span>, <span class="dv">75</span>, <span class="dv">70</span>, <span class="dv">74</span>, <span class="dv">69</span>, <span class="dv">73</span>, <span class="dv">71</span>, <span class="dv">76</span>, <span class="dv">70</span>,</span>
<span id="cb375-985"><a href="#cb375-985" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Training B: slightly higher scores</span></span>
<span id="cb375-986"><a href="#cb375-986" aria-hidden="true" tabindex="-1"></a>    <span class="dv">78</span>, <span class="dv">82</span>, <span class="dv">79</span>, <span class="dv">84</span>, <span class="dv">81</span>, <span class="dv">77</span>, <span class="dv">83</span>, <span class="dv">80</span>, <span class="dv">85</span>, <span class="dv">79</span></span>
<span id="cb375-987"><a href="#cb375-987" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb375-988"><a href="#cb375-988" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb375-989"><a href="#cb375-989" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-990"><a href="#cb375-990" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary statistics</span></span>
<span id="cb375-991"><a href="#cb375-991" aria-hidden="true" tabindex="-1"></a>sales_data <span class="sc">%&gt;%</span></span>
<span id="cb375-992"><a href="#cb375-992" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(training) <span class="sc">%&gt;%</span></span>
<span id="cb375-993"><a href="#cb375-993" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb375-994"><a href="#cb375-994" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb375-995"><a href="#cb375-995" aria-hidden="true" tabindex="-1"></a>    <span class="at">median =</span> <span class="fu">median</span>(satisfaction),</span>
<span id="cb375-996"><a href="#cb375-996" aria-hidden="true" tabindex="-1"></a>    <span class="at">IQR =</span> <span class="fu">IQR</span>(satisfaction),</span>
<span id="cb375-997"><a href="#cb375-997" aria-hidden="true" tabindex="-1"></a>    <span class="at">min =</span> <span class="fu">min</span>(satisfaction),</span>
<span id="cb375-998"><a href="#cb375-998" aria-hidden="true" tabindex="-1"></a>    <span class="at">max =</span> <span class="fu">max</span>(satisfaction)</span>
<span id="cb375-999"><a href="#cb375-999" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb375-1000"><a href="#cb375-1000" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-1001"><a href="#cb375-1001" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1002"><a href="#cb375-1002" aria-hidden="true" tabindex="-1"></a>**Checkpoint**: Training B has a higher median (80 vs 71.5) and similar spread (IQR). The distributions may differ in location.</span>
<span id="cb375-1003"><a href="#cb375-1003" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1004"><a href="#cb375-1004" aria-hidden="true" tabindex="-1"></a>**Step 2: Visualize Distributions**</span>
<span id="cb375-1005"><a href="#cb375-1005" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1008"><a href="#cb375-1008" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb375-1009"><a href="#cb375-1009" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: part-c-lab-4-2</span></span>
<span id="cb375-1010"><a href="#cb375-1010" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sales_data, <span class="fu">aes</span>(<span class="at">x =</span> training, <span class="at">y =</span> satisfaction, <span class="at">fill =</span> training)) <span class="sc">+</span></span>
<span id="cb375-1011"><a href="#cb375-1011" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb375-1012"><a href="#cb375-1012" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb375-1013"><a href="#cb375-1013" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb375-1014"><a href="#cb375-1014" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Customer Satisfaction by Training Program"</span>,</span>
<span id="cb375-1015"><a href="#cb375-1015" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Training Program"</span>,</span>
<span id="cb375-1016"><a href="#cb375-1016" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Satisfaction Score"</span></span>
<span id="cb375-1017"><a href="#cb375-1017" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb375-1018"><a href="#cb375-1018" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb375-1019"><a href="#cb375-1019" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-1020"><a href="#cb375-1020" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1021"><a href="#cb375-1021" aria-hidden="true" tabindex="-1"></a>**Checkpoint**: Boxplots show similar shapes (both roughly symmetric) with Training B shifted higher. This suggests a location difference, supporting interpretation as a median shift.</span>
<span id="cb375-1022"><a href="#cb375-1022" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1023"><a href="#cb375-1023" aria-hidden="true" tabindex="-1"></a>**Step 3: Conduct Mann-Whitney U Test**</span>
<span id="cb375-1024"><a href="#cb375-1024" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1027"><a href="#cb375-1027" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb375-1028"><a href="#cb375-1028" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: part-c-lab-4-3</span></span>
<span id="cb375-1029"><a href="#cb375-1029" aria-hidden="true" tabindex="-1"></a><span class="co"># Mann-Whitney U test</span></span>
<span id="cb375-1030"><a href="#cb375-1030" aria-hidden="true" tabindex="-1"></a>mw_result <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(</span>
<span id="cb375-1031"><a href="#cb375-1031" aria-hidden="true" tabindex="-1"></a>  satisfaction <span class="sc">~</span> training,</span>
<span id="cb375-1032"><a href="#cb375-1032" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> sales_data,</span>
<span id="cb375-1033"><a href="#cb375-1033" aria-hidden="true" tabindex="-1"></a>  <span class="at">exact =</span> <span class="cn">FALSE</span>,</span>
<span id="cb375-1034"><a href="#cb375-1034" aria-hidden="true" tabindex="-1"></a>  <span class="at">conf.int =</span> <span class="cn">TRUE</span></span>
<span id="cb375-1035"><a href="#cb375-1035" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb375-1036"><a href="#cb375-1036" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1037"><a href="#cb375-1037" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(mw_result)</span>
<span id="cb375-1038"><a href="#cb375-1038" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1039"><a href="#cb375-1039" aria-hidden="true" tabindex="-1"></a><span class="co"># Effect size: rank-biserial correlation</span></span>
<span id="cb375-1040"><a href="#cb375-1040" aria-hidden="true" tabindex="-1"></a>rb <span class="ot">&lt;-</span> <span class="fu">cliff.delta</span>(</span>
<span id="cb375-1041"><a href="#cb375-1041" aria-hidden="true" tabindex="-1"></a>  satisfaction <span class="sc">~</span> training,</span>
<span id="cb375-1042"><a href="#cb375-1042" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> sales_data</span>
<span id="cb375-1043"><a href="#cb375-1043" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb375-1044"><a href="#cb375-1044" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(rb)</span>
<span id="cb375-1045"><a href="#cb375-1045" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-1046"><a href="#cb375-1046" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1047"><a href="#cb375-1047" aria-hidden="true" tabindex="-1"></a>**Checkpoint**: The p-value is &lt; 0.05 (significant difference). Cliff's Delta (rank-biserial correlation) shows a large effect size (~0.7), indicating Training B consistently outperforms A.</span>
<span id="cb375-1048"><a href="#cb375-1048" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1049"><a href="#cb375-1049" aria-hidden="true" tabindex="-1"></a>**Step 4: Interpretation Flowchart**</span>
<span id="cb375-1050"><a href="#cb375-1050" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1051"><a href="#cb375-1051" aria-hidden="true" tabindex="-1"></a>Follow this decision tree:</span>
<span id="cb375-1052"><a href="#cb375-1052" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1053"><a href="#cb375-1053" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Are the distributions similarly shaped?**</span>
<span id="cb375-1054"><a href="#cb375-1054" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Yes (from boxplots) â†’ Interpret as a location shift (median difference)</span>
<span id="cb375-1055"><a href="#cb375-1055" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>No â†’ Interpret as stochastic dominance (one group tends to have higher values)</span>
<span id="cb375-1056"><a href="#cb375-1056" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1057"><a href="#cb375-1057" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**What is the effect size?**</span>
<span id="cb375-1058"><a href="#cb375-1058" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Cliff's Delta: |d| &lt; 0.33 (small), 0.33â€“0.47 (medium), &gt; 0.47 (large)</span>
<span id="cb375-1059"><a href="#cb375-1059" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Here: d â‰ˆ 0.7 (large effect)</span>
<span id="cb375-1060"><a href="#cb375-1060" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1061"><a href="#cb375-1061" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Conclusion**:</span>
<span id="cb375-1062"><a href="#cb375-1062" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Training B produces significantly higher customer satisfaction scores than Training A (W = 8, p &lt; 0.01, Cliff's d = 0.70)</span>
<span id="cb375-1063"><a href="#cb375-1063" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Interpretation: The median satisfaction score for Training B exceeds that of Training A by approximately 8â€“9 points (from confidence interval)</span>
<span id="cb375-1064"><a href="#cb375-1064" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Practical implication: Training B should be adopted company-wide</span>
<span id="cb375-1065"><a href="#cb375-1065" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1066"><a href="#cb375-1066" aria-hidden="true" tabindex="-1"></a>**Step 5: Report the Results**</span>
<span id="cb375-1067"><a href="#cb375-1067" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1068"><a href="#cb375-1068" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; "Customer satisfaction scores were compared between two training programs using the Mann-Whitney U test. Training B (Mdn = 80, IQR = 6) significantly outperformed Training A (Mdn = 71.5, IQR = 5), W = 8, p &lt; 0.01, Cliff's Î´ = 0.70 (large effect). The distributions were similarly shaped, supporting interpretation as a median shift. Management should implement Training B across all stores."</span></span>
<span id="cb375-1069"><a href="#cb375-1069" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1070"><a href="#cb375-1070" aria-hidden="true" tabindex="-1"></a>**Discussion Questions**:</span>
<span id="cb375-1071"><a href="#cb375-1071" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1072"><a href="#cb375-1072" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>What would change if the boxplots showed skewed distributions with different shapes?</span>
<span id="cb375-1073"><a href="#cb375-1073" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>We would interpret the result as stochastic dominance (Training B values tend to exceed A) rather than a simple median shift</span>
<span id="cb375-1074"><a href="#cb375-1074" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Why use Cliff's Delta instead of Cohen's d?</span>
<span id="cb375-1075"><a href="#cb375-1075" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Cliff's Delta is a nonparametric effect size that doesn't assume normality or equal variances, making it more appropriate for rank-based tests</span>
<span id="cb375-1076"><a href="#cb375-1076" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>How would you handle ties (identical satisfaction scores)?</span>
<span id="cb375-1077"><a href="#cb375-1077" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>The <span class="in">`exact = FALSE`</span> argument uses a normal approximation that adjusts for ties; with many ties, consider reporting the tie correction</span>
<span id="cb375-1078"><a href="#cb375-1078" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1079"><a href="#cb375-1079" aria-hidden="true" tabindex="-1"></a>**Extension**: Try comparing three training programs (A, B, C) using the Kruskal-Wallis test, followed by pairwise Mann-Whitney U tests with Bonferroni correction.</span>
<span id="cb375-1080"><a href="#cb375-1080" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1081"><a href="#cb375-1081" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-1082"><a href="#cb375-1082" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1083"><a href="#cb375-1083" aria-hidden="true" tabindex="-1"></a><span class="fu">### Self-Assessment Quiz</span></span>
<span id="cb375-1084"><a href="#cb375-1084" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1085"><a href="#cb375-1085" aria-hidden="true" tabindex="-1"></a>Test your understanding of nonparametric tests and rank-based methods from Chapter 4. Answers and explanations are provided at the end.</span>
<span id="cb375-1086"><a href="#cb375-1086" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1087"><a href="#cb375-1087" aria-hidden="true" tabindex="-1"></a>::: {.callout-note icon=false}</span>
<span id="cb375-1088"><a href="#cb375-1088" aria-hidden="true" tabindex="-1"></a><span class="fu">## Questions</span></span>
<span id="cb375-1089"><a href="#cb375-1089" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1090"><a href="#cb375-1090" aria-hidden="true" tabindex="-1"></a>**Q1.** The Mann-Whitney U test is appropriate when:</span>
<span id="cb375-1091"><a href="#cb375-1091" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1092"><a href="#cb375-1092" aria-hidden="true" tabindex="-1"></a>A. Data are perfectly normally distributed  </span>
<span id="cb375-1093"><a href="#cb375-1093" aria-hidden="true" tabindex="-1"></a>B. Comparing two independent groups with ordinal or skewed continuous data  </span>
<span id="cb375-1094"><a href="#cb375-1094" aria-hidden="true" tabindex="-1"></a>C. Testing correlation between variables  </span>
<span id="cb375-1095"><a href="#cb375-1095" aria-hidden="true" tabindex="-1"></a>D. Data have no outliers</span>
<span id="cb375-1096"><a href="#cb375-1096" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1097"><a href="#cb375-1097" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-1098"><a href="#cb375-1098" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1099"><a href="#cb375-1099" aria-hidden="true" tabindex="-1"></a>**Q2.** A Mann-Whitney test yields p=0.03. What can we conclude?</span>
<span id="cb375-1100"><a href="#cb375-1100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1101"><a href="#cb375-1101" aria-hidden="true" tabindex="-1"></a>A. The medians definitely differ  </span>
<span id="cb375-1102"><a href="#cb375-1102" aria-hidden="true" tabindex="-1"></a>B. The distributions of the two groups differ in location (if shapes are similar)  </span>
<span id="cb375-1103"><a href="#cb375-1103" aria-hidden="true" tabindex="-1"></a>C. The means differ  </span>
<span id="cb375-1104"><a href="#cb375-1104" aria-hidden="true" tabindex="-1"></a>D. One group is always higher than the other</span>
<span id="cb375-1105"><a href="#cb375-1105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1106"><a href="#cb375-1106" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-1107"><a href="#cb375-1107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1108"><a href="#cb375-1108" aria-hidden="true" tabindex="-1"></a>**Q3.** Wilcoxon signed-rank test is used for:</span>
<span id="cb375-1109"><a href="#cb375-1109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1110"><a href="#cb375-1110" aria-hidden="true" tabindex="-1"></a>A. Comparing two independent groups  </span>
<span id="cb375-1111"><a href="#cb375-1111" aria-hidden="true" tabindex="-1"></a>B. Comparing paired/matched observations (e.g., before-after)  </span>
<span id="cb375-1112"><a href="#cb375-1112" aria-hidden="true" tabindex="-1"></a>C. Testing normality  </span>
<span id="cb375-1113"><a href="#cb375-1113" aria-hidden="true" tabindex="-1"></a>D. Comparing three or more groups</span>
<span id="cb375-1114"><a href="#cb375-1114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1115"><a href="#cb375-1115" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-1116"><a href="#cb375-1116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1117"><a href="#cb375-1117" aria-hidden="true" tabindex="-1"></a>**Q4.** What does the Hodges-Lehmann estimate represent?</span>
<span id="cb375-1118"><a href="#cb375-1118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1119"><a href="#cb375-1119" aria-hidden="true" tabindex="-1"></a>A. The mean difference between groups  </span>
<span id="cb375-1120"><a href="#cb375-1120" aria-hidden="true" tabindex="-1"></a>B. The median of all pairwise differences between two groups  </span>
<span id="cb375-1121"><a href="#cb375-1121" aria-hidden="true" tabindex="-1"></a>C. The standard error  </span>
<span id="cb375-1122"><a href="#cb375-1122" aria-hidden="true" tabindex="-1"></a>D. The p-value</span>
<span id="cb375-1123"><a href="#cb375-1123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1124"><a href="#cb375-1124" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-1125"><a href="#cb375-1125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1126"><a href="#cb375-1126" aria-hidden="true" tabindex="-1"></a>**Q5.** Spearman's rank correlation is preferred over Pearson's when:</span>
<span id="cb375-1127"><a href="#cb375-1127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1128"><a href="#cb375-1128" aria-hidden="true" tabindex="-1"></a>A. Data are perfectly normally distributed  </span>
<span id="cb375-1129"><a href="#cb375-1129" aria-hidden="true" tabindex="-1"></a>B. Relationships are monotonic but not necessarily linear, or data contain outliers  </span>
<span id="cb375-1130"><a href="#cb375-1130" aria-hidden="true" tabindex="-1"></a>C. Sample size exceeds 1,000  </span>
<span id="cb375-1131"><a href="#cb375-1131" aria-hidden="true" tabindex="-1"></a>D. Variables are categorical</span>
<span id="cb375-1132"><a href="#cb375-1132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1133"><a href="#cb375-1133" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-1134"><a href="#cb375-1134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1135"><a href="#cb375-1135" aria-hidden="true" tabindex="-1"></a>**Q6.** Kendall's tau vs. Spearman's rho: Which is preferred when there are many tied ranks?</span>
<span id="cb375-1136"><a href="#cb375-1136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1137"><a href="#cb375-1137" aria-hidden="true" tabindex="-1"></a>A. Spearman's (always)  </span>
<span id="cb375-1138"><a href="#cb375-1138" aria-hidden="true" tabindex="-1"></a>B. Kendall's (more robust to ties)  </span>
<span id="cb375-1139"><a href="#cb375-1139" aria-hidden="true" tabindex="-1"></a>C. Neither (ties invalidate both)  </span>
<span id="cb375-1140"><a href="#cb375-1140" aria-hidden="true" tabindex="-1"></a>D. Pearson's instead</span>
<span id="cb375-1141"><a href="#cb375-1141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1142"><a href="#cb375-1142" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-1143"><a href="#cb375-1143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1144"><a href="#cb375-1144" aria-hidden="true" tabindex="-1"></a>**Q7.** Kruskal-Wallis test is the nonparametric equivalent of:</span>
<span id="cb375-1145"><a href="#cb375-1145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1146"><a href="#cb375-1146" aria-hidden="true" tabindex="-1"></a>A. Independent t-test  </span>
<span id="cb375-1147"><a href="#cb375-1147" aria-hidden="true" tabindex="-1"></a>B. Paired t-test  </span>
<span id="cb375-1148"><a href="#cb375-1148" aria-hidden="true" tabindex="-1"></a>C. One-way ANOVA  </span>
<span id="cb375-1149"><a href="#cb375-1149" aria-hidden="true" tabindex="-1"></a>D. Correlation</span>
<span id="cb375-1150"><a href="#cb375-1150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1151"><a href="#cb375-1151" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-1152"><a href="#cb375-1152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1153"><a href="#cb375-1153" aria-hidden="true" tabindex="-1"></a>**Q8.** After a significant Kruskal-Wallis test (p=0.02), what should you do?</span>
<span id="cb375-1154"><a href="#cb375-1154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1155"><a href="#cb375-1155" aria-hidden="true" tabindex="-1"></a>A. Stopâ€”the overall test is sufficient  </span>
<span id="cb375-1156"><a href="#cb375-1156" aria-hidden="true" tabindex="-1"></a>B. Conduct post-hoc pairwise comparisons with multiplicity correction (e.g., Dunn's test)  </span>
<span id="cb375-1157"><a href="#cb375-1157" aria-hidden="true" tabindex="-1"></a>C. Re-run the test  </span>
<span id="cb375-1158"><a href="#cb375-1158" aria-hidden="true" tabindex="-1"></a>D. Ignore itâ€”nonparametric tests are unreliable</span>
<span id="cb375-1159"><a href="#cb375-1159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1160"><a href="#cb375-1160" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-1161"><a href="#cb375-1161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1162"><a href="#cb375-1162" aria-hidden="true" tabindex="-1"></a>**Q9.** Friedman test is used for:</span>
<span id="cb375-1163"><a href="#cb375-1163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1164"><a href="#cb375-1164" aria-hidden="true" tabindex="-1"></a>A. Two independent groups  </span>
<span id="cb375-1165"><a href="#cb375-1165" aria-hidden="true" tabindex="-1"></a>B. Three or more independent groups  </span>
<span id="cb375-1166"><a href="#cb375-1166" aria-hidden="true" tabindex="-1"></a>C. Three or more related/repeated measures  </span>
<span id="cb375-1167"><a href="#cb375-1167" aria-hidden="true" tabindex="-1"></a>D. Correlation analysis</span>
<span id="cb375-1168"><a href="#cb375-1168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1169"><a href="#cb375-1169" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-1170"><a href="#cb375-1170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1171"><a href="#cb375-1171" aria-hidden="true" tabindex="-1"></a>**Q10.** A researcher finds: t-test p=0.04, Mann-Whitney p=0.06. What does this suggest?</span>
<span id="cb375-1172"><a href="#cb375-1172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1173"><a href="#cb375-1173" aria-hidden="true" tabindex="-1"></a>A. One test is wrong  </span>
<span id="cb375-1174"><a href="#cb375-1174" aria-hidden="true" tabindex="-1"></a>B. Results are sensitive to distributional assumptions; report both and interpret cautiously  </span>
<span id="cb375-1175"><a href="#cb375-1175" aria-hidden="true" tabindex="-1"></a>C. Use whichever p-value is smaller  </span>
<span id="cb375-1176"><a href="#cb375-1176" aria-hidden="true" tabindex="-1"></a>D. Ignore the Mann-Whitney result</span>
<span id="cb375-1177"><a href="#cb375-1177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1178"><a href="#cb375-1178" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-1179"><a href="#cb375-1179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1180"><a href="#cb375-1180" aria-hidden="true" tabindex="-1"></a>**Q11.** Rank-biserial correlation (effect size for Mann-Whitney) ranges from:</span>
<span id="cb375-1181"><a href="#cb375-1181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1182"><a href="#cb375-1182" aria-hidden="true" tabindex="-1"></a>A. 0 to 1  </span>
<span id="cb375-1183"><a href="#cb375-1183" aria-hidden="true" tabindex="-1"></a>B. -1 to +1  </span>
<span id="cb375-1184"><a href="#cb375-1184" aria-hidden="true" tabindex="-1"></a>C. 0 to âˆž  </span>
<span id="cb375-1185"><a href="#cb375-1185" aria-hidden="true" tabindex="-1"></a>D. -âˆž to +âˆž</span>
<span id="cb375-1186"><a href="#cb375-1186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1187"><a href="#cb375-1187" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-1188"><a href="#cb375-1188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1189"><a href="#cb375-1189" aria-hidden="true" tabindex="-1"></a>**Q12.** A Mann-Whitney test with n=8 per group yields p=0.08, Hodges-Lehmann estimate=5. Interpretation:</span>
<span id="cb375-1190"><a href="#cb375-1190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1191"><a href="#cb375-1191" aria-hidden="true" tabindex="-1"></a>A. No effect exists  </span>
<span id="cb375-1192"><a href="#cb375-1192" aria-hidden="true" tabindex="-1"></a>B. The estimated location shift is 5 units, but evidence is weak (p&gt;0.05) likely due to low power  </span>
<span id="cb375-1193"><a href="#cb375-1193" aria-hidden="true" tabindex="-1"></a>C. The effect is exactly 5  </span>
<span id="cb375-1194"><a href="#cb375-1194" aria-hidden="true" tabindex="-1"></a>D. The test is invalid with n=8</span>
<span id="cb375-1195"><a href="#cb375-1195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1196"><a href="#cb375-1196" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb375-1197"><a href="#cb375-1197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1198"><a href="#cb375-1198" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip icon=false collapse="true"}</span>
<span id="cb375-1199"><a href="#cb375-1199" aria-hidden="true" tabindex="-1"></a><span class="fu">## Answers and Explanations</span></span>
<span id="cb375-1200"><a href="#cb375-1200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1201"><a href="#cb375-1201" aria-hidden="true" tabindex="-1"></a>**Q1. Answer: B**  </span>
<span id="cb375-1202"><a href="#cb375-1202" aria-hidden="true" tabindex="-1"></a>*Explanation*: Mann-Whitney (Wilcoxon rank-sum) is the nonparametric alternative to the independent t-test. It's ideal for ordinal data, skewed distributions, or small samples where normality is questionable. The chapter states: "Two independent groups, ordinal or continuous outcomes, small samples, non-normal distributions."</span>
<span id="cb375-1203"><a href="#cb375-1203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1204"><a href="#cb375-1204" aria-hidden="true" tabindex="-1"></a>**Q2. Answer: B**  </span>
<span id="cb375-1205"><a href="#cb375-1205" aria-hidden="true" tabindex="-1"></a>*Explanation*: Mann-Whitney tests whether distributions differ in location shift. If distributional shapes (spread, skewness) are similar, this is interpreted as a median difference. If shapes differ, it tests stochastic dominance. The chapter's warning callout emphasizes checking whether "distributions have similar shapes (for location shift interpretation)."</span>
<span id="cb375-1206"><a href="#cb375-1206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1207"><a href="#cb375-1207" aria-hidden="true" tabindex="-1"></a>**Q3. Answer: B**  </span>
<span id="cb375-1208"><a href="#cb375-1208" aria-hidden="true" tabindex="-1"></a>*Explanation*: Wilcoxon signed-rank is the nonparametric paired test (alternative to paired t-test). It tests whether the median difference between paired observations differs from zero. The chapter's learning objectives state it's for comparing "paired/matched observations."</span>
<span id="cb375-1209"><a href="#cb375-1209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1210"><a href="#cb375-1210" aria-hidden="true" tabindex="-1"></a>**Q4. Answer: B**  </span>
<span id="cb375-1211"><a href="#cb375-1211" aria-hidden="true" tabindex="-1"></a>*Explanation*: The Hodges-Lehmann estimator is the median of all possible pairwise differences between groups. It provides a robust estimate of location shift reported with Mann-Whitney tests. The chapter explicitly states: "The Hodgesâ€“Lehmann estimator provides a point estimate of the location shift (the median of all pairwise differences between groups)."</span>
<span id="cb375-1212"><a href="#cb375-1212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1213"><a href="#cb375-1213" aria-hidden="true" tabindex="-1"></a>**Q5. Answer: B**  </span>
<span id="cb375-1214"><a href="#cb375-1214" aria-hidden="true" tabindex="-1"></a>*Explanation*: Spearman's Ï assesses monotonic associations by ranking data first, making it robust to outliers and nonlinear (but monotonic) relationships. The chapter describes it as "robust to outliers and non-linear relationships (as long as they are monotonic)."</span>
<span id="cb375-1215"><a href="#cb375-1215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1216"><a href="#cb375-1216" aria-hidden="true" tabindex="-1"></a>**Q6. Answer: B**  </span>
<span id="cb375-1217"><a href="#cb375-1217" aria-hidden="true" tabindex="-1"></a>*Explanation*: Kendall's Ï„ handles tied ranks more gracefully than Spearman's Ï and has a direct probability interpretation (difference between concordant and discordant pairs). The chapter section on Kendall's correlation explains its advantages with tied data.</span>
<span id="cb375-1218"><a href="#cb375-1218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1219"><a href="#cb375-1219" aria-hidden="true" tabindex="-1"></a>**Q7. Answer: C**  </span>
<span id="cb375-1220"><a href="#cb375-1220" aria-hidden="true" tabindex="-1"></a>*Explanation*: Kruskal-Wallis extends Mann-Whitney to three or more independent groups, testing whether distributions differ. It's the nonparametric alternative to one-way ANOVA. This is stated in the learning objectives: comparisons of "three or more independent groups."</span>
<span id="cb375-1221"><a href="#cb375-1221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1222"><a href="#cb375-1222" aria-hidden="true" tabindex="-1"></a>**Q8. Answer: B**  </span>
<span id="cb375-1223"><a href="#cb375-1223" aria-hidden="true" tabindex="-1"></a>*Explanation*: A significant omnibus test indicates at least one group differs, but not which pairs differ. Post-hoc tests (Dunn's test with Bonferroni or FDR correction) identify specific differences. The chapter mentions post-hoc comparisons for identifying "which conditions differ."</span>
<span id="cb375-1224"><a href="#cb375-1224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1225"><a href="#cb375-1225" aria-hidden="true" tabindex="-1"></a>**Q9. Answer: C**  </span>
<span id="cb375-1226"><a href="#cb375-1226" aria-hidden="true" tabindex="-1"></a>*Explanation*: Friedman's test is the nonparametric equivalent of repeated-measures ANOVA, comparing three or more related samples (e.g., measurements at times 1, 2, and 3 on the same subjects). The chapter explicitly states: "The Friedman test is the nonparametric analogue of repeated-measures ANOVA."</span>
<span id="cb375-1227"><a href="#cb375-1227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1228"><a href="#cb375-1228" aria-hidden="true" tabindex="-1"></a>**Q10. Answer: B**  </span>
<span id="cb375-1229"><a href="#cb375-1229" aria-hidden="true" tabindex="-1"></a>*Explanation*: Discordant results suggest sensitivity to assumptions (normality, outliers). Report both, inspect data carefully (Q-Q plots, boxplots), and note that results are on the threshold of significanceâ€”interpret with caution. This reflects good statistical practice when assumptions matter.</span>
<span id="cb375-1230"><a href="#cb375-1230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1231"><a href="#cb375-1231" aria-hidden="true" tabindex="-1"></a>**Q11. Answer: B**  </span>
<span id="cb375-1232"><a href="#cb375-1232" aria-hidden="true" tabindex="-1"></a>*Explanation*: Rank-biserial correlation ranges from -1 (complete separation, Group B always higher) through 0 (no difference) to +1 (complete separation, Group A always higher). It's analogous to Cohen's d but for ranks. This is a standard property of correlation-based effect sizes.</span>
<span id="cb375-1233"><a href="#cb375-1233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1234"><a href="#cb375-1234" aria-hidden="true" tabindex="-1"></a>**Q12. Answer: B**  </span>
<span id="cb375-1235"><a href="#cb375-1235" aria-hidden="true" tabindex="-1"></a>*Explanation*: The point estimate (5 units) suggests a moderate effect, but p=0.08 indicates insufficient evidence to reject the null at Î±=0.05. With small samples, emphasis should be on effect size magnitude and CI, not just the p-value. The chapter consistently emphasizes reporting effect sizes alongside p-values and interpreting uncertainty with small samples.</span>
<span id="cb375-1236"><a href="#cb375-1236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1237"><a href="#cb375-1237" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb375-1238"><a href="#cb375-1238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1239"><a href="#cb375-1239" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-1240"><a href="#cb375-1240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1241"><a href="#cb375-1241" aria-hidden="true" tabindex="-1"></a><span class="fu">### Key Takeaways</span></span>
<span id="cb375-1242"><a href="#cb375-1242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1243"><a href="#cb375-1243" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Rank-based methods provide robust, assumption-free inferences for ordinal and non-normal continuous outcomes.</span>
<span id="cb375-1244"><a href="#cb375-1244" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Mannâ€“Whitney U and Wilcoxon signed-rank tests are nonparametric alternatives to t-tests for independent and paired comparisons.</span>
<span id="cb375-1245"><a href="#cb375-1245" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Kruskalâ€“Wallis and Friedman tests extend rank-based comparisons to three or more groups (independent and related, respectively).</span>
<span id="cb375-1246"><a href="#cb375-1246" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Spearman's Ï and Kendall's Ï„ measure monotonic association without assuming linearity or normality.</span>
<span id="cb375-1247"><a href="#cb375-1247" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Effect sizes (rank-biserial correlation, epsilon-squared, Kendall's W) should accompany p-values to quantify practical importance.</span>
<span id="cb375-1248"><a href="#cb375-1248" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Post-hoc tests with multiplicity adjustments identify specific group differences after omnibus tests.</span>
<span id="cb375-1249"><a href="#cb375-1249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1250"><a href="#cb375-1250" aria-hidden="true" tabindex="-1"></a><span class="fu">### Smoke Test</span></span>
<span id="cb375-1251"><a href="#cb375-1251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1254"><a href="#cb375-1254" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb375-1255"><a href="#cb375-1255" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: part-c-chunk-16</span></span>
<span id="cb375-1256"><a href="#cb375-1256" aria-hidden="true" tabindex="-1"></a><span class="co"># Re-run Mannâ€“Whitney test</span></span>
<span id="cb375-1257"><a href="#cb375-1257" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb375-1258"><a href="#cb375-1258" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">9</span>)</span>
<span id="cb375-1259"><a href="#cb375-1259" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">12</span>, <span class="dv">11</span>, <span class="dv">13</span>, <span class="dv">14</span>)</span>
<span id="cb375-1260"><a href="#cb375-1260" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(x, y)</span>
<span id="cb375-1261"><a href="#cb375-1261" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-1262"><a href="#cb375-1262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1263"><a href="#cb375-1263" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-1264"><a href="#cb375-1264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1265"><a href="#cb375-1265" aria-hidden="true" tabindex="-1"></a><span class="fu">## Chapter 5. Penalised and Bayesian Regression for Small Samples</span></span>
<span id="cb375-1266"><a href="#cb375-1266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1267"><a href="#cb375-1267" aria-hidden="true" tabindex="-1"></a><span class="fu">### Learning Objectives</span></span>
<span id="cb375-1268"><a href="#cb375-1268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1269"><a href="#cb375-1269" aria-hidden="true" tabindex="-1"></a>By the end of this chapter, you will be able to:</span>
<span id="cb375-1270"><a href="#cb375-1270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1271"><a href="#cb375-1271" aria-hidden="true" tabindex="-1"></a>**Conceptual Understanding**</span>
<span id="cb375-1272"><a href="#cb375-1272" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Explain how separation causes MLE to fail in logistic regression</span>
<span id="cb375-1273"><a href="#cb375-1273" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Understand the role of penalization in stabilizing coefficient estimates</span>
<span id="cb375-1274"><a href="#cb375-1274" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Recognize how Bayesian priors regularize estimates with limited data</span>
<span id="cb375-1275"><a href="#cb375-1275" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Distinguish weakly informative from strong informative priors</span>
<span id="cb375-1276"><a href="#cb375-1276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1277"><a href="#cb375-1277" aria-hidden="true" tabindex="-1"></a>**Practical Skills**</span>
<span id="cb375-1278"><a href="#cb375-1278" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Fit Firth-penalized logistic regression using <span class="in">`logistf`</span> package in R</span>
<span id="cb375-1279"><a href="#cb375-1279" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Implement Bayesian regression models with <span class="in">`brms`</span> or <span class="in">`rstanarm`</span></span>
<span id="cb375-1280"><a href="#cb375-1280" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Specify appropriate priors (e.g., normal, Student-t, Cauchy) in Stan</span>
<span id="cb375-1281"><a href="#cb375-1281" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Perform posterior predictive checks and LOOCV for model validation</span>
<span id="cb375-1282"><a href="#cb375-1282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1283"><a href="#cb375-1283" aria-hidden="true" tabindex="-1"></a>**Critical Evaluation**</span>
<span id="cb375-1284"><a href="#cb375-1284" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Assess when separation is present and when penalization is necessary</span>
<span id="cb375-1285"><a href="#cb375-1285" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Evaluate the sensitivity of Bayesian results to prior specifications</span>
<span id="cb375-1286"><a href="#cb375-1286" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Critique frequentist vs. Bayesian approaches in small-sample contexts</span>
<span id="cb375-1287"><a href="#cb375-1287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1288"><a href="#cb375-1288" aria-hidden="true" tabindex="-1"></a>**Application**</span>
<span id="cb375-1289"><a href="#cb375-1289" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Apply penalized methods to sparse binary outcomes (e.g., rare events)</span>
<span id="cb375-1290"><a href="#cb375-1290" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Report Bayesian analyses transparently (priors, diagnostics, credible intervals)</span>
<span id="cb375-1291"><a href="#cb375-1291" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Use LOOCV to compare competing models with limited data</span>
<span id="cb375-1292"><a href="#cb375-1292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1293"><a href="#cb375-1293" aria-hidden="true" tabindex="-1"></a><span class="fu">### The Problem of Sparse Data in Regression</span></span>
<span id="cb375-1294"><a href="#cb375-1294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1295"><a href="#cb375-1295" aria-hidden="true" tabindex="-1"></a>Classical maximum likelihood estimation (MLE) can fail when sample sizes are small or events are rare. In logistic regression, separation (perfect prediction of some outcomes) causes MLE to diverge, yielding infinite coefficient estimates. Even without complete separation, small samples produce unstable estimates with wide confidence intervals.</span>
<span id="cb375-1296"><a href="#cb375-1296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1297"><a href="#cb375-1297" aria-hidden="true" tabindex="-1"></a>Penalised regression adds a penalty term to the likelihood, shrinking coefficients towards zero and stabilising estimates. Bayesian regression incorporates prior information (such as weakly informative priors that gently regularise estimates) and quantifies uncertainty through posterior distributions. Both approaches are well-suited to small samples.</span>
<span id="cb375-1298"><a href="#cb375-1298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1299"><a href="#cb375-1299" aria-hidden="true" tabindex="-1"></a><span class="fu">### Firth-Penalised Logistic Regression</span></span>
<span id="cb375-1300"><a href="#cb375-1300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1301"><a href="#cb375-1301" aria-hidden="true" tabindex="-1"></a>Firth's method (Firth, 1993) modifies the logistic regression likelihood to reduce small-sample bias. It is equivalent to adding a penalty that favours finite coefficient estimates. Firth logistic regression is particularly useful when events are sparse (fewer than 10 events per predictor) or when separation occurs.</span>
<span id="cb375-1302"><a href="#cb375-1302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1303"><a href="#cb375-1303" aria-hidden="true" tabindex="-1"></a>**Assumptions**: Binary outcome. Predictors are measured without error. Observations are independent.</span>
<span id="cb375-1304"><a href="#cb375-1304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1305"><a href="#cb375-1305" aria-hidden="true" tabindex="-1"></a>**When to use**: Small samples, rare events (fewer than 10 per predictor), separation or near-separation in standard logistic regression, desire for finite estimates.</span>
<span id="cb375-1306"><a href="#cb375-1306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1307"><a href="#cb375-1307" aria-hidden="true" tabindex="-1"></a><span class="fu">### Example: Firth-Penalised Logistic Regression</span></span>
<span id="cb375-1308"><a href="#cb375-1308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1309"><a href="#cb375-1309" aria-hidden="true" tabindex="-1"></a>We model the probability of project success (binary outcome) based on team size and prior experience. With only 20 projects and 6 successes, standard logistic regression is unstable.</span>
<span id="cb375-1310"><a href="#cb375-1310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1313"><a href="#cb375-1313" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb375-1314"><a href="#cb375-1314" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: part-c-chunk-17</span></span>
<span id="cb375-1315"><a href="#cb375-1315" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb375-1316"><a href="#cb375-1316" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(logistf)</span>
<span id="cb375-1317"><a href="#cb375-1317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1318"><a href="#cb375-1318" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb375-1319"><a href="#cb375-1319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1320"><a href="#cb375-1320" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulated project data</span></span>
<span id="cb375-1321"><a href="#cb375-1321" aria-hidden="true" tabindex="-1"></a>project_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb375-1322"><a href="#cb375-1322" aria-hidden="true" tabindex="-1"></a>  <span class="at">project_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>,</span>
<span id="cb375-1323"><a href="#cb375-1323" aria-hidden="true" tabindex="-1"></a>  <span class="at">team_size =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">5</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">7</span>, <span class="dv">6</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>),</span>
<span id="cb375-1324"><a href="#cb375-1324" aria-hidden="true" tabindex="-1"></a>  <span class="at">experience_years =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">8</span>, <span class="dv">6</span>, <span class="dv">5</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">7</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">7</span>),</span>
<span id="cb375-1325"><a href="#cb375-1325" aria-hidden="true" tabindex="-1"></a>  <span class="at">success =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb375-1326"><a href="#cb375-1326" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb375-1327"><a href="#cb375-1327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1328"><a href="#cb375-1328" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Number of successes:"</span>, <span class="fu">sum</span>(project_data<span class="sc">$</span>success), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-1329"><a href="#cb375-1329" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Events per predictor:"</span>, <span class="fu">sum</span>(project_data<span class="sc">$</span>success) <span class="sc">/</span> <span class="dv">2</span>, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-1330"><a href="#cb375-1330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1331"><a href="#cb375-1331" aria-hidden="true" tabindex="-1"></a><span class="co"># Standard logistic regression (may have issues)</span></span>
<span id="cb375-1332"><a href="#cb375-1332" aria-hidden="true" tabindex="-1"></a>glm_standard <span class="ot">&lt;-</span> <span class="fu">glm</span>(success <span class="sc">~</span> team_size <span class="sc">+</span> experience_years, </span>
<span id="cb375-1333"><a href="#cb375-1333" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> project_data, <span class="at">family =</span> binomial)</span>
<span id="cb375-1334"><a href="#cb375-1334" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(glm_standard)</span>
<span id="cb375-1335"><a href="#cb375-1335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1336"><a href="#cb375-1336" aria-hidden="true" tabindex="-1"></a><span class="co"># Firth-penalised logistic regression</span></span>
<span id="cb375-1337"><a href="#cb375-1337" aria-hidden="true" tabindex="-1"></a>firth_fit <span class="ot">&lt;-</span> <span class="fu">logistf</span>(success <span class="sc">~</span> team_size <span class="sc">+</span> experience_years, </span>
<span id="cb375-1338"><a href="#cb375-1338" aria-hidden="true" tabindex="-1"></a>                     <span class="at">data =</span> project_data)</span>
<span id="cb375-1339"><a href="#cb375-1339" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(firth_fit)</span>
<span id="cb375-1340"><a href="#cb375-1340" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-1341"><a href="#cb375-1341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1342"><a href="#cb375-1342" aria-hidden="true" tabindex="-1"></a>Interpretation: The standard logistic regression may show large standard errors or convergence warnings due to the small number of events. Firth regression produces finite, stable coefficient estimates. Compare the coefficients and standard errors between the two models. Firth estimates are typically smaller in magnitude (shrunken towards zero) and have narrower confidence intervals. The profile likelihood confidence intervals from Firth regression are more reliable than Wald intervals when samples are small.</span>
<span id="cb375-1343"><a href="#cb375-1343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1344"><a href="#cb375-1344" aria-hidden="true" tabindex="-1"></a><span class="fu">### Bayesian Linear Regression with Weakly Informative Priors</span></span>
<span id="cb375-1345"><a href="#cb375-1345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1346"><a href="#cb375-1346" aria-hidden="true" tabindex="-1"></a>Bayesian regression treats regression coefficients as random variables with prior distributions. Weakly informative priors (such as normal priors with moderate variance) gently regularise estimates without imposing strong beliefs. The posterior distribution combines prior and data, yielding probabilistic statements about coefficients and predictions.</span>
<span id="cb375-1347"><a href="#cb375-1347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1348"><a href="#cb375-1348" aria-hidden="true" tabindex="-1"></a>Bayesian methods naturally quantify uncertainty and remain well-defined with small samples. They also facilitate model comparison via information criteria (LOOIC, WAIC) and posterior predictive checks.</span>
<span id="cb375-1349"><a href="#cb375-1349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1350"><a href="#cb375-1350" aria-hidden="true" tabindex="-1"></a>::: {.callout-warning}</span>
<span id="cb375-1351"><a href="#cb375-1351" aria-hidden="true" tabindex="-1"></a><span class="fu">## âš ï¸ Common Misconception: "Bayesian Priors Are Subjective and Biased"</span></span>
<span id="cb375-1352"><a href="#cb375-1352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1353"><a href="#cb375-1353" aria-hidden="true" tabindex="-1"></a>**Myth**: "Using priors means you're forcing your beliefs onto the data. Results are biased."</span>
<span id="cb375-1354"><a href="#cb375-1354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1355"><a href="#cb375-1355" aria-hidden="true" tabindex="-1"></a>**Reality**: **Weakly informative priors** are not "subjective opinions"â€”they're regularization tools that prevent extreme estimates when data are sparse. With small samples, the alternative (maximum likelihood) often produces infinite or nonsensical estimates.</span>
<span id="cb375-1356"><a href="#cb375-1356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1357"><a href="#cb375-1357" aria-hidden="true" tabindex="-1"></a>**Example**:</span>
<span id="cb375-1360"><a href="#cb375-1360" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb375-1361"><a href="#cb375-1361" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: part-c-misconception-3</span></span>
<span id="cb375-1362"><a href="#cb375-1362" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb375-1363"><a href="#cb375-1363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1364"><a href="#cb375-1364" aria-hidden="true" tabindex="-1"></a><span class="co"># Scenario: n=15, binary outcome with separation</span></span>
<span id="cb375-1365"><a href="#cb375-1365" aria-hidden="true" tabindex="-1"></a>logistic_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb375-1366"><a href="#cb375-1366" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">12</span>, <span class="dv">13</span>, <span class="dv">14</span>, <span class="dv">15</span>),</span>
<span id="cb375-1367"><a href="#cb375-1367" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>)  <span class="co"># Perfect separation</span></span>
<span id="cb375-1368"><a href="#cb375-1368" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb375-1369"><a href="#cb375-1369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1370"><a href="#cb375-1370" aria-hidden="true" tabindex="-1"></a><span class="co"># Standard logistic regression (frequentist)</span></span>
<span id="cb375-1371"><a href="#cb375-1371" aria-hidden="true" tabindex="-1"></a>freq_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> logistic_data, <span class="at">family =</span> binomial)</span>
<span id="cb375-1372"><a href="#cb375-1372" aria-hidden="true" tabindex="-1"></a><span class="co"># â†’ Warning: "fitted probabilities 0 or 1"</span></span>
<span id="cb375-1373"><a href="#cb375-1373" aria-hidden="true" tabindex="-1"></a><span class="co"># â†’ Coefficient: âˆž (not useful!)</span></span>
<span id="cb375-1374"><a href="#cb375-1374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1375"><a href="#cb375-1375" aria-hidden="true" tabindex="-1"></a><span class="co"># Bayesian logistic regression with weakly informative prior</span></span>
<span id="cb375-1376"><a href="#cb375-1376" aria-hidden="true" tabindex="-1"></a><span class="co"># Prior: Î² ~ Normal(0, 2.5) â€” allows Â±5 SD range (very wide!)</span></span>
<span id="cb375-1377"><a href="#cb375-1377" aria-hidden="true" tabindex="-1"></a>bayes_model <span class="ot">&lt;-</span> rstanarm<span class="sc">::</span><span class="fu">stan_glm</span>(</span>
<span id="cb375-1378"><a href="#cb375-1378" aria-hidden="true" tabindex="-1"></a>  y <span class="sc">~</span> x, <span class="at">data =</span> logistic_data, <span class="at">family =</span> binomial,</span>
<span id="cb375-1379"><a href="#cb375-1379" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior =</span> <span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.5</span>),</span>
<span id="cb375-1380"><a href="#cb375-1380" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">2</span>, <span class="at">iter =</span> <span class="dv">1000</span>, <span class="at">refresh =</span> <span class="dv">0</span></span>
<span id="cb375-1381"><a href="#cb375-1381" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb375-1382"><a href="#cb375-1382" aria-hidden="true" tabindex="-1"></a><span class="co"># â†’ Coefficient: finite, interpretable value (e.g., Î² â‰ˆ 2.3)</span></span>
<span id="cb375-1383"><a href="#cb375-1383" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-1384"><a href="#cb375-1384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1385"><a href="#cb375-1385" aria-hidden="true" tabindex="-1"></a>**What does the prior do?**</span>
<span id="cb375-1386"><a href="#cb375-1386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1387"><a href="#cb375-1387" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Normal(0, 2.5)** on log-odds scale means: </span>
<span id="cb375-1388"><a href="#cb375-1388" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>95% of prior probability is between -5 and +5 (odds ratios: 0.007 to 148)</span>
<span id="cb375-1389"><a href="#cb375-1389" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>This is **very uninformative** about plausible effect sizes</span>
<span id="cb375-1390"><a href="#cb375-1390" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>But it prevents extreme estimates (Î² = Â±âˆž) when data are sparse</span>
<span id="cb375-1391"><a href="#cb375-1391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1392"><a href="#cb375-1392" aria-hidden="true" tabindex="-1"></a>**Lesson**:</span>
<span id="cb375-1393"><a href="#cb375-1393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1394"><a href="#cb375-1394" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Weakly informative priors â‰  strong beliefs**. They're safety constraints.</span>
<span id="cb375-1395"><a href="#cb375-1395" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>With adequate data (n &gt; 100), priors have minimal influenceâ€”data dominate</span>
<span id="cb375-1396"><a href="#cb375-1396" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>With small samples, priors **stabilize** estimates (like Firth regression)</span>
<span id="cb375-1397"><a href="#cb375-1397" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Sensitivity analysis: Try different priors (e.g., Normal(0, 1) vs Normal(0, 5)) and check if conclusions change</span>
<span id="cb375-1398"><a href="#cb375-1398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1399"><a href="#cb375-1399" aria-hidden="true" tabindex="-1"></a>**Rule of thumb**: If your results change drastically with mildly different priors, your data are too weak to support firm conclusionsâ€”report this uncertainty honestly.</span>
<span id="cb375-1400"><a href="#cb375-1400" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb375-1401"><a href="#cb375-1401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1402"><a href="#cb375-1402" aria-hidden="true" tabindex="-1"></a>**Assumptions**: Linear relationship between predictors and outcome (for linear regression). Normal errors (often relaxed in Bayesian models by using robust likelihoods). Independent observations.</span>
<span id="cb375-1403"><a href="#cb375-1403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1404"><a href="#cb375-1404" aria-hidden="true" tabindex="-1"></a>**When to use**: Small samples, desire for probabilistic inference, need for flexible error distributions, model comparison and selection.</span>
<span id="cb375-1405"><a href="#cb375-1405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1406"><a href="#cb375-1406" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; **Note**: The following Bayesian examples use the </span><span class="in">`brms`</span><span class="at"> package, which requires Rtools to be installed on Windows for Stan model compilation. If you encounter "make not found" errors, install Rtools from https://cran.r-project.org/bin/windows/Rtools/ and restart R. The code chunks below are set to </span><span class="in">`eval=FALSE`</span><span class="at"> to allow document rendering without Rtools.</span></span>
<span id="cb375-1407"><a href="#cb375-1407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1408"><a href="#cb375-1408" aria-hidden="true" tabindex="-1"></a>A short note on <span class="in">`brms`</span> vs <span class="in">`rstanarm`</span>: <span class="in">`brms`</span> provides a very flexible, formula-based interface to Stan (via <span class="in">`rstan`</span> or <span class="in">`cmdstanr`</span>) and supports complex model families and custom Stan code; it is ideal when you need advanced models, custom priors, or full control over sampling. <span class="in">`rstanarm`</span> offers a lighter-weight interface with precompiled model templates (easier for classrooms and quick demos). If you need broad model flexibility and are comfortable installing Stan toolchains, prefer <span class="in">`brms`</span>. For runnable examples, teaching, or simpler models where installation friction is a concern, <span class="in">`rstanarm`</span> is a practical alternative â€” the chapter includes both examples so you can choose based on your environment.</span>
<span id="cb375-1409"><a href="#cb375-1409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1410"><a href="#cb375-1410" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; **Always inspect diagnostics.** After fitting a Bayesian model, verify that $</span></span>
<span id="cb375-1411"><a href="#cb375-1411" aria-hidden="true" tabindex="-1"></a><span class="at">\hat{R} &lt; 1.01$ for all parameters, effective sample size ratios exceed 0.1 (ideally &gt; 0.5), and there are no divergent transitions. Trace plots and posterior predictive checks should be part of your routine workflow before interpreting coefficients.</span></span>
<span id="cb375-1412"><a href="#cb375-1412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1413"><a href="#cb375-1413" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Essential MCMC Diagnostics</span></span>
<span id="cb375-1414"><a href="#cb375-1414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1415"><a href="#cb375-1415" aria-hidden="true" tabindex="-1"></a>**Always check these before trusting Bayesian results:**</span>
<span id="cb375-1416"><a href="#cb375-1416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1417"><a href="#cb375-1417" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**R-hat &lt; 1.01**: Indicates chains have converged</span>
<span id="cb375-1418"><a href="#cb375-1418" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>If R-hat &gt; 1.01: Increase iterations or add chains</span>
<span id="cb375-1419"><a href="#cb375-1419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1420"><a href="#cb375-1420" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**ESS &gt; 400** (or ESS ratio &gt; 0.1): Adequate effective samples</span>
<span id="cb375-1421"><a href="#cb375-1421" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>If low: Increase iterations or adjust <span class="in">`adapt_delta`</span></span>
<span id="cb375-1422"><a href="#cb375-1422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1423"><a href="#cb375-1423" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Trace plots**: Should look like "hairy caterpillars"</span>
<span id="cb375-1424"><a href="#cb375-1424" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Trends or stickiness indicate problems</span>
<span id="cb375-1425"><a href="#cb375-1425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1426"><a href="#cb375-1426" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Posterior predictive checks**: Simulated data should match observed values</span>
<span id="cb375-1427"><a href="#cb375-1427" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Use <span class="in">`pp_check()`</span> to visualise fit</span>
<span id="cb375-1428"><a href="#cb375-1428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1429"><a href="#cb375-1429" aria-hidden="true" tabindex="-1"></a>**Red flags:**</span>
<span id="cb375-1430"><a href="#cb375-1430" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Divergent transition warnings</span>
<span id="cb375-1431"><a href="#cb375-1431" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Tree depth exceeded messages</span>
<span id="cb375-1432"><a href="#cb375-1432" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Very wide posterior intervals (possible underfitting)</span>
<span id="cb375-1433"><a href="#cb375-1433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1434"><a href="#cb375-1434" aria-hidden="true" tabindex="-1"></a>**When diagnostics fail:**</span>
<span id="cb375-1435"><a href="#cb375-1435" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Increase iterations: <span class="in">`iter = 4000`</span>, <span class="in">`warmup = 2000`</span></span>
<span id="cb375-1436"><a href="#cb375-1436" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Increase chains: <span class="in">`chains = 4`</span></span>
<span id="cb375-1437"><a href="#cb375-1437" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Adjust sampler: <span class="in">`control = list(adapt_delta = 0.95)`</span></span>
<span id="cb375-1438"><a href="#cb375-1438" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Check for priorâ€“data conflict</span>
<span id="cb375-1439"><a href="#cb375-1439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1440"><a href="#cb375-1440" aria-hidden="true" tabindex="-1"></a>::: {.callout-important}</span>
<span id="cb375-1441"><a href="#cb375-1441" aria-hidden="true" tabindex="-1"></a><span class="fu">## MCMC Diagnostic Checklist</span></span>
<span id="cb375-1442"><a href="#cb375-1442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1443"><a href="#cb375-1443" aria-hidden="true" tabindex="-1"></a>Before interpreting Bayesian results:</span>
<span id="cb375-1444"><a href="#cb375-1444" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> All R-hat values &lt; 1.01</span>
<span id="cb375-1445"><a href="#cb375-1445" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> All ESS &gt; 400 (or ESS ratio &gt; 0.1)</span>
<span id="cb375-1446"><a href="#cb375-1446" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> No divergent transitions</span>
<span id="cb375-1447"><a href="#cb375-1447" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> Trace plots show good mixing</span>
<span id="cb375-1448"><a href="#cb375-1448" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> Posterior predictive check shows reasonable fit</span>
<span id="cb375-1449"><a href="#cb375-1449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1450"><a href="#cb375-1450" aria-hidden="true" tabindex="-1"></a>If any check fails, do not trust the results.</span>
<span id="cb375-1451"><a href="#cb375-1451" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb375-1452"><a href="#cb375-1452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1453"><a href="#cb375-1453" aria-hidden="true" tabindex="-1"></a><span class="fu">### Example: Bayesian Linear Regression with brms</span></span>
<span id="cb375-1454"><a href="#cb375-1454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1455"><a href="#cb375-1455" aria-hidden="true" tabindex="-1"></a>We model customer satisfaction scores (continuous, 1â€“10 scale) based on wait time and staff friendliness ratings. With only 18 observations, classical regression has limited precision.</span>
<span id="cb375-1456"><a href="#cb375-1456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1457"><a href="#cb375-1457" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval=FALSE}</span></span>
<span id="cb375-1458"><a href="#cb375-1458" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: part-c-chunk-18</span></span>
<span id="cb375-1459"><a href="#cb375-1459" aria-hidden="true" tabindex="-1"></a><span class="co"># Note: This example requires Rtools to be installed for Stan compilation</span></span>
<span id="cb375-1460"><a href="#cb375-1460" aria-hidden="true" tabindex="-1"></a><span class="co"># To run this code, install Rtools from: https://cran.r-project.org/bin/windows/Rtools/</span></span>
<span id="cb375-1461"><a href="#cb375-1461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1462"><a href="#cb375-1462" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb375-1463"><a href="#cb375-1463" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(brms)</span>
<span id="cb375-1464"><a href="#cb375-1464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1465"><a href="#cb375-1465" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb375-1466"><a href="#cb375-1466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1467"><a href="#cb375-1467" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulated customer data</span></span>
<span id="cb375-1468"><a href="#cb375-1468" aria-hidden="true" tabindex="-1"></a>customer_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb375-1469"><a href="#cb375-1469" aria-hidden="true" tabindex="-1"></a>  <span class="at">customer_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">18</span>,</span>
<span id="cb375-1470"><a href="#cb375-1470" aria-hidden="true" tabindex="-1"></a>  <span class="at">wait_time =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">8</span>, <span class="dv">12</span>, <span class="dv">7</span>, <span class="dv">15</span>, <span class="dv">6</span>, <span class="dv">9</span>, <span class="dv">11</span>, <span class="dv">8</span>, <span class="dv">13</span>, <span class="dv">7</span>, <span class="dv">10</span>, <span class="dv">9</span>, <span class="dv">12</span>, <span class="dv">8</span>, <span class="dv">11</span>, <span class="dv">10</span>),</span>
<span id="cb375-1471"><a href="#cb375-1471" aria-hidden="true" tabindex="-1"></a>  <span class="at">friendliness =</span> <span class="fu">c</span>(<span class="dv">8</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">6</span>, <span class="dv">9</span>, <span class="dv">5</span>, <span class="dv">9</span>, <span class="dv">8</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">6</span>, <span class="dv">9</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">7</span>, <span class="dv">7</span>),</span>
<span id="cb375-1472"><a href="#cb375-1472" aria-hidden="true" tabindex="-1"></a>  <span class="at">satisfaction =</span> <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">3</span>, <span class="dv">8</span>, <span class="dv">6</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">6</span>, <span class="dv">6</span>)</span>
<span id="cb375-1473"><a href="#cb375-1473" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb375-1474"><a href="#cb375-1474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1475"><a href="#cb375-1475" aria-hidden="true" tabindex="-1"></a><span class="co"># Bayesian linear regression with weakly informative priors</span></span>
<span id="cb375-1476"><a href="#cb375-1476" aria-hidden="true" tabindex="-1"></a>bayes_fit <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb375-1477"><a href="#cb375-1477" aria-hidden="true" tabindex="-1"></a>  satisfaction <span class="sc">~</span> wait_time <span class="sc">+</span> friendliness,</span>
<span id="cb375-1478"><a href="#cb375-1478" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> customer_data,</span>
<span id="cb375-1479"><a href="#cb375-1479" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">gaussian</span>(),</span>
<span id="cb375-1480"><a href="#cb375-1480" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior =</span> <span class="fu">c</span>(</span>
<span id="cb375-1481"><a href="#cb375-1481" aria-hidden="true" tabindex="-1"></a>    <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">5</span>), <span class="at">class =</span> <span class="st">"b"</span>),</span>
<span id="cb375-1482"><a href="#cb375-1482" aria-hidden="true" tabindex="-1"></a>    <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">6</span>, <span class="dv">3</span>), <span class="at">class =</span> <span class="st">"Intercept"</span>),</span>
<span id="cb375-1483"><a href="#cb375-1483" aria-hidden="true" tabindex="-1"></a>    <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> <span class="st">"sigma"</span>)</span>
<span id="cb375-1484"><a href="#cb375-1484" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb375-1485"><a href="#cb375-1485" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb375-1486"><a href="#cb375-1486" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter =</span> <span class="dv">2000</span>,</span>
<span id="cb375-1487"><a href="#cb375-1487" aria-hidden="true" tabindex="-1"></a>  <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb375-1488"><a href="#cb375-1488" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">2025</span>,</span>
<span id="cb375-1489"><a href="#cb375-1489" aria-hidden="true" tabindex="-1"></a>  <span class="at">refresh =</span> <span class="dv">0</span>,</span>
<span id="cb375-1490"><a href="#cb375-1490" aria-hidden="true" tabindex="-1"></a>  <span class="at">silent =</span> <span class="dv">2</span></span>
<span id="cb375-1491"><a href="#cb375-1491" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb375-1492"><a href="#cb375-1492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1493"><a href="#cb375-1493" aria-hidden="true" tabindex="-1"></a><span class="co"># MCMC Diagnostics</span></span>
<span id="cb375-1494"><a href="#cb375-1494" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== MCMC DIAGNOSTICS ===</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-1495"><a href="#cb375-1495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1496"><a href="#cb375-1496" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Check R-hat (convergence)</span></span>
<span id="cb375-1497"><a href="#cb375-1497" aria-hidden="true" tabindex="-1"></a>rhat_vals <span class="ot">&lt;-</span> <span class="fu">rhat</span>(bayes_fit)</span>
<span id="cb375-1498"><a href="#cb375-1498" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"R-hat values (should be &lt; 1.01):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-1499"><a href="#cb375-1499" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(rhat_vals[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>])</span>
<span id="cb375-1500"><a href="#cb375-1500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1501"><a href="#cb375-1501" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">all</span>(rhat_vals <span class="sc">&lt;</span> <span class="fl">1.01</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb375-1502"><a href="#cb375-1502" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"OK: All R-hat &lt; 1.01, chains converged</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-1503"><a href="#cb375-1503" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb375-1504"><a href="#cb375-1504" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"WARNING: Some R-hat &gt;= 1.01, check convergence</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-1505"><a href="#cb375-1505" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb375-1506"><a href="#cb375-1506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1507"><a href="#cb375-1507" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Check Effective Sample Size</span></span>
<span id="cb375-1508"><a href="#cb375-1508" aria-hidden="true" tabindex="-1"></a>ess_vals <span class="ot">&lt;-</span> <span class="fu">neff_ratio</span>(bayes_fit)</span>
<span id="cb375-1509"><a href="#cb375-1509" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Effective sample size ratio (should be &gt; 0.1):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-1510"><a href="#cb375-1510" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(ess_vals[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>])</span>
<span id="cb375-1511"><a href="#cb375-1511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1512"><a href="#cb375-1512" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">all</span>(ess_vals <span class="sc">&gt;</span> <span class="fl">0.1</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb375-1513"><a href="#cb375-1513" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"OK: ESS ratios adequate</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-1514"><a href="#cb375-1514" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb375-1515"><a href="#cb375-1515" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"WARNING: Low ESS detected, consider more iterations</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-1516"><a href="#cb375-1516" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb375-1517"><a href="#cb375-1517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1518"><a href="#cb375-1518" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Posterior predictive check</span></span>
<span id="cb375-1519"><a href="#cb375-1519" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(bayes_fit, <span class="at">ndraws =</span> <span class="dv">50</span>)</span>
<span id="cb375-1520"><a href="#cb375-1520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1521"><a href="#cb375-1521" aria-hidden="true" tabindex="-1"></a><span class="co"># Posterior summary for reporting</span></span>
<span id="cb375-1522"><a href="#cb375-1522" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bayes_fit)</span>
<span id="cb375-1523"><a href="#cb375-1523" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-1524"><a href="#cb375-1524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1527"><a href="#cb375-1527" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb375-1528"><a href="#cb375-1528" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: part-c-chunk-18-rstanarm</span></span>
<span id="cb375-1529"><a href="#cb375-1529" aria-hidden="true" tabindex="-1"></a><span class="co"># Runnable alternative using rstanarm (lighter Stan setup)</span></span>
<span id="cb375-1530"><a href="#cb375-1530" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb375-1531"><a href="#cb375-1531" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"rstanarm"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb375-1532"><a href="#cb375-1532" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"rstanarm not installed; install with install.packages('rstanarm')</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-1533"><a href="#cb375-1533" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb375-1534"><a href="#cb375-1534" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(rstanarm)</span>
<span id="cb375-1535"><a href="#cb375-1535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1536"><a href="#cb375-1536" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Use the same simulated data as the brms example</span></span>
<span id="cb375-1537"><a href="#cb375-1537" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb375-1538"><a href="#cb375-1538" aria-hidden="true" tabindex="-1"></a>  customer_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb375-1539"><a href="#cb375-1539" aria-hidden="true" tabindex="-1"></a>    <span class="at">customer_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">18</span>,</span>
<span id="cb375-1540"><a href="#cb375-1540" aria-hidden="true" tabindex="-1"></a>    <span class="at">wait_time =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">8</span>, <span class="dv">12</span>, <span class="dv">7</span>, <span class="dv">15</span>, <span class="dv">6</span>, <span class="dv">9</span>, <span class="dv">11</span>, <span class="dv">8</span>, <span class="dv">13</span>, <span class="dv">7</span>, <span class="dv">10</span>, <span class="dv">9</span>, <span class="dv">12</span>, <span class="dv">8</span>, <span class="dv">11</span>, <span class="dv">10</span>),</span>
<span id="cb375-1541"><a href="#cb375-1541" aria-hidden="true" tabindex="-1"></a>    <span class="at">friendliness =</span> <span class="fu">c</span>(<span class="dv">8</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">6</span>, <span class="dv">9</span>, <span class="dv">5</span>, <span class="dv">9</span>, <span class="dv">8</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">6</span>, <span class="dv">9</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">7</span>, <span class="dv">7</span>),</span>
<span id="cb375-1542"><a href="#cb375-1542" aria-hidden="true" tabindex="-1"></a>    <span class="at">satisfaction =</span> <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">3</span>, <span class="dv">8</span>, <span class="dv">6</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">6</span>, <span class="dv">6</span>)</span>
<span id="cb375-1543"><a href="#cb375-1543" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb375-1544"><a href="#cb375-1544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1545"><a href="#cb375-1545" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Fit a Bayesian linear model with weakly informative priors</span></span>
<span id="cb375-1546"><a href="#cb375-1546" aria-hidden="true" tabindex="-1"></a>  fit_rstanarm <span class="ot">&lt;-</span> <span class="fu">stan_glm</span>(</span>
<span id="cb375-1547"><a href="#cb375-1547" aria-hidden="true" tabindex="-1"></a>    satisfaction <span class="sc">~</span> wait_time <span class="sc">+</span> friendliness,</span>
<span id="cb375-1548"><a href="#cb375-1548" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> customer_data,</span>
<span id="cb375-1549"><a href="#cb375-1549" aria-hidden="true" tabindex="-1"></a>    <span class="at">prior =</span> <span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">5</span>),</span>
<span id="cb375-1550"><a href="#cb375-1550" aria-hidden="true" tabindex="-1"></a>    <span class="at">prior_intercept =</span> <span class="fu">normal</span>(<span class="dv">6</span>, <span class="dv">3</span>),</span>
<span id="cb375-1551"><a href="#cb375-1551" aria-hidden="true" tabindex="-1"></a>    <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb375-1552"><a href="#cb375-1552" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter =</span> <span class="dv">2000</span>,</span>
<span id="cb375-1553"><a href="#cb375-1553" aria-hidden="true" tabindex="-1"></a>    <span class="at">seed =</span> <span class="dv">2025</span>,</span>
<span id="cb375-1554"><a href="#cb375-1554" aria-hidden="true" tabindex="-1"></a>    <span class="at">refresh =</span> <span class="dv">0</span></span>
<span id="cb375-1555"><a href="#cb375-1555" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb375-1556"><a href="#cb375-1556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1557"><a href="#cb375-1557" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Simple diagnostics and checks</span></span>
<span id="cb375-1558"><a href="#cb375-1558" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">summary</span>(fit_rstanarm))</span>
<span id="cb375-1559"><a href="#cb375-1559" aria-hidden="true" tabindex="-1"></a>  posterior_samples <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(fit_rstanarm)</span>
<span id="cb375-1560"><a href="#cb375-1560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1561"><a href="#cb375-1561" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Basic diagnostics using posterior draws: compute R-hat from posterior draws</span></span>
<span id="cb375-1562"><a href="#cb375-1562" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">requireNamespace</span>(<span class="st">"posterior"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb375-1563"><a href="#cb375-1563" aria-hidden="true" tabindex="-1"></a>    draws <span class="ot">&lt;-</span> posterior<span class="sc">::</span><span class="fu">as_draws_array</span>(fit_rstanarm)</span>
<span id="cb375-1564"><a href="#cb375-1564" aria-hidden="true" tabindex="-1"></a>    rhats <span class="ot">&lt;-</span> posterior<span class="sc">::</span><span class="fu">rhat</span>(draws)</span>
<span id="cb375-1565"><a href="#cb375-1565" aria-hidden="true" tabindex="-1"></a>    ess <span class="ot">&lt;-</span> posterior<span class="sc">::</span><span class="fu">ess_bulk</span>(draws)</span>
<span id="cb375-1566"><a href="#cb375-1566" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">R-hat (first coefficients):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-1567"><a href="#cb375-1567" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(rhats[<span class="dv">1</span><span class="sc">:</span><span class="fu">min</span>(<span class="fu">length</span>(rhats),<span class="dv">5</span>)])</span>
<span id="cb375-1568"><a href="#cb375-1568" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">ESS (first coefficients):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-1569"><a href="#cb375-1569" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(ess[<span class="dv">1</span><span class="sc">:</span><span class="fu">min</span>(<span class="fu">length</span>(ess),<span class="dv">5</span>)])</span>
<span id="cb375-1570"><a href="#cb375-1570" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb375-1571"><a href="#cb375-1571" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"posterior package not installed; skipping R-hat/ESS checks</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-1572"><a href="#cb375-1572" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb375-1573"><a href="#cb375-1573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1574"><a href="#cb375-1574" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Posterior predictive check (basic)</span></span>
<span id="cb375-1575"><a href="#cb375-1575" aria-hidden="true" tabindex="-1"></a>  yrep <span class="ot">&lt;-</span> <span class="fu">posterior_predict</span>(fit_rstanarm, <span class="at">draws =</span> <span class="dv">50</span>)</span>
<span id="cb375-1576"><a href="#cb375-1576" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">requireNamespace</span>(<span class="st">"bayesplot"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb375-1577"><a href="#cb375-1577" aria-hidden="true" tabindex="-1"></a>    bayesplot<span class="sc">::</span><span class="fu">ppc_dens_overlay</span>(<span class="at">y =</span> customer_data<span class="sc">$</span>satisfaction, <span class="at">yrep =</span> yrep)</span>
<span id="cb375-1578"><a href="#cb375-1578" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb375-1579"><a href="#cb375-1579" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"bayesplot not installed; skipping ppc plot</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-1580"><a href="#cb375-1580" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb375-1581"><a href="#cb375-1581" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb375-1582"><a href="#cb375-1582" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-1583"><a href="#cb375-1583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1584"><a href="#cb375-1584" aria-hidden="true" tabindex="-1"></a>Interpretation: The posterior summary provides estimates (posterior means or medians), standard errors (posterior standard deviations), and credible intervals (Bayesian analogue of confidence intervals). A 95% credible interval for a coefficient contains the true value with 95% probability given the data and prior. Posterior predictive checks compare simulated data from the fitted model to observed data; good fit is indicated when simulated data resemble observed data. The <span class="in">`brms`</span> package uses Stan for efficient Markov chain Monte Carlo (MCMC) sampling.</span>
<span id="cb375-1585"><a href="#cb375-1585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1586"><a href="#cb375-1586" aria-hidden="true" tabindex="-1"></a><span class="fu">### Bayesian Logistic Regression</span></span>
<span id="cb375-1587"><a href="#cb375-1587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1588"><a href="#cb375-1588" aria-hidden="true" tabindex="-1"></a>Bayesian logistic regression extends Bayesian methods to binary outcomes. Weakly informative priors on log-odds coefficients (such as normal priors centred at zero) stabilise estimates and prevent divergence.</span>
<span id="cb375-1589"><a href="#cb375-1589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1590"><a href="#cb375-1590" aria-hidden="true" tabindex="-1"></a><span class="fu">### Example: Bayesian Logistic Regression</span></span>
<span id="cb375-1591"><a href="#cb375-1591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1592"><a href="#cb375-1592" aria-hidden="true" tabindex="-1"></a>We model the probability of employee retention (binary: retained or left) based on job satisfaction and salary level in a small company with 25 employees.</span>
<span id="cb375-1593"><a href="#cb375-1593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1594"><a href="#cb375-1594" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval=FALSE}</span></span>
<span id="cb375-1595"><a href="#cb375-1595" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: part-c-chunk-19</span></span>
<span id="cb375-1596"><a href="#cb375-1596" aria-hidden="true" tabindex="-1"></a><span class="co"># Note: This example requires Rtools to be installed for Stan compilation</span></span>
<span id="cb375-1597"><a href="#cb375-1597" aria-hidden="true" tabindex="-1"></a><span class="co"># To run this code, install Rtools from: https://cran.r-project.org/bin/windows/Rtools/</span></span>
<span id="cb375-1598"><a href="#cb375-1598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1599"><a href="#cb375-1599" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb375-1600"><a href="#cb375-1600" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(brms)</span>
<span id="cb375-1601"><a href="#cb375-1601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1602"><a href="#cb375-1602" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb375-1603"><a href="#cb375-1603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1604"><a href="#cb375-1604" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulated retention data</span></span>
<span id="cb375-1605"><a href="#cb375-1605" aria-hidden="true" tabindex="-1"></a>retention_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb375-1606"><a href="#cb375-1606" aria-hidden="true" tabindex="-1"></a>  <span class="at">employee_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>,</span>
<span id="cb375-1607"><a href="#cb375-1607" aria-hidden="true" tabindex="-1"></a>  <span class="at">satisfaction =</span> <span class="fu">sample</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">9</span>, <span class="dv">25</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb375-1608"><a href="#cb375-1608" aria-hidden="true" tabindex="-1"></a>  <span class="at">salary_level =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">25</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb375-1609"><a href="#cb375-1609" aria-hidden="true" tabindex="-1"></a>  <span class="at">retained =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb375-1610"><a href="#cb375-1610" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb375-1611"><a href="#cb375-1611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1612"><a href="#cb375-1612" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Retention rate:"</span>, <span class="fu">mean</span>(retention_data<span class="sc">$</span>retained), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-1613"><a href="#cb375-1613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1614"><a href="#cb375-1614" aria-hidden="true" tabindex="-1"></a><span class="co"># Bayesian logistic regression</span></span>
<span id="cb375-1615"><a href="#cb375-1615" aria-hidden="true" tabindex="-1"></a>bayes_logit <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb375-1616"><a href="#cb375-1616" aria-hidden="true" tabindex="-1"></a>  retained <span class="sc">~</span> satisfaction <span class="sc">+</span> salary_level,</span>
<span id="cb375-1617"><a href="#cb375-1617" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> retention_data,</span>
<span id="cb375-1618"><a href="#cb375-1618" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">bernoulli</span>(<span class="at">link =</span> <span class="st">"logit"</span>),</span>
<span id="cb375-1619"><a href="#cb375-1619" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior =</span> <span class="fu">c</span>(</span>
<span id="cb375-1620"><a href="#cb375-1620" aria-hidden="true" tabindex="-1"></a>    <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="at">class =</span> <span class="st">"b"</span>),</span>
<span id="cb375-1621"><a href="#cb375-1621" aria-hidden="true" tabindex="-1"></a>    <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">5</span>), <span class="at">class =</span> <span class="st">"Intercept"</span>)</span>
<span id="cb375-1622"><a href="#cb375-1622" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb375-1623"><a href="#cb375-1623" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb375-1624"><a href="#cb375-1624" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter =</span> <span class="dv">2000</span>,</span>
<span id="cb375-1625"><a href="#cb375-1625" aria-hidden="true" tabindex="-1"></a>  <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb375-1626"><a href="#cb375-1626" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">2025</span>,</span>
<span id="cb375-1627"><a href="#cb375-1627" aria-hidden="true" tabindex="-1"></a>  <span class="at">refresh =</span> <span class="dv">0</span>,</span>
<span id="cb375-1628"><a href="#cb375-1628" aria-hidden="true" tabindex="-1"></a>  <span class="at">silent =</span> <span class="dv">2</span></span>
<span id="cb375-1629"><a href="#cb375-1629" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb375-1630"><a href="#cb375-1630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1631"><a href="#cb375-1631" aria-hidden="true" tabindex="-1"></a><span class="co"># MCMC Diagnostics</span></span>
<span id="cb375-1632"><a href="#cb375-1632" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== MCMC DIAGNOSTICS ===</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-1633"><a href="#cb375-1633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1634"><a href="#cb375-1634" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Check R-hat (convergence)</span></span>
<span id="cb375-1635"><a href="#cb375-1635" aria-hidden="true" tabindex="-1"></a>rhat_vals <span class="ot">&lt;-</span> <span class="fu">rhat</span>(bayes_logit)</span>
<span id="cb375-1636"><a href="#cb375-1636" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"R-hat values (should be &lt; 1.01):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-1637"><a href="#cb375-1637" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(rhat_vals[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>])</span>
<span id="cb375-1638"><a href="#cb375-1638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1639"><a href="#cb375-1639" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">all</span>(rhat_vals <span class="sc">&lt;</span> <span class="fl">1.01</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb375-1640"><a href="#cb375-1640" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"OK: All R-hat &lt; 1.01, chains converged</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-1641"><a href="#cb375-1641" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb375-1642"><a href="#cb375-1642" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"WARNING: Some R-hat &gt;= 1.01, check convergence</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-1643"><a href="#cb375-1643" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb375-1644"><a href="#cb375-1644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1645"><a href="#cb375-1645" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Check Effective Sample Size</span></span>
<span id="cb375-1646"><a href="#cb375-1646" aria-hidden="true" tabindex="-1"></a>ess_vals <span class="ot">&lt;-</span> <span class="fu">neff_ratio</span>(bayes_logit)</span>
<span id="cb375-1647"><a href="#cb375-1647" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Effective sample size ratio (should be &gt; 0.1):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-1648"><a href="#cb375-1648" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(ess_vals[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>])</span>
<span id="cb375-1649"><a href="#cb375-1649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1650"><a href="#cb375-1650" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">all</span>(ess_vals <span class="sc">&gt;</span> <span class="fl">0.1</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb375-1651"><a href="#cb375-1651" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"OK: ESS ratios adequate</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-1652"><a href="#cb375-1652" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb375-1653"><a href="#cb375-1653" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"WARNING: Low ESS detected, consider more iterations</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-1654"><a href="#cb375-1654" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb375-1655"><a href="#cb375-1655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1656"><a href="#cb375-1656" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Posterior predictive check</span></span>
<span id="cb375-1657"><a href="#cb375-1657" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(bayes_logit, <span class="at">ndraws =</span> <span class="dv">50</span>, <span class="at">type =</span> <span class="st">"bars"</span>)</span>
<span id="cb375-1658"><a href="#cb375-1658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1659"><a href="#cb375-1659" aria-hidden="true" tabindex="-1"></a><span class="co"># Posterior summary for reporting</span></span>
<span id="cb375-1660"><a href="#cb375-1660" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bayes_logit)</span>
<span id="cb375-1661"><a href="#cb375-1661" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-1662"><a href="#cb375-1662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1665"><a href="#cb375-1665" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb375-1666"><a href="#cb375-1666" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: part-c-chunk-19-rstanarm</span></span>
<span id="cb375-1667"><a href="#cb375-1667" aria-hidden="true" tabindex="-1"></a><span class="co"># Runnable alternative using rstanarm for logistic regression</span></span>
<span id="cb375-1668"><a href="#cb375-1668" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb375-1669"><a href="#cb375-1669" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"rstanarm"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb375-1670"><a href="#cb375-1670" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"rstanarm not installed; install with install.packages('rstanarm')</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-1671"><a href="#cb375-1671" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb375-1672"><a href="#cb375-1672" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(rstanarm)</span>
<span id="cb375-1673"><a href="#cb375-1673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1674"><a href="#cb375-1674" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb375-1675"><a href="#cb375-1675" aria-hidden="true" tabindex="-1"></a>  retention_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb375-1676"><a href="#cb375-1676" aria-hidden="true" tabindex="-1"></a>    <span class="at">employee_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>,</span>
<span id="cb375-1677"><a href="#cb375-1677" aria-hidden="true" tabindex="-1"></a>    <span class="at">satisfaction =</span> <span class="fu">sample</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">9</span>, <span class="dv">25</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb375-1678"><a href="#cb375-1678" aria-hidden="true" tabindex="-1"></a>    <span class="at">salary_level =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">25</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb375-1679"><a href="#cb375-1679" aria-hidden="true" tabindex="-1"></a>    <span class="at">retained =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb375-1680"><a href="#cb375-1680" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb375-1681"><a href="#cb375-1681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1682"><a href="#cb375-1682" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Retention rate:"</span>, <span class="fu">mean</span>(retention_data<span class="sc">$</span>retained), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-1683"><a href="#cb375-1683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1684"><a href="#cb375-1684" aria-hidden="true" tabindex="-1"></a>  fit_logit_rstanarm <span class="ot">&lt;-</span> <span class="fu">stan_glm</span>(</span>
<span id="cb375-1685"><a href="#cb375-1685" aria-hidden="true" tabindex="-1"></a>    retained <span class="sc">~</span> satisfaction <span class="sc">+</span> salary_level,</span>
<span id="cb375-1686"><a href="#cb375-1686" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> retention_data,</span>
<span id="cb375-1687"><a href="#cb375-1687" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>),</span>
<span id="cb375-1688"><a href="#cb375-1688" aria-hidden="true" tabindex="-1"></a>    <span class="at">prior =</span> <span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>),</span>
<span id="cb375-1689"><a href="#cb375-1689" aria-hidden="true" tabindex="-1"></a>    <span class="at">prior_intercept =</span> <span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">5</span>),</span>
<span id="cb375-1690"><a href="#cb375-1690" aria-hidden="true" tabindex="-1"></a>    <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb375-1691"><a href="#cb375-1691" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter =</span> <span class="dv">2000</span>,</span>
<span id="cb375-1692"><a href="#cb375-1692" aria-hidden="true" tabindex="-1"></a>    <span class="at">seed =</span> <span class="dv">2025</span>,</span>
<span id="cb375-1693"><a href="#cb375-1693" aria-hidden="true" tabindex="-1"></a>    <span class="at">refresh =</span> <span class="dv">0</span></span>
<span id="cb375-1694"><a href="#cb375-1694" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb375-1695"><a href="#cb375-1695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1696"><a href="#cb375-1696" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== rstanarm summary ===</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-1697"><a href="#cb375-1697" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">summary</span>(fit_logit_rstanarm))</span>
<span id="cb375-1698"><a href="#cb375-1698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1699"><a href="#cb375-1699" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">requireNamespace</span>(<span class="st">"posterior"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb375-1700"><a href="#cb375-1700" aria-hidden="true" tabindex="-1"></a>    draws <span class="ot">&lt;-</span> posterior<span class="sc">::</span><span class="fu">as_draws_array</span>(fit_logit_rstanarm)</span>
<span id="cb375-1701"><a href="#cb375-1701" aria-hidden="true" tabindex="-1"></a>    rhats <span class="ot">&lt;-</span> posterior<span class="sc">::</span><span class="fu">rhat</span>(draws)</span>
<span id="cb375-1702"><a href="#cb375-1702" aria-hidden="true" tabindex="-1"></a>    ess <span class="ot">&lt;-</span> posterior<span class="sc">::</span><span class="fu">ess_bulk</span>(draws)</span>
<span id="cb375-1703"><a href="#cb375-1703" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">R-hat (first coefficients):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-1704"><a href="#cb375-1704" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(rhats[<span class="dv">1</span><span class="sc">:</span><span class="fu">min</span>(<span class="fu">length</span>(rhats),<span class="dv">5</span>)])</span>
<span id="cb375-1705"><a href="#cb375-1705" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">ESS (first coefficients):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-1706"><a href="#cb375-1706" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(ess[<span class="dv">1</span><span class="sc">:</span><span class="fu">min</span>(<span class="fu">length</span>(ess),<span class="dv">5</span>)])</span>
<span id="cb375-1707"><a href="#cb375-1707" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb375-1708"><a href="#cb375-1708" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"posterior package not installed; skipping R-hat/ESS checks</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-1709"><a href="#cb375-1709" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb375-1710"><a href="#cb375-1710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1711"><a href="#cb375-1711" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Basic posterior predictive check for binary data</span></span>
<span id="cb375-1712"><a href="#cb375-1712" aria-hidden="true" tabindex="-1"></a>  yrep <span class="ot">&lt;-</span> <span class="fu">posterior_predict</span>(fit_logit_rstanarm, <span class="at">draws =</span> <span class="dv">50</span>)</span>
<span id="cb375-1713"><a href="#cb375-1713" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">requireNamespace</span>(<span class="st">"bayesplot"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb375-1714"><a href="#cb375-1714" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ppc_bars expects a matrix-like yrep; show observed vs predicted distribution</span></span>
<span id="cb375-1715"><a href="#cb375-1715" aria-hidden="true" tabindex="-1"></a>    bayesplot<span class="sc">::</span><span class="fu">ppc_bars</span>(<span class="at">y =</span> retention_data<span class="sc">$</span>retained, <span class="at">yrep =</span> yrep)</span>
<span id="cb375-1716"><a href="#cb375-1716" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb375-1717"><a href="#cb375-1717" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"bayesplot not installed; skipping ppc plot</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-1718"><a href="#cb375-1718" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb375-1719"><a href="#cb375-1719" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb375-1720"><a href="#cb375-1720" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-1721"><a href="#cb375-1721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1722"><a href="#cb375-1722" aria-hidden="true" tabindex="-1"></a>Interpretation: Coefficients are on the log-odds scale. Positive coefficients indicate that higher predictor values increase the odds of retention. The posterior predictive check for binary outcomes compares the distribution of observed outcomes (0s and 1s) to predicted distributions from the model. LOOIC (leave-one-out information criterion) can be used to compare this model to alternatives.</span>
<span id="cb375-1723"><a href="#cb375-1723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1724"><a href="#cb375-1724" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; **Diagnostic reminder:** Just like the linear model, inspect R-hat values, effective sample sizes, divergent transition warnings, and trace plots before trusting logistic regression inferences.</span></span>
<span id="cb375-1725"><a href="#cb375-1725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1726"><a href="#cb375-1726" aria-hidden="true" tabindex="-1"></a><span class="fu">### Leave-One-Out Cross-Validation (LOOCV)</span></span>
<span id="cb375-1727"><a href="#cb375-1727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1728"><a href="#cb375-1728" aria-hidden="true" tabindex="-1"></a>Bayesian models can be compared using LOOIC, which estimates out-of-sample predictive accuracy. LOOIC is computed efficiently from the posterior samples using Pareto-smoothed importance sampling. Lower LOOIC indicates better predictive performance.</span>
<span id="cb375-1729"><a href="#cb375-1729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1730"><a href="#cb375-1730" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval=FALSE}</span></span>
<span id="cb375-1731"><a href="#cb375-1731" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: part-c-chunk-20</span></span>
<span id="cb375-1732"><a href="#cb375-1732" aria-hidden="true" tabindex="-1"></a><span class="co"># Note: This example requires the bayes_logit model from the previous chunk</span></span>
<span id="cb375-1733"><a href="#cb375-1733" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute LOOIC for the retention model</span></span>
<span id="cb375-1734"><a href="#cb375-1734" aria-hidden="true" tabindex="-1"></a>loo_result <span class="ot">&lt;-</span> <span class="fu">loo</span>(bayes_logit)</span>
<span id="cb375-1735"><a href="#cb375-1735" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(loo_result)</span>
<span id="cb375-1736"><a href="#cb375-1736" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-1737"><a href="#cb375-1737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1738"><a href="#cb375-1738" aria-hidden="true" tabindex="-1"></a>Interpretation: The LOOIC value provides a measure of model fit adjusted for complexity. When comparing models, prefer the one with lower LOOIC. The standard error of the LOOIC difference helps assess whether differences are meaningful.</span>
<span id="cb375-1739"><a href="#cb375-1739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1740"><a href="#cb375-1740" aria-hidden="true" tabindex="-1"></a><span class="fu">### Lab Practical 5.1: Predicting Medication Adherence with Firth Regression</span></span>
<span id="cb375-1741"><a href="#cb375-1741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1742"><a href="#cb375-1742" aria-hidden="true" tabindex="-1"></a>**Context**: A health psychology study examined whether depression severity (PHQ-9 score) and perceived social support predict medication adherence (Yes/No) in a sample of 18 patients with chronic illness. With a small sample and potential separation (e.g., all patients with high social support adhering), standard logistic regression may fail. Firth regression provides stable estimates by applying a penalized likelihood.</span>
<span id="cb375-1743"><a href="#cb375-1743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1744"><a href="#cb375-1744" aria-hidden="true" tabindex="-1"></a>**Learning Goals**:</span>
<span id="cb375-1745"><a href="#cb375-1745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1746"><a href="#cb375-1746" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Detect separation in binary outcomes</span>
<span id="cb375-1747"><a href="#cb375-1747" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Compare standard (<span class="in">`glm`</span>) and Firth-penalised (<span class="in">`logistf`</span>) logistic regression</span>
<span id="cb375-1748"><a href="#cb375-1748" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Interpret penalized coefficients and confidence intervals</span>
<span id="cb375-1749"><a href="#cb375-1749" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Understand when Firth regression is essential</span>
<span id="cb375-1750"><a href="#cb375-1750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1751"><a href="#cb375-1751" aria-hidden="true" tabindex="-1"></a>**Step 1: Load and Explore the Data**</span>
<span id="cb375-1752"><a href="#cb375-1752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1755"><a href="#cb375-1755" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb375-1756"><a href="#cb375-1756" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: part-c-lab-5-1</span></span>
<span id="cb375-1757"><a href="#cb375-1757" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb375-1758"><a href="#cb375-1758" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(logistf)</span>
<span id="cb375-1759"><a href="#cb375-1759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1760"><a href="#cb375-1760" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulated medication adherence data</span></span>
<span id="cb375-1761"><a href="#cb375-1761" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb375-1762"><a href="#cb375-1762" aria-hidden="true" tabindex="-1"></a>adherence_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb375-1763"><a href="#cb375-1763" aria-hidden="true" tabindex="-1"></a>  <span class="at">patient_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">18</span>,</span>
<span id="cb375-1764"><a href="#cb375-1764" aria-hidden="true" tabindex="-1"></a>  <span class="at">depression =</span> <span class="fu">c</span>(<span class="dv">22</span>, <span class="dv">18</span>, <span class="dv">15</span>, <span class="dv">20</span>, <span class="dv">19</span>, <span class="dv">12</span>, <span class="dv">10</span>, <span class="dv">8</span>, <span class="dv">14</span>, <span class="dv">16</span>, <span class="dv">11</span>, <span class="dv">9</span>, <span class="dv">7</span>, <span class="dv">13</span>, <span class="dv">6</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">3</span>),</span>
<span id="cb375-1765"><a href="#cb375-1765" aria-hidden="true" tabindex="-1"></a>  <span class="at">social_support =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">6</span>, <span class="dv">4</span>, <span class="dv">7</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">8</span>),</span>
<span id="cb375-1766"><a href="#cb375-1766" aria-hidden="true" tabindex="-1"></a>  <span class="at">adherent =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb375-1767"><a href="#cb375-1767" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb375-1768"><a href="#cb375-1768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1769"><a href="#cb375-1769" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary statistics</span></span>
<span id="cb375-1770"><a href="#cb375-1770" aria-hidden="true" tabindex="-1"></a>adherence_data <span class="sc">%&gt;%</span></span>
<span id="cb375-1771"><a href="#cb375-1771" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(adherent) <span class="sc">%&gt;%</span></span>
<span id="cb375-1772"><a href="#cb375-1772" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb375-1773"><a href="#cb375-1773" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb375-1774"><a href="#cb375-1774" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_depression =</span> <span class="fu">mean</span>(depression),</span>
<span id="cb375-1775"><a href="#cb375-1775" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_support =</span> <span class="fu">mean</span>(social_support)</span>
<span id="cb375-1776"><a href="#cb375-1776" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb375-1777"><a href="#cb375-1777" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-1778"><a href="#cb375-1778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1779"><a href="#cb375-1779" aria-hidden="true" tabindex="-1"></a>**Checkpoint**: Non-adherent patients (n = 8) have higher depression scores (mean â‰ˆ 18) and lower social support (mean â‰ˆ 2.5). Adherent patients (n = 10) show the opposite pattern. This suggests strong predictors but potential separation.</span>
<span id="cb375-1780"><a href="#cb375-1780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1781"><a href="#cb375-1781" aria-hidden="true" tabindex="-1"></a>**Step 2: Visualize the Data**</span>
<span id="cb375-1782"><a href="#cb375-1782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1785"><a href="#cb375-1785" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb375-1786"><a href="#cb375-1786" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: part-c-lab-5-2</span></span>
<span id="cb375-1787"><a href="#cb375-1787" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(adherence_data, <span class="fu">aes</span>(<span class="at">x =</span> social_support, <span class="at">y =</span> depression, <span class="at">color =</span> <span class="fu">factor</span>(adherent), <span class="at">shape =</span> <span class="fu">factor</span>(adherent))) <span class="sc">+</span></span>
<span id="cb375-1788"><a href="#cb375-1788" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb375-1789"><a href="#cb375-1789" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb375-1790"><a href="#cb375-1790" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Medication Adherence by Depression and Social Support"</span>,</span>
<span id="cb375-1791"><a href="#cb375-1791" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Social Support (1-10 scale)"</span>,</span>
<span id="cb375-1792"><a href="#cb375-1792" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Depression Severity (PHQ-9)"</span>,</span>
<span id="cb375-1793"><a href="#cb375-1793" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Adherent"</span>,</span>
<span id="cb375-1794"><a href="#cb375-1794" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> <span class="st">"Adherent"</span></span>
<span id="cb375-1795"><a href="#cb375-1795" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb375-1796"><a href="#cb375-1796" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"0"</span> <span class="ot">=</span> <span class="st">"red"</span>, <span class="st">"1"</span> <span class="ot">=</span> <span class="st">"blue"</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No"</span>, <span class="st">"Yes"</span>)) <span class="sc">+</span></span>
<span id="cb375-1797"><a href="#cb375-1797" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">16</span>, <span class="dv">17</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No"</span>, <span class="st">"Yes"</span>)) <span class="sc">+</span></span>
<span id="cb375-1798"><a href="#cb375-1798" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb375-1799"><a href="#cb375-1799" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-1800"><a href="#cb375-1800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1801"><a href="#cb375-1801" aria-hidden="true" tabindex="-1"></a>**Checkpoint**: The scatterplot shows clear separation: high social support values (â‰¥6) are associated with adherence, while low values (â‰¤3) predict non-adherence. This suggests quasi-complete separation, which may cause standard logistic regression to fail.</span>
<span id="cb375-1802"><a href="#cb375-1802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1803"><a href="#cb375-1803" aria-hidden="true" tabindex="-1"></a>**Step 3: Attempt Standard Logistic Regression**</span>
<span id="cb375-1804"><a href="#cb375-1804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1807"><a href="#cb375-1807" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb375-1808"><a href="#cb375-1808" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: part-c-lab-5-3</span></span>
<span id="cb375-1809"><a href="#cb375-1809" aria-hidden="true" tabindex="-1"></a><span class="co"># Standard logistic regression</span></span>
<span id="cb375-1810"><a href="#cb375-1810" aria-hidden="true" tabindex="-1"></a>standard_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb375-1811"><a href="#cb375-1811" aria-hidden="true" tabindex="-1"></a>  adherent <span class="sc">~</span> depression <span class="sc">+</span> social_support,</span>
<span id="cb375-1812"><a href="#cb375-1812" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> adherence_data,</span>
<span id="cb375-1813"><a href="#cb375-1813" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>)</span>
<span id="cb375-1814"><a href="#cb375-1814" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb375-1815"><a href="#cb375-1815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1816"><a href="#cb375-1816" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(standard_model)</span>
<span id="cb375-1817"><a href="#cb375-1817" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-1818"><a href="#cb375-1818" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1819"><a href="#cb375-1819" aria-hidden="true" tabindex="-1"></a>**Checkpoint**: Look for warning messages like "fitted probabilities numerically 0 or 1" or extremely large coefficient estimates (e.g., |Î²| &gt; 10) and large standard errors. These indicate separation. The model may produce unreliable predictions.</span>
<span id="cb375-1820"><a href="#cb375-1820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1821"><a href="#cb375-1821" aria-hidden="true" tabindex="-1"></a>**Step 4: Fit Firth-Penalised Logistic Regression**</span>
<span id="cb375-1822"><a href="#cb375-1822" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1825"><a href="#cb375-1825" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb375-1826"><a href="#cb375-1826" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: part-c-lab-5-4</span></span>
<span id="cb375-1827"><a href="#cb375-1827" aria-hidden="true" tabindex="-1"></a><span class="co"># Firth-penalised logistic regression</span></span>
<span id="cb375-1828"><a href="#cb375-1828" aria-hidden="true" tabindex="-1"></a>firth_model <span class="ot">&lt;-</span> <span class="fu">logistf</span>(</span>
<span id="cb375-1829"><a href="#cb375-1829" aria-hidden="true" tabindex="-1"></a>  adherent <span class="sc">~</span> depression <span class="sc">+</span> social_support,</span>
<span id="cb375-1830"><a href="#cb375-1830" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> adherence_data</span>
<span id="cb375-1831"><a href="#cb375-1831" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb375-1832"><a href="#cb375-1832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1833"><a href="#cb375-1833" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(firth_model)</span>
<span id="cb375-1834"><a href="#cb375-1834" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-1835"><a href="#cb375-1835" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1836"><a href="#cb375-1836" aria-hidden="true" tabindex="-1"></a>**Checkpoint**: Firth regression produces finite coefficient estimates with reduced bias. Compare the coefficients and standard errors to the standard model. Firth estimates should be smaller in magnitude but more stable.</span>
<span id="cb375-1837"><a href="#cb375-1837" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1838"><a href="#cb375-1838" aria-hidden="true" tabindex="-1"></a>**Step 5: Interpret the Results**</span>
<span id="cb375-1839"><a href="#cb375-1839" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1842"><a href="#cb375-1842" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb375-1843"><a href="#cb375-1843" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: part-c-lab-5-5</span></span>
<span id="cb375-1844"><a href="#cb375-1844" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract coefficients and confidence intervals</span></span>
<span id="cb375-1845"><a href="#cb375-1845" aria-hidden="true" tabindex="-1"></a>coef_firth <span class="ot">&lt;-</span> <span class="fu">coef</span>(firth_model)</span>
<span id="cb375-1846"><a href="#cb375-1846" aria-hidden="true" tabindex="-1"></a>ci_firth <span class="ot">&lt;-</span> <span class="fu">confint</span>(firth_model)</span>
<span id="cb375-1847"><a href="#cb375-1847" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1848"><a href="#cb375-1848" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Depression coefficient:"</span>, <span class="fu">round</span>(coef_firth[<span class="st">"depression"</span>], <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-1849"><a href="#cb375-1849" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  95% CI:"</span>, <span class="fu">round</span>(ci_firth[<span class="st">"depression"</span>, ], <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-1850"><a href="#cb375-1850" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Social support coefficient:"</span>, <span class="fu">round</span>(coef_firth[<span class="st">"social_support"</span>], <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-1851"><a href="#cb375-1851" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  95% CI:"</span>, <span class="fu">round</span>(ci_firth[<span class="st">"social_support"</span>, ], <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-1852"><a href="#cb375-1852" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1853"><a href="#cb375-1853" aria-hidden="true" tabindex="-1"></a><span class="co"># Odds ratios</span></span>
<span id="cb375-1854"><a href="#cb375-1854" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(coef_firth[<span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb375-1855"><a href="#cb375-1855" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-1856"><a href="#cb375-1856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1857"><a href="#cb375-1857" aria-hidden="true" tabindex="-1"></a>**Interpretation**:</span>
<span id="cb375-1858"><a href="#cb375-1858" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1859"><a href="#cb375-1859" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Depression**: Each 1-point increase in PHQ-9 score is associated with lower odds of adherence (OR &lt; 1, negative coefficient)</span>
<span id="cb375-1860"><a href="#cb375-1860" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Social Support**: Each 1-point increase in social support is associated with higher odds of adherence (OR &gt; 1, positive coefficient)</span>
<span id="cb375-1861"><a href="#cb375-1861" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The confidence intervals exclude 1 (assuming significant effects), confirming both predictors are important</span>
<span id="cb375-1862"><a href="#cb375-1862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1863"><a href="#cb375-1863" aria-hidden="true" tabindex="-1"></a>**Step 6: Compare Models**</span>
<span id="cb375-1864"><a href="#cb375-1864" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1867"><a href="#cb375-1867" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb375-1868"><a href="#cb375-1868" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: part-c-lab-5-6</span></span>
<span id="cb375-1869"><a href="#cb375-1869" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare AIC (if standard model converged)</span></span>
<span id="cb375-1870"><a href="#cb375-1870" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Standard model AIC:"</span>, <span class="fu">AIC</span>(standard_model), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-1871"><a href="#cb375-1871" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Firth model AIC:"</span>, firth_model<span class="sc">$</span>loglik[<span class="dv">2</span>], <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)  <span class="co"># Note: logistf returns penalized log-likelihood</span></span>
<span id="cb375-1872"><a href="#cb375-1872" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-1873"><a href="#cb375-1873" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1874"><a href="#cb375-1874" aria-hidden="true" tabindex="-1"></a>**Checkpoint**: Firth regression provides stable estimates even when standard regression warns of separation. In small samples with rare events, Firth is the preferred approach.</span>
<span id="cb375-1875"><a href="#cb375-1875" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1876"><a href="#cb375-1876" aria-hidden="true" tabindex="-1"></a>**Step 7: Report the Results**</span>
<span id="cb375-1877"><a href="#cb375-1877" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1878"><a href="#cb375-1878" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; "Medication adherence was predicted from depression severity (PHQ-9) and perceived social support (n = 18) using Firth-penalised logistic regression due to quasi-complete separation. Higher social support was associated with increased adherence (OR = </span><span class="co">[</span><span class="ot">value</span><span class="co">]</span><span class="at">, 95% CI </span><span class="co">[</span><span class="ot">lower, upper</span><span class="co">]</span><span class="at">, p &lt; 0.05), while higher depression severity was associated with decreased adherence (OR = </span><span class="co">[</span><span class="ot">value</span><span class="co">]</span><span class="at">, 95% CI </span><span class="co">[</span><span class="ot">lower, upper</span><span class="co">]</span><span class="at">, p &lt; 0.05). Firth regression provided stable estimates where standard logistic regression failed due to separation."</span></span>
<span id="cb375-1879"><a href="#cb375-1879" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1880"><a href="#cb375-1880" aria-hidden="true" tabindex="-1"></a>**Discussion Questions**:</span>
<span id="cb375-1881"><a href="#cb375-1881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1882"><a href="#cb375-1882" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>What are the signs of separation in the standard model output?</span>
<span id="cb375-1883"><a href="#cb375-1883" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Warning messages about fitted probabilities, extremely large coefficients (|Î²| &gt; 10), inflated standard errors, or non-convergence</span>
<span id="cb375-1884"><a href="#cb375-1884" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Why does Firth regression work when standard regression fails?</span>
<span id="cb375-1885"><a href="#cb375-1885" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Firth adds a penalty term (Jeffreys prior) to the likelihood, shrinking coefficients toward zero and preventing infinite estimates</span>
<span id="cb375-1886"><a href="#cb375-1886" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>When should you use Firth regression vs. Bayesian logistic regression?</span>
<span id="cb375-1887"><a href="#cb375-1887" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Firth: Quick, frequentist inference, handles separation automatically</span>
<span id="cb375-1888"><a href="#cb375-1888" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Bayesian: Incorporates prior beliefs, provides full posterior distributions, better for complex models or expert knowledge</span>
<span id="cb375-1889"><a href="#cb375-1889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1890"><a href="#cb375-1890" aria-hidden="true" tabindex="-1"></a>**Extension**: Try adding an interaction term (<span class="in">`depression * social_support`</span>) to test whether the effect of depression depends on social support level. Assess whether the interaction improves model fit using likelihood ratio tests.</span>
<span id="cb375-1891"><a href="#cb375-1891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1892"><a href="#cb375-1892" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-1893"><a href="#cb375-1893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1894"><a href="#cb375-1894" aria-hidden="true" tabindex="-1"></a><span class="fu">### Lab Practical 5.2: Regularized Regression for Multiple Predictors (Ridge, Lasso, Elastic Net)</span></span>
<span id="cb375-1895"><a href="#cb375-1895" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1896"><a href="#cb375-1896" aria-hidden="true" tabindex="-1"></a>**Context**: A startup company (n = 60 employees) wants to predict employee turnover (binary: stayed/left) using 8 potential predictors: satisfaction, salary, commute time, tenure, performance rating, team size, training hours, and work-from-home days. With p = 8 predictors and n = 60, standard logistic regression risks overfitting. Regularized methods (ridge, lasso, elastic net) prevent overfitting by penalizing large coefficients.</span>
<span id="cb375-1897"><a href="#cb375-1897" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1898"><a href="#cb375-1898" aria-hidden="true" tabindex="-1"></a>**Learning Goals**:</span>
<span id="cb375-1899"><a href="#cb375-1899" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1900"><a href="#cb375-1900" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Understand when regularization is needed (p/n ratio approaching 0.1-0.2)</span>
<span id="cb375-1901"><a href="#cb375-1901" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Compare ridge (L2), lasso (L1), and elastic net penalties</span>
<span id="cb375-1902"><a href="#cb375-1902" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Use cross-validation to select optimal penalty strength (Î»)</span>
<span id="cb375-1903"><a href="#cb375-1903" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Interpret regularized coefficients and variable selection</span>
<span id="cb375-1904"><a href="#cb375-1904" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Report regularized models transparently</span>
<span id="cb375-1905"><a href="#cb375-1905" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1906"><a href="#cb375-1906" aria-hidden="true" tabindex="-1"></a>**When to Use Regularized Regression**:</span>
<span id="cb375-1907"><a href="#cb375-1907" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1908"><a href="#cb375-1908" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Ridge (L2)**: Many correlated predictors, want to shrink all coefficients</span>
<span id="cb375-1909"><a href="#cb375-1909" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Lasso (L1)**: Want automatic variable selection (some coefficients â†’ 0)</span>
<span id="cb375-1910"><a href="#cb375-1910" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Elastic Net**: Combines ridge + lasso; best for correlated predictors with selection</span>
<span id="cb375-1911"><a href="#cb375-1911" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1912"><a href="#cb375-1912" aria-hidden="true" tabindex="-1"></a>**Step 1: Simulate Employee Turnover Data**</span>
<span id="cb375-1913"><a href="#cb375-1913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1916"><a href="#cb375-1916" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb375-1917"><a href="#cb375-1917" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: part-c-lab-5-2-1</span></span>
<span id="cb375-1918"><a href="#cb375-1918" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb375-1919"><a href="#cb375-1919" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glmnet)  <span class="co"># For regularized regression</span></span>
<span id="cb375-1920"><a href="#cb375-1920" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1921"><a href="#cb375-1921" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb375-1922"><a href="#cb375-1922" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1923"><a href="#cb375-1923" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate 60 employees with 8 predictors</span></span>
<span id="cb375-1924"><a href="#cb375-1924" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">60</span></span>
<span id="cb375-1925"><a href="#cb375-1925" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1926"><a href="#cb375-1926" aria-hidden="true" tabindex="-1"></a>employee_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb375-1927"><a href="#cb375-1927" aria-hidden="true" tabindex="-1"></a>  <span class="at">employee_id =</span> <span class="dv">1</span><span class="sc">:</span>n,</span>
<span id="cb375-1928"><a href="#cb375-1928" aria-hidden="true" tabindex="-1"></a>  <span class="at">satisfaction =</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">6</span>, <span class="at">sd =</span> <span class="fl">1.5</span>),</span>
<span id="cb375-1929"><a href="#cb375-1929" aria-hidden="true" tabindex="-1"></a>  <span class="at">salary =</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">55000</span>, <span class="at">sd =</span> <span class="dv">10000</span>),</span>
<span id="cb375-1930"><a href="#cb375-1930" aria-hidden="true" tabindex="-1"></a>  <span class="at">commute_min =</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">30</span>, <span class="at">sd =</span> <span class="dv">15</span>),</span>
<span id="cb375-1931"><a href="#cb375-1931" aria-hidden="true" tabindex="-1"></a>  <span class="at">tenure_years =</span> <span class="fu">round</span>(<span class="fu">runif</span>(n, <span class="at">min =</span> <span class="fl">0.5</span>, <span class="at">max =</span> <span class="dv">8</span>), <span class="dv">1</span>),</span>
<span id="cb375-1932"><a href="#cb375-1932" aria-hidden="true" tabindex="-1"></a>  <span class="at">performance =</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="fl">3.5</span>, <span class="at">sd =</span> <span class="fl">0.7</span>),  <span class="co"># 1-5 scale</span></span>
<span id="cb375-1933"><a href="#cb375-1933" aria-hidden="true" tabindex="-1"></a>  <span class="at">team_size =</span> <span class="fu">sample</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">12</span>, n, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb375-1934"><a href="#cb375-1934" aria-hidden="true" tabindex="-1"></a>  <span class="at">training_hours =</span> <span class="fu">round</span>(<span class="fu">runif</span>(n, <span class="at">min =</span> <span class="dv">5</span>, <span class="at">max =</span> <span class="dv">50</span>)),</span>
<span id="cb375-1935"><a href="#cb375-1935" aria-hidden="true" tabindex="-1"></a>  <span class="at">wfh_days =</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>, n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb375-1936"><a href="#cb375-1936" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb375-1937"><a href="#cb375-1937" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1938"><a href="#cb375-1938" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate turnover outcome (logistic model)</span></span>
<span id="cb375-1939"><a href="#cb375-1939" aria-hidden="true" tabindex="-1"></a><span class="co"># Higher satisfaction, salary, performance â†’ lower turnover</span></span>
<span id="cb375-1940"><a href="#cb375-1940" aria-hidden="true" tabindex="-1"></a><span class="co"># Higher commute, longer tenure (paradoxically) â†’ higher turnover</span></span>
<span id="cb375-1941"><a href="#cb375-1941" aria-hidden="true" tabindex="-1"></a>prob_leave <span class="ot">&lt;-</span> <span class="fu">plogis</span>(</span>
<span id="cb375-1942"><a href="#cb375-1942" aria-hidden="true" tabindex="-1"></a>  <span class="sc">-</span><span class="fl">0.5</span> <span class="sc">+</span>  <span class="co"># Adjusted intercept for more balanced outcome</span></span>
<span id="cb375-1943"><a href="#cb375-1943" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span><span class="fl">0.5</span> <span class="sc">*</span> <span class="fu">scale</span>(employee_data<span class="sc">$</span>satisfaction)[,<span class="dv">1</span>] <span class="sc">+</span></span>
<span id="cb375-1944"><a href="#cb375-1944" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span><span class="fl">0.3</span> <span class="sc">*</span> <span class="fu">scale</span>(employee_data<span class="sc">$</span>salary)[,<span class="dv">1</span>] <span class="sc">+</span></span>
<span id="cb375-1945"><a href="#cb375-1945" aria-hidden="true" tabindex="-1"></a>    <span class="fl">0.4</span> <span class="sc">*</span> <span class="fu">scale</span>(employee_data<span class="sc">$</span>commute_min)[,<span class="dv">1</span>] <span class="sc">+</span></span>
<span id="cb375-1946"><a href="#cb375-1946" aria-hidden="true" tabindex="-1"></a>    <span class="fl">0.2</span> <span class="sc">*</span> <span class="fu">scale</span>(employee_data<span class="sc">$</span>tenure_years)[,<span class="dv">1</span>] <span class="sc">+</span></span>
<span id="cb375-1947"><a href="#cb375-1947" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span><span class="fl">0.3</span> <span class="sc">*</span> <span class="fu">scale</span>(employee_data<span class="sc">$</span>performance)[,<span class="dv">1</span>] <span class="sc">+</span></span>
<span id="cb375-1948"><a href="#cb375-1948" aria-hidden="true" tabindex="-1"></a>    <span class="fl">0.1</span> <span class="sc">*</span> <span class="fu">scale</span>(employee_data<span class="sc">$</span>team_size)[,<span class="dv">1</span>] <span class="sc">+</span></span>
<span id="cb375-1949"><a href="#cb375-1949" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span><span class="fl">0.1</span> <span class="sc">*</span> <span class="fu">scale</span>(employee_data<span class="sc">$</span>training_hours)[,<span class="dv">1</span>] <span class="sc">+</span></span>
<span id="cb375-1950"><a href="#cb375-1950" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span><span class="fl">0.05</span> <span class="sc">*</span> <span class="fu">scale</span>(employee_data<span class="sc">$</span>wfh_days)[,<span class="dv">1</span>]</span>
<span id="cb375-1951"><a href="#cb375-1951" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb375-1952"><a href="#cb375-1952" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1953"><a href="#cb375-1953" aria-hidden="true" tabindex="-1"></a>employee_data<span class="sc">$</span>left <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, <span class="dv">1</span>, prob_leave)</span>
<span id="cb375-1954"><a href="#cb375-1954" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1955"><a href="#cb375-1955" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure we have both classes represented (minimum 5 per class for CV)</span></span>
<span id="cb375-1956"><a href="#cb375-1956" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span>(<span class="fu">sum</span>(employee_data<span class="sc">$</span>left) <span class="sc">&lt;</span> <span class="dv">5</span> <span class="sc">|</span> <span class="fu">sum</span>(employee_data<span class="sc">$</span>left) <span class="sc">&gt;</span> <span class="dv">55</span>) {</span>
<span id="cb375-1957"><a href="#cb375-1957" aria-hidden="true" tabindex="-1"></a>  prob_leave <span class="ot">&lt;-</span> <span class="fu">plogis</span>(</span>
<span id="cb375-1958"><a href="#cb375-1958" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span><span class="fl">0.5</span> <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="fl">0.2</span>) <span class="sc">+</span>  <span class="co"># Add slight variation</span></span>
<span id="cb375-1959"><a href="#cb375-1959" aria-hidden="true" tabindex="-1"></a>      <span class="sc">-</span><span class="fl">0.5</span> <span class="sc">*</span> <span class="fu">scale</span>(employee_data<span class="sc">$</span>satisfaction)[,<span class="dv">1</span>] <span class="sc">+</span></span>
<span id="cb375-1960"><a href="#cb375-1960" aria-hidden="true" tabindex="-1"></a>      <span class="sc">-</span><span class="fl">0.3</span> <span class="sc">*</span> <span class="fu">scale</span>(employee_data<span class="sc">$</span>salary)[,<span class="dv">1</span>] <span class="sc">+</span></span>
<span id="cb375-1961"><a href="#cb375-1961" aria-hidden="true" tabindex="-1"></a>      <span class="fl">0.4</span> <span class="sc">*</span> <span class="fu">scale</span>(employee_data<span class="sc">$</span>commute_min)[,<span class="dv">1</span>] <span class="sc">+</span></span>
<span id="cb375-1962"><a href="#cb375-1962" aria-hidden="true" tabindex="-1"></a>      <span class="fl">0.2</span> <span class="sc">*</span> <span class="fu">scale</span>(employee_data<span class="sc">$</span>tenure_years)[,<span class="dv">1</span>] <span class="sc">+</span></span>
<span id="cb375-1963"><a href="#cb375-1963" aria-hidden="true" tabindex="-1"></a>      <span class="sc">-</span><span class="fl">0.3</span> <span class="sc">*</span> <span class="fu">scale</span>(employee_data<span class="sc">$</span>performance)[,<span class="dv">1</span>] <span class="sc">+</span></span>
<span id="cb375-1964"><a href="#cb375-1964" aria-hidden="true" tabindex="-1"></a>      <span class="fl">0.1</span> <span class="sc">*</span> <span class="fu">scale</span>(employee_data<span class="sc">$</span>team_size)[,<span class="dv">1</span>] <span class="sc">+</span></span>
<span id="cb375-1965"><a href="#cb375-1965" aria-hidden="true" tabindex="-1"></a>      <span class="sc">-</span><span class="fl">0.1</span> <span class="sc">*</span> <span class="fu">scale</span>(employee_data<span class="sc">$</span>training_hours)[,<span class="dv">1</span>] <span class="sc">+</span></span>
<span id="cb375-1966"><a href="#cb375-1966" aria-hidden="true" tabindex="-1"></a>      <span class="sc">-</span><span class="fl">0.05</span> <span class="sc">*</span> <span class="fu">scale</span>(employee_data<span class="sc">$</span>wfh_days)[,<span class="dv">1</span>]</span>
<span id="cb375-1967"><a href="#cb375-1967" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb375-1968"><a href="#cb375-1968" aria-hidden="true" tabindex="-1"></a>  employee_data<span class="sc">$</span>left <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, <span class="dv">1</span>, prob_leave)</span>
<span id="cb375-1969"><a href="#cb375-1969" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb375-1970"><a href="#cb375-1970" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1971"><a href="#cb375-1971" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary</span></span>
<span id="cb375-1972"><a href="#cb375-1972" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Sample size:"</span>, n, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-1973"><a href="#cb375-1973" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Number of predictors:"</span>, <span class="dv">8</span>, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-1974"><a href="#cb375-1974" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Turnover rate:"</span>, <span class="fu">mean</span>(employee_data<span class="sc">$</span>left), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-1975"><a href="#cb375-1975" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"p/n ratio:"</span>, <span class="fu">round</span>(<span class="dv">8</span><span class="sc">/</span><span class="dv">60</span>, <span class="dv">3</span>), <span class="st">"(approaching danger zone of 0.1-0.2)</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb375-1976"><a href="#cb375-1976" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1977"><a href="#cb375-1977" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for multicollinearity</span></span>
<span id="cb375-1978"><a href="#cb375-1978" aria-hidden="true" tabindex="-1"></a>cor_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(employee_data[, <span class="dv">2</span><span class="sc">:</span><span class="dv">9</span>])</span>
<span id="cb375-1979"><a href="#cb375-1979" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Correlation matrix (check for |r| &gt; 0.7):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-1980"><a href="#cb375-1980" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(cor_matrix, <span class="dv">2</span>))</span>
<span id="cb375-1981"><a href="#cb375-1981" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-1982"><a href="#cb375-1982" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1983"><a href="#cb375-1983" aria-hidden="true" tabindex="-1"></a>**Interpretation**: With p/n = 0.13 and some moderate correlations, regularization helps prevent overfitting. Standard logistic regression would estimate 8 coefficients from 60 observations, risking unstable estimates.</span>
<span id="cb375-1984"><a href="#cb375-1984" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1985"><a href="#cb375-1985" aria-hidden="true" tabindex="-1"></a>**Step 2: Prepare Data for glmnet**</span>
<span id="cb375-1986"><a href="#cb375-1986" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1989"><a href="#cb375-1989" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb375-1990"><a href="#cb375-1990" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: part-c-lab-5-2-2</span></span>
<span id="cb375-1991"><a href="#cb375-1991" aria-hidden="true" tabindex="-1"></a><span class="co"># glmnet requires matrix format (not data.frame)</span></span>
<span id="cb375-1992"><a href="#cb375-1992" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(employee_data[, <span class="dv">2</span><span class="sc">:</span><span class="dv">9</span>])  <span class="co"># Predictors</span></span>
<span id="cb375-1993"><a href="#cb375-1993" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> employee_data<span class="sc">$</span>left  <span class="co"># Outcome</span></span>
<span id="cb375-1994"><a href="#cb375-1994" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1995"><a href="#cb375-1995" aria-hidden="true" tabindex="-1"></a><span class="co"># Check dimensions</span></span>
<span id="cb375-1996"><a href="#cb375-1996" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Predictor matrix X:"</span>, <span class="fu">nrow</span>(X), <span class="st">"rows Ã—"</span>, <span class="fu">ncol</span>(X), <span class="st">"columns</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-1997"><a href="#cb375-1997" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Outcome vector y:"</span>, <span class="fu">length</span>(y), <span class="st">"observations</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-1998"><a href="#cb375-1998" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Outcome distribution:"</span>, <span class="fu">table</span>(y), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-1999"><a href="#cb375-1999" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-2000"><a href="#cb375-2000" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2001"><a href="#cb375-2001" aria-hidden="true" tabindex="-1"></a>**Step 3: Fit Ridge Regression (alpha = 0)**</span>
<span id="cb375-2002"><a href="#cb375-2002" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2003"><a href="#cb375-2003" aria-hidden="true" tabindex="-1"></a>Ridge regression applies L2 penalty: minimizes âˆ‘(residualÂ²) + Î»âˆ‘(Î²Â²).  </span>
<span id="cb375-2004"><a href="#cb375-2004" aria-hidden="true" tabindex="-1"></a>All coefficients shrink toward zero but none become exactly zero.</span>
<span id="cb375-2005"><a href="#cb375-2005" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2008"><a href="#cb375-2008" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb375-2009"><a href="#cb375-2009" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: part-c-lab-5-2-3</span></span>
<span id="cb375-2010"><a href="#cb375-2010" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit ridge regression with cross-validation to find optimal Î»</span></span>
<span id="cb375-2011"><a href="#cb375-2011" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb375-2012"><a href="#cb375-2012" aria-hidden="true" tabindex="-1"></a><span class="co"># Use 5 folds to ensure each fold has both classes</span></span>
<span id="cb375-2013"><a href="#cb375-2013" aria-hidden="true" tabindex="-1"></a>ridge_cv <span class="ot">&lt;-</span> <span class="fu">cv.glmnet</span>(</span>
<span id="cb375-2014"><a href="#cb375-2014" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> X,</span>
<span id="cb375-2015"><a href="#cb375-2015" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> y,</span>
<span id="cb375-2016"><a href="#cb375-2016" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">"binomial"</span>,</span>
<span id="cb375-2017"><a href="#cb375-2017" aria-hidden="true" tabindex="-1"></a>  <span class="at">alpha =</span> <span class="dv">0</span>,  <span class="co"># alpha = 0 â†’ ridge</span></span>
<span id="cb375-2018"><a href="#cb375-2018" aria-hidden="true" tabindex="-1"></a>  <span class="at">nfolds =</span> <span class="dv">5</span>,  <span class="co"># Fewer folds for small sample with binary outcome</span></span>
<span id="cb375-2019"><a href="#cb375-2019" aria-hidden="true" tabindex="-1"></a>  <span class="at">type.measure =</span> <span class="st">"deviance"</span>  <span class="co"># Use deviance for classification</span></span>
<span id="cb375-2020"><a href="#cb375-2020" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb375-2021"><a href="#cb375-2021" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2022"><a href="#cb375-2022" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot cross-validation results</span></span>
<span id="cb375-2023"><a href="#cb375-2023" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ridge_cv, <span class="at">main =</span> <span class="st">"Ridge Regression: Cross-Validation"</span>)</span>
<span id="cb375-2024"><a href="#cb375-2024" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">log</span>(ridge_cv<span class="sc">$</span>lambda.min), <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb375-2025"><a href="#cb375-2025" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">log</span>(ridge_cv<span class="sc">$</span>lambda<span class="fl">.1</span>se), <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb375-2026"><a href="#cb375-2026" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Î»_min"</span>, <span class="st">"Î»_1se"</span>), </span>
<span id="cb375-2027"><a href="#cb375-2027" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>), <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">cex =</span> <span class="fl">0.8</span>)</span>
<span id="cb375-2028"><a href="#cb375-2028" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2029"><a href="#cb375-2029" aria-hidden="true" tabindex="-1"></a><span class="co"># Optimal lambda</span></span>
<span id="cb375-2030"><a href="#cb375-2030" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Optimal Î» (minimum CV error):"</span>, <span class="fu">round</span>(ridge_cv<span class="sc">$</span>lambda.min, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-2031"><a href="#cb375-2031" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Conservative Î» (1 SE rule):"</span>, <span class="fu">round</span>(ridge_cv<span class="sc">$</span>lambda<span class="fl">.1</span>se, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-2032"><a href="#cb375-2032" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2033"><a href="#cb375-2033" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficients at optimal lambda</span></span>
<span id="cb375-2034"><a href="#cb375-2034" aria-hidden="true" tabindex="-1"></a>ridge_coef <span class="ot">&lt;-</span> <span class="fu">coef</span>(ridge_cv, <span class="at">s =</span> <span class="st">"lambda.1se"</span>)</span>
<span id="cb375-2035"><a href="#cb375-2035" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Ridge coefficients (at Î»_1se):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-2036"><a href="#cb375-2036" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(ridge_coef)</span>
<span id="cb375-2037"><a href="#cb375-2037" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-2038"><a href="#cb375-2038" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2039"><a href="#cb375-2039" aria-hidden="true" tabindex="-1"></a>**Interpretation**: </span>
<span id="cb375-2040"><a href="#cb375-2040" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Î»_min**: Lambda that minimizes CV error (may overfit slightly)</span>
<span id="cb375-2041"><a href="#cb375-2041" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Î»_1se**: Lambda within 1 SE of minimum (more conservative, preferred)</span>
<span id="cb375-2042"><a href="#cb375-2042" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Ridge shrinks all coefficients but keeps all 8 predictors in the model</span>
<span id="cb375-2043"><a href="#cb375-2043" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Coefficients on standardized scale (larger |Î²| = stronger effect)</span>
<span id="cb375-2044"><a href="#cb375-2044" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2045"><a href="#cb375-2045" aria-hidden="true" tabindex="-1"></a>**Step 4: Fit Lasso Regression (alpha = 1)**</span>
<span id="cb375-2046"><a href="#cb375-2046" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2047"><a href="#cb375-2047" aria-hidden="true" tabindex="-1"></a>Lasso applies L1 penalty: minimizes âˆ‘(residualÂ²) + Î»âˆ‘|Î²|.  </span>
<span id="cb375-2048"><a href="#cb375-2048" aria-hidden="true" tabindex="-1"></a>Can shrink coefficients to exactly zero â†’ automatic variable selection.</span>
<span id="cb375-2049"><a href="#cb375-2049" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2052"><a href="#cb375-2052" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb375-2053"><a href="#cb375-2053" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: part-c-lab-5-2-4</span></span>
<span id="cb375-2054"><a href="#cb375-2054" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit lasso with cross-validation</span></span>
<span id="cb375-2055"><a href="#cb375-2055" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb375-2056"><a href="#cb375-2056" aria-hidden="true" tabindex="-1"></a>lasso_cv <span class="ot">&lt;-</span> <span class="fu">cv.glmnet</span>(</span>
<span id="cb375-2057"><a href="#cb375-2057" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> X,</span>
<span id="cb375-2058"><a href="#cb375-2058" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> y,</span>
<span id="cb375-2059"><a href="#cb375-2059" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">"binomial"</span>,</span>
<span id="cb375-2060"><a href="#cb375-2060" aria-hidden="true" tabindex="-1"></a>  <span class="at">alpha =</span> <span class="dv">1</span>,  <span class="co"># alpha = 1 â†’ lasso</span></span>
<span id="cb375-2061"><a href="#cb375-2061" aria-hidden="true" tabindex="-1"></a>  <span class="at">nfolds =</span> <span class="dv">5</span>,  <span class="co"># Fewer folds for small sample</span></span>
<span id="cb375-2062"><a href="#cb375-2062" aria-hidden="true" tabindex="-1"></a>  <span class="at">type.measure =</span> <span class="st">"deviance"</span></span>
<span id="cb375-2063"><a href="#cb375-2063" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb375-2064"><a href="#cb375-2064" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2065"><a href="#cb375-2065" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot cross-validation</span></span>
<span id="cb375-2066"><a href="#cb375-2066" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lasso_cv, <span class="at">main =</span> <span class="st">"Lasso Regression: Cross-Validation"</span>)</span>
<span id="cb375-2067"><a href="#cb375-2067" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">log</span>(lasso_cv<span class="sc">$</span>lambda.min), <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb375-2068"><a href="#cb375-2068" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">log</span>(lasso_cv<span class="sc">$</span>lambda<span class="fl">.1</span>se), <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb375-2069"><a href="#cb375-2069" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2070"><a href="#cb375-2070" aria-hidden="true" tabindex="-1"></a><span class="co"># Optimal lambda</span></span>
<span id="cb375-2071"><a href="#cb375-2071" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Optimal Î» (minimum CV error):"</span>, <span class="fu">round</span>(lasso_cv<span class="sc">$</span>lambda.min, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-2072"><a href="#cb375-2072" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Conservative Î» (1 SE rule):"</span>, <span class="fu">round</span>(lasso_cv<span class="sc">$</span>lambda<span class="fl">.1</span>se, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-2073"><a href="#cb375-2073" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2074"><a href="#cb375-2074" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficients at optimal lambda</span></span>
<span id="cb375-2075"><a href="#cb375-2075" aria-hidden="true" tabindex="-1"></a>lasso_coef <span class="ot">&lt;-</span> <span class="fu">coef</span>(lasso_cv, <span class="at">s =</span> <span class="st">"lambda.1se"</span>)</span>
<span id="cb375-2076"><a href="#cb375-2076" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Lasso coefficients (at Î»_1se):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-2077"><a href="#cb375-2077" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(lasso_coef)</span>
<span id="cb375-2078"><a href="#cb375-2078" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2079"><a href="#cb375-2079" aria-hidden="true" tabindex="-1"></a><span class="co"># Count non-zero coefficients</span></span>
<span id="cb375-2080"><a href="#cb375-2080" aria-hidden="true" tabindex="-1"></a>n_selected <span class="ot">&lt;-</span> <span class="fu">sum</span>(lasso_coef[<span class="sc">-</span><span class="dv">1</span>] <span class="sc">!=</span> <span class="dv">0</span>)  <span class="co"># Exclude intercept</span></span>
<span id="cb375-2081"><a href="#cb375-2081" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Variables selected:"</span>, n_selected, <span class="st">"out of 8</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-2082"><a href="#cb375-2082" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-2083"><a href="#cb375-2083" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2084"><a href="#cb375-2084" aria-hidden="true" tabindex="-1"></a>**Interpretation**:</span>
<span id="cb375-2085"><a href="#cb375-2085" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Lasso performs automatic variable selection</span>
<span id="cb375-2086"><a href="#cb375-2086" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>At Î»_1se, some coefficients are exactly 0 (excluded from model)</span>
<span id="cb375-2087"><a href="#cb375-2087" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Simplifies model: easier to interpret and less prone to overfitting</span>
<span id="cb375-2088"><a href="#cb375-2088" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Variables with Î² = 0 are deemed unimportant after controlling for others</span>
<span id="cb375-2089"><a href="#cb375-2089" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2090"><a href="#cb375-2090" aria-hidden="true" tabindex="-1"></a>**Step 5: Fit Elastic Net (alpha = 0.5)**</span>
<span id="cb375-2091"><a href="#cb375-2091" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2092"><a href="#cb375-2092" aria-hidden="true" tabindex="-1"></a>Elastic net combines ridge + lasso: penalty = (1-Î±)âˆ‘Î²Â² + Î±âˆ‘|Î²|.  </span>
<span id="cb375-2093"><a href="#cb375-2093" aria-hidden="true" tabindex="-1"></a>With Î± = 0.5, equally weights L1 and L2 penalties.</span>
<span id="cb375-2094"><a href="#cb375-2094" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2097"><a href="#cb375-2097" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb375-2098"><a href="#cb375-2098" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: part-c-lab-5-2-5</span></span>
<span id="cb375-2099"><a href="#cb375-2099" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit elastic net</span></span>
<span id="cb375-2100"><a href="#cb375-2100" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb375-2101"><a href="#cb375-2101" aria-hidden="true" tabindex="-1"></a>enet_cv <span class="ot">&lt;-</span> <span class="fu">cv.glmnet</span>(</span>
<span id="cb375-2102"><a href="#cb375-2102" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> X,</span>
<span id="cb375-2103"><a href="#cb375-2103" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> y,</span>
<span id="cb375-2104"><a href="#cb375-2104" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">"binomial"</span>,</span>
<span id="cb375-2105"><a href="#cb375-2105" aria-hidden="true" tabindex="-1"></a>  <span class="at">alpha =</span> <span class="fl">0.5</span>,  <span class="co"># alpha = 0.5 â†’ elastic net (50% ridge + 50% lasso)</span></span>
<span id="cb375-2106"><a href="#cb375-2106" aria-hidden="true" tabindex="-1"></a>  <span class="at">nfolds =</span> <span class="dv">5</span>,  <span class="co"># Fewer folds for small sample</span></span>
<span id="cb375-2107"><a href="#cb375-2107" aria-hidden="true" tabindex="-1"></a>  <span class="at">type.measure =</span> <span class="st">"deviance"</span></span>
<span id="cb375-2108"><a href="#cb375-2108" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb375-2109"><a href="#cb375-2109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2110"><a href="#cb375-2110" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot cross-validation</span></span>
<span id="cb375-2111"><a href="#cb375-2111" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(enet_cv, <span class="at">main =</span> <span class="st">"Elastic Net: Cross-Validation"</span>)</span>
<span id="cb375-2112"><a href="#cb375-2112" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">log</span>(enet_cv<span class="sc">$</span>lambda.min), <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb375-2113"><a href="#cb375-2113" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">log</span>(enet_cv<span class="sc">$</span>lambda<span class="fl">.1</span>se), <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb375-2114"><a href="#cb375-2114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2115"><a href="#cb375-2115" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficients</span></span>
<span id="cb375-2116"><a href="#cb375-2116" aria-hidden="true" tabindex="-1"></a>enet_coef <span class="ot">&lt;-</span> <span class="fu">coef</span>(enet_cv, <span class="at">s =</span> <span class="st">"lambda.1se"</span>)</span>
<span id="cb375-2117"><a href="#cb375-2117" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Elastic Net coefficients (at Î»_1se):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-2118"><a href="#cb375-2118" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(enet_coef)</span>
<span id="cb375-2119"><a href="#cb375-2119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2120"><a href="#cb375-2120" aria-hidden="true" tabindex="-1"></a><span class="co"># Count non-zero</span></span>
<span id="cb375-2121"><a href="#cb375-2121" aria-hidden="true" tabindex="-1"></a>n_selected_enet <span class="ot">&lt;-</span> <span class="fu">sum</span>(enet_coef[<span class="sc">-</span><span class="dv">1</span>] <span class="sc">!=</span> <span class="dv">0</span>)</span>
<span id="cb375-2122"><a href="#cb375-2122" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Variables selected:"</span>, n_selected_enet, <span class="st">"out of 8</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-2123"><a href="#cb375-2123" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-2124"><a href="#cb375-2124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2125"><a href="#cb375-2125" aria-hidden="true" tabindex="-1"></a>**Step 6: Compare All Three Methods**</span>
<span id="cb375-2126"><a href="#cb375-2126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2129"><a href="#cb375-2129" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb375-2130"><a href="#cb375-2130" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: part-c-lab-5-2-6</span></span>
<span id="cb375-2131"><a href="#cb375-2131" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract coefficients from all models</span></span>
<span id="cb375-2132"><a href="#cb375-2132" aria-hidden="true" tabindex="-1"></a>comparison <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb375-2133"><a href="#cb375-2133" aria-hidden="true" tabindex="-1"></a>  <span class="at">Variable =</span> <span class="fu">rownames</span>(ridge_coef)[<span class="sc">-</span><span class="dv">1</span>],  <span class="co"># Exclude intercept</span></span>
<span id="cb375-2134"><a href="#cb375-2134" aria-hidden="true" tabindex="-1"></a>  <span class="at">Ridge =</span> <span class="fu">as.numeric</span>(ridge_coef[<span class="sc">-</span><span class="dv">1</span>]),</span>
<span id="cb375-2135"><a href="#cb375-2135" aria-hidden="true" tabindex="-1"></a>  <span class="at">Lasso =</span> <span class="fu">as.numeric</span>(lasso_coef[<span class="sc">-</span><span class="dv">1</span>]),</span>
<span id="cb375-2136"><a href="#cb375-2136" aria-hidden="true" tabindex="-1"></a>  <span class="at">ElasticNet =</span> <span class="fu">as.numeric</span>(enet_coef[<span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb375-2137"><a href="#cb375-2137" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb375-2138"><a href="#cb375-2138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2139"><a href="#cb375-2139" aria-hidden="true" tabindex="-1"></a><span class="co"># Round for readability</span></span>
<span id="cb375-2140"><a href="#cb375-2140" aria-hidden="true" tabindex="-1"></a>comparison[, <span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="fu">round</span>(comparison[, <span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>], <span class="dv">3</span>)</span>
<span id="cb375-2141"><a href="#cb375-2141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2142"><a href="#cb375-2142" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Coefficient Comparison (at Î»_1se):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-2143"><a href="#cb375-2143" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(comparison)</span>
<span id="cb375-2144"><a href="#cb375-2144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2145"><a href="#cb375-2145" aria-hidden="true" tabindex="-1"></a><span class="co"># Visual comparison</span></span>
<span id="cb375-2146"><a href="#cb375-2146" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb375-2147"><a href="#cb375-2147" aria-hidden="true" tabindex="-1"></a>comparison_long <span class="ot">&lt;-</span> comparison <span class="sc">%&gt;%</span></span>
<span id="cb375-2148"><a href="#cb375-2148" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(Ridge, Lasso, ElasticNet),</span>
<span id="cb375-2149"><a href="#cb375-2149" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"Method"</span>,</span>
<span id="cb375-2150"><a href="#cb375-2150" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"Coefficient"</span>)</span>
<span id="cb375-2151"><a href="#cb375-2151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2152"><a href="#cb375-2152" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb375-2153"><a href="#cb375-2153" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(comparison_long, <span class="fu">aes</span>(<span class="at">x =</span> Variable, <span class="at">y =</span> Coefficient, <span class="at">fill =</span> Method)) <span class="sc">+</span></span>
<span id="cb375-2154"><a href="#cb375-2154" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb375-2155"><a href="#cb375-2155" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb375-2156"><a href="#cb375-2156" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb375-2157"><a href="#cb375-2157" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Regularized Regression Comparison"</span>,</span>
<span id="cb375-2158"><a href="#cb375-2158" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Ridge keeps all variables; Lasso/Elastic Net select subset"</span>,</span>
<span id="cb375-2159"><a href="#cb375-2159" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Predictor"</span>,</span>
<span id="cb375-2160"><a href="#cb375-2160" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Standardized Coefficient"</span></span>
<span id="cb375-2161"><a href="#cb375-2161" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb375-2162"><a href="#cb375-2162" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb375-2163"><a href="#cb375-2163" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>)</span>
<span id="cb375-2164"><a href="#cb375-2164" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-2165"><a href="#cb375-2165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2166"><a href="#cb375-2166" aria-hidden="true" tabindex="-1"></a>**Step 7: Model Performance Comparison**</span>
<span id="cb375-2167"><a href="#cb375-2167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2170"><a href="#cb375-2170" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb375-2171"><a href="#cb375-2171" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: part-c-lab-5-2-7</span></span>
<span id="cb375-2172"><a href="#cb375-2172" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict probabilities using optimal models</span></span>
<span id="cb375-2173"><a href="#cb375-2173" aria-hidden="true" tabindex="-1"></a>ridge_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(ridge_cv, <span class="at">newx =</span> X, <span class="at">s =</span> <span class="st">"lambda.1se"</span>, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb375-2174"><a href="#cb375-2174" aria-hidden="true" tabindex="-1"></a>lasso_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(lasso_cv, <span class="at">newx =</span> X, <span class="at">s =</span> <span class="st">"lambda.1se"</span>, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb375-2175"><a href="#cb375-2175" aria-hidden="true" tabindex="-1"></a>enet_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(enet_cv, <span class="at">newx =</span> X, <span class="at">s =</span> <span class="st">"lambda.1se"</span>, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb375-2176"><a href="#cb375-2176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2177"><a href="#cb375-2177" aria-hidden="true" tabindex="-1"></a><span class="co"># Classification accuracy (using 0.5 threshold)</span></span>
<span id="cb375-2178"><a href="#cb375-2178" aria-hidden="true" tabindex="-1"></a>ridge_class <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(ridge_pred <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb375-2179"><a href="#cb375-2179" aria-hidden="true" tabindex="-1"></a>lasso_class <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(lasso_pred <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb375-2180"><a href="#cb375-2180" aria-hidden="true" tabindex="-1"></a>enet_class <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(enet_pred <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb375-2181"><a href="#cb375-2181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2182"><a href="#cb375-2182" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Classification Accuracy (in-sample):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-2183"><a href="#cb375-2183" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Ridge:"</span>, <span class="fu">mean</span>(ridge_class <span class="sc">==</span> y), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-2184"><a href="#cb375-2184" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Lasso:"</span>, <span class="fu">mean</span>(lasso_class <span class="sc">==</span> y), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-2185"><a href="#cb375-2185" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Elastic Net:"</span>, <span class="fu">mean</span>(enet_class <span class="sc">==</span> y), <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb375-2186"><a href="#cb375-2186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2187"><a href="#cb375-2187" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Cross-Validation Deviance (lower = better):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-2188"><a href="#cb375-2188" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Ridge:"</span>, <span class="fu">round</span>(<span class="fu">min</span>(ridge_cv<span class="sc">$</span>cvm), <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-2189"><a href="#cb375-2189" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Lasso:"</span>, <span class="fu">round</span>(<span class="fu">min</span>(lasso_cv<span class="sc">$</span>cvm), <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-2190"><a href="#cb375-2190" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Elastic Net:"</span>, <span class="fu">round</span>(<span class="fu">min</span>(enet_cv<span class="sc">$</span>cvm), <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-2191"><a href="#cb375-2191" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-2192"><a href="#cb375-2192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2193"><a href="#cb375-2193" aria-hidden="true" tabindex="-1"></a>**Step 8: Interpretation for Stakeholders**</span>
<span id="cb375-2194"><a href="#cb375-2194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2197"><a href="#cb375-2197" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb375-2198"><a href="#cb375-2198" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: part-c-lab-5-2-8</span></span>
<span id="cb375-2199"><a href="#cb375-2199" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify top predictors from Lasso (non-zero coefficients)</span></span>
<span id="cb375-2200"><a href="#cb375-2200" aria-hidden="true" tabindex="-1"></a>top_predictors <span class="ot">&lt;-</span> comparison <span class="sc">%&gt;%</span></span>
<span id="cb375-2201"><a href="#cb375-2201" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Lasso <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb375-2202"><a href="#cb375-2202" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(<span class="fu">abs</span>(Lasso)))</span>
<span id="cb375-2203"><a href="#cb375-2203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2204"><a href="#cb375-2204" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== KEY FINDINGS FOR TURNOVER PREDICTION ===</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb375-2205"><a href="#cb375-2205" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Top predictors of turnover (Lasso selection):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-2206"><a href="#cb375-2206" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(top_predictors)</span>
<span id="cb375-2207"><a href="#cb375-2207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2208"><a href="#cb375-2208" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Interpretation:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-2209"><a href="#cb375-2209" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">nrow</span>(top_predictors) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb375-2210"><a href="#cb375-2210" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"- Negative coefficients â†’ Higher values reduce turnover risk</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-2211"><a href="#cb375-2211" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"- Positive coefficients â†’ Higher values increase turnover risk</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-2212"><a href="#cb375-2212" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"- Variables with Î² = 0 were excluded (not predictive after controlling for others)</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-2213"><a href="#cb375-2213" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb375-2214"><a href="#cb375-2214" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-2215"><a href="#cb375-2215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2216"><a href="#cb375-2216" aria-hidden="true" tabindex="-1"></a>**Discussion Questions**:</span>
<span id="cb375-2217"><a href="#cb375-2217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2218"><a href="#cb375-2218" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**When should you use regularization vs. Firth regression?**</span>
<span id="cb375-2219"><a href="#cb375-2219" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Firth: Binary outcome with separation, small n (&lt; 50)</span>
<span id="cb375-2220"><a href="#cb375-2220" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Regularization: Multiple predictors, p/n &gt; 0.1, multicollinearity, n = 50-100</span>
<span id="cb375-2221"><a href="#cb375-2221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2222"><a href="#cb375-2222" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**How do you choose between Ridge, Lasso, and Elastic Net?**</span>
<span id="cb375-2223"><a href="#cb375-2223" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Ridge: Keep all predictors, just shrink coefficients (interpretability less important)</span>
<span id="cb375-2224"><a href="#cb375-2224" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Lasso: Want automatic variable selection, sparse models</span>
<span id="cb375-2225"><a href="#cb375-2225" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Elastic Net: Correlated predictors + selection (best of both worlds)</span>
<span id="cb375-2226"><a href="#cb375-2226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2227"><a href="#cb375-2227" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**What does Î» control?**</span>
<span id="cb375-2228"><a href="#cb375-2228" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Î» = 0: No penalty (standard logistic regression, may overfit)</span>
<span id="cb375-2229"><a href="#cb375-2229" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Î» = âˆž: All Î² â†’ 0 (underfits, intercept-only model)</span>
<span id="cb375-2230"><a href="#cb375-2230" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Optimal Î»: Balance bias-variance via cross-validation</span>
<span id="cb375-2231"><a href="#cb375-2231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2232"><a href="#cb375-2232" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**How do you report regularized regression results?**</span>
<span id="cb375-2233"><a href="#cb375-2233" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>State method (ridge/lasso/elastic net), Î± value, cross-validation procedure</span>
<span id="cb375-2234"><a href="#cb375-2234" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Report optimal Î» (Î»_min or Î»_1se)</span>
<span id="cb375-2235"><a href="#cb375-2235" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Report which variables were selected (lasso/elastic net)</span>
<span id="cb375-2236"><a href="#cb375-2236" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Report coefficients and interpret direction/magnitude</span>
<span id="cb375-2237"><a href="#cb375-2237" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Acknowledge: coefficients are biased toward zero (shrinkage), but predictions are often better</span>
<span id="cb375-2238"><a href="#cb375-2238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2239"><a href="#cb375-2239" aria-hidden="true" tabindex="-1"></a>**Key Takeaways**:</span>
<span id="cb375-2240"><a href="#cb375-2240" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Regularization prevents overfitting when p/n ratio is high (&gt; 0.1)</span>
<span id="cb375-2241"><a href="#cb375-2241" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Cross-validation selects optimal penalty strength automatically</span>
<span id="cb375-2242"><a href="#cb375-2242" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Lasso provides interpretable models via automatic variable selection</span>
<span id="cb375-2243"><a href="#cb375-2243" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Elastic net combines strengths of ridge and lasso</span>
<span id="cb375-2244"><a href="#cb375-2244" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Regularized models sacrifice unbiasedness for better prediction accuracy</span>
<span id="cb375-2245"><a href="#cb375-2245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2246"><a href="#cb375-2246" aria-hidden="true" tabindex="-1"></a>**Extension**: </span>
<span id="cb375-2247"><a href="#cb375-2247" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Try different Î± values (0, 0.25, 0.5, 0.75, 1) to see how variable selection changes</span>
<span id="cb375-2248"><a href="#cb375-2248" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Split data into train (70%) and test (30%) to assess out-of-sample performance</span>
<span id="cb375-2249"><a href="#cb375-2249" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Use <span class="in">`glmnet`</span>'s built-in <span class="in">`predict()`</span> function with <span class="in">`type = "class"`</span> for classification</span>
<span id="cb375-2250"><a href="#cb375-2250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2251"><a href="#cb375-2251" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-2252"><a href="#cb375-2252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2253"><a href="#cb375-2253" aria-hidden="true" tabindex="-1"></a><span class="fu">### Self-Assessment Quiz</span></span>
<span id="cb375-2254"><a href="#cb375-2254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2255"><a href="#cb375-2255" aria-hidden="true" tabindex="-1"></a>Test your understanding of penalized and Bayesian regression methods from Chapter 5. Answers and explanations are provided at the end.</span>
<span id="cb375-2256"><a href="#cb375-2256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2257"><a href="#cb375-2257" aria-hidden="true" tabindex="-1"></a>::: {.callout-note icon=false}</span>
<span id="cb375-2258"><a href="#cb375-2258" aria-hidden="true" tabindex="-1"></a><span class="fu">## Questions</span></span>
<span id="cb375-2259"><a href="#cb375-2259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2260"><a href="#cb375-2260" aria-hidden="true" tabindex="-1"></a>**Q1.** Firth's penalized logistic regression is necessary when:</span>
<span id="cb375-2261"><a href="#cb375-2261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2262"><a href="#cb375-2262" aria-hidden="true" tabindex="-1"></a>A. Sample size exceeds 1,000  </span>
<span id="cb375-2263"><a href="#cb375-2263" aria-hidden="true" tabindex="-1"></a>B. Complete or quasi-complete separation occurs in standard logistic regression  </span>
<span id="cb375-2264"><a href="#cb375-2264" aria-hidden="true" tabindex="-1"></a>C. The outcome is continuous  </span>
<span id="cb375-2265"><a href="#cb375-2265" aria-hidden="true" tabindex="-1"></a>D. There are no missing data</span>
<span id="cb375-2266"><a href="#cb375-2266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2267"><a href="#cb375-2267" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-2268"><a href="#cb375-2268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2269"><a href="#cb375-2269" aria-hidden="true" tabindex="-1"></a>**Q2.** What is the "separation problem" in logistic regression?</span>
<span id="cb375-2270"><a href="#cb375-2270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2271"><a href="#cb375-2271" aria-hidden="true" tabindex="-1"></a>A. Predictors are uncorrelated  </span>
<span id="cb375-2272"><a href="#cb375-2272" aria-hidden="true" tabindex="-1"></a>B. A predictor perfectly predicts the outcome, causing infinite coefficient estimates  </span>
<span id="cb375-2273"><a href="#cb375-2273" aria-hidden="true" tabindex="-1"></a>C. Sample size is too large  </span>
<span id="cb375-2274"><a href="#cb375-2274" aria-hidden="true" tabindex="-1"></a>D. The outcome has only one level</span>
<span id="cb375-2275"><a href="#cb375-2275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2276"><a href="#cb375-2276" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-2277"><a href="#cb375-2277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2278"><a href="#cb375-2278" aria-hidden="true" tabindex="-1"></a>**Q3.** In Bayesian regression, a "weakly informative prior" means:</span>
<span id="cb375-2279"><a href="#cb375-2279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2280"><a href="#cb375-2280" aria-hidden="true" tabindex="-1"></a>A. Strong beliefs based on previous research  </span>
<span id="cb375-2281"><a href="#cb375-2281" aria-hidden="true" tabindex="-1"></a>B. Priors that gently regularize estimates without imposing strong constraints  </span>
<span id="cb375-2282"><a href="#cb375-2282" aria-hidden="true" tabindex="-1"></a>C. Flat, non-informative priors  </span>
<span id="cb375-2283"><a href="#cb375-2283" aria-hidden="true" tabindex="-1"></a>D. Priors are not used</span>
<span id="cb375-2284"><a href="#cb375-2284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2285"><a href="#cb375-2285" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-2286"><a href="#cb375-2286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2287"><a href="#cb375-2287" aria-hidden="true" tabindex="-1"></a>**Q4.** Why are Bayesian methods well-suited to small samples?</span>
<span id="cb375-2288"><a href="#cb375-2288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2289"><a href="#cb375-2289" aria-hidden="true" tabindex="-1"></a>A. They automatically increase sample size  </span>
<span id="cb375-2290"><a href="#cb375-2290" aria-hidden="true" tabindex="-1"></a>B. Priors stabilize estimates and quantify uncertainty through posterior distributions  </span>
<span id="cb375-2291"><a href="#cb375-2291" aria-hidden="true" tabindex="-1"></a>C. They eliminate the need for assumptions  </span>
<span id="cb375-2292"><a href="#cb375-2292" aria-hidden="true" tabindex="-1"></a>D. They always produce significant results</span>
<span id="cb375-2293"><a href="#cb375-2293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2294"><a href="#cb375-2294" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-2295"><a href="#cb375-2295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2296"><a href="#cb375-2296" aria-hidden="true" tabindex="-1"></a>**Q5.** What does MCMC stand for, and why is it used in Bayesian regression?</span>
<span id="cb375-2297"><a href="#cb375-2297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2298"><a href="#cb375-2298" aria-hidden="true" tabindex="-1"></a>A. Maximum Correlation for Model Comparison; used for variable selection  </span>
<span id="cb375-2299"><a href="#cb375-2299" aria-hidden="true" tabindex="-1"></a>B. Markov Chain Monte Carlo; used to sample from posterior distributions  </span>
<span id="cb375-2300"><a href="#cb375-2300" aria-hidden="true" tabindex="-1"></a>C. Minimum Covariance Model Checking; used for diagnostics  </span>
<span id="cb375-2301"><a href="#cb375-2301" aria-hidden="true" tabindex="-1"></a>D. Multiple Comparison Correction; used to adjust p-values</span>
<span id="cb375-2302"><a href="#cb375-2302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2303"><a href="#cb375-2303" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-2304"><a href="#cb375-2304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2305"><a href="#cb375-2305" aria-hidden="true" tabindex="-1"></a>**Q6.** R-hat (RÌ‚) is a diagnostic for Bayesian models. What does RÌ‚ &gt; 1.1 indicate?</span>
<span id="cb375-2306"><a href="#cb375-2306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2307"><a href="#cb375-2307" aria-hidden="true" tabindex="-1"></a>A. Perfect convergence  </span>
<span id="cb375-2308"><a href="#cb375-2308" aria-hidden="true" tabindex="-1"></a>B. Chains have not converged; more iterations or different initialization needed  </span>
<span id="cb375-2309"><a href="#cb375-2309" aria-hidden="true" tabindex="-1"></a>C. The model fits well  </span>
<span id="cb375-2310"><a href="#cb375-2310" aria-hidden="true" tabindex="-1"></a>D. Sample size is too large</span>
<span id="cb375-2311"><a href="#cb375-2311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2312"><a href="#cb375-2312" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-2313"><a href="#cb375-2313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2314"><a href="#cb375-2314" aria-hidden="true" tabindex="-1"></a>**Q7.** Posterior predictive checks assess:</span>
<span id="cb375-2315"><a href="#cb375-2315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2316"><a href="#cb375-2316" aria-hidden="true" tabindex="-1"></a>A. Whether priors are reasonable  </span>
<span id="cb375-2317"><a href="#cb375-2317" aria-hidden="true" tabindex="-1"></a>B. Whether simulated data from the fitted model resemble observed data  </span>
<span id="cb375-2318"><a href="#cb375-2318" aria-hidden="true" tabindex="-1"></a>C. Whether R-hat &lt; 1.01  </span>
<span id="cb375-2319"><a href="#cb375-2319" aria-hidden="true" tabindex="-1"></a>D. Statistical power</span>
<span id="cb375-2320"><a href="#cb375-2320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2321"><a href="#cb375-2321" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-2322"><a href="#cb375-2322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2323"><a href="#cb375-2323" aria-hidden="true" tabindex="-1"></a>**Q8.** LOOIC (Leave-One-Out Information Criterion) is used for:</span>
<span id="cb375-2324"><a href="#cb375-2324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2325"><a href="#cb375-2325" aria-hidden="true" tabindex="-1"></a>A. Hypothesis testing  </span>
<span id="cb375-2326"><a href="#cb375-2326" aria-hidden="true" tabindex="-1"></a>B. Model comparisonâ€”lower LOOIC indicates better predictive accuracy  </span>
<span id="cb375-2327"><a href="#cb375-2327" aria-hidden="true" tabindex="-1"></a>C. Diagnosing convergence  </span>
<span id="cb375-2328"><a href="#cb375-2328" aria-hidden="true" tabindex="-1"></a>D. Calculating p-values</span>
<span id="cb375-2329"><a href="#cb375-2329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2330"><a href="#cb375-2330" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-2331"><a href="#cb375-2331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2332"><a href="#cb375-2332" aria-hidden="true" tabindex="-1"></a>**Q9.** A Bayesian 95% credible interval <span class="co">[</span><span class="ot">2, 8</span><span class="co">]</span> means:</span>
<span id="cb375-2333"><a href="#cb375-2333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2334"><a href="#cb375-2334" aria-hidden="true" tabindex="-1"></a>A. There is a 95% probability the true parameter lies in <span class="co">[</span><span class="ot">2, 8</span><span class="co">]</span> given the data and prior  </span>
<span id="cb375-2335"><a href="#cb375-2335" aria-hidden="true" tabindex="-1"></a>B. 95% of future samples will have values in <span class="co">[</span><span class="ot">2, 8</span><span class="co">]</span>  </span>
<span id="cb375-2336"><a href="#cb375-2336" aria-hidden="true" tabindex="-1"></a>C. The parameter is exactly 5  </span>
<span id="cb375-2337"><a href="#cb375-2337" aria-hidden="true" tabindex="-1"></a>D. The p-value is 0.05</span>
<span id="cb375-2338"><a href="#cb375-2338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2339"><a href="#cb375-2339" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-2340"><a href="#cb375-2340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2341"><a href="#cb375-2341" aria-hidden="true" tabindex="-1"></a>**Q10.** When should you prefer Firth regression over Bayesian logistic regression?</span>
<span id="cb375-2342"><a href="#cb375-2342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2343"><a href="#cb375-2343" aria-hidden="true" tabindex="-1"></a>A. When you want probability statements about parameters  </span>
<span id="cb375-2344"><a href="#cb375-2344" aria-hidden="true" tabindex="-1"></a>B. When you need a quick, simple solution for separation without specifying priors  </span>
<span id="cb375-2345"><a href="#cb375-2345" aria-hidden="true" tabindex="-1"></a>C. Neverâ€”Bayesian is always better  </span>
<span id="cb375-2346"><a href="#cb375-2346" aria-hidden="true" tabindex="-1"></a>D. Only with n&gt;100</span>
<span id="cb375-2347"><a href="#cb375-2347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2348"><a href="#cb375-2348" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb375-2349"><a href="#cb375-2349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2350"><a href="#cb375-2350" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip icon=false collapse="true"}</span>
<span id="cb375-2351"><a href="#cb375-2351" aria-hidden="true" tabindex="-1"></a><span class="fu">## Answers and Explanations</span></span>
<span id="cb375-2352"><a href="#cb375-2352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2353"><a href="#cb375-2353" aria-hidden="true" tabindex="-1"></a>**Q1. Answer: B**  </span>
<span id="cb375-2354"><a href="#cb375-2354" aria-hidden="true" tabindex="-1"></a>*Explanation*: When a predictor perfectly or nearly perfectly separates outcomes (e.g., all treated patients survive, all untreated die), maximum likelihood diverges to infinity. Firth's method adds a penalty to shrink coefficients toward finite values. The chapter states: "Firth logistic regression is particularly useful when events are sparse (fewer than 10 events per predictor) or when separation occurs."</span>
<span id="cb375-2355"><a href="#cb375-2355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2356"><a href="#cb375-2356" aria-hidden="true" tabindex="-1"></a>**Q2. Answer: B**  </span>
<span id="cb375-2357"><a href="#cb375-2357" aria-hidden="true" tabindex="-1"></a>*Explanation*: Separation occurs when a combination of predictors perfectly classifies outcomes (e.g., all patients with predictor=1 have outcome=1). Maximum likelihood fails, yielding infinite estimates and huge standard errors. The lab practical demonstrates this with the medication adherence example showing "clear separation."</span>
<span id="cb375-2358"><a href="#cb375-2358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2359"><a href="#cb375-2359" aria-hidden="true" tabindex="-1"></a>**Q3. Answer: B**  </span>
<span id="cb375-2360"><a href="#cb375-2360" aria-hidden="true" tabindex="-1"></a>*Explanation*: Weakly informative priors (e.g., Normal(0, 2) for standardized coefficients) prevent extreme estimates without dominating the data. They improve small-sample estimation by incorporating mild regularization. The chapter describes them as priors that "gently regularise estimates without imposing strong beliefs."</span>
<span id="cb375-2361"><a href="#cb375-2361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2362"><a href="#cb375-2362" aria-hidden="true" tabindex="-1"></a>**Q4. Answer: B**  </span>
<span id="cb375-2363"><a href="#cb375-2363" aria-hidden="true" tabindex="-1"></a>*Explanation*: Bayesian methods incorporate prior information (even weak priors) to stabilize estimates when data are limited. Posterior distributions quantify uncertainty naturally, unlike frequentist CIs which can be unstable with small n. The chapter emphasizes that priors "stabilize estimates" and Bayesian methods "quantify uncertainty through posterior distributions."</span>
<span id="cb375-2364"><a href="#cb375-2364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2365"><a href="#cb375-2365" aria-hidden="true" tabindex="-1"></a>**Q5. Answer: B**  </span>
<span id="cb375-2366"><a href="#cb375-2366" aria-hidden="true" tabindex="-1"></a>*Explanation*: MCMC (Markov Chain Monte Carlo) algorithms (e.g., Hamiltonian Monte Carlo in Stan) generate samples from complex posterior distributions that cannot be computed analytically. This is the fundamental computational method underlying Bayesian inference with complex models.</span>
<span id="cb375-2367"><a href="#cb375-2367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2368"><a href="#cb375-2368" aria-hidden="true" tabindex="-1"></a>**Q6. Answer: B**  </span>
<span id="cb375-2369"><a href="#cb375-2369" aria-hidden="true" tabindex="-1"></a>*Explanation*: R-hat compares within-chain and between-chain variance. Values near 1.0 indicate convergence; values &gt;1.01 (and especially &gt;1.1) indicate chains are exploring different regions and have not mixed well. This is a standard diagnostic for assessing MCMC convergence.</span>
<span id="cb375-2370"><a href="#cb375-2370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2371"><a href="#cb375-2371" aria-hidden="true" tabindex="-1"></a>**Q7. Answer: B**  </span>
<span id="cb375-2372"><a href="#cb375-2372" aria-hidden="true" tabindex="-1"></a>*Explanation*: Posterior predictive checks (PPCs) simulate datasets from the fitted model and compare them to the actual data. If simulated data match observed patterns (distributions, means, etc.), the model fits well. The chapter describes PPCs as validating "model fit by comparing observed and simulated data."</span>
<span id="cb375-2373"><a href="#cb375-2373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2374"><a href="#cb375-2374" aria-hidden="true" tabindex="-1"></a>**Q8. Answer: B**  </span>
<span id="cb375-2375"><a href="#cb375-2375" aria-hidden="true" tabindex="-1"></a>*Explanation*: LOOIC estimates out-of-sample predictive accuracy using leave-one-out cross-validation. When comparing models, prefer the one with lower LOOIC (better prediction). The Key Takeaways state: "LOOIC facilitates model comparison, favouring models with better out-of-sample predictive accuracy."</span>
<span id="cb375-2376"><a href="#cb375-2376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2377"><a href="#cb375-2377" aria-hidden="true" tabindex="-1"></a>**Q9. Answer: A**  </span>
<span id="cb375-2378"><a href="#cb375-2378" aria-hidden="true" tabindex="-1"></a>*Explanation*: Credible intervals (Bayesian) have a direct probability interpretation: given the data and prior, there's a 95% probability the parameter is in the interval. This differs from frequentist CIs, which are about long-run coverage. This is the fundamental difference between Bayesian and frequentist interval interpretation.</span>
<span id="cb375-2379"><a href="#cb375-2379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2380"><a href="#cb375-2380" aria-hidden="true" tabindex="-1"></a>**Q10. Answer: B**  </span>
<span id="cb375-2381"><a href="#cb375-2381" aria-hidden="true" tabindex="-1"></a>*Explanation*: Firth regression is simpler (no prior specification, no MCMC convergence checks) and provides a quick fix for separation. Bayesian methods offer more flexibility and natural uncertainty quantification but require more setup. The lab practical's reflection question addresses this: "Firth: Quick, frequentist inference, handles separation automatically."</span>
<span id="cb375-2382"><a href="#cb375-2382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2383"><a href="#cb375-2383" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb375-2384"><a href="#cb375-2384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2385"><a href="#cb375-2385" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-2386"><a href="#cb375-2386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2387"><a href="#cb375-2387" aria-hidden="true" tabindex="-1"></a><span class="fu">### Key Takeaways</span></span>
<span id="cb375-2388"><a href="#cb375-2388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2389"><a href="#cb375-2389" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Firth-penalised logistic regression stabilises estimates when events are sparse or separation occurs.</span>
<span id="cb375-2390"><a href="#cb375-2390" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Bayesian regression incorporates prior information and quantifies uncertainty through posterior distributions.</span>
<span id="cb375-2391"><a href="#cb375-2391" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Weakly informative priors regularise estimates without imposing strong beliefs, improving small-sample performance.</span>
<span id="cb375-2392"><a href="#cb375-2392" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Posterior predictive checks validate model fit by comparing observed and simulated data.</span>
<span id="cb375-2393"><a href="#cb375-2393" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>LOOIC facilitates model comparison, favouring models with better out-of-sample predictive accuracy.</span>
<span id="cb375-2394"><a href="#cb375-2394" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Both penalised and Bayesian methods are well-suited to small samples and provide robust, interpretable inferences.</span>
<span id="cb375-2395"><a href="#cb375-2395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2396"><a href="#cb375-2396" aria-hidden="true" tabindex="-1"></a><span class="fu">### Smoke Test</span></span>
<span id="cb375-2397"><a href="#cb375-2397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2400"><a href="#cb375-2400" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb375-2401"><a href="#cb375-2401" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: part-c-chunk-21</span></span>
<span id="cb375-2402"><a href="#cb375-2402" aria-hidden="true" tabindex="-1"></a><span class="co"># Re-run Firth logistic regression on simple example</span></span>
<span id="cb375-2403"><a href="#cb375-2403" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(logistf)</span>
<span id="cb375-2404"><a href="#cb375-2404" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb375-2405"><a href="#cb375-2405" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">y =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>))</span>
<span id="cb375-2406"><a href="#cb375-2406" aria-hidden="true" tabindex="-1"></a><span class="fu">logistf</span>(y <span class="sc">~</span> x, <span class="at">data =</span> dat)</span>
<span id="cb375-2407"><a href="#cb375-2407" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-2408"><a href="#cb375-2408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2409"><a href="#cb375-2409" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-2410"><a href="#cb375-2410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2411"><a href="#cb375-2411" aria-hidden="true" tabindex="-1"></a><span class="fu">## Chapter 6. Reliability and Measurement Quality for Short Scales</span></span>
<span id="cb375-2412"><a href="#cb375-2412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2413"><a href="#cb375-2413" aria-hidden="true" tabindex="-1"></a><span class="fu">### Learning Objectives</span></span>
<span id="cb375-2414"><a href="#cb375-2414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2415"><a href="#cb375-2415" aria-hidden="true" tabindex="-1"></a>By the end of this chapter, you will be able to:</span>
<span id="cb375-2416"><a href="#cb375-2416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2417"><a href="#cb375-2417" aria-hidden="true" tabindex="-1"></a>**Conceptual Understanding**</span>
<span id="cb375-2418"><a href="#cb375-2418" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Explain the theoretical basis of reliability (true score theory)</span>
<span id="cb375-2419"><a href="#cb375-2419" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Understand why Cronbach's alpha is attenuated for short scales</span>
<span id="cb375-2420"><a href="#cb375-2420" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Recognize the differences between alpha, omega, and split-half reliability</span>
<span id="cb375-2421"><a href="#cb375-2421" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Distinguish reliability from validity in measurement quality</span>
<span id="cb375-2422"><a href="#cb375-2422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2423"><a href="#cb375-2423" aria-hidden="true" tabindex="-1"></a>**Practical Skills**</span>
<span id="cb375-2424"><a href="#cb375-2424" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Compute Cronbach's alpha using <span class="in">`psych::alpha()`</span> in R</span>
<span id="cb375-2425"><a href="#cb375-2425" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Calculate McDonald's omega with <span class="in">`psych::omega()`</span> for multidimensional scales</span>
<span id="cb375-2426"><a href="#cb375-2426" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Estimate split-half reliability with bootstrap confidence intervals</span>
<span id="cb375-2427"><a href="#cb375-2427" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Apply polychoric correlations for ordinal items using <span class="in">`polycor`</span> package</span>
<span id="cb375-2428"><a href="#cb375-2428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2429"><a href="#cb375-2429" aria-hidden="true" tabindex="-1"></a>**Critical Evaluation**</span>
<span id="cb375-2430"><a href="#cb375-2430" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Assess when reliability estimates are trustworthy vs. unstable with small n</span>
<span id="cb375-2431"><a href="#cb375-2431" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Evaluate the trade-off between scale brevity and internal consistency</span>
<span id="cb375-2432"><a href="#cb375-2432" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Critique inappropriate use of alpha for multidimensional scales</span>
<span id="cb375-2433"><a href="#cb375-2433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2434"><a href="#cb375-2434" aria-hidden="true" tabindex="-1"></a>**Application**</span>
<span id="cb375-2435"><a href="#cb375-2435" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Report reliability with confidence intervals and appropriate caveats</span>
<span id="cb375-2436"><a href="#cb375-2436" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Use item analysis to identify low-performing items for deletion</span>
<span id="cb375-2437"><a href="#cb375-2437" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Apply measurement quality checks in small-scale instrument development</span>
<span id="cb375-2438"><a href="#cb375-2438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2439"><a href="#cb375-2439" aria-hidden="true" tabindex="-1"></a><span class="fu">### The Challenge of Short Scales</span></span>
<span id="cb375-2440"><a href="#cb375-2440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2441"><a href="#cb375-2441" aria-hidden="true" tabindex="-1"></a>Many small-sample studies use brief measurement instruments (3â€“5 items) to reduce respondent burden. Short scales, however, pose challenges for reliability assessment. Classical reliability indices (Cronbach's alpha, split-half reliability) are attenuated when scales have few items. Moreover, small sample sizes yield imprecise reliability estimates with wide confidence intervals.</span>
<span id="cb375-2442"><a href="#cb375-2442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2443"><a href="#cb375-2443" aria-hidden="true" tabindex="-1"></a>Despite these limitations, reliability assessment remains essential. Unreliable measures introduce noise, reducing statistical power and biasing effect estimates. Researchers should report reliability alongside validity evidence and interpret findings cautiously when reliability is low.</span>
<span id="cb375-2444"><a href="#cb375-2444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2445"><a href="#cb375-2445" aria-hidden="true" tabindex="-1"></a><span class="fu">### Cronbach's Alpha</span></span>
<span id="cb375-2446"><a href="#cb375-2446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2447"><a href="#cb375-2447" aria-hidden="true" tabindex="-1"></a>Cronbach's alpha estimates internal consistency by comparing item variances to total scale variance. It assumes that all items measure a single underlying construct with equal factor loadings (tau-equivalent model). Alpha increases with the number of items and the average inter-item correlation.</span>
<span id="cb375-2448"><a href="#cb375-2448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2449"><a href="#cb375-2449" aria-hidden="true" tabindex="-1"></a>**Assumptions**: Items are tau-equivalent. Errors are uncorrelated. Continuous or approximately continuous item responses.</span>
<span id="cb375-2450"><a href="#cb375-2450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2451"><a href="#cb375-2451" aria-hidden="true" tabindex="-1"></a>**When to use**: Multi-item scales (3 or more items), desire for simple internal consistency estimate. Interpret cautiously for short scales and with small samples.</span>
<span id="cb375-2452"><a href="#cb375-2452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2453"><a href="#cb375-2453" aria-hidden="true" tabindex="-1"></a><span class="fu">### Interpreting Alpha in Context</span></span>
<span id="cb375-2454"><a href="#cb375-2454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2455"><a href="#cb375-2455" aria-hidden="true" tabindex="-1"></a>Traditional thresholds (0.70 for research, 0.90 for clinical decisions) are **guidelines, not rules**:</span>
<span id="cb375-2456"><a href="#cb375-2456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2457"><a href="#cb375-2457" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Exploratory research / pilot studies**: Î± = 0.60â€“0.70 acceptable</span>
<span id="cb375-2458"><a href="#cb375-2458" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Established scales in research**: Î± = 0.70â€“0.90 expected</span>
<span id="cb375-2459"><a href="#cb375-2459" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**High-stakes decisions**: Î± &gt; 0.90 required</span>
<span id="cb375-2460"><a href="#cb375-2460" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Very short scales** (3 items): Î± = 0.50â€“0.65 may be acceptable if items are conceptually narrow</span>
<span id="cb375-2461"><a href="#cb375-2461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2462"><a href="#cb375-2462" aria-hidden="true" tabindex="-1"></a>**More important than alpha:**</span>
<span id="cb375-2463"><a href="#cb375-2463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2464"><a href="#cb375-2464" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Item-total correlations (all &gt; 0.30?)</span>
<span id="cb375-2465"><a href="#cb375-2465" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Conceptual coherence of items</span>
<span id="cb375-2466"><a href="#cb375-2466" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Confidence interval width (precision matters!)</span>
<span id="cb375-2467"><a href="#cb375-2467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2468"><a href="#cb375-2468" aria-hidden="true" tabindex="-1"></a>With n = 36, an alpha of 0.65 has a 95% CI of approximately <span class="co">[</span><span class="ot">0.45, 0.80</span><span class="co">]</span>â€”wide uncertainty! Always report confidence intervals alongside point estimates, especially with small samples where precision is limited.</span>
<span id="cb375-2469"><a href="#cb375-2469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2470"><a href="#cb375-2470" aria-hidden="true" tabindex="-1"></a>::: {.callout-warning}</span>
<span id="cb375-2471"><a href="#cb375-2471" aria-hidden="true" tabindex="-1"></a><span class="fu">## âš ï¸ Common Misconception: "Alpha &gt; 0.70 = Good Scale"</span></span>
<span id="cb375-2472"><a href="#cb375-2472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2473"><a href="#cb375-2473" aria-hidden="true" tabindex="-1"></a>**Myth**: "If Cronbach's alpha is above 0.70, my scale is reliable and valid."</span>
<span id="cb375-2474"><a href="#cb375-2474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2475"><a href="#cb375-2475" aria-hidden="true" tabindex="-1"></a>**Reality**: Alpha can be **artificially inflated** by redundant items or scale length. High alpha â‰  good measurement.</span>
<span id="cb375-2476"><a href="#cb375-2476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2477"><a href="#cb375-2477" aria-hidden="true" tabindex="-1"></a>**Demonstration**:</span>
<span id="cb375-2480"><a href="#cb375-2480" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb375-2481"><a href="#cb375-2481" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: part-c-misconception-4</span></span>
<span id="cb375-2482"><a href="#cb375-2482" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb375-2483"><a href="#cb375-2483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2484"><a href="#cb375-2484" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a scale with near-duplicate items (bad scale design!)</span></span>
<span id="cb375-2485"><a href="#cb375-2485" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb375-2486"><a href="#cb375-2486" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb375-2487"><a href="#cb375-2487" aria-hidden="true" tabindex="-1"></a>redundant_scale <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb375-2488"><a href="#cb375-2488" aria-hidden="true" tabindex="-1"></a>  <span class="at">item1 =</span> <span class="fu">rnorm</span>(n, <span class="dv">50</span>, <span class="dv">10</span>),</span>
<span id="cb375-2489"><a href="#cb375-2489" aria-hidden="true" tabindex="-1"></a>  <span class="at">item2 =</span> <span class="fu">rnorm</span>(n, <span class="dv">50</span>, <span class="dv">10</span>),  <span class="co"># Completely independent items (measuring different things)</span></span>
<span id="cb375-2490"><a href="#cb375-2490" aria-hidden="true" tabindex="-1"></a>  <span class="at">item3 =</span> <span class="fu">rnorm</span>(n, <span class="dv">50</span>, <span class="dv">10</span>),</span>
<span id="cb375-2491"><a href="#cb375-2491" aria-hidden="true" tabindex="-1"></a>  <span class="at">item4 =</span> <span class="fu">rnorm</span>(n, <span class="dv">50</span>, <span class="dv">10</span>)</span>
<span id="cb375-2492"><a href="#cb375-2492" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb375-2493"><a href="#cb375-2493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2494"><a href="#cb375-2494" aria-hidden="true" tabindex="-1"></a><span class="co"># Add redundancy by duplicating item1 with slight noise</span></span>
<span id="cb375-2495"><a href="#cb375-2495" aria-hidden="true" tabindex="-1"></a>redundant_scale<span class="sc">$</span>item2 <span class="ot">&lt;-</span> redundant_scale<span class="sc">$</span>item1 <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">2</span>)  <span class="co"># Near-duplicate</span></span>
<span id="cb375-2496"><a href="#cb375-2496" aria-hidden="true" tabindex="-1"></a>redundant_scale<span class="sc">$</span>item3 <span class="ot">&lt;-</span> redundant_scale<span class="sc">$</span>item1 <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">2</span>)  <span class="co"># Near-duplicate</span></span>
<span id="cb375-2497"><a href="#cb375-2497" aria-hidden="true" tabindex="-1"></a>redundant_scale<span class="sc">$</span>item4 <span class="ot">&lt;-</span> redundant_scale<span class="sc">$</span>item1 <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">2</span>)  <span class="co"># Near-duplicate</span></span>
<span id="cb375-2498"><a href="#cb375-2498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2499"><a href="#cb375-2499" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute alpha</span></span>
<span id="cb375-2500"><a href="#cb375-2500" aria-hidden="true" tabindex="-1"></a>alpha_result <span class="ot">&lt;-</span> <span class="fu">alpha</span>(redundant_scale)</span>
<span id="cb375-2501"><a href="#cb375-2501" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Cronbach's alpha:"</span>, <span class="fu">round</span>(alpha_result<span class="sc">$</span>total<span class="sc">$</span>raw_alpha, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb375-2502"><a href="#cb375-2502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2503"><a href="#cb375-2503" aria-hidden="true" tabindex="-1"></a><span class="co"># Check item-total correlations</span></span>
<span id="cb375-2504"><a href="#cb375-2504" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Item-total correlations (r.cor):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-2505"><a href="#cb375-2505" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(alpha_result<span class="sc">$</span>item.stats<span class="sc">$</span>r.cor, <span class="dv">2</span>))</span>
<span id="cb375-2506"><a href="#cb375-2506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2507"><a href="#cb375-2507" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">â†’ Alpha looks great (&gt;0.90), but all items are nearly identical!</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-2508"><a href="#cb375-2508" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"â†’ This scale has poor content validity (measures only one narrow facet)</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-2509"><a href="#cb375-2509" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-2510"><a href="#cb375-2510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2511"><a href="#cb375-2511" aria-hidden="true" tabindex="-1"></a>**Problems with high-but-meaningless alpha:**</span>
<span id="cb375-2512"><a href="#cb375-2512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2513"><a href="#cb375-2513" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Redundant items**: Asking the same question 10 times inflates alpha but doesn't improve measurement</span>
<span id="cb375-2514"><a href="#cb375-2514" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Alpha increases with # items**: 20 poor items can yield Î± = 0.90</span>
<span id="cb375-2515"><a href="#cb375-2515" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Ignores unidimensionality**: Alpha doesn't test whether items measure one construct or multiple</span>
<span id="cb375-2516"><a href="#cb375-2516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2517"><a href="#cb375-2517" aria-hidden="true" tabindex="-1"></a>**What to check instead:**</span>
<span id="cb375-2518"><a href="#cb375-2518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2519"><a href="#cb375-2519" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Item-total correlations**: Are all items contributing (r.cor &gt; 0.30)?</span>
<span id="cb375-2520"><a href="#cb375-2520" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Mean inter-item correlation**: Should be 0.15â€“0.50 (Briggs &amp; Cheek, 1986)</span>
<span id="cb375-2521"><a href="#cb375-2521" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>&lt; 0.15: Items don't cohere</span>
<span id="cb375-2522"><a href="#cb375-2522" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>&gt; 0.50: Items are redundant</span>
<span id="cb375-2523"><a href="#cb375-2523" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Factor analysis**: Do items load on one factor or multiple?</span>
<span id="cb375-2524"><a href="#cb375-2524" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Content validity**: Do items cover the full construct breadth?</span>
<span id="cb375-2525"><a href="#cb375-2525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2526"><a href="#cb375-2526" aria-hidden="true" tabindex="-1"></a>**Lesson**: **Don't chase alpha &gt; 0.90 by adding redundant items.** Better to have Î± = 0.75 with diverse, non-redundant items than Î± = 0.95 with near-duplicates.</span>
<span id="cb375-2527"><a href="#cb375-2527" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb375-2528"><a href="#cb375-2528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2529"><a href="#cb375-2529" aria-hidden="true" tabindex="-1"></a><span class="fu">### Example: Cronbach's Alpha for a Short Scale</span></span>
<span id="cb375-2530"><a href="#cb375-2530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2531"><a href="#cb375-2531" aria-hidden="true" tabindex="-1"></a>We assess the internal consistency of a 3-item service quality scale using the <span class="in">`service_quality.csv`</span> data.</span>
<span id="cb375-2532"><a href="#cb375-2532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2535"><a href="#cb375-2535" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb375-2536"><a href="#cb375-2536" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: part-c-chunk-22</span></span>
<span id="cb375-2537"><a href="#cb375-2537" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb375-2538"><a href="#cb375-2538" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb375-2539"><a href="#cb375-2539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2540"><a href="#cb375-2540" aria-hidden="true" tabindex="-1"></a><span class="co"># Load service quality data</span></span>
<span id="cb375-2541"><a href="#cb375-2541" aria-hidden="true" tabindex="-1"></a>service_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/service_quality.csv"</span>, <span class="at">show_col_types =</span> <span class="cn">FALSE</span>)</span>
<span id="cb375-2542"><a href="#cb375-2542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2543"><a href="#cb375-2543" aria-hidden="true" tabindex="-1"></a><span class="co"># Select the three quality items</span></span>
<span id="cb375-2544"><a href="#cb375-2544" aria-hidden="true" tabindex="-1"></a>quality_items <span class="ot">&lt;-</span> service_data <span class="sc">%&gt;%</span></span>
<span id="cb375-2545"><a href="#cb375-2545" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(q1_responsiveness, q2_professionalism, q3_clarity)</span>
<span id="cb375-2546"><a href="#cb375-2546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2547"><a href="#cb375-2547" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute Cronbach's alpha</span></span>
<span id="cb375-2548"><a href="#cb375-2548" aria-hidden="true" tabindex="-1"></a>alpha_result <span class="ot">&lt;-</span> <span class="fu">alpha</span>(quality_items)</span>
<span id="cb375-2549"><a href="#cb375-2549" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(alpha_result)</span>
<span id="cb375-2550"><a href="#cb375-2550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2551"><a href="#cb375-2551" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract key values</span></span>
<span id="cb375-2552"><a href="#cb375-2552" aria-hidden="true" tabindex="-1"></a>alpha_est <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(alpha_result<span class="sc">$</span>total<span class="sc">$</span>raw_alpha)</span>
<span id="cb375-2553"><a href="#cb375-2553" aria-hidden="true" tabindex="-1"></a>alpha_se <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(alpha_result<span class="sc">$</span>total<span class="sc">$</span>ase)</span>
<span id="cb375-2554"><a href="#cb375-2554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2555"><a href="#cb375-2555" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Cronbach's alpha:"</span>, <span class="fu">formatC</span>(alpha_est, <span class="at">format =</span> <span class="st">"f"</span>, <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-2556"><a href="#cb375-2556" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"95% CI:"</span>,</span>
<span id="cb375-2557"><a href="#cb375-2557" aria-hidden="true" tabindex="-1"></a>  <span class="fu">formatC</span>(alpha_est <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> alpha_se, <span class="at">format =</span> <span class="st">"f"</span>, <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">"to"</span>,</span>
<span id="cb375-2558"><a href="#cb375-2558" aria-hidden="true" tabindex="-1"></a>  <span class="fu">formatC</span>(alpha_est <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> alpha_se, <span class="at">format =</span> <span class="st">"f"</span>, <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-2559"><a href="#cb375-2559" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-2560"><a href="#cb375-2560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2561"><a href="#cb375-2561" aria-hidden="true" tabindex="-1"></a>Interpretation: Alpha quantifies the proportion of variance in scale scores attributable to the true score. Higher alpha indicates stronger internal consistency. The confidence interval reflects sampling uncertainty; with small samples, the interval may be wide. If alpha is below 0.70, consider whether items truly measure a single construct or whether the scale is too heterogeneous. The <span class="in">`psych`</span> package also reports "alpha if item deleted", showing how alpha would change if each item were removed; this helps identify problematic items.</span>
<span id="cb375-2562"><a href="#cb375-2562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2563"><a href="#cb375-2563" aria-hidden="true" tabindex="-1"></a><span class="fu">### Standard Error of Measurement (SEM)</span></span>
<span id="cb375-2564"><a href="#cb375-2564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2565"><a href="#cb375-2565" aria-hidden="true" tabindex="-1"></a>The SEM quantifies measurement precisionâ€”how much individual scores vary due to measurement error.</span>
<span id="cb375-2566"><a href="#cb375-2566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2567"><a href="#cb375-2567" aria-hidden="true" tabindex="-1"></a>**Formula**: $\text{SEM} = \text{SD} \times \sqrt{1 - \text{reliability}}$</span>
<span id="cb375-2568"><a href="#cb375-2568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2571"><a href="#cb375-2571" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb375-2572"><a href="#cb375-2572" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: part-c-sem</span></span>
<span id="cb375-2573"><a href="#cb375-2573" aria-hidden="true" tabindex="-1"></a><span class="co"># Example: Test with SD = 10, Cronbach's alpha = 0.75</span></span>
<span id="cb375-2574"><a href="#cb375-2574" aria-hidden="true" tabindex="-1"></a>scale_SD <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb375-2575"><a href="#cb375-2575" aria-hidden="true" tabindex="-1"></a>cronbach_alpha <span class="ot">&lt;-</span> <span class="fl">0.75</span></span>
<span id="cb375-2576"><a href="#cb375-2576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2577"><a href="#cb375-2577" aria-hidden="true" tabindex="-1"></a>SEM <span class="ot">&lt;-</span> scale_SD <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="dv">1</span> <span class="sc">-</span> cronbach_alpha)</span>
<span id="cb375-2578"><a href="#cb375-2578" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"SEM ="</span>, <span class="fu">round</span>(SEM, <span class="dv">2</span>), <span class="st">"points</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-2579"><a href="#cb375-2579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2580"><a href="#cb375-2580" aria-hidden="true" tabindex="-1"></a><span class="co"># Confidence interval for individual scores</span></span>
<span id="cb375-2581"><a href="#cb375-2581" aria-hidden="true" tabindex="-1"></a><span class="co"># 95% CI: observed score Â± 1.96 Ã— SEM</span></span>
<span id="cb375-2582"><a href="#cb375-2582" aria-hidden="true" tabindex="-1"></a>CI_width <span class="ot">&lt;-</span> <span class="fl">1.96</span> <span class="sc">*</span> SEM</span>
<span id="cb375-2583"><a href="#cb375-2583" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"95% CI width: Â±"</span>, <span class="fu">round</span>(CI_width, <span class="dv">1</span>), <span class="st">"points</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-2584"><a href="#cb375-2584" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-2585"><a href="#cb375-2585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2586"><a href="#cb375-2586" aria-hidden="true" tabindex="-1"></a>**Interpretation**: With SEM = 5 points, an individual's true score likely falls within Â±10 points of their observed score (95% CI). This helps judge whether observed changes are genuine or merely measurement error.</span>
<span id="cb375-2587"><a href="#cb375-2587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2588"><a href="#cb375-2588" aria-hidden="true" tabindex="-1"></a>**Practical use**:</span>
<span id="cb375-2589"><a href="#cb375-2589" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Minimum detectable change = $1.96 \times \text{SEM} \times \sqrt{2} \approx 14$ points</span>
<span id="cb375-2590"><a href="#cb375-2590" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Changes smaller than this could be measurement error</span>
<span id="cb375-2591"><a href="#cb375-2591" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>SEM increases as reliability decreases</span>
<span id="cb375-2592"><a href="#cb375-2592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2593"><a href="#cb375-2593" aria-hidden="true" tabindex="-1"></a><span class="fu">### McDonald's Omega</span></span>
<span id="cb375-2594"><a href="#cb375-2594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2595"><a href="#cb375-2595" aria-hidden="true" tabindex="-1"></a>McDonald's omega (Ï‰â‚œ) is an alternative to alpha that relaxes the tau-equivalence assumption. It is computed from a single-factor confirmatory factor analysis model and reflects the proportion of variance in scale scores due to the general factor. Omega is generally preferred over alpha when factor loadings differ across items.</span>
<span id="cb375-2596"><a href="#cb375-2596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2597"><a href="#cb375-2597" aria-hidden="true" tabindex="-1"></a>**When to use**: Multi-item scales with varying item-factor relationships, when tau-equivalence is questionable, or when reporting alongside alpha for robustness.</span>
<span id="cb375-2598"><a href="#cb375-2598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2599"><a href="#cb375-2599" aria-hidden="true" tabindex="-1"></a><span class="fu">### Example: McDonald's Omega</span></span>
<span id="cb375-2600"><a href="#cb375-2600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2601"><a href="#cb375-2601" aria-hidden="true" tabindex="-1"></a>We compute omega for the same 3-item service quality scale.</span>
<span id="cb375-2602"><a href="#cb375-2602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2605"><a href="#cb375-2605" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb375-2606"><a href="#cb375-2606" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: part-c-chunk-23</span></span>
<span id="cb375-2607"><a href="#cb375-2607" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb375-2608"><a href="#cb375-2608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2609"><a href="#cb375-2609" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute McDonald's omega</span></span>
<span id="cb375-2610"><a href="#cb375-2610" aria-hidden="true" tabindex="-1"></a>omega_result <span class="ot">&lt;-</span> <span class="fu">omega</span>(quality_items, <span class="at">nfactors =</span> <span class="dv">1</span>, <span class="at">plot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb375-2611"><a href="#cb375-2611" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(omega_result)</span>
<span id="cb375-2612"><a href="#cb375-2612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2613"><a href="#cb375-2613" aria-hidden="true" tabindex="-1"></a>omega_tot <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(omega_result<span class="sc">$</span>omega.tot)</span>
<span id="cb375-2614"><a href="#cb375-2614" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"McDonald's omega total:"</span>, <span class="fu">formatC</span>(omega_tot, <span class="at">format =</span> <span class="st">"f"</span>, <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-2615"><a href="#cb375-2615" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-2616"><a href="#cb375-2616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2617"><a href="#cb375-2617" aria-hidden="true" tabindex="-1"></a>Interpretation: Omega total (Ï‰â‚œ) is analogous to alpha but allows items to have different factor loadings. If omega and alpha are similar, the tau-equivalence assumption is reasonable. If omega is higher, items have unequal loadings, and omega is more accurate. The <span class="in">`omega()`</span> function also reports omega hierarchical (Ï‰â‚•), which is relevant for multidimensional scales, though less applicable to brief unidimensional scales.</span>
<span id="cb375-2618"><a href="#cb375-2618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2619"><a href="#cb375-2619" aria-hidden="true" tabindex="-1"></a><span class="fu">### Split-Half Reliability</span></span>
<span id="cb375-2620"><a href="#cb375-2620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2621"><a href="#cb375-2621" aria-hidden="true" tabindex="-1"></a>Split-half reliability divides a scale into two halves, computes the correlation between half-scale scores, and adjusts using the Spearmanâ€“Brown formula to estimate reliability of the full scale. With small samples, split-half estimates are imprecise, but bootstrapping can provide confidence intervals.</span>
<span id="cb375-2622"><a href="#cb375-2622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2623"><a href="#cb375-2623" aria-hidden="true" tabindex="-1"></a>**When to use**: Multi-item scales, desire for alternative reliability estimate, comparison with alpha or omega.</span>
<span id="cb375-2624"><a href="#cb375-2624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2625"><a href="#cb375-2625" aria-hidden="true" tabindex="-1"></a><span class="fu">### Example: Bootstrap Split-Half Reliability</span></span>
<span id="cb375-2626"><a href="#cb375-2626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2627"><a href="#cb375-2627" aria-hidden="true" tabindex="-1"></a>We compute split-half reliability with a bootstrap confidence interval for the service quality scale.</span>
<span id="cb375-2628"><a href="#cb375-2628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2631"><a href="#cb375-2631" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb375-2632"><a href="#cb375-2632" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: part-c-chunk-24</span></span>
<span id="cb375-2633"><a href="#cb375-2633" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb375-2634"><a href="#cb375-2634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2635"><a href="#cb375-2635" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb375-2636"><a href="#cb375-2636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2637"><a href="#cb375-2637" aria-hidden="true" tabindex="-1"></a><span class="co"># Split-half reliability with bootstrap CI</span></span>
<span id="cb375-2638"><a href="#cb375-2638" aria-hidden="true" tabindex="-1"></a>split_result <span class="ot">&lt;-</span> <span class="fu">splitHalf</span>(quality_items, <span class="at">raw =</span> <span class="cn">TRUE</span>)</span>
<span id="cb375-2639"><a href="#cb375-2639" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(split_result)</span>
<span id="cb375-2640"><a href="#cb375-2640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2641"><a href="#cb375-2641" aria-hidden="true" tabindex="-1"></a>split_alpha <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(split_result<span class="sc">$</span>raw_alpha)</span>
<span id="cb375-2642"><a href="#cb375-2642" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Split-half reliability (Spearmanâ€“Brown adjusted):"</span>,</span>
<span id="cb375-2643"><a href="#cb375-2643" aria-hidden="true" tabindex="-1"></a>  <span class="fu">formatC</span>(split_alpha, <span class="at">format =</span> <span class="st">"f"</span>, <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-2644"><a href="#cb375-2644" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-2645"><a href="#cb375-2645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2646"><a href="#cb375-2646" aria-hidden="true" tabindex="-1"></a>Interpretation: The split-half correlation measures consistency between the two halves. The Spearmanâ€“Brown adjustment estimates the reliability of the full scale. This method is less commonly used than alpha but provides a complementary perspective. Random splits can yield different estimates, so bootstrap CIs (if available) are valuable for quantifying uncertainty.</span>
<span id="cb375-2647"><a href="#cb375-2647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2648"><a href="#cb375-2648" aria-hidden="true" tabindex="-1"></a><span class="fu">### Revelle's Beta (Worst Split-Half Reliability)</span></span>
<span id="cb375-2649"><a href="#cb375-2649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2650"><a href="#cb375-2650" aria-hidden="true" tabindex="-1"></a>Revelle's beta identifies the **least reliable** split of a scale and reports the reliability for that worst-case partition. Beta is useful for stress-testing very short scales: if the worst split still looks acceptable, the scale is unlikely to fail under any other split.</span>
<span id="cb375-2651"><a href="#cb375-2651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2654"><a href="#cb375-2654" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb375-2655"><a href="#cb375-2655" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: part-c-chunk-25</span></span>
<span id="cb375-2656"><a href="#cb375-2656" aria-hidden="true" tabindex="-1"></a><span class="co"># Revelle's beta (accessed via psych's internal helper when available)</span></span>
<span id="cb375-2657"><a href="#cb375-2657" aria-hidden="true" tabindex="-1"></a>beta_available <span class="ot">&lt;-</span> <span class="fu">exists</span>(<span class="st">"beta"</span>, <span class="at">where =</span> <span class="fu">asNamespace</span>(<span class="st">"psych"</span>), <span class="at">inherits =</span> <span class="cn">FALSE</span>)</span>
<span id="cb375-2658"><a href="#cb375-2658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2659"><a href="#cb375-2659" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (beta_available) {</span>
<span id="cb375-2660"><a href="#cb375-2660" aria-hidden="true" tabindex="-1"></a>  beta_fn <span class="ot">&lt;-</span> <span class="fu">getFromNamespace</span>(<span class="st">"beta"</span>, <span class="st">"psych"</span>)</span>
<span id="cb375-2661"><a href="#cb375-2661" aria-hidden="true" tabindex="-1"></a>  beta_result <span class="ot">&lt;-</span> <span class="fu">beta_fn</span>(quality_items)</span>
<span id="cb375-2662"><a href="#cb375-2662" aria-hidden="true" tabindex="-1"></a>  beta_est <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(beta_result<span class="sc">$</span>beta)</span>
<span id="cb375-2663"><a href="#cb375-2663" aria-hidden="true" tabindex="-1"></a>  beta_worst <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(beta_result<span class="sc">$</span>worst.r)</span>
<span id="cb375-2664"><a href="#cb375-2664" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Revelle's beta:"</span>, <span class="fu">formatC</span>(beta_est, <span class="at">format =</span> <span class="st">"f"</span>, <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-2665"><a href="#cb375-2665" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Worst split halves correlation:"</span>, <span class="fu">formatC</span>(beta_worst, <span class="at">format =</span> <span class="st">"f"</span>, <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-2666"><a href="#cb375-2666" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb375-2667"><a href="#cb375-2667" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Revelle's beta is unavailable in psych"</span>, <span class="fu">as.character</span>(<span class="fu">packageVersion</span>(<span class="st">"psych"</span>)),</span>
<span id="cb375-2668"><a href="#cb375-2668" aria-hidden="true" tabindex="-1"></a>      <span class="st">"because the helper function is not exported.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-2669"><a href="#cb375-2669" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb375-2670"><a href="#cb375-2670" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-2671"><a href="#cb375-2671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2672"><a href="#cb375-2672" aria-hidden="true" tabindex="-1"></a>Interpretation: Beta is typically lower than alpha because it evaluates the weakest halfâ€“half combination. Large gaps between alpha/omega and beta indicate that some item splits are fragile, suggesting the scale may behave inconsistently across subgroups. With very small samples, beta estimates can fluctuate; report them alongside alpha and omega and acknowledge sampling variability. If the function is unavailable, note the limitation and emphasise alpha and omega instead.</span>
<span id="cb375-2673"><a href="#cb375-2673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2674"><a href="#cb375-2674" aria-hidden="true" tabindex="-1"></a><span class="fu">### Polychoric Correlations for Ordinal Items</span></span>
<span id="cb375-2675"><a href="#cb375-2675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2676"><a href="#cb375-2676" aria-hidden="true" tabindex="-1"></a>Likert-scale items (e.g., 1â€“7 ratings) are ordinal, not continuous. Pearson correlations and alpha computed on ordinal data may underestimate reliability. Polychoric correlations estimate the correlation between underlying continuous latent variables, assuming ordinal responses arise from categorising continuous variables.</span>
<span id="cb375-2677"><a href="#cb375-2677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2678"><a href="#cb375-2678" aria-hidden="true" tabindex="-1"></a>When items are ordinal and have few response options, polychoric correlations and ordinal alpha may be more accurate. However, polychoric estimation requires larger samples than are typically available in small-n studies, so results should be interpreted cautiously.</span>
<span id="cb375-2679"><a href="#cb375-2679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2680"><a href="#cb375-2680" aria-hidden="true" tabindex="-1"></a>**When to use**: Ordinal items with few response categories, when sample size permits (n â‰¥ 30â€“50), desire for theoretically appropriate correlation estimates.</span>
<span id="cb375-2681"><a href="#cb375-2681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2682"><a href="#cb375-2682" aria-hidden="true" tabindex="-1"></a><span class="fu">### Example: Polychoric Correlations (Conceptual)</span></span>
<span id="cb375-2683"><a href="#cb375-2683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2684"><a href="#cb375-2684" aria-hidden="true" tabindex="-1"></a>We compute polychoric correlations for the service quality items. With n = 36, this is at the lower bound of recommended sample sizes for polychoric estimation.</span>
<span id="cb375-2685"><a href="#cb375-2685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2688"><a href="#cb375-2688" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb375-2689"><a href="#cb375-2689" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: part-c-chunk-26</span></span>
<span id="cb375-2690"><a href="#cb375-2690" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb375-2691"><a href="#cb375-2691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2692"><a href="#cb375-2692" aria-hidden="true" tabindex="-1"></a><span class="co"># Polychoric correlation matrix with error handling</span></span>
<span id="cb375-2693"><a href="#cb375-2693" aria-hidden="true" tabindex="-1"></a><span class="co"># Falls back to Pearson correlations if sample is too small</span></span>
<span id="cb375-2694"><a href="#cb375-2694" aria-hidden="true" tabindex="-1"></a>poly_result <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>(</span>
<span id="cb375-2695"><a href="#cb375-2695" aria-hidden="true" tabindex="-1"></a>  <span class="fu">polychoric</span>(quality_items),</span>
<span id="cb375-2696"><a href="#cb375-2696" aria-hidden="true" tabindex="-1"></a>  <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb375-2697"><a href="#cb375-2697" aria-hidden="true" tabindex="-1"></a>    <span class="fu">message</span>(<span class="st">"Polychoric estimation failed (sample too small). Using Pearson correlations."</span>)</span>
<span id="cb375-2698"><a href="#cb375-2698" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">rho =</span> <span class="fu">cor</span>(quality_items)))</span>
<span id="cb375-2699"><a href="#cb375-2699" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb375-2700"><a href="#cb375-2700" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb375-2701"><a href="#cb375-2701" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(poly_result)</span>
<span id="cb375-2702"><a href="#cb375-2702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2703"><a href="#cb375-2703" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute alpha based on polychoric correlations</span></span>
<span id="cb375-2704"><a href="#cb375-2704" aria-hidden="true" tabindex="-1"></a>alpha_poly <span class="ot">&lt;-</span> <span class="fu">alpha</span>(poly_result<span class="sc">$</span>rho)</span>
<span id="cb375-2705"><a href="#cb375-2705" aria-hidden="true" tabindex="-1"></a>alpha_poly_est <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(alpha_poly<span class="sc">$</span>total<span class="sc">$</span>raw_alpha)</span>
<span id="cb375-2706"><a href="#cb375-2706" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Alpha based on polychoric correlations:"</span>,</span>
<span id="cb375-2707"><a href="#cb375-2707" aria-hidden="true" tabindex="-1"></a>  <span class="fu">formatC</span>(alpha_poly_est, <span class="at">format =</span> <span class="st">"f"</span>, <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-2708"><a href="#cb375-2708" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-2709"><a href="#cb375-2709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2710"><a href="#cb375-2710" aria-hidden="true" tabindex="-1"></a>Interpretation: Polychoric correlations are typically higher than Pearson correlations for ordinal data. Alpha computed from polychoric correlations may also be higher. However, polychoric estimation can be unstable with small samples, so results should be reported alongside Pearson-based alpha. If polychoric and Pearson estimates are similar, the choice of method has little impact. If they differ substantially, report both and acknowledge the uncertainty.</span>
<span id="cb375-2711"><a href="#cb375-2711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2712"><a href="#cb375-2712" aria-hidden="true" tabindex="-1"></a><span class="fu">### Reporting Reliability with Small Samples</span></span>
<span id="cb375-2713"><a href="#cb375-2713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2714"><a href="#cb375-2714" aria-hidden="true" tabindex="-1"></a>When reporting reliability for small samples and short scales:</span>
<span id="cb375-2715"><a href="#cb375-2715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2716"><a href="#cb375-2716" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Report Cronbach's alpha with confidence intervals.</span>
<span id="cb375-2717"><a href="#cb375-2717" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Consider reporting McDonald's omega as a robustness check.</span>
<span id="cb375-2718"><a href="#cb375-2718" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Acknowledge limitations (short scale, small sample, wide CIs).</span>
<span id="cb375-2719"><a href="#cb375-2719" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Provide item-level descriptive statistics (means, SDs, inter-item correlations).</span>
<span id="cb375-2720"><a href="#cb375-2720" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Discuss implications for interpretation (e.g., "The modest alpha suggests caution in interpreting scale scores; findings should be replicated with longer instruments").</span>
<span id="cb375-2721"><a href="#cb375-2721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2722"><a href="#cb375-2722" aria-hidden="true" tabindex="-1"></a><span class="fu">### Lab Practical 6.1: Refining a Workplace Resilience Scale</span></span>
<span id="cb375-2723"><a href="#cb375-2723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2724"><a href="#cb375-2724" aria-hidden="true" tabindex="-1"></a>**Context**: An organizational psychologist developed a 6-item Workplace Resilience Scale (WRS) to measure employees' ability to cope with job stress. After piloting the scale with 22 employees, the researcher wants to evaluate internal consistency and decide whether to drop any items to improve reliability. This walkthrough demonstrates item analysis, alpha calculation, and item-deletion decisions.</span>
<span id="cb375-2725"><a href="#cb375-2725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2726"><a href="#cb375-2726" aria-hidden="true" tabindex="-1"></a>**Learning Goals**:</span>
<span id="cb375-2727"><a href="#cb375-2727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2728"><a href="#cb375-2728" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Compute Cronbach's alpha for a multi-item scale</span>
<span id="cb375-2729"><a href="#cb375-2729" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Examine item-total correlations to identify weak items</span>
<span id="cb375-2730"><a href="#cb375-2730" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Assess the impact of dropping items on reliability</span>
<span id="cb375-2731"><a href="#cb375-2731" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Make evidence-based decisions about scale refinement</span>
<span id="cb375-2732"><a href="#cb375-2732" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Understand context-dependent alpha thresholds</span>
<span id="cb375-2733"><a href="#cb375-2733" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2734"><a href="#cb375-2734" aria-hidden="true" tabindex="-1"></a>**Step 1: Load and Explore the Data**</span>
<span id="cb375-2735"><a href="#cb375-2735" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2738"><a href="#cb375-2738" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb375-2739"><a href="#cb375-2739" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: part-c-lab-6-1</span></span>
<span id="cb375-2740"><a href="#cb375-2740" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb375-2741"><a href="#cb375-2741" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb375-2742"><a href="#cb375-2742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2743"><a href="#cb375-2743" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulated WRS data: 22 employees, 6 items (1-5 Likert scale)</span></span>
<span id="cb375-2744"><a href="#cb375-2744" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb375-2745"><a href="#cb375-2745" aria-hidden="true" tabindex="-1"></a>wrs_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb375-2746"><a href="#cb375-2746" aria-hidden="true" tabindex="-1"></a>  <span class="at">WRS1 =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">4</span>),</span>
<span id="cb375-2747"><a href="#cb375-2747" aria-hidden="true" tabindex="-1"></a>  <span class="at">WRS2 =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb375-2748"><a href="#cb375-2748" aria-hidden="true" tabindex="-1"></a>  <span class="at">WRS3 =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">5</span>),</span>
<span id="cb375-2749"><a href="#cb375-2749" aria-hidden="true" tabindex="-1"></a>  <span class="at">WRS4 =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">2</span>),  <span class="co"># Weak item</span></span>
<span id="cb375-2750"><a href="#cb375-2750" aria-hidden="true" tabindex="-1"></a>  <span class="at">WRS5 =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">4</span>),</span>
<span id="cb375-2751"><a href="#cb375-2751" aria-hidden="true" tabindex="-1"></a>  <span class="at">WRS6 =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb375-2752"><a href="#cb375-2752" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb375-2753"><a href="#cb375-2753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2754"><a href="#cb375-2754" aria-hidden="true" tabindex="-1"></a><span class="co"># Descriptive statistics</span></span>
<span id="cb375-2755"><a href="#cb375-2755" aria-hidden="true" tabindex="-1"></a>wrs_data <span class="sc">%&gt;%</span></span>
<span id="cb375-2756"><a href="#cb375-2756" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), <span class="fu">list</span>(<span class="at">mean =</span> mean, <span class="at">sd =</span> sd))) <span class="sc">%&gt;%</span></span>
<span id="cb375-2757"><a href="#cb375-2757" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">"Item"</span>, <span class="st">".value"</span>), <span class="at">names_sep =</span> <span class="st">"_"</span>)</span>
<span id="cb375-2758"><a href="#cb375-2758" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-2759"><a href="#cb375-2759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2760"><a href="#cb375-2760" aria-hidden="true" tabindex="-1"></a>**Checkpoint**: Items have similar means (3â€“4) and SDs (0.5â€“1.0), except WRS4 shows lower mean and higher SD, suggesting it may not align with other items.</span>
<span id="cb375-2761"><a href="#cb375-2761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2762"><a href="#cb375-2762" aria-hidden="true" tabindex="-1"></a>**Step 2: Compute Cronbach's Alpha (Full Scale)**</span>
<span id="cb375-2763"><a href="#cb375-2763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2766"><a href="#cb375-2766" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb375-2767"><a href="#cb375-2767" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: part-c-lab-6-2</span></span>
<span id="cb375-2768"><a href="#cb375-2768" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute alpha for all 6 items</span></span>
<span id="cb375-2769"><a href="#cb375-2769" aria-hidden="true" tabindex="-1"></a>alpha_full <span class="ot">&lt;-</span> <span class="fu">alpha</span>(wrs_data)</span>
<span id="cb375-2770"><a href="#cb375-2770" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(alpha_full)</span>
<span id="cb375-2771"><a href="#cb375-2771" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-2772"><a href="#cb375-2772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2773"><a href="#cb375-2773" aria-hidden="true" tabindex="-1"></a>**Checkpoint**: The output shows:</span>
<span id="cb375-2774"><a href="#cb375-2774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2775"><a href="#cb375-2775" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**raw_alpha**: Overall reliability (target: â‰¥ 0.70 for research scales, â‰¥ 0.80 for high-stakes decisions)</span>
<span id="cb375-2776"><a href="#cb375-2776" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**std.alpha**: Standardized alpha (assumes equal item variances)</span>
<span id="cb375-2777"><a href="#cb375-2777" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**raw.r**: Mean inter-item correlation (should be 0.15â€“0.50)</span>
<span id="cb375-2778"><a href="#cb375-2778" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**S/N**: Signal-to-noise ratio (higher is better)</span>
<span id="cb375-2779"><a href="#cb375-2779" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2780"><a href="#cb375-2780" aria-hidden="true" tabindex="-1"></a>Check the "Reliability if an item is dropped" table: Does alpha increase if any item is removed?</span>
<span id="cb375-2781"><a href="#cb375-2781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2782"><a href="#cb375-2782" aria-hidden="true" tabindex="-1"></a>**Step 3: Examine Item-Total Correlations**</span>
<span id="cb375-2783"><a href="#cb375-2783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2786"><a href="#cb375-2786" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb375-2787"><a href="#cb375-2787" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: part-c-lab-6-3</span></span>
<span id="cb375-2788"><a href="#cb375-2788" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract item-total correlations</span></span>
<span id="cb375-2789"><a href="#cb375-2789" aria-hidden="true" tabindex="-1"></a>item_stats <span class="ot">&lt;-</span> alpha_full<span class="sc">$</span>item.stats</span>
<span id="cb375-2790"><a href="#cb375-2790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2791"><a href="#cb375-2791" aria-hidden="true" tabindex="-1"></a><span class="co"># Display key statistics</span></span>
<span id="cb375-2792"><a href="#cb375-2792" aria-hidden="true" tabindex="-1"></a>item_stats <span class="sc">%&gt;%</span></span>
<span id="cb375-2793"><a href="#cb375-2793" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(r.cor, r.drop, mean, sd) <span class="sc">%&gt;%</span></span>
<span id="cb375-2794"><a href="#cb375-2794" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(r.cor)</span>
<span id="cb375-2795"><a href="#cb375-2795" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-2796"><a href="#cb375-2796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2797"><a href="#cb375-2797" aria-hidden="true" tabindex="-1"></a>**Checkpoint**: Look for:</span>
<span id="cb375-2798"><a href="#cb375-2798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2799"><a href="#cb375-2799" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**r.cor**: Corrected item-total correlation (item vs. scale without that item). Values &lt; 0.30 indicate weak contribution</span>
<span id="cb375-2800"><a href="#cb375-2800" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**r.drop**: Raw item-total correlation (item vs. full scale including that item)</span>
<span id="cb375-2801"><a href="#cb375-2801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2802"><a href="#cb375-2802" aria-hidden="true" tabindex="-1"></a>Items with r.cor &lt; 0.30 are candidates for deletion. Here, WRS4 shows the weakest correlation.</span>
<span id="cb375-2803"><a href="#cb375-2803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2804"><a href="#cb375-2804" aria-hidden="true" tabindex="-1"></a>**Step 4: Assess "Alpha if Item Dropped"**</span>
<span id="cb375-2805"><a href="#cb375-2805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2808"><a href="#cb375-2808" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb375-2809"><a href="#cb375-2809" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: part-c-lab-6-4</span></span>
<span id="cb375-2810"><a href="#cb375-2810" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract alpha-if-deleted</span></span>
<span id="cb375-2811"><a href="#cb375-2811" aria-hidden="true" tabindex="-1"></a>alpha_if_dropped <span class="ot">&lt;-</span> alpha_full<span class="sc">$</span>alpha.drop</span>
<span id="cb375-2812"><a href="#cb375-2812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2813"><a href="#cb375-2813" aria-hidden="true" tabindex="-1"></a><span class="co"># Display with item labels</span></span>
<span id="cb375-2814"><a href="#cb375-2814" aria-hidden="true" tabindex="-1"></a>alpha_if_dropped <span class="sc">%&gt;%</span></span>
<span id="cb375-2815"><a href="#cb375-2815" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(raw_alpha) <span class="sc">%&gt;%</span></span>
<span id="cb375-2816"><a href="#cb375-2816" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(raw_alpha))</span>
<span id="cb375-2817"><a href="#cb375-2817" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-2818"><a href="#cb375-2818" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2819"><a href="#cb375-2819" aria-hidden="true" tabindex="-1"></a>**Checkpoint**: If dropping WRS4 increases alpha (e.g., from 0.68 to 0.75), consider removing it. Compare the magnitude of improvement (e.g., Î”Î± &gt; 0.05 is meaningful).</span>
<span id="cb375-2820"><a href="#cb375-2820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2821"><a href="#cb375-2821" aria-hidden="true" tabindex="-1"></a>**Step 5: Recompute Alpha Without WRS4**</span>
<span id="cb375-2822"><a href="#cb375-2822" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2825"><a href="#cb375-2825" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb375-2826"><a href="#cb375-2826" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: part-c-lab-6-5</span></span>
<span id="cb375-2827"><a href="#cb375-2827" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop WRS4 and recompute alpha</span></span>
<span id="cb375-2828"><a href="#cb375-2828" aria-hidden="true" tabindex="-1"></a>wrs_refined <span class="ot">&lt;-</span> wrs_data <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>WRS4)</span>
<span id="cb375-2829"><a href="#cb375-2829" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2830"><a href="#cb375-2830" aria-hidden="true" tabindex="-1"></a>alpha_refined <span class="ot">&lt;-</span> <span class="fu">alpha</span>(wrs_refined)</span>
<span id="cb375-2831"><a href="#cb375-2831" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(alpha_refined)</span>
<span id="cb375-2832"><a href="#cb375-2832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2833"><a href="#cb375-2833" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare full vs. refined alpha</span></span>
<span id="cb375-2834"><a href="#cb375-2834" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Full scale alpha:"</span>, <span class="fu">round</span>(alpha_full<span class="sc">$</span>total<span class="sc">$</span>raw_alpha, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-2835"><a href="#cb375-2835" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Refined scale alpha (WRS4 dropped):"</span>, <span class="fu">round</span>(alpha_refined<span class="sc">$</span>total<span class="sc">$</span>raw_alpha, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-2836"><a href="#cb375-2836" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Improvement:"</span>, <span class="fu">round</span>(alpha_refined<span class="sc">$</span>total<span class="sc">$</span>raw_alpha <span class="sc">-</span> alpha_full<span class="sc">$</span>total<span class="sc">$</span>raw_alpha, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-2837"><a href="#cb375-2837" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-2838"><a href="#cb375-2838" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2839"><a href="#cb375-2839" aria-hidden="true" tabindex="-1"></a>**Checkpoint**: The refined scale (5 items) has higher alpha (â‰¥ 0.75) and all items show r.cor &gt; 0.40. This is a more reliable measure.</span>
<span id="cb375-2840"><a href="#cb375-2840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2841"><a href="#cb375-2841" aria-hidden="true" tabindex="-1"></a>**Step 6: Interpret in Context**</span>
<span id="cb375-2842"><a href="#cb375-2842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2843"><a href="#cb375-2843" aria-hidden="true" tabindex="-1"></a>Follow these guidelines:</span>
<span id="cb375-2844"><a href="#cb375-2844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2845"><a href="#cb375-2845" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Research/exploratory scales**: Î± â‰¥ 0.60â€“0.70 acceptable</span>
<span id="cb375-2846"><a href="#cb375-2846" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Established scales in research**: Î± â‰¥ 0.70â€“0.80 preferred</span>
<span id="cb375-2847"><a href="#cb375-2847" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**High-stakes decisions (clinical, personnel)**: Î± â‰¥ 0.80â€“0.90 required</span>
<span id="cb375-2848"><a href="#cb375-2848" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Short scales (3â€“5 items)**: Expect Î± 0.05â€“0.10 lower than longer scales</span>
<span id="cb375-2849"><a href="#cb375-2849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2850"><a href="#cb375-2850" aria-hidden="true" tabindex="-1"></a>**Decision**: Drop WRS4 because:</span>
<span id="cb375-2851"><a href="#cb375-2851" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2852"><a href="#cb375-2852" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>It has the weakest item-total correlation (r.cor &lt; 0.30)</span>
<span id="cb375-2853"><a href="#cb375-2853" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Dropping it increases alpha by &gt; 0.05</span>
<span id="cb375-2854"><a href="#cb375-2854" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>The refined 5-item scale meets acceptable reliability (Î± â‰¥ 0.75 for research use)</span>
<span id="cb375-2855"><a href="#cb375-2855" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2856"><a href="#cb375-2856" aria-hidden="true" tabindex="-1"></a>**Step 7: Visualize Item Performance**</span>
<span id="cb375-2857"><a href="#cb375-2857" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2860"><a href="#cb375-2860" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb375-2861"><a href="#cb375-2861" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: part-c-lab-6-6</span></span>
<span id="cb375-2862"><a href="#cb375-2862" aria-hidden="true" tabindex="-1"></a><span class="co"># Create item performance plot</span></span>
<span id="cb375-2863"><a href="#cb375-2863" aria-hidden="true" tabindex="-1"></a>item_performance <span class="ot">&lt;-</span> item_stats <span class="sc">%&gt;%</span></span>
<span id="cb375-2864"><a href="#cb375-2864" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"Item"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb375-2865"><a href="#cb375-2865" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Item, r.cor, mean, sd)</span>
<span id="cb375-2866"><a href="#cb375-2866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2867"><a href="#cb375-2867" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(item_performance, <span class="fu">aes</span>(<span class="at">x =</span> Item, <span class="at">y =</span> r.cor, <span class="at">fill =</span> r.cor <span class="sc">&gt;</span> <span class="fl">0.30</span>)) <span class="sc">+</span></span>
<span id="cb375-2868"><a href="#cb375-2868" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb375-2869"><a href="#cb375-2869" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.30</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb375-2870"><a href="#cb375-2870" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb375-2871"><a href="#cb375-2871" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Item-Total Correlations (Corrected)"</span>,</span>
<span id="cb375-2872"><a href="#cb375-2872" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Item"</span>,</span>
<span id="cb375-2873"><a href="#cb375-2873" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Corrected Item-Total Correlation"</span>,</span>
<span id="cb375-2874"><a href="#cb375-2874" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Adequate (r &gt; 0.30)"</span></span>
<span id="cb375-2875"><a href="#cb375-2875" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb375-2876"><a href="#cb375-2876" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb375-2877"><a href="#cb375-2877" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"TRUE"</span> <span class="ot">=</span> <span class="st">"steelblue"</span>, <span class="st">"FALSE"</span> <span class="ot">=</span> <span class="st">"salmon"</span>))</span>
<span id="cb375-2878"><a href="#cb375-2878" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-2879"><a href="#cb375-2879" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2880"><a href="#cb375-2880" aria-hidden="true" tabindex="-1"></a>**Checkpoint**: The plot clearly shows WRS4 falls below the 0.30 threshold, justifying its removal.</span>
<span id="cb375-2881"><a href="#cb375-2881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2882"><a href="#cb375-2882" aria-hidden="true" tabindex="-1"></a>**Step 8: Report the Results**</span>
<span id="cb375-2883"><a href="#cb375-2883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2884"><a href="#cb375-2884" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; "The 6-item Workplace Resilience Scale was piloted with 22 employees. Initial Cronbach's alpha was 0.68 (95% CI </span><span class="co">[</span><span class="ot">0.42, 0.84</span><span class="co">]</span><span class="at">). Item analysis revealed that WRS4 had a weak corrected item-total correlation (r = 0.18) and its removal increased alpha to 0.75 (95% CI </span><span class="co">[</span><span class="ot">0.54, 0.88</span><span class="co">]</span><span class="at">). The refined 5-item scale demonstrates acceptable internal consistency for research purposes. Future validation should include a larger sample (n â‰¥ 100) and test-retest reliability."</span></span>
<span id="cb375-2885"><a href="#cb375-2885" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2886"><a href="#cb375-2886" aria-hidden="true" tabindex="-1"></a>**Discussion Questions**:</span>
<span id="cb375-2887"><a href="#cb375-2887" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2888"><a href="#cb375-2888" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Why is item-total correlation more informative than item mean or SD?</span>
<span id="cb375-2889"><a href="#cb375-2889" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>It measures how well an item captures the same construct as the rest of the scale; items with low correlations dilute reliability</span>
<span id="cb375-2890"><a href="#cb375-2890" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>What if two items both have r.cor &lt; 0.30?</span>
<span id="cb375-2891"><a href="#cb375-2891" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Drop them one at a time, recomputing alpha after each removal, to see which has the greatest impact; or drop both if each independently improves alpha</span>
<span id="cb375-2892"><a href="#cb375-2892" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Should you always maximize alpha by dropping items?</span>
<span id="cb375-2893"><a href="#cb375-2893" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>No: Dropping items reduces content coverage. Balance reliability with construct validity (does the scale still measure what it should?). Sometimes Î± = 0.70 with more items is preferable to Î± = 0.80 with too few items</span>
<span id="cb375-2894"><a href="#cb375-2894" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>How does sample size affect these decisions?</span>
<span id="cb375-2895"><a href="#cb375-2895" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Small samples (n &lt; 30) yield unstable item-total correlations; decisions should be tentative and revisited with larger samples</span>
<span id="cb375-2896"><a href="#cb375-2896" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2897"><a href="#cb375-2897" aria-hidden="true" tabindex="-1"></a>**Extension**: Conduct split-half reliability or omega (hierarchical) to assess whether the scale is unidimensional or if subscales exist. Use confirmatory factor analysis (CFA) if you have theory about item groupings.</span>
<span id="cb375-2898"><a href="#cb375-2898" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2899"><a href="#cb375-2899" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-2900"><a href="#cb375-2900" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2901"><a href="#cb375-2901" aria-hidden="true" tabindex="-1"></a><span class="fu">### Self-Assessment Quiz</span></span>
<span id="cb375-2902"><a href="#cb375-2902" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2903"><a href="#cb375-2903" aria-hidden="true" tabindex="-1"></a>Test your understanding of reliability and measurement quality from Chapter 6. Answers and explanations are provided at the end.</span>
<span id="cb375-2904"><a href="#cb375-2904" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2905"><a href="#cb375-2905" aria-hidden="true" tabindex="-1"></a>::: {.callout-note icon=false}</span>
<span id="cb375-2906"><a href="#cb375-2906" aria-hidden="true" tabindex="-1"></a><span class="fu">## Questions</span></span>
<span id="cb375-2907"><a href="#cb375-2907" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2908"><a href="#cb375-2908" aria-hidden="true" tabindex="-1"></a>**Q1.** Cronbach's alpha measures:</span>
<span id="cb375-2909"><a href="#cb375-2909" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2910"><a href="#cb375-2910" aria-hidden="true" tabindex="-1"></a>A. Whether data are normally distributed  </span>
<span id="cb375-2911"><a href="#cb375-2911" aria-hidden="true" tabindex="-1"></a>B. Internal consistencyâ€”how closely related a set of items are  </span>
<span id="cb375-2912"><a href="#cb375-2912" aria-hidden="true" tabindex="-1"></a>C. Test-retest reliability  </span>
<span id="cb375-2913"><a href="#cb375-2913" aria-hidden="true" tabindex="-1"></a>D. Inter-rater agreement</span>
<span id="cb375-2914"><a href="#cb375-2914" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2915"><a href="#cb375-2915" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-2916"><a href="#cb375-2916" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2917"><a href="#cb375-2917" aria-hidden="true" tabindex="-1"></a>**Q2.** What is the main limitation of Cronbach's alpha?</span>
<span id="cb375-2918"><a href="#cb375-2918" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2919"><a href="#cb375-2919" aria-hidden="true" tabindex="-1"></a>A. It requires n&gt;1,000  </span>
<span id="cb375-2920"><a href="#cb375-2920" aria-hidden="true" tabindex="-1"></a>B. It assumes tau-equivalence (equal factor loadings across items)  </span>
<span id="cb375-2921"><a href="#cb375-2921" aria-hidden="true" tabindex="-1"></a>C. It cannot be calculated for short scales  </span>
<span id="cb375-2922"><a href="#cb375-2922" aria-hidden="true" tabindex="-1"></a>D. It is always too high</span>
<span id="cb375-2923"><a href="#cb375-2923" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2924"><a href="#cb375-2924" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-2925"><a href="#cb375-2925" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2926"><a href="#cb375-2926" aria-hidden="true" tabindex="-1"></a>**Q3.** A 3-item scale has Î±=0.55 with n=25. Is this acceptable?</span>
<span id="cb375-2927"><a href="#cb375-2927" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2928"><a href="#cb375-2928" aria-hidden="true" tabindex="-1"></a>A. Noâ€”alpha must always exceed 0.70  </span>
<span id="cb375-2929"><a href="#cb375-2929" aria-hidden="true" tabindex="-1"></a>B. Possiblyâ€”short scales naturally have lower alpha; consider context, item-total correlations, and CI  </span>
<span id="cb375-2930"><a href="#cb375-2930" aria-hidden="true" tabindex="-1"></a>C. Yesâ€”always acceptable  </span>
<span id="cb375-2931"><a href="#cb375-2931" aria-hidden="true" tabindex="-1"></a>D. Noâ€”the scale must be discarded</span>
<span id="cb375-2932"><a href="#cb375-2932" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2933"><a href="#cb375-2933" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-2934"><a href="#cb375-2934" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2935"><a href="#cb375-2935" aria-hidden="true" tabindex="-1"></a>**Q4.** McDonald's omega is preferred over alpha when:</span>
<span id="cb375-2936"><a href="#cb375-2936" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2937"><a href="#cb375-2937" aria-hidden="true" tabindex="-1"></a>A. Items have equal factor loadings  </span>
<span id="cb375-2938"><a href="#cb375-2938" aria-hidden="true" tabindex="-1"></a>B. Items have varying factor loadings (not tau-equivalent)  </span>
<span id="cb375-2939"><a href="#cb375-2939" aria-hidden="true" tabindex="-1"></a>C. Sample size exceeds 500  </span>
<span id="cb375-2940"><a href="#cb375-2940" aria-hidden="true" tabindex="-1"></a>D. Data are categorical</span>
<span id="cb375-2941"><a href="#cb375-2941" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2942"><a href="#cb375-2942" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-2943"><a href="#cb375-2943" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2944"><a href="#cb375-2944" aria-hidden="true" tabindex="-1"></a>**Q5.** Item-total correlation measures:</span>
<span id="cb375-2945"><a href="#cb375-2945" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2946"><a href="#cb375-2946" aria-hidden="true" tabindex="-1"></a>A. How well an item correlates with the total scale score (excluding that item)  </span>
<span id="cb375-2947"><a href="#cb375-2947" aria-hidden="true" tabindex="-1"></a>B. Test-retest stability  </span>
<span id="cb375-2948"><a href="#cb375-2948" aria-hidden="true" tabindex="-1"></a>C. The mean of all items  </span>
<span id="cb375-2949"><a href="#cb375-2949" aria-hidden="true" tabindex="-1"></a>D. Sample size adequacy</span>
<span id="cb375-2950"><a href="#cb375-2950" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2951"><a href="#cb375-2951" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-2952"><a href="#cb375-2952" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2953"><a href="#cb375-2953" aria-hidden="true" tabindex="-1"></a>**Q6.** What does "alpha if item deleted" show?</span>
<span id="cb375-2954"><a href="#cb375-2954" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2955"><a href="#cb375-2955" aria-hidden="true" tabindex="-1"></a>A. The p-value for each item  </span>
<span id="cb375-2956"><a href="#cb375-2956" aria-hidden="true" tabindex="-1"></a>B. How alpha would change if a specific item were removed  </span>
<span id="cb375-2957"><a href="#cb375-2957" aria-hidden="true" tabindex="-1"></a>C. The mean of each item  </span>
<span id="cb375-2958"><a href="#cb375-2958" aria-hidden="true" tabindex="-1"></a>D. Whether items are normally distributed</span>
<span id="cb375-2959"><a href="#cb375-2959" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2960"><a href="#cb375-2960" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-2961"><a href="#cb375-2961" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2962"><a href="#cb375-2962" aria-hidden="true" tabindex="-1"></a>**Q7.** Polychoric correlations are used when:</span>
<span id="cb375-2963"><a href="#cb375-2963" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2964"><a href="#cb375-2964" aria-hidden="true" tabindex="-1"></a>A. Items are continuous and normally distributed  </span>
<span id="cb375-2965"><a href="#cb375-2965" aria-hidden="true" tabindex="-1"></a>B. Items are ordinal (e.g., Likert scales) and you want to estimate correlations between underlying continuous latent variables  </span>
<span id="cb375-2966"><a href="#cb375-2966" aria-hidden="true" tabindex="-1"></a>C. Sample size exceeds 1,000  </span>
<span id="cb375-2967"><a href="#cb375-2967" aria-hidden="true" tabindex="-1"></a>D. Data have no missing values</span>
<span id="cb375-2968"><a href="#cb375-2968" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2969"><a href="#cb375-2969" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-2970"><a href="#cb375-2970" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2971"><a href="#cb375-2971" aria-hidden="true" tabindex="-1"></a>**Q8.** A scale has Î±=0.72 with n=36. The 95% CI is <span class="co">[</span><span class="ot">0.52, 0.86</span><span class="co">]</span>. What does this tell us?</span>
<span id="cb375-2972"><a href="#cb375-2972" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2973"><a href="#cb375-2973" aria-hidden="true" tabindex="-1"></a>A. Reliability is excellent  </span>
<span id="cb375-2974"><a href="#cb375-2974" aria-hidden="true" tabindex="-1"></a>B. Reliability is moderate, but precision is limited (wide CI) due to small sample  </span>
<span id="cb375-2975"><a href="#cb375-2975" aria-hidden="true" tabindex="-1"></a>C. The scale is unreliable  </span>
<span id="cb375-2976"><a href="#cb375-2976" aria-hidden="true" tabindex="-1"></a>D. More items must be added</span>
<span id="cb375-2977"><a href="#cb375-2977" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2978"><a href="#cb375-2978" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-2979"><a href="#cb375-2979" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2980"><a href="#cb375-2980" aria-hidden="true" tabindex="-1"></a>**Q9.** Split-half reliability involves:</span>
<span id="cb375-2981"><a href="#cb375-2981" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2982"><a href="#cb375-2982" aria-hidden="true" tabindex="-1"></a>A. Testing participants twice  </span>
<span id="cb375-2983"><a href="#cb375-2983" aria-hidden="true" tabindex="-1"></a>B. Dividing items into two halves, computing correlation, and applying Spearman-Brown correction  </span>
<span id="cb375-2984"><a href="#cb375-2984" aria-hidden="true" tabindex="-1"></a>C. Removing half the sample  </span>
<span id="cb375-2985"><a href="#cb375-2985" aria-hidden="true" tabindex="-1"></a>D. Using different raters</span>
<span id="cb375-2986"><a href="#cb375-2986" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2987"><a href="#cb375-2987" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-2988"><a href="#cb375-2988" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2989"><a href="#cb375-2989" aria-hidden="true" tabindex="-1"></a>**Q10.** A scale shows Î±=âˆ’0.15. What is the most likely cause?</span>
<span id="cb375-2990"><a href="#cb375-2990" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2991"><a href="#cb375-2991" aria-hidden="true" tabindex="-1"></a>A. Perfect reliability  </span>
<span id="cb375-2992"><a href="#cb375-2992" aria-hidden="true" tabindex="-1"></a>B. Reverse-coded items not properly recoded, or items measuring different constructs  </span>
<span id="cb375-2993"><a href="#cb375-2993" aria-hidden="true" tabindex="-1"></a>C. Sample size too large  </span>
<span id="cb375-2994"><a href="#cb375-2994" aria-hidden="true" tabindex="-1"></a>D. Normal distribution</span>
<span id="cb375-2995"><a href="#cb375-2995" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2996"><a href="#cb375-2996" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb375-2997"><a href="#cb375-2997" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2998"><a href="#cb375-2998" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip icon=false collapse="true"}</span>
<span id="cb375-2999"><a href="#cb375-2999" aria-hidden="true" tabindex="-1"></a><span class="fu">## Answers and Explanations</span></span>
<span id="cb375-3000"><a href="#cb375-3000" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3001"><a href="#cb375-3001" aria-hidden="true" tabindex="-1"></a>**Q1. Answer: B**  </span>
<span id="cb375-3002"><a href="#cb375-3002" aria-hidden="true" tabindex="-1"></a>*Explanation*: Cronbach's alpha quantifies internal consistency by comparing item variances to total scale variance. It indicates whether items measure a common construct. The chapter states: "Cronbach's alpha estimates internal consistency by comparing item variances to total scale variance."</span>
<span id="cb375-3003"><a href="#cb375-3003" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3004"><a href="#cb375-3004" aria-hidden="true" tabindex="-1"></a>**Q2. Answer: B**  </span>
<span id="cb375-3005"><a href="#cb375-3005" aria-hidden="true" tabindex="-1"></a>*Explanation*: Alpha assumes all items contribute equally to the construct (tau-equivalence). When items have varying loadings, alpha may underestimate reliability. McDonald's omega relaxes this assumption. The chapter explicitly notes alpha "assumes that all items measure a single underlying construct with equal factor loadings (tau-equivalent model)."</span>
<span id="cb375-3006"><a href="#cb375-3006" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3007"><a href="#cb375-3007" aria-hidden="true" tabindex="-1"></a>**Q3. Answer: B**  </span>
<span id="cb375-3008"><a href="#cb375-3008" aria-hidden="true" tabindex="-1"></a>*Explanation*: Alpha depends on scale length; 3-item scales often yield Î±=0.50-0.65 even when internally consistent. Check: (1) item-total correlations (all &gt;0.30?), (2) alpha's 95% CI (precision), (3) conceptual coherence. For exploratory work, Î±=0.55 may be acceptable. This reflects the chapter's nuanced guidance about context-dependent thresholds rather than rigid cutoffs.</span>
<span id="cb375-3009"><a href="#cb375-3009" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3010"><a href="#cb375-3010" aria-hidden="true" tabindex="-1"></a>**Q4. Answer: B**  </span>
<span id="cb375-3011"><a href="#cb375-3011" aria-hidden="true" tabindex="-1"></a>*Explanation*: Omega (Ï‰_total) allows items to have different factor loadings, providing a more accurate reliability estimate when tau-equivalence does not hold. The chapter states: "McDonald's omega (Ï‰â‚œ) is an alternative to alpha that relaxes the tau-equivalence assumption."</span>
<span id="cb375-3012"><a href="#cb375-3012" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3013"><a href="#cb375-3013" aria-hidden="true" tabindex="-1"></a>**Q5. Answer: A**  </span>
<span id="cb375-3014"><a href="#cb375-3014" aria-hidden="true" tabindex="-1"></a>*Explanation*: Corrected item-total correlation indicates how strongly each item relates to the overall scale. Values &lt;0.30 suggest the item measures something different or is poorly worded. The lab practical emphasizes examining item-total correlations as a diagnostic tool.</span>
<span id="cb375-3015"><a href="#cb375-3015" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3016"><a href="#cb375-3016" aria-hidden="true" tabindex="-1"></a>**Q6. Answer: B**  </span>
<span id="cb375-3017"><a href="#cb375-3017" aria-hidden="true" tabindex="-1"></a>*Explanation*: If alpha increases substantially when an item is removed, that item is weakening internal consistency (low correlation with others or measuring a different construct). Consider revising or removing it. This is a standard feature of reliability analysis output used to identify problematic items.</span>
<span id="cb375-3018"><a href="#cb375-3018" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3019"><a href="#cb375-3019" aria-hidden="true" tabindex="-1"></a>**Q7. Answer: B**  </span>
<span id="cb375-3020"><a href="#cb375-3020" aria-hidden="true" tabindex="-1"></a>*Explanation*: Polychoric correlations assume ordinal responses arise from categorizing underlying continuous variables. They often yield higher estimates than Pearson correlations for Likert data, but require adequate sample size (nâ‰¥50 preferred). The chapter discusses polychoric correlations as theoretically appropriate for ordinal items.</span>
<span id="cb375-3021"><a href="#cb375-3021" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3022"><a href="#cb375-3022" aria-hidden="true" tabindex="-1"></a>**Q8. Answer: B**  </span>
<span id="cb375-3023"><a href="#cb375-3023" aria-hidden="true" tabindex="-1"></a>*Explanation*: The point estimate (0.72) suggests acceptable reliability, but the wide CI reflects substantial uncertainty with n=36. The true population alpha could be as low as 0.52 (questionable) or as high as 0.86 (good). The chapter emphasizes that "small samples produce imprecise reliability estimates with wide confidence intervals."</span>
<span id="cb375-3024"><a href="#cb375-3024" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3025"><a href="#cb375-3025" aria-hidden="true" tabindex="-1"></a>**Q9. Answer: B**  </span>
<span id="cb375-3026"><a href="#cb375-3026" aria-hidden="true" tabindex="-1"></a>*Explanation*: Split-half reliability divides a scale into two halves (e.g., odd vs even items), correlates the half-scores, then adjusts using the Spearman-Brown formula to estimate full-scale reliability. This is a classic alternative method for assessing reliability mentioned in the learning objectives.</span>
<span id="cb375-3027"><a href="#cb375-3027" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3028"><a href="#cb375-3028" aria-hidden="true" tabindex="-1"></a>**Q10. Answer: B**  </span>
<span id="cb375-3029"><a href="#cb375-3029" aria-hidden="true" tabindex="-1"></a>*Explanation*: Negative alpha indicates items are negatively correlated with each otherâ€”usually because reverse-coded items weren't recoded (e.g., item 4 = "I intend to quit" on a job satisfaction scale). Check inter-item correlations for negative values. This is a common practical problem in survey research that the chapter addresses.</span>
<span id="cb375-3030"><a href="#cb375-3030" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3031"><a href="#cb375-3031" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb375-3032"><a href="#cb375-3032" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3033"><a href="#cb375-3033" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-3034"><a href="#cb375-3034" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3035"><a href="#cb375-3035" aria-hidden="true" tabindex="-1"></a><span class="fu">### Key Takeaways</span></span>
<span id="cb375-3036"><a href="#cb375-3036" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3037"><a href="#cb375-3037" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Cronbach's alpha and McDonald's omega quantify internal consistency for multi-item scales.</span>
<span id="cb375-3038"><a href="#cb375-3038" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Short scales (3â€“5 items) yield lower reliability estimates than longer scales, even when items are internally consistent.</span>
<span id="cb375-3039"><a href="#cb375-3039" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Small samples produce imprecise reliability estimates with wide confidence intervals.</span>
<span id="cb375-3040"><a href="#cb375-3040" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Polychoric correlations are theoretically appropriate for ordinal items but require adequate sample sizes.</span>
<span id="cb375-3041"><a href="#cb375-3041" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Reliability should be reported transparently, with acknowledgement of limitations and implications for interpretation.</span>
<span id="cb375-3042"><a href="#cb375-3042" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Low reliability attenuates observed effect sizes and reduces power; researchers should interpret findings cautiously and advocate for scale development when feasible.</span>
<span id="cb375-3043"><a href="#cb375-3043" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3044"><a href="#cb375-3044" aria-hidden="true" tabindex="-1"></a><span class="fu">### Smoke Test</span></span>
<span id="cb375-3045"><a href="#cb375-3045" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3048"><a href="#cb375-3048" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb375-3049"><a href="#cb375-3049" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: part-c-chunk-27</span></span>
<span id="cb375-3050"><a href="#cb375-3050" aria-hidden="true" tabindex="-1"></a><span class="co"># Re-run alpha on simple dataset</span></span>
<span id="cb375-3051"><a href="#cb375-3051" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb375-3052"><a href="#cb375-3052" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb375-3053"><a href="#cb375-3053" aria-hidden="true" tabindex="-1"></a>test_items <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb375-3054"><a href="#cb375-3054" aria-hidden="true" tabindex="-1"></a>  <span class="at">item1 =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">20</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb375-3055"><a href="#cb375-3055" aria-hidden="true" tabindex="-1"></a>  <span class="at">item2 =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">20</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb375-3056"><a href="#cb375-3056" aria-hidden="true" tabindex="-1"></a>  <span class="at">item3 =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">20</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb375-3057"><a href="#cb375-3057" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb375-3058"><a href="#cb375-3058" aria-hidden="true" tabindex="-1"></a><span class="fu">alpha</span>(test_items)</span>
<span id="cb375-3059"><a href="#cb375-3059" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-3060"><a href="#cb375-3060" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3061"><a href="#cb375-3061" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-3062"><a href="#cb375-3062" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3063"><a href="#cb375-3063" aria-hidden="true" tabindex="-1"></a><span class="fu">## Chapter 6.5. Developing Short Scales for Small Samples</span></span>
<span id="cb375-3064"><a href="#cb375-3064" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3065"><a href="#cb375-3065" aria-hidden="true" tabindex="-1"></a><span class="fu">### Learning Objectives</span></span>
<span id="cb375-3066"><a href="#cb375-3066" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3067"><a href="#cb375-3067" aria-hidden="true" tabindex="-1"></a>By the end of this section, you will understand the iterative process of scale development when working with small samples. You will learn what analyses are feasible at different sample sizes, how to identify problematic items early, and when to defer advanced psychometric analyses until larger validation studies are possible.</span>
<span id="cb375-3068"><a href="#cb375-3068" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3069"><a href="#cb375-3069" aria-hidden="true" tabindex="-1"></a><span class="fu">### The Scale Development Lifecycle</span></span>
<span id="cb375-3070"><a href="#cb375-3070" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3071"><a href="#cb375-3071" aria-hidden="true" tabindex="-1"></a>Scale development is inherently a multi-stage process. With small samples, researchers must be strategic about which psychometric analyses to conduct at each stage and which to reserve for later validation.</span>
<span id="cb375-3072"><a href="#cb375-3072" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3073"><a href="#cb375-3073" aria-hidden="true" tabindex="-1"></a><span class="fu">### The Iterative Process</span></span>
<span id="cb375-3074"><a href="#cb375-3074" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3075"><a href="#cb375-3075" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Stage 1: Item Generation (n = 5â€“10 cognitive interviews)</span></span>
<span id="cb375-3076"><a href="#cb375-3076" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3077"><a href="#cb375-3077" aria-hidden="true" tabindex="-1"></a>**Goal**: Generate a pool of 2â€“3Ã— your target number of items and ensure they are comprehensible.</span>
<span id="cb375-3078"><a href="#cb375-3078" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3079"><a href="#cb375-3079" aria-hidden="true" tabindex="-1"></a>**Methods**:</span>
<span id="cb375-3080"><a href="#cb375-3080" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3081"><a href="#cb375-3081" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Literature review**: Identify existing scales and adapt items</span>
<span id="cb375-3082"><a href="#cb375-3082" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Expert consultation**: Subject matter experts suggest relevant content</span>
<span id="cb375-3083"><a href="#cb375-3083" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Cognitive interviews**: Think-aloud protocols with 5â€“10 participants from the target population</span>
<span id="cb375-3084"><a href="#cb375-3084" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3085"><a href="#cb375-3085" aria-hidden="true" tabindex="-1"></a>**Example**:</span>
<span id="cb375-3086"><a href="#cb375-3086" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3089"><a href="#cb375-3089" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb375-3090"><a href="#cb375-3090" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: part-c-scale-dev-1</span></span>
<span id="cb375-3091"><a href="#cb375-3091" aria-hidden="true" tabindex="-1"></a><span class="co"># Documenting item generation</span></span>
<span id="cb375-3092"><a href="#cb375-3092" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb375-3093"><a href="#cb375-3093" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3094"><a href="#cb375-3094" aria-hidden="true" tabindex="-1"></a>item_pool <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb375-3095"><a href="#cb375-3095" aria-hidden="true" tabindex="-1"></a>  <span class="at">item_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>,</span>
<span id="cb375-3096"><a href="#cb375-3096" aria-hidden="true" tabindex="-1"></a>  <span class="at">item_text =</span> <span class="fu">c</span>(</span>
<span id="cb375-3097"><a href="#cb375-3097" aria-hidden="true" tabindex="-1"></a>    <span class="st">"I feel confident handling work challenges"</span>,</span>
<span id="cb375-3098"><a href="#cb375-3098" aria-hidden="true" tabindex="-1"></a>    <span class="st">"I bounce back quickly from setbacks"</span>,</span>
<span id="cb375-3099"><a href="#cb375-3099" aria-hidden="true" tabindex="-1"></a>    <span class="st">"I maintain composure under pressure"</span>,</span>
<span id="cb375-3100"><a href="#cb375-3100" aria-hidden="true" tabindex="-1"></a>    <span class="st">"I remain calm when facing obstacles"</span>,</span>
<span id="cb375-3101"><a href="#cb375-3101" aria-hidden="true" tabindex="-1"></a>    <span class="st">"I trust my ability to solve problems"</span>,</span>
<span id="cb375-3102"><a href="#cb375-3102" aria-hidden="true" tabindex="-1"></a>    <span class="st">"I recover from stress effectively"</span>,</span>
<span id="cb375-3103"><a href="#cb375-3103" aria-hidden="true" tabindex="-1"></a>    <span class="st">"I rebound after difficult situations"</span>,</span>
<span id="cb375-3104"><a href="#cb375-3104" aria-hidden="true" tabindex="-1"></a>    <span class="st">"I regain focus after disruptions"</span>,</span>
<span id="cb375-3105"><a href="#cb375-3105" aria-hidden="true" tabindex="-1"></a>    <span class="st">"I process setbacks constructively"</span>,</span>
<span id="cb375-3106"><a href="#cb375-3106" aria-hidden="true" tabindex="-1"></a>    <span class="st">"I maintain perspective during challenges"</span>,</span>
<span id="cb375-3107"><a href="#cb375-3107" aria-hidden="true" tabindex="-1"></a>    <span class="st">"I adapt easily to changing priorities"</span>,</span>
<span id="cb375-3108"><a href="#cb375-3108" aria-hidden="true" tabindex="-1"></a>    <span class="st">"I adjust my approach when needed"</span>,</span>
<span id="cb375-3109"><a href="#cb375-3109" aria-hidden="true" tabindex="-1"></a>    <span class="st">"I seek support when needed"</span>,</span>
<span id="cb375-3110"><a href="#cb375-3110" aria-hidden="true" tabindex="-1"></a>    <span class="st">"I learn from difficult experiences"</span>,</span>
<span id="cb375-3111"><a href="#cb375-3111" aria-hidden="true" tabindex="-1"></a>    <span class="st">"I embrace new work demands"</span></span>
<span id="cb375-3112"><a href="#cb375-3112" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb375-3113"><a href="#cb375-3113" aria-hidden="true" tabindex="-1"></a>  <span class="at">domain =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Confidence"</span>, <span class="st">"Recovery"</span>, <span class="st">"Adaptability"</span>), <span class="at">each =</span> <span class="dv">5</span>),</span>
<span id="cb375-3114"><a href="#cb375-3114" aria-hidden="true" tabindex="-1"></a>  <span class="at">cognitive_issues =</span> <span class="fu">c</span>(</span>
<span id="cb375-3115"><a href="#cb375-3115" aria-hidden="true" tabindex="-1"></a>    <span class="cn">NA</span>, <span class="st">"Ambiguous: what counts as 'quickly'?"</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>,</span>
<span id="cb375-3116"><a href="#cb375-3116" aria-hidden="true" tabindex="-1"></a>    <span class="cn">NA</span>, <span class="st">"Too similar to item 2"</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>,</span>
<span id="cb375-3117"><a href="#cb375-3117" aria-hidden="true" tabindex="-1"></a>    <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="st">"Double-barreled: 'seek' and 'support'"</span>, <span class="cn">NA</span>, <span class="cn">NA</span></span>
<span id="cb375-3118"><a href="#cb375-3118" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb375-3119"><a href="#cb375-3119" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb375-3120"><a href="#cb375-3120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3121"><a href="#cb375-3121" aria-hidden="true" tabindex="-1"></a><span class="co"># Flag items with comprehension issues</span></span>
<span id="cb375-3122"><a href="#cb375-3122" aria-hidden="true" tabindex="-1"></a>item_pool <span class="sc">%&gt;%</span></span>
<span id="cb375-3123"><a href="#cb375-3123" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(cognitive_issues)) <span class="sc">%&gt;%</span></span>
<span id="cb375-3124"><a href="#cb375-3124" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(item_id, item_text, cognitive_issues)</span>
<span id="cb375-3125"><a href="#cb375-3125" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-3126"><a href="#cb375-3126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3127"><a href="#cb375-3127" aria-hidden="true" tabindex="-1"></a>**Key Point**: At this stage, **do NOT collect quantitative data**. Focus on qualitative feedback about item clarity, relevance, and comprehensiveness.</span>
<span id="cb375-3128"><a href="#cb375-3128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3129"><a href="#cb375-3129" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Stage 2: Pilot Testing (n = 20â€“30)</span></span>
<span id="cb375-3130"><a href="#cb375-3130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3131"><a href="#cb375-3131" aria-hidden="true" tabindex="-1"></a>**Goal**: Identify problematic items before committing to a larger study.</span>
<span id="cb375-3132"><a href="#cb375-3132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3133"><a href="#cb375-3133" aria-hidden="true" tabindex="-1"></a>**Methods**:</span>
<span id="cb375-3134"><a href="#cb375-3134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3135"><a href="#cb375-3135" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Administer all items to a small pilot sample</span>
<span id="cb375-3136"><a href="#cb375-3136" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Compute **item-total correlations** (r.cor)</span>
<span id="cb375-3137"><a href="#cb375-3137" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Check for **ceiling/floor effects** (&gt; 80% at extreme response)</span>
<span id="cb375-3138"><a href="#cb375-3138" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Examine **item means and SDs** (avoid items with no variance)</span>
<span id="cb375-3139"><a href="#cb375-3139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3140"><a href="#cb375-3140" aria-hidden="true" tabindex="-1"></a>**What you CAN do with n = 20â€“30**:</span>
<span id="cb375-3141"><a href="#cb375-3141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3144"><a href="#cb375-3144" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb375-3145"><a href="#cb375-3145" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: part-c-scale-dev-2</span></span>
<span id="cb375-3146"><a href="#cb375-3146" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb375-3147"><a href="#cb375-3147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3148"><a href="#cb375-3148" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulated pilot data: 25 participants, 12 items</span></span>
<span id="cb375-3149"><a href="#cb375-3149" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb375-3150"><a href="#cb375-3150" aria-hidden="true" tabindex="-1"></a>pilot_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb375-3151"><a href="#cb375-3151" aria-hidden="true" tabindex="-1"></a>  <span class="at">WRS1 =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">25</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="fl">0.3</span>, <span class="fl">0.4</span>, <span class="fl">0.15</span>)),</span>
<span id="cb375-3152"><a href="#cb375-3152" aria-hidden="true" tabindex="-1"></a>  <span class="at">WRS2 =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">25</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.15</span>, <span class="fl">0.35</span>, <span class="fl">0.3</span>, <span class="fl">0.1</span>)),</span>
<span id="cb375-3153"><a href="#cb375-3153" aria-hidden="true" tabindex="-1"></a>  <span class="at">WRS3 =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">25</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="fl">0.25</span>, <span class="fl">0.45</span>, <span class="fl">0.15</span>)),</span>
<span id="cb375-3154"><a href="#cb375-3154" aria-hidden="true" tabindex="-1"></a>  <span class="at">WRS4 =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">25</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="fl">0.3</span>, <span class="fl">0.4</span>, <span class="fl">0.15</span>)),</span>
<span id="cb375-3155"><a href="#cb375-3155" aria-hidden="true" tabindex="-1"></a>  <span class="at">WRS5 =</span> <span class="fu">rep</span>(<span class="dv">5</span>, <span class="dv">25</span>),  <span class="co"># Ceiling effect item</span></span>
<span id="cb375-3156"><a href="#cb375-3156" aria-hidden="true" tabindex="-1"></a>  <span class="at">WRS6 =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">25</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.15</span>, <span class="fl">0.3</span>, <span class="fl">0.35</span>, <span class="fl">0.1</span>)),</span>
<span id="cb375-3157"><a href="#cb375-3157" aria-hidden="true" tabindex="-1"></a>  <span class="at">WRS7 =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">25</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.15</span>, <span class="fl">0.35</span>, <span class="fl">0.35</span>, <span class="fl">0.1</span>)),</span>
<span id="cb375-3158"><a href="#cb375-3158" aria-hidden="true" tabindex="-1"></a>  <span class="at">WRS8 =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">25</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),  <span class="co"># Weak item: uncorrelated</span></span>
<span id="cb375-3159"><a href="#cb375-3159" aria-hidden="true" tabindex="-1"></a>  <span class="at">WRS9 =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">25</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.15</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span>, <span class="fl">0.15</span>)),</span>
<span id="cb375-3160"><a href="#cb375-3160" aria-hidden="true" tabindex="-1"></a>  <span class="at">WRS10 =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">25</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="fl">0.35</span>, <span class="fl">0.4</span>, <span class="fl">0.1</span>)),</span>
<span id="cb375-3161"><a href="#cb375-3161" aria-hidden="true" tabindex="-1"></a>  <span class="at">WRS11 =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">25</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.15</span>, <span class="fl">0.3</span>, <span class="fl">0.35</span>, <span class="fl">0.1</span>)),</span>
<span id="cb375-3162"><a href="#cb375-3162" aria-hidden="true" tabindex="-1"></a>  <span class="at">WRS12 =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">25</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="fl">0.3</span>, <span class="fl">0.45</span>, <span class="fl">0.1</span>))</span>
<span id="cb375-3163"><a href="#cb375-3163" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb375-3164"><a href="#cb375-3164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3165"><a href="#cb375-3165" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute item-total correlations</span></span>
<span id="cb375-3166"><a href="#cb375-3166" aria-hidden="true" tabindex="-1"></a>pilot_alpha <span class="ot">&lt;-</span> <span class="fu">alpha</span>(pilot_data)</span>
<span id="cb375-3167"><a href="#cb375-3167" aria-hidden="true" tabindex="-1"></a>item_stats <span class="ot">&lt;-</span> pilot_alpha<span class="sc">$</span>item.stats</span>
<span id="cb375-3168"><a href="#cb375-3168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3169"><a href="#cb375-3169" aria-hidden="true" tabindex="-1"></a><span class="co"># Flag problematic items</span></span>
<span id="cb375-3170"><a href="#cb375-3170" aria-hidden="true" tabindex="-1"></a>item_stats <span class="sc">%&gt;%</span></span>
<span id="cb375-3171"><a href="#cb375-3171" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"Item"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb375-3172"><a href="#cb375-3172" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Item, r.cor, mean, sd) <span class="sc">%&gt;%</span></span>
<span id="cb375-3173"><a href="#cb375-3173" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb375-3174"><a href="#cb375-3174" aria-hidden="true" tabindex="-1"></a>    <span class="at">problem =</span> <span class="fu">case_when</span>(</span>
<span id="cb375-3175"><a href="#cb375-3175" aria-hidden="true" tabindex="-1"></a>      r.cor <span class="sc">&lt;</span> <span class="fl">0.30</span> <span class="sc">~</span> <span class="st">"Weak correlation"</span>,</span>
<span id="cb375-3176"><a href="#cb375-3176" aria-hidden="true" tabindex="-1"></a>      mean <span class="sc">&gt;</span> <span class="fl">4.5</span> <span class="sc">|</span> mean <span class="sc">&lt;</span> <span class="fl">1.5</span> <span class="sc">~</span> <span class="st">"Ceiling/floor effect"</span>,</span>
<span id="cb375-3177"><a href="#cb375-3177" aria-hidden="true" tabindex="-1"></a>      sd <span class="sc">&lt;</span> <span class="fl">0.5</span> <span class="sc">~</span> <span class="st">"Low variance"</span>,</span>
<span id="cb375-3178"><a href="#cb375-3178" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"OK"</span></span>
<span id="cb375-3179"><a href="#cb375-3179" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb375-3180"><a href="#cb375-3180" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb375-3181"><a href="#cb375-3181" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(problem <span class="sc">!=</span> <span class="st">"OK"</span>)</span>
<span id="cb375-3182"><a href="#cb375-3182" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-3183"><a href="#cb375-3183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3184"><a href="#cb375-3184" aria-hidden="true" tabindex="-1"></a>**Interpretation**:</span>
<span id="cb375-3185"><a href="#cb375-3185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3186"><a href="#cb375-3186" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**WRS5**: Ceiling effect (everyone answered 5). Remove or reword.</span>
<span id="cb375-3187"><a href="#cb375-3187" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**WRS8**: Weak item-total correlation (r &lt; 0.30). Consider dropping.</span>
<span id="cb375-3188"><a href="#cb375-3188" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Items with very low SD suggest participants don't differentiate; reword for clarity.</span>
<span id="cb375-3189"><a href="#cb375-3189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3190"><a href="#cb375-3190" aria-hidden="true" tabindex="-1"></a>**What you CANNOT do with n = 20â€“30**:</span>
<span id="cb375-3191"><a href="#cb375-3191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3192"><a href="#cb375-3192" aria-hidden="true" tabindex="-1"></a>::: {.callout-warning}</span>
<span id="cb375-3193"><a href="#cb375-3193" aria-hidden="true" tabindex="-1"></a><span class="fu">## Do NOT Compute Alpha with n &lt; 30</span></span>
<span id="cb375-3194"><a href="#cb375-3194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3195"><a href="#cb375-3195" aria-hidden="true" tabindex="-1"></a>Cronbach's alpha estimates are **highly unstable** with n &lt; 30. The 95% confidence interval will be extremely wide (e.g., <span class="co">[</span><span class="ot">0.40, 0.85</span><span class="co">]</span>), making the estimate nearly meaningless. </span>
<span id="cb375-3196"><a href="#cb375-3196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3197"><a href="#cb375-3197" aria-hidden="true" tabindex="-1"></a>**Instead**: Focus on item-level diagnostics (means, SDs, item-total correlations) to refine your scale. Defer reliability estimation to Stage 3.</span>
<span id="cb375-3198"><a href="#cb375-3198" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb375-3199"><a href="#cb375-3199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3200"><a href="#cb375-3200" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Stage 3: Refinement (n = 50â€“100)</span></span>
<span id="cb375-3201"><a href="#cb375-3201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3202"><a href="#cb375-3202" aria-hidden="true" tabindex="-1"></a>**Goal**: Estimate reliability and assess dimensionality.</span>
<span id="cb375-3203"><a href="#cb375-3203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3204"><a href="#cb375-3204" aria-hidden="true" tabindex="-1"></a>**Methods**:</span>
<span id="cb375-3205"><a href="#cb375-3205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3206"><a href="#cb375-3206" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Cronbach's alpha** with confidence intervals</span>
<span id="cb375-3207"><a href="#cb375-3207" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**McDonald's omega** (if you suspect multidimensionality)</span>
<span id="cb375-3208"><a href="#cb375-3208" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Split-half reliability** as a robustness check</span>
<span id="cb375-3209"><a href="#cb375-3209" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Exploratory Factor Analysis (EFA)** if n â‰¥ 100 and you suspect subscales</span>
<span id="cb375-3210"><a href="#cb375-3210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3211"><a href="#cb375-3211" aria-hidden="true" tabindex="-1"></a>**Example**:</span>
<span id="cb375-3212"><a href="#cb375-3212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3215"><a href="#cb375-3215" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb375-3216"><a href="#cb375-3216" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: part-c-scale-dev-3</span></span>
<span id="cb375-3217"><a href="#cb375-3217" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulated refinement data: 60 participants, 8 items (problematic items removed)</span></span>
<span id="cb375-3218"><a href="#cb375-3218" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb375-3219"><a href="#cb375-3219" aria-hidden="true" tabindex="-1"></a>refinement_data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">matrix</span>(</span>
<span id="cb375-3220"><a href="#cb375-3220" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">60</span> <span class="sc">*</span> <span class="dv">8</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.15</span>, <span class="fl">0.30</span>, <span class="fl">0.35</span>, <span class="fl">0.15</span>)),</span>
<span id="cb375-3221"><a href="#cb375-3221" aria-hidden="true" tabindex="-1"></a>  <span class="at">nrow =</span> <span class="dv">60</span>, <span class="at">ncol =</span> <span class="dv">8</span></span>
<span id="cb375-3222"><a href="#cb375-3222" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb375-3223"><a href="#cb375-3223" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(refinement_data) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"WRS"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>)</span>
<span id="cb375-3224"><a href="#cb375-3224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3225"><a href="#cb375-3225" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute alpha</span></span>
<span id="cb375-3226"><a href="#cb375-3226" aria-hidden="true" tabindex="-1"></a>alpha_result <span class="ot">&lt;-</span> <span class="fu">alpha</span>(refinement_data)</span>
<span id="cb375-3227"><a href="#cb375-3227" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Cronbach's alpha:"</span>, <span class="fu">round</span>(alpha_result<span class="sc">$</span>total<span class="sc">$</span>raw_alpha, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-3228"><a href="#cb375-3228" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Note: With n=60, alpha estimate is more stable than with n&lt;30</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-3229"><a href="#cb375-3229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3230"><a href="#cb375-3230" aria-hidden="true" tabindex="-1"></a><span class="co"># Split-half reliability</span></span>
<span id="cb375-3231"><a href="#cb375-3231" aria-hidden="true" tabindex="-1"></a>split_half <span class="ot">&lt;-</span> <span class="fu">splitHalf</span>(refinement_data)</span>
<span id="cb375-3232"><a href="#cb375-3232" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(split_half)</span>
<span id="cb375-3233"><a href="#cb375-3233" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-3234"><a href="#cb375-3234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3235"><a href="#cb375-3235" aria-hidden="true" tabindex="-1"></a>**Interpretation**:</span>
<span id="cb375-3236"><a href="#cb375-3236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3237"><a href="#cb375-3237" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Alpha â‰¥ 0.70 suggests adequate internal consistency for research purposes</span>
<span id="cb375-3238"><a href="#cb375-3238" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The confidence interval is still fairly wide (n = 60), but informative</span>
<span id="cb375-3239"><a href="#cb375-3239" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>If alpha &lt; 0.60, consider dropping more items or revising wording</span>
<span id="cb375-3240"><a href="#cb375-3240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3241"><a href="#cb375-3241" aria-hidden="true" tabindex="-1"></a>**Exploratory Factor Analysis (EFA)** with n = 50â€“100:</span>
<span id="cb375-3242"><a href="#cb375-3242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3245"><a href="#cb375-3245" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb375-3246"><a href="#cb375-3246" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: part-c-scale-dev-4</span></span>
<span id="cb375-3247"><a href="#cb375-3247" aria-hidden="true" tabindex="-1"></a><span class="co"># EFA requires n â‰¥ 100 ideally; with n=60, results are exploratory only</span></span>
<span id="cb375-3248"><a href="#cb375-3248" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate larger dataset for demonstration</span></span>
<span id="cb375-3249"><a href="#cb375-3249" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb375-3250"><a href="#cb375-3250" aria-hidden="true" tabindex="-1"></a>efa_data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">matrix</span>(</span>
<span id="cb375-3251"><a href="#cb375-3251" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">100</span> <span class="sc">*</span> <span class="dv">8</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.15</span>, <span class="fl">0.30</span>, <span class="fl">0.35</span>, <span class="fl">0.15</span>)),</span>
<span id="cb375-3252"><a href="#cb375-3252" aria-hidden="true" tabindex="-1"></a>  <span class="at">nrow =</span> <span class="dv">100</span>, <span class="at">ncol =</span> <span class="dv">8</span></span>
<span id="cb375-3253"><a href="#cb375-3253" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb375-3254"><a href="#cb375-3254" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(efa_data) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"WRS"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>)</span>
<span id="cb375-3255"><a href="#cb375-3255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3256"><a href="#cb375-3256" aria-hidden="true" tabindex="-1"></a><span class="co"># Scree plot to determine number of factors</span></span>
<span id="cb375-3257"><a href="#cb375-3257" aria-hidden="true" tabindex="-1"></a><span class="fu">scree</span>(efa_data, <span class="at">factors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb375-3258"><a href="#cb375-3258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3259"><a href="#cb375-3259" aria-hidden="true" tabindex="-1"></a><span class="co"># Parallel analysis (more robust than scree plot alone)</span></span>
<span id="cb375-3260"><a href="#cb375-3260" aria-hidden="true" tabindex="-1"></a><span class="fu">fa.parallel</span>(efa_data, <span class="at">fa =</span> <span class="st">"fa"</span>)</span>
<span id="cb375-3261"><a href="#cb375-3261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3262"><a href="#cb375-3262" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit 1-factor model</span></span>
<span id="cb375-3263"><a href="#cb375-3263" aria-hidden="true" tabindex="-1"></a>efa_result <span class="ot">&lt;-</span> <span class="fu">fa</span>(efa_data, <span class="at">nfactors =</span> <span class="dv">1</span>, <span class="at">rotate =</span> <span class="st">"oblimin"</span>)</span>
<span id="cb375-3264"><a href="#cb375-3264" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(efa_result<span class="sc">$</span>loadings, <span class="at">cutoff =</span> <span class="fl">0.3</span>)</span>
<span id="cb375-3265"><a href="#cb375-3265" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-3266"><a href="#cb375-3266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3267"><a href="#cb375-3267" aria-hidden="true" tabindex="-1"></a>**Caution**: With n &lt; 100, factor loadings and structure are unstable. Use EFA results as **preliminary guidance** for item grouping, not definitive evidence of subscales.</span>
<span id="cb375-3268"><a href="#cb375-3268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3269"><a href="#cb375-3269" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Stage 4: Validation (n = 150+)</span></span>
<span id="cb375-3270"><a href="#cb375-3270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3271"><a href="#cb375-3271" aria-hidden="true" tabindex="-1"></a>**Goal**: Confirm scale structure and establish validity.</span>
<span id="cb375-3272"><a href="#cb375-3272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3273"><a href="#cb375-3273" aria-hidden="true" tabindex="-1"></a>**Methods**:</span>
<span id="cb375-3274"><a href="#cb375-3274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3275"><a href="#cb375-3275" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Confirmatory Factor Analysis (CFA)**: Test hypothesized factor structure</span>
<span id="cb375-3276"><a href="#cb375-3276" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Test-retest reliability**: Administer scale twice (2â€“4 weeks apart)</span>
<span id="cb375-3277"><a href="#cb375-3277" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Convergent validity**: Correlate with theoretically related measures</span>
<span id="cb375-3278"><a href="#cb375-3278" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Discriminant validity**: Show low correlation with unrelated constructs</span>
<span id="cb375-3279"><a href="#cb375-3279" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Known-groups validity**: Scale discriminates between relevant groups</span>
<span id="cb375-3280"><a href="#cb375-3280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3281"><a href="#cb375-3281" aria-hidden="true" tabindex="-1"></a>**Example**:</span>
<span id="cb375-3282"><a href="#cb375-3282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3285"><a href="#cb375-3285" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb375-3286"><a href="#cb375-3286" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: part-c-scale-dev-5</span></span>
<span id="cb375-3287"><a href="#cb375-3287" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb375-3288"><a href="#cb375-3288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3289"><a href="#cb375-3289" aria-hidden="true" tabindex="-1"></a><span class="co"># CFA requires lavaan package and n â‰¥ 150</span></span>
<span id="cb375-3290"><a href="#cb375-3290" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lavaan)</span>
<span id="cb375-3291"><a href="#cb375-3291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3292"><a href="#cb375-3292" aria-hidden="true" tabindex="-1"></a><span class="co"># Define 1-factor model</span></span>
<span id="cb375-3293"><a href="#cb375-3293" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb375-3294"><a href="#cb375-3294" aria-hidden="true" tabindex="-1"></a><span class="st">  resilience =~ WRS1 + WRS2 + WRS3 + WRS4 + WRS5 + WRS6 + WRS7 + WRS8</span></span>
<span id="cb375-3295"><a href="#cb375-3295" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb375-3296"><a href="#cb375-3296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3297"><a href="#cb375-3297" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit model</span></span>
<span id="cb375-3298"><a href="#cb375-3298" aria-hidden="true" tabindex="-1"></a>cfa_result <span class="ot">&lt;-</span> <span class="fu">cfa</span>(model, <span class="at">data =</span> validation_data)</span>
<span id="cb375-3299"><a href="#cb375-3299" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(cfa_result, <span class="at">fit.measures =</span> <span class="cn">TRUE</span>, <span class="at">standardized =</span> <span class="cn">TRUE</span>)</span>
<span id="cb375-3300"><a href="#cb375-3300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3301"><a href="#cb375-3301" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit indices to assess model adequacy:</span></span>
<span id="cb375-3302"><a href="#cb375-3302" aria-hidden="true" tabindex="-1"></a><span class="co"># - CFI &gt; 0.90 (good fit)</span></span>
<span id="cb375-3303"><a href="#cb375-3303" aria-hidden="true" tabindex="-1"></a><span class="co"># - RMSEA &lt; 0.08 (acceptable fit)</span></span>
<span id="cb375-3304"><a href="#cb375-3304" aria-hidden="true" tabindex="-1"></a><span class="co"># - SRMR &lt; 0.08 (good fit)</span></span>
<span id="cb375-3305"><a href="#cb375-3305" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-3306"><a href="#cb375-3306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3307"><a href="#cb375-3307" aria-hidden="true" tabindex="-1"></a>**Test-retest reliability**:</span>
<span id="cb375-3308"><a href="#cb375-3308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3311"><a href="#cb375-3311" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb375-3312"><a href="#cb375-3312" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: part-c-scale-dev-6</span></span>
<span id="cb375-3313"><a href="#cb375-3313" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb375-3314"><a href="#cb375-3314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3315"><a href="#cb375-3315" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute scale scores at Time 1 and Time 2</span></span>
<span id="cb375-3316"><a href="#cb375-3316" aria-hidden="true" tabindex="-1"></a>validation_data <span class="ot">&lt;-</span> validation_data <span class="sc">%&gt;%</span></span>
<span id="cb375-3317"><a href="#cb375-3317" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb375-3318"><a href="#cb375-3318" aria-hidden="true" tabindex="-1"></a>    <span class="at">resilience_t1 =</span> <span class="fu">rowMeans</span>(<span class="fu">select</span>(., WRS1_t1<span class="sc">:</span>WRS8_t1)),</span>
<span id="cb375-3319"><a href="#cb375-3319" aria-hidden="true" tabindex="-1"></a>    <span class="at">resilience_t2 =</span> <span class="fu">rowMeans</span>(<span class="fu">select</span>(., WRS1_t2<span class="sc">:</span>WRS8_t2))</span>
<span id="cb375-3320"><a href="#cb375-3320" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb375-3321"><a href="#cb375-3321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3322"><a href="#cb375-3322" aria-hidden="true" tabindex="-1"></a><span class="co"># Intraclass correlation coefficient (ICC)</span></span>
<span id="cb375-3323"><a href="#cb375-3323" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(irr)</span>
<span id="cb375-3324"><a href="#cb375-3324" aria-hidden="true" tabindex="-1"></a>icc_result <span class="ot">&lt;-</span> <span class="fu">icc</span>(</span>
<span id="cb375-3325"><a href="#cb375-3325" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(validation_data<span class="sc">$</span>resilience_t1, validation_data<span class="sc">$</span>resilience_t2),</span>
<span id="cb375-3326"><a href="#cb375-3326" aria-hidden="true" tabindex="-1"></a>  <span class="at">model =</span> <span class="st">"twoway"</span>,</span>
<span id="cb375-3327"><a href="#cb375-3327" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"agreement"</span></span>
<span id="cb375-3328"><a href="#cb375-3328" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb375-3329"><a href="#cb375-3329" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(icc_result)</span>
<span id="cb375-3330"><a href="#cb375-3330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3331"><a href="#cb375-3331" aria-hidden="true" tabindex="-1"></a><span class="co"># ICC &gt; 0.75 indicates good test-retest reliability</span></span>
<span id="cb375-3332"><a href="#cb375-3332" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-3333"><a href="#cb375-3333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3334"><a href="#cb375-3334" aria-hidden="true" tabindex="-1"></a><span class="fu">### Special Considerations for n &lt; 50</span></span>
<span id="cb375-3335"><a href="#cb375-3335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3336"><a href="#cb375-3336" aria-hidden="true" tabindex="-1"></a><span class="fu">#### What You CANNOT Do</span></span>
<span id="cb375-3337"><a href="#cb375-3337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3338"><a href="#cb375-3338" aria-hidden="true" tabindex="-1"></a>::: {.callout-important}</span>
<span id="cb375-3339"><a href="#cb375-3339" aria-hidden="true" tabindex="-1"></a><span class="fu">## Analyses That Require Larger Samples</span></span>
<span id="cb375-3340"><a href="#cb375-3340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3341"><a href="#cb375-3341" aria-hidden="true" tabindex="-1"></a>::: {.callout-warning icon=true}</span>
<span id="cb375-3342"><a href="#cb375-3342" aria-hidden="true" tabindex="-1"></a><span class="fu">## âš ï¸ Do NOT Force Large-Sample Methods on Small Data</span></span>
<span id="cb375-3343"><a href="#cb375-3343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3344"><a href="#cb375-3344" aria-hidden="true" tabindex="-1"></a>With n &lt; 50, the following analyses are **not feasible** or will produce unreliable results:</span>
<span id="cb375-3345"><a href="#cb375-3345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3346"><a href="#cb375-3346" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Exploratory Factor Analysis (EFA)**: Rule of thumb is n â‰¥ 100 or 5â€“10 participants per item</span>
<span id="cb375-3347"><a href="#cb375-3347" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Confirmatory Factor Analysis (CFA)**: Requires n â‰¥ 150â€“200 for stable parameter estimates</span>
<span id="cb375-3348"><a href="#cb375-3348" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Measurement Invariance Testing**: Requires n â‰¥ 200 per group</span>
<span id="cb375-3349"><a href="#cb375-3349" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Structural Equation Modeling (SEM)**: Complex models need n â‰¥ 200â€“400</span>
<span id="cb375-3350"><a href="#cb375-3350" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>**PLS-SEM (Partial Least Squares SEM)**: Despite marketing claims, needs n â‰¥ 100 for reliable results</span>
<span id="cb375-3351"><a href="#cb375-3351" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span>**Item Response Theory (IRT)**: Most models require n â‰¥ 250â€“500</span>
<span id="cb375-3352"><a href="#cb375-3352" aria-hidden="true" tabindex="-1"></a><span class="ss">7. </span>**Reliable Cronbach's alpha**: With n &lt; 30, alpha estimates have 95% CIs spanning 0.3â€“0.4 units</span>
<span id="cb375-3353"><a href="#cb375-3353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3354"><a href="#cb375-3354" aria-hidden="true" tabindex="-1"></a>**Do NOT force these analyses** with inadequate sample sizes. Results will be misleading.</span>
<span id="cb375-3355"><a href="#cb375-3355" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb375-3356"><a href="#cb375-3356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3357"><a href="#cb375-3357" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-3358"><a href="#cb375-3358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3359"><a href="#cb375-3359" aria-hidden="true" tabindex="-1"></a>::: {.callout-note icon=false collapse=true}</span>
<span id="cb375-3360"><a href="#cb375-3360" aria-hidden="true" tabindex="-1"></a><span class="fu">## ðŸ“– Why Structural Equation Modeling (SEM) Requires Large Samples</span></span>
<span id="cb375-3361"><a href="#cb375-3361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3362"><a href="#cb375-3362" aria-hidden="true" tabindex="-1"></a>**Question**: "Can I use SEM, CFA, or PLS-SEM with my small sample (n &lt; 100)?"</span>
<span id="cb375-3363"><a href="#cb375-3363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3364"><a href="#cb375-3364" aria-hidden="true" tabindex="-1"></a>**Short Answer**: **No.** SEM-based methods require substantially larger samples than this book's target range (n = 10â€“100).</span>
<span id="cb375-3365"><a href="#cb375-3365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3366"><a href="#cb375-3366" aria-hidden="true" tabindex="-1"></a><span class="fu">### Minimum Sample Size Requirements</span></span>
<span id="cb375-3367"><a href="#cb375-3367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3368"><a href="#cb375-3368" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Method <span class="pp">|</span> Minimum n <span class="pp">|</span> Realistic n <span class="pp">|</span> Why? <span class="pp">|</span></span>
<span id="cb375-3369"><a href="#cb375-3369" aria-hidden="true" tabindex="-1"></a><span class="pp">|--------|-----------|-------------|------|</span></span>
<span id="cb375-3370"><a href="#cb375-3370" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Confirmatory Factor Analysis (CFA)** <span class="pp">|</span> 150 <span class="pp">|</span> 200-300 <span class="pp">|</span> Stable factor loadings, fit indices <span class="pp">|</span></span>
<span id="cb375-3371"><a href="#cb375-3371" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Structural Equation Modeling (SEM)** <span class="pp">|</span> 200 <span class="pp">|</span> 300-500 <span class="pp">|</span> Complex path models, multiple latent variables <span class="pp">|</span></span>
<span id="cb375-3372"><a href="#cb375-3372" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **PLS-SEM** <span class="pp">|</span> 100 <span class="pp">|</span> 150-300 <span class="pp">|</span> Despite "small-sample" marketing, needs 100+ for reliability <span class="pp">|</span></span>
<span id="cb375-3373"><a href="#cb375-3373" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Multi-Group SEM** <span class="pp">|</span> 200/group <span class="pp">|</span> 300/group <span class="pp">|</span> Measurement invariance testing <span class="pp">|</span></span>
<span id="cb375-3374"><a href="#cb375-3374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3375"><a href="#cb375-3375" aria-hidden="true" tabindex="-1"></a>**Rule of Thumb**: 10-20 observations per estimated parameter (e.g., 5 indicators + 3 paths = 8 parameters â†’ need 80-160 observations).</span>
<span id="cb375-3376"><a href="#cb375-3376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3377"><a href="#cb375-3377" aria-hidden="true" tabindex="-1"></a><span class="fu">### What Happens If You Ignore These Requirements?</span></span>
<span id="cb375-3378"><a href="#cb375-3378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3379"><a href="#cb375-3379" aria-hidden="true" tabindex="-1"></a>With n &lt; 100, SEM/CFA/PLS-SEM will produce:</span>
<span id="cb375-3380"><a href="#cb375-3380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3381"><a href="#cb375-3381" aria-hidden="true" tabindex="-1"></a>âŒ **Unstable Parameter Estimates**</span>
<span id="cb375-3382"><a href="#cb375-3382" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Factor loadings fluctuate wildly with small perturbations</span>
<span id="cb375-3383"><a href="#cb375-3383" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Path coefficients have huge standard errors</span>
<span id="cb375-3384"><a href="#cb375-3384" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Adding/removing 5 observations changes conclusions</span>
<span id="cb375-3385"><a href="#cb375-3385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3386"><a href="#cb375-3386" aria-hidden="true" tabindex="-1"></a>âŒ **Non-Convergent Solutions**</span>
<span id="cb375-3387"><a href="#cb375-3387" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Maximum likelihood fails to converge</span>
<span id="cb375-3388"><a href="#cb375-3388" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Heywood cases (negative variances, loadings &gt; 1.0)</span>
<span id="cb375-3389"><a href="#cb375-3389" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Improper solutions requiring arbitrary constraints</span>
<span id="cb375-3390"><a href="#cb375-3390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3391"><a href="#cb375-3391" aria-hidden="true" tabindex="-1"></a>âŒ **Unreliable Fit Indices**</span>
<span id="cb375-3392"><a href="#cb375-3392" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Ï‡Â², CFI, TLI, RMSEA become meaningless with small n</span>
<span id="cb375-3393"><a href="#cb375-3393" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>"Good fit" may be statistical artifact, not real model adequacy</span>
<span id="cb375-3394"><a href="#cb375-3394" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Modification indices unreliable (suggest spurious changes)</span>
<span id="cb375-3395"><a href="#cb375-3395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3396"><a href="#cb375-3396" aria-hidden="true" tabindex="-1"></a>âŒ **Overfit Models**</span>
<span id="cb375-3397"><a href="#cb375-3397" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Model fits sample perfectly but fails to generalize</span>
<span id="cb375-3398"><a href="#cb375-3398" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Cross-validation impossible (too few observations to split)</span>
<span id="cb375-3399"><a href="#cb375-3399" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Results won't replicate in new samples</span>
<span id="cb375-3400"><a href="#cb375-3400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3401"><a href="#cb375-3401" aria-hidden="true" tabindex="-1"></a>âŒ **False Confidence**</span>
<span id="cb375-3402"><a href="#cb375-3402" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Software produces output even when results are garbage</span>
<span id="cb375-3403"><a href="#cb375-3403" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>p-values and CIs misleadingly precise</span>
<span id="cb375-3404"><a href="#cb375-3404" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Reviewers will reject papers citing insufficient sample size</span>
<span id="cb375-3405"><a href="#cb375-3405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3406"><a href="#cb375-3406" aria-hidden="true" tabindex="-1"></a><span class="fu">### What Should You Do Instead? (For n &lt; 100)</span></span>
<span id="cb375-3407"><a href="#cb375-3407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3408"><a href="#cb375-3408" aria-hidden="true" tabindex="-1"></a>**Use the methods in THIS book:**</span>
<span id="cb375-3409"><a href="#cb375-3409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3410"><a href="#cb375-3410" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> SEM Goal <span class="pp">|</span> Small-Sample Alternative <span class="pp">|</span> Chapter <span class="pp">|</span> Minimum n <span class="pp">|</span></span>
<span id="cb375-3411"><a href="#cb375-3411" aria-hidden="true" tabindex="-1"></a><span class="pp">|----------|-------------------------|---------|-----------|</span></span>
<span id="cb375-3412"><a href="#cb375-3412" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Assess scale reliability** <span class="pp">|</span> Cronbach's Î±, McDonald's Ï‰, split-half <span class="pp">|</span> Ch 6 <span class="pp">|</span> 30-50 <span class="pp">|</span></span>
<span id="cb375-3413"><a href="#cb375-3413" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Validate items** <span class="pp">|</span> Item-total correlations, alpha-if-deleted <span class="pp">|</span> Ch 6 <span class="pp">|</span> 30-50 <span class="pp">|</span></span>
<span id="cb375-3414"><a href="#cb375-3414" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Reduce dimensionality** | **Sum/mean composite scores** <span class="pp">|</span> Ch 6 <span class="pp">|</span> 20+ <span class="pp">|</span></span>
<span id="cb375-3415"><a href="#cb375-3415" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Test relationships (X â†’ Y)** <span class="pp">|</span> Regression with composite scores <span class="pp">|</span> Ch 5 <span class="pp">|</span> 30-50 <span class="pp">|</span></span>
<span id="cb375-3416"><a href="#cb375-3416" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Multiple predictors** <span class="pp">|</span> Penalized regression (ridge/lasso/elastic net) <span class="pp">|</span> Ch 5 Lab 5.2 <span class="pp">|</span> 50-100 <span class="pp">|</span></span>
<span id="cb375-3417"><a href="#cb375-3417" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Mediation (X â†’ M â†’ Y)** <span class="pp">|</span> Simple mediation with bootstrap CIs <span class="pp">|</span> Part E Project 5 <span class="pp">|</span> 80-100 <span class="pp">|</span></span>
<span id="cb375-3418"><a href="#cb375-3418" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Latent correlations** <span class="pp">|</span> Polychoric correlations (exploratory) <span class="pp">|</span> Ch 6 <span class="pp">|</span> 50+ <span class="pp">|</span></span>
<span id="cb375-3419"><a href="#cb375-3419" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Measurement precision** <span class="pp">|</span> Standard Error of Measurement (SEM statistic) <span class="pp">|</span> Ch 6 <span class="pp">|</span> 30+ <span class="pp">|</span></span>
<span id="cb375-3420"><a href="#cb375-3420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3421"><a href="#cb375-3421" aria-hidden="true" tabindex="-1"></a>**Key Principle**: **Composite scores are your friend.**</span>
<span id="cb375-3422"><a href="#cb375-3422" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Sum or average your scale items to create observed composite variables</span>
<span id="cb375-3423"><a href="#cb375-3423" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Use these composites in regression, t-tests, ANOVA</span>
<span id="cb375-3424"><a href="#cb375-3424" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Acknowledge measurement error in limitations section</span>
<span id="cb375-3425"><a href="#cb375-3425" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Plan larger validation study (n â‰¥ 200) for future CFA/SEM</span>
<span id="cb375-3426"><a href="#cb375-3426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3427"><a href="#cb375-3427" aria-hidden="true" tabindex="-1"></a><span class="fu">### Example: Replacing SEM with Composite-Score Analysis</span></span>
<span id="cb375-3428"><a href="#cb375-3428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3429"><a href="#cb375-3429" aria-hidden="true" tabindex="-1"></a>**Proposed SEM Model (n = 60):**</span>
<span id="cb375-3430"><a href="#cb375-3430" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-3431"><a href="#cb375-3431" aria-hidden="true" tabindex="-1"></a><span class="in">Job_Satisfaction (5 items) â†’ Turnover_Intent (3 items)</span></span>
<span id="cb375-3432"><a href="#cb375-3432" aria-hidden="true" tabindex="-1"></a><span class="in">     â†‘</span></span>
<span id="cb375-3433"><a href="#cb375-3433" aria-hidden="true" tabindex="-1"></a><span class="in">Performance (4 items)</span></span>
<span id="cb375-3434"><a href="#cb375-3434" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-3435"><a href="#cb375-3435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3436"><a href="#cb375-3436" aria-hidden="true" tabindex="-1"></a>**Small-Sample Alternative:**</span>
<span id="cb375-3437"><a href="#cb375-3437" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb375-3438"><a href="#cb375-3438" aria-hidden="true" tabindex="-1"></a><span class="co"># Create composite scores by averaging items</span></span>
<span id="cb375-3439"><a href="#cb375-3439" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb375-3440"><a href="#cb375-3440" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb375-3441"><a href="#cb375-3441" aria-hidden="true" tabindex="-1"></a>    <span class="at">satisfaction =</span> <span class="fu">rowMeans</span>(<span class="fu">select</span>(., satisfaction_1<span class="sc">:</span>satisfaction_5)),</span>
<span id="cb375-3442"><a href="#cb375-3442" aria-hidden="true" tabindex="-1"></a>    <span class="at">performance =</span> <span class="fu">rowMeans</span>(<span class="fu">select</span>(., performance_1<span class="sc">:</span>performance_4)),</span>
<span id="cb375-3443"><a href="#cb375-3443" aria-hidden="true" tabindex="-1"></a>    <span class="at">turnover =</span> <span class="fu">rowMeans</span>(<span class="fu">select</span>(., turnover_1<span class="sc">:</span>turnover_3))</span>
<span id="cb375-3444"><a href="#cb375-3444" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb375-3445"><a href="#cb375-3445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3446"><a href="#cb375-3446" aria-hidden="true" tabindex="-1"></a><span class="co"># Test relationships with standard regression</span></span>
<span id="cb375-3447"><a href="#cb375-3447" aria-hidden="true" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(turnover <span class="sc">~</span> satisfaction, <span class="at">data =</span> data)</span>
<span id="cb375-3448"><a href="#cb375-3448" aria-hidden="true" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(turnover <span class="sc">~</span> satisfaction <span class="sc">+</span> performance, <span class="at">data =</span> data)</span>
<span id="cb375-3449"><a href="#cb375-3449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3450"><a href="#cb375-3450" aria-hidden="true" tabindex="-1"></a><span class="co"># Report coefficients, RÂ², confidence intervals</span></span>
<span id="cb375-3451"><a href="#cb375-3451" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-3452"><a href="#cb375-3452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3453"><a href="#cb375-3453" aria-hidden="true" tabindex="-1"></a>**Advantages**:</span>
<span id="cb375-3454"><a href="#cb375-3454" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ… Works with n = 60</span>
<span id="cb375-3455"><a href="#cb375-3455" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ… Interpretable (unit change in averaged scale score)</span>
<span id="cb375-3456"><a href="#cb375-3456" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ… Robust (doesn't require distributional assumptions for latent variables)</span>
<span id="cb375-3457"><a href="#cb375-3457" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ… Honest (acknowledges you're using observed composites, not latent variables)</span>
<span id="cb375-3458"><a href="#cb375-3458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3459"><a href="#cb375-3459" aria-hidden="true" tabindex="-1"></a>**Limitations to Acknowledge**:</span>
<span id="cb375-3460"><a href="#cb375-3460" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Composites contain measurement error (but so does SEM with n &lt; 150!)</span>
<span id="cb375-3461"><a href="#cb375-3461" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Cannot test complex factor structures</span>
<span id="cb375-3462"><a href="#cb375-3462" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Cannot partition within-item vs. between-item variance</span>
<span id="cb375-3463"><a href="#cb375-3463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3464"><a href="#cb375-3464" aria-hidden="true" tabindex="-1"></a>**When to Pursue SEM**: Collect n â‰¥ 200 in a follow-up study. Then:</span>
<span id="cb375-3465"><a href="#cb375-3465" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Use EFA to explore factor structure (if theory is unclear)</span>
<span id="cb375-3466"><a href="#cb375-3466" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Use CFA to confirm measurement model</span>
<span id="cb375-3467"><a href="#cb375-3467" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Test structural paths with latent variables</span>
<span id="cb375-3468"><a href="#cb375-3468" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Assess model fit rigorously</span>
<span id="cb375-3469"><a href="#cb375-3469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3470"><a href="#cb375-3470" aria-hidden="true" tabindex="-1"></a><span class="fu">### Software Will Let You Do Bad Things</span></span>
<span id="cb375-3471"><a href="#cb375-3471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3472"><a href="#cb375-3472" aria-hidden="true" tabindex="-1"></a>**Warning**: SmartPLS, AMOS, Mplus, and other SEM software will happily run with n = 50. They will produce:</span>
<span id="cb375-3473"><a href="#cb375-3473" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Parameter estimates</span>
<span id="cb375-3474"><a href="#cb375-3474" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>p-values</span>
<span id="cb375-3475"><a href="#cb375-3475" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Fit indices</span>
<span id="cb375-3476"><a href="#cb375-3476" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Pretty path diagrams</span>
<span id="cb375-3477"><a href="#cb375-3477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3478"><a href="#cb375-3478" aria-hidden="true" tabindex="-1"></a>**This does NOT mean the results are trustworthy.** Software cannot judge whether your sample size is adequateâ€”**you must.**</span>
<span id="cb375-3479"><a href="#cb375-3479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3480"><a href="#cb375-3480" aria-hidden="true" tabindex="-1"></a><span class="fu">### Recommended Reading (For Future Large-Sample Studies)</span></span>
<span id="cb375-3481"><a href="#cb375-3481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3482"><a href="#cb375-3482" aria-hidden="true" tabindex="-1"></a>When you collect n â‰¥ 200, consult these resources:</span>
<span id="cb375-3483"><a href="#cb375-3483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3484"><a href="#cb375-3484" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Kline, R. B. (2016).** *Principles and Practice of Structural Equation Modeling* (4th ed.). Guilford Press.</span>
<span id="cb375-3485"><a href="#cb375-3485" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Gold standard SEM textbook</span>
<span id="cb375-3486"><a href="#cb375-3486" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Sample size guidelines (pp. 15-18, 264-270)</span>
<span id="cb375-3487"><a href="#cb375-3487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3488"><a href="#cb375-3488" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Brown, T. A. (2015).** *Confirmatory Factor Analysis for Applied Research* (2nd ed.). Guilford Press.</span>
<span id="cb375-3489"><a href="#cb375-3489" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>CFA-specific guidance</span>
<span id="cb375-3490"><a href="#cb375-3490" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Measurement invariance testing</span>
<span id="cb375-3491"><a href="#cb375-3491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3492"><a href="#cb375-3492" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Hair, J. F., Hult, G. T. M., Ringle, C. M., &amp; Sarstedt, M. (2022).** *A Primer on Partial Least Squares Structural Equation Modeling (PLS-SEM)* (3rd ed.). Sage.</span>
<span id="cb375-3493"><a href="#cb375-3493" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>PLS-SEM methods (but note: still needs n â‰¥ 100-150 realistically)</span>
<span id="cb375-3494"><a href="#cb375-3494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3495"><a href="#cb375-3495" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Hoyle, R. H. (Ed.). (2023).** *Handbook of Structural Equation Modeling* (2nd ed.). Guilford Press.</span>
<span id="cb375-3496"><a href="#cb375-3496" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Advanced topics, sample size planning</span>
<span id="cb375-3497"><a href="#cb375-3497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3498"><a href="#cb375-3498" aria-hidden="true" tabindex="-1"></a><span class="fu">### Bottom Line</span></span>
<span id="cb375-3499"><a href="#cb375-3499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3500"><a href="#cb375-3500" aria-hidden="true" tabindex="-1"></a>**For n = 10â€“100, use the methods in this book.** They are:</span>
<span id="cb375-3501"><a href="#cb375-3501" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ… **Appropriate** for small samples</span>
<span id="cb375-3502"><a href="#cb375-3502" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ… **Robust** to violations of assumptions</span>
<span id="cb375-3503"><a href="#cb375-3503" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ… **Honest** about uncertainty</span>
<span id="cb375-3504"><a href="#cb375-3504" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ… **Interpretable** for stakeholders</span>
<span id="cb375-3505"><a href="#cb375-3505" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ… **Defensible** to reviewers</span>
<span id="cb375-3506"><a href="#cb375-3506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3507"><a href="#cb375-3507" aria-hidden="true" tabindex="-1"></a>**Save SEM for when you have n â‰¥ 200.** Until then, composite scores + regression will serve you well.</span>
<span id="cb375-3508"><a href="#cb375-3508" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb375-3509"><a href="#cb375-3509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3510"><a href="#cb375-3510" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-3511"><a href="#cb375-3511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3512"><a href="#cb375-3512" aria-hidden="true" tabindex="-1"></a><span class="fu">#### What You CAN Do</span></span>
<span id="cb375-3513"><a href="#cb375-3513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3514"><a href="#cb375-3514" aria-hidden="true" tabindex="-1"></a>With n = 20â€“50, focus on these **feasible and informative** analyses:</span>
<span id="cb375-3515"><a href="#cb375-3515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3516"><a href="#cb375-3516" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Content Validity**:</span>
<span id="cb375-3517"><a href="#cb375-3517" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Expert review (e.g., Content Validity Index with 5â€“10 experts)</span>
<span id="cb375-3518"><a href="#cb375-3518" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Cognitive interviews to assess comprehension</span>
<span id="cb375-3519"><a href="#cb375-3519" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Alignment with theoretical framework</span>
<span id="cb375-3520"><a href="#cb375-3520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3521"><a href="#cb375-3521" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Item-Level Diagnostics**:</span>
<span id="cb375-3522"><a href="#cb375-3522" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Item means, SDs, skewness</span>
<span id="cb375-3523"><a href="#cb375-3523" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Item-total correlations (r.cor)</span>
<span id="cb375-3524"><a href="#cb375-3524" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Ceiling/floor effects</span>
<span id="cb375-3525"><a href="#cb375-3525" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Inter-item correlation matrix</span>
<span id="cb375-3526"><a href="#cb375-3526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3527"><a href="#cb375-3527" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Preliminary Reliability** (n â‰¥ 30):</span>
<span id="cb375-3528"><a href="#cb375-3528" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Cronbach's alpha **with 95% CI** (report the wide CI!)</span>
<span id="cb375-3529"><a href="#cb375-3529" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Split-half reliability as robustness check</span>
<span id="cb375-3530"><a href="#cb375-3530" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Mean inter-item correlation (0.15â€“0.50 is typical)</span>
<span id="cb375-3531"><a href="#cb375-3531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3532"><a href="#cb375-3532" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Known-Groups Validity**:</span>
<span id="cb375-3533"><a href="#cb375-3533" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Compare scale scores between groups expected to differ (e.g., clinical vs. non-clinical)</span>
<span id="cb375-3534"><a href="#cb375-3534" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Use nonparametric tests (Mann-Whitney U) if distributions are skewed</span>
<span id="cb375-3535"><a href="#cb375-3535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3536"><a href="#cb375-3536" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>**Prepare for Larger Validation Study**:</span>
<span id="cb375-3537"><a href="#cb375-3537" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Document item generation process</span>
<span id="cb375-3538"><a href="#cb375-3538" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Report pilot results transparently (including dropped items and why)</span>
<span id="cb375-3539"><a href="#cb375-3539" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Specify hypotheses for CFA in future study</span>
<span id="cb375-3540"><a href="#cb375-3540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3541"><a href="#cb375-3541" aria-hidden="true" tabindex="-1"></a><span class="fu">### Example: Documenting a Small-Sample Scale Development</span></span>
<span id="cb375-3542"><a href="#cb375-3542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3545"><a href="#cb375-3545" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb375-3546"><a href="#cb375-3546" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: part-c-scale-dev-7</span></span>
<span id="cb375-3547"><a href="#cb375-3547" aria-hidden="true" tabindex="-1"></a><span class="co"># Reporting template for n &lt; 50 pilot study</span></span>
<span id="cb375-3548"><a href="#cb375-3548" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb375-3549"><a href="#cb375-3549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3550"><a href="#cb375-3550" aria-hidden="true" tabindex="-1"></a>scale_dev_report <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb375-3551"><a href="#cb375-3551" aria-hidden="true" tabindex="-1"></a>  <span class="at">Stage =</span> <span class="fu">c</span>(<span class="st">"Item Generation"</span>, <span class="st">"Pilot Testing"</span>, <span class="st">"Refinement"</span>, <span class="st">"Validation"</span>),</span>
<span id="cb375-3552"><a href="#cb375-3552" aria-hidden="true" tabindex="-1"></a>  <span class="at">Sample_Size =</span> <span class="fu">c</span>(<span class="st">"n = 8 (cognitive interviews)"</span>, <span class="st">"n = 25"</span>, <span class="st">"n = 60"</span>, <span class="st">"Planned: n = 200"</span>),</span>
<span id="cb375-3553"><a href="#cb375-3553" aria-hidden="true" tabindex="-1"></a>  <span class="at">Analyses_Conducted =</span> <span class="fu">c</span>(</span>
<span id="cb375-3554"><a href="#cb375-3554" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Think-aloud protocols; expert review (CVI = 0.88)"</span>,</span>
<span id="cb375-3555"><a href="#cb375-3555" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Item-total correlations; ceiling/floor checks; 3 items dropped"</span>,</span>
<span id="cb375-3556"><a href="#cb375-3556" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Alpha = 0.73 [95% CI: 0.61, 0.82]; split-half r = 0.70"</span>,</span>
<span id="cb375-3557"><a href="#cb375-3557" aria-hidden="true" tabindex="-1"></a>    <span class="st">"CFA, test-retest ICC, convergent validity (planned)"</span></span>
<span id="cb375-3558"><a href="#cb375-3558" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb375-3559"><a href="#cb375-3559" aria-hidden="true" tabindex="-1"></a>  <span class="at">Key_Findings =</span> <span class="fu">c</span>(</span>
<span id="cb375-3560"><a href="#cb375-3560" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Generated 15 items; 2 flagged as ambiguous"</span>,</span>
<span id="cb375-3561"><a href="#cb375-3561" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Dropped WRS5 (ceiling), WRS8 (r.cor = 0.18), WRS11 (low variance)"</span>,</span>
<span id="cb375-3562"><a href="#cb375-3562" aria-hidden="true" tabindex="-1"></a>    <span class="st">"8-item scale shows acceptable reliability for research use"</span>,</span>
<span id="cb375-3563"><a href="#cb375-3563" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Pending larger validation sample"</span></span>
<span id="cb375-3564"><a href="#cb375-3564" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb375-3565"><a href="#cb375-3565" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb375-3566"><a href="#cb375-3566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3567"><a href="#cb375-3567" aria-hidden="true" tabindex="-1"></a>scale_dev_report <span class="sc">%&gt;%</span></span>
<span id="cb375-3568"><a href="#cb375-3568" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb375-3569"><a href="#cb375-3569" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb375-3570"><a href="#cb375-3570" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Workplace Resilience Scale Development Summary"</span>,</span>
<span id="cb375-3571"><a href="#cb375-3571" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Iterative pilot and refinement process"</span></span>
<span id="cb375-3572"><a href="#cb375-3572" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb375-3573"><a href="#cb375-3573" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(</span>
<span id="cb375-3574"><a href="#cb375-3574" aria-hidden="true" tabindex="-1"></a>    <span class="at">Stage =</span> <span class="st">"Development Stage"</span>,</span>
<span id="cb375-3575"><a href="#cb375-3575" aria-hidden="true" tabindex="-1"></a>    <span class="at">Sample_Size =</span> <span class="st">"Sample Size"</span>,</span>
<span id="cb375-3576"><a href="#cb375-3576" aria-hidden="true" tabindex="-1"></a>    <span class="at">Analyses_Conducted =</span> <span class="st">"Analyses Conducted"</span>,</span>
<span id="cb375-3577"><a href="#cb375-3577" aria-hidden="true" tabindex="-1"></a>    <span class="at">Key_Findings =</span> <span class="st">"Key Findings"</span></span>
<span id="cb375-3578"><a href="#cb375-3578" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb375-3579"><a href="#cb375-3579" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_options</span>(</span>
<span id="cb375-3580"><a href="#cb375-3580" aria-hidden="true" tabindex="-1"></a>    <span class="at">table.font.size =</span> <span class="dv">10</span></span>
<span id="cb375-3581"><a href="#cb375-3581" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb375-3582"><a href="#cb375-3582" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-3583"><a href="#cb375-3583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3584"><a href="#cb375-3584" aria-hidden="true" tabindex="-1"></a><span class="fu">### Reporting Guidelines for Small-Sample Scale Development</span></span>
<span id="cb375-3585"><a href="#cb375-3585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3586"><a href="#cb375-3586" aria-hidden="true" tabindex="-1"></a>When publishing or reporting scale development work with n &lt; 50:</span>
<span id="cb375-3587"><a href="#cb375-3587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3588"><a href="#cb375-3588" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Acknowledge limitations explicitly**:</span>
<span id="cb375-3589"><a href="#cb375-3589" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>"With n = 25, we could not reliably estimate Cronbach's alpha. Instead, we focused on item-total correlations to identify weak items."</span>
<span id="cb375-3590"><a href="#cb375-3590" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>"Exploratory factor analysis was not feasible (n = 60); we plan CFA with a larger sample (target n = 200)."</span>
<span id="cb375-3591"><a href="#cb375-3591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3592"><a href="#cb375-3592" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Report what you did (not what you wish you could do)**:</span>
<span id="cb375-3593"><a href="#cb375-3593" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Don't report alpha if n &lt; 30 (the CI will be embarrassingly wide)</span>
<span id="cb375-3594"><a href="#cb375-3594" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Don't force EFA/CFA with inadequate samples; instead, document theoretical rationale for item grouping</span>
<span id="cb375-3595"><a href="#cb375-3595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3596"><a href="#cb375-3596" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Frame as a preliminary/pilot study**:</span>
<span id="cb375-3597"><a href="#cb375-3597" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>"This pilot study (n = 35) was designed to refine item wording and identify problematic items before a larger validation study."</span>
<span id="cb375-3598"><a href="#cb375-3598" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>"Results are preliminary and should be interpreted with caution pending validation with n â‰¥ 150."</span>
<span id="cb375-3599"><a href="#cb375-3599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3600"><a href="#cb375-3600" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Provide detailed item-level information**:</span>
<span id="cb375-3601"><a href="#cb375-3601" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Publish item means, SDs, item-total correlations</span>
<span id="cb375-3602"><a href="#cb375-3602" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Report which items were dropped and why</span>
<span id="cb375-3603"><a href="#cb375-3603" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Share cognitive interview feedback (qualitative)</span>
<span id="cb375-3604"><a href="#cb375-3604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3605"><a href="#cb375-3605" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>**Plan and fund the validation study**:</span>
<span id="cb375-3606"><a href="#cb375-3606" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Use pilot data to justify sample size for validation (power analysis for CFA)</span>
<span id="cb375-3607"><a href="#cb375-3607" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Secure resources for n â‰¥ 150â€“200 before claiming a "validated" scale</span>
<span id="cb375-3608"><a href="#cb375-3608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3609"><a href="#cb375-3609" aria-hidden="true" tabindex="-1"></a><span class="fu">### Key Takeaways</span></span>
<span id="cb375-3610"><a href="#cb375-3610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3611"><a href="#cb375-3611" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Scale development is a **multi-stage process** requiring progressively larger samples</span>
<span id="cb375-3612"><a href="#cb375-3612" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>With n &lt; 30: Focus on qualitative feedback and item-level diagnostics; **do not compute alpha**</span>
<span id="cb375-3613"><a href="#cb375-3613" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>With n = 30â€“50: Compute preliminary alpha (with wide CI); identify weak items</span>
<span id="cb375-3614"><a href="#cb375-3614" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>With n = 50â€“100: Assess reliability; exploratory factor analysis is feasible but results are tentative</span>
<span id="cb375-3615"><a href="#cb375-3615" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>With n â‰¥ 150: Conduct CFA, test-retest, and validity studies</span>
<span id="cb375-3616"><a href="#cb375-3616" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Transparency is key**: Report what you did and didn't do, and acknowledge sample size limitations</span>
<span id="cb375-3617"><a href="#cb375-3617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3618"><a href="#cb375-3618" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-3619"><a href="#cb375-3619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3620"><a href="#cb375-3620" aria-hidden="true" tabindex="-1"></a><span class="fu">## Chapter 7. Multi-Criteria Decision Making (MCDM) for Small Sets of Alternatives</span></span>
<span id="cb375-3621"><a href="#cb375-3621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3622"><a href="#cb375-3622" aria-hidden="true" tabindex="-1"></a><span class="fu">### Learning Objectives</span></span>
<span id="cb375-3623"><a href="#cb375-3623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3624"><a href="#cb375-3624" aria-hidden="true" tabindex="-1"></a>By the end of this chapter, you will be able to:</span>
<span id="cb375-3625"><a href="#cb375-3625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3626"><a href="#cb375-3626" aria-hidden="true" tabindex="-1"></a>**Conceptual Understanding**</span>
<span id="cb375-3627"><a href="#cb375-3627" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Explain the principles of multi-criteria decision analysis (MCDM)</span>
<span id="cb375-3628"><a href="#cb375-3628" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Understand the theoretical basis of AHP, TOPSIS, and VIKOR methods</span>
<span id="cb375-3629"><a href="#cb375-3629" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Recognize when MCDM is appropriate vs. when statistical inference is needed</span>
<span id="cb375-3630"><a href="#cb375-3630" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Distinguish compensatory from non-compensatory aggregation methods</span>
<span id="cb375-3631"><a href="#cb375-3631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3632"><a href="#cb375-3632" aria-hidden="true" tabindex="-1"></a>**Practical Skills**</span>
<span id="cb375-3633"><a href="#cb375-3633" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Structure decision problems with hierarchies of criteria and sub-criteria</span>
<span id="cb375-3634"><a href="#cb375-3634" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Elicit pairwise comparison judgments for AHP using consistency checks</span>
<span id="cb375-3635"><a href="#cb375-3635" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Implement TOPSIS and VIKOR in R to rank alternatives</span>
<span id="cb375-3636"><a href="#cb375-3636" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Compute composite scores with weighted criteria</span>
<span id="cb375-3637"><a href="#cb375-3637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3638"><a href="#cb375-3638" aria-hidden="true" tabindex="-1"></a>**Critical Evaluation**</span>
<span id="cb375-3639"><a href="#cb375-3639" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Assess the consistency of expert judgments (AHP consistency ratio)</span>
<span id="cb375-3640"><a href="#cb375-3640" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Evaluate sensitivity of rankings to weight changes</span>
<span id="cb375-3641"><a href="#cb375-3641" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Critique subjective weight elicitation procedures</span>
<span id="cb375-3642"><a href="#cb375-3642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3643"><a href="#cb375-3643" aria-hidden="true" tabindex="-1"></a>**Application**</span>
<span id="cb375-3644"><a href="#cb375-3644" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Apply MCDM methods to policy selection, technology choice, or program evaluation</span>
<span id="cb375-3645"><a href="#cb375-3645" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Perform sensitivity analyses to test robustness of rankings</span>
<span id="cb375-3646"><a href="#cb375-3646" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Report MCDM results transparently with criteria weights and score decompositions</span>
<span id="cb375-3647"><a href="#cb375-3647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3648"><a href="#cb375-3648" aria-hidden="true" tabindex="-1"></a><span class="fu">### When to Use MCDM Methods</span></span>
<span id="cb375-3649"><a href="#cb375-3649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3650"><a href="#cb375-3650" aria-hidden="true" tabindex="-1"></a>Multi-criteria decision-making (MCDM) methods are designed for problems where a small set of alternatives (options, projects, policies) must be evaluated and ranked on multiple criteria. They are particularly useful when:</span>
<span id="cb375-3651"><a href="#cb375-3651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3652"><a href="#cb375-3652" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The number of alternatives is small (typically fewer than 20).</span>
<span id="cb375-3653"><a href="#cb375-3653" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Alternatives are assessed on diverse criteria (quantitative and qualitative).</span>
<span id="cb375-3654"><a href="#cb375-3654" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Stakeholder preferences or expert judgements must be incorporated.</span>
<span id="cb375-3655"><a href="#cb375-3655" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The goal is ranking, selection, or resource allocation rather than hypothesis testing.</span>
<span id="cb375-3656"><a href="#cb375-3656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3657"><a href="#cb375-3657" aria-hidden="true" tabindex="-1"></a>MCDM methods do not test statistical hypotheses or quantify uncertainty in the same way as inferential statistics. Instead, they provide structured frameworks for synthesising information and making transparent, defensible choices.</span>
<span id="cb375-3658"><a href="#cb375-3658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3659"><a href="#cb375-3659" aria-hidden="true" tabindex="-1"></a><span class="fu">### Analytic Hierarchy Process (AHP)</span></span>
<span id="cb375-3660"><a href="#cb375-3660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3661"><a href="#cb375-3661" aria-hidden="true" tabindex="-1"></a>AHP decomposes a decision problem into a hierarchy of criteria and alternatives, then uses pairwise comparisons to derive priority weights. Decision-makers compare each pair of criteria (and each pair of alternatives under each criterion) to indicate relative importance or preference. AHP synthesises these comparisons into overall scores for each alternative.</span>
<span id="cb375-3662"><a href="#cb375-3662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3663"><a href="#cb375-3663" aria-hidden="true" tabindex="-1"></a>**When to use**: Multiple criteria with subjective importance weights, need for structured elicitation of expert judgements, transparency in weighting and aggregation.</span>
<span id="cb375-3664"><a href="#cb375-3664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3665"><a href="#cb375-3665" aria-hidden="true" tabindex="-1"></a>**Steps**:</span>
<span id="cb375-3666"><a href="#cb375-3666" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Define the goal, criteria, and alternatives.</span>
<span id="cb375-3667"><a href="#cb375-3667" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Perform pairwise comparisons of criteria to derive criteria weights.</span>
<span id="cb375-3668"><a href="#cb375-3668" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Perform pairwise comparisons of alternatives under each criterion.</span>
<span id="cb375-3669"><a href="#cb375-3669" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Aggregate to obtain overall scores for each alternative.</span>
<span id="cb375-3670"><a href="#cb375-3670" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>Check consistency of pairwise judgements.</span>
<span id="cb375-3671"><a href="#cb375-3671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3672"><a href="#cb375-3672" aria-hidden="true" tabindex="-1"></a><span class="fu">### Example: AHP for Selecting a Training Programme</span></span>
<span id="cb375-3673"><a href="#cb375-3673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3674"><a href="#cb375-3674" aria-hidden="true" tabindex="-1"></a>Suppose an organisation must choose among three training programmes (A, B, C) based on three criteria: Cost (lower is better), Effectiveness (higher is better), and Feasibility (higher is better). We use AHP to rank the programmes.</span>
<span id="cb375-3675"><a href="#cb375-3675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3678"><a href="#cb375-3678" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb375-3679"><a href="#cb375-3679" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: part-c-chunk-28</span></span>
<span id="cb375-3680"><a href="#cb375-3680" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb375-3681"><a href="#cb375-3681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3682"><a href="#cb375-3682" aria-hidden="true" tabindex="-1"></a><span class="co"># Define criteria weights from pairwise comparisons</span></span>
<span id="cb375-3683"><a href="#cb375-3683" aria-hidden="true" tabindex="-1"></a><span class="co"># Suppose decision-makers judge: </span></span>
<span id="cb375-3684"><a href="#cb375-3684" aria-hidden="true" tabindex="-1"></a><span class="co">#   Effectiveness is 3 times more important than Cost</span></span>
<span id="cb375-3685"><a href="#cb375-3685" aria-hidden="true" tabindex="-1"></a><span class="co">#   Effectiveness is 2 times more important than Feasibility</span></span>
<span id="cb375-3686"><a href="#cb375-3686" aria-hidden="true" tabindex="-1"></a><span class="co">#   Feasibility is slightly more important than Cost (1.5 times)</span></span>
<span id="cb375-3687"><a href="#cb375-3687" aria-hidden="true" tabindex="-1"></a><span class="co"># These comparisons yield approximate normalised weights:</span></span>
<span id="cb375-3688"><a href="#cb375-3688" aria-hidden="true" tabindex="-1"></a>criteria_weights <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">Cost =</span> <span class="fl">0.20</span>, <span class="at">Effectiveness =</span> <span class="fl">0.58</span>, <span class="at">Feasibility =</span> <span class="fl">0.22</span>)</span>
<span id="cb375-3689"><a href="#cb375-3689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3690"><a href="#cb375-3690" aria-hidden="true" tabindex="-1"></a><span class="co"># Define alternative scores on each criterion (normalised 0-1 scale)</span></span>
<span id="cb375-3691"><a href="#cb375-3691" aria-hidden="true" tabindex="-1"></a><span class="co"># These might come from pairwise comparisons or direct assessments</span></span>
<span id="cb375-3692"><a href="#cb375-3692" aria-hidden="true" tabindex="-1"></a>alternatives <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb375-3693"><a href="#cb375-3693" aria-hidden="true" tabindex="-1"></a>  <span class="at">Programme =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>),</span>
<span id="cb375-3694"><a href="#cb375-3694" aria-hidden="true" tabindex="-1"></a>  <span class="at">Cost_score =</span> <span class="fu">c</span>(<span class="fl">0.50</span>, <span class="fl">0.30</span>, <span class="fl">0.20</span>),         <span class="co"># A is cheapest</span></span>
<span id="cb375-3695"><a href="#cb375-3695" aria-hidden="true" tabindex="-1"></a>  <span class="at">Effectiveness_score =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.50</span>, <span class="fl">0.25</span>), <span class="co"># B is most effective</span></span>
<span id="cb375-3696"><a href="#cb375-3696" aria-hidden="true" tabindex="-1"></a>  <span class="at">Feasibility_score =</span> <span class="fu">c</span>(<span class="fl">0.40</span>, <span class="fl">0.30</span>, <span class="fl">0.30</span>)    <span class="co"># A is most feasible</span></span>
<span id="cb375-3697"><a href="#cb375-3697" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb375-3698"><a href="#cb375-3698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3699"><a href="#cb375-3699" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute weighted scores</span></span>
<span id="cb375-3700"><a href="#cb375-3700" aria-hidden="true" tabindex="-1"></a>alternatives <span class="ot">&lt;-</span> alternatives <span class="sc">%&gt;%</span></span>
<span id="cb375-3701"><a href="#cb375-3701" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb375-3702"><a href="#cb375-3702" aria-hidden="true" tabindex="-1"></a>    <span class="at">Weighted_Cost =</span> Cost_score <span class="sc">*</span> criteria_weights[<span class="st">"Cost"</span>],</span>
<span id="cb375-3703"><a href="#cb375-3703" aria-hidden="true" tabindex="-1"></a>    <span class="at">Weighted_Effectiveness =</span> Effectiveness_score <span class="sc">*</span> criteria_weights[<span class="st">"Effectiveness"</span>],</span>
<span id="cb375-3704"><a href="#cb375-3704" aria-hidden="true" tabindex="-1"></a>    <span class="at">Weighted_Feasibility =</span> Feasibility_score <span class="sc">*</span> criteria_weights[<span class="st">"Feasibility"</span>],</span>
<span id="cb375-3705"><a href="#cb375-3705" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Score =</span> Weighted_Cost <span class="sc">+</span> Weighted_Effectiveness <span class="sc">+</span> Weighted_Feasibility</span>
<span id="cb375-3706"><a href="#cb375-3706" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb375-3707"><a href="#cb375-3707" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Total_Score))</span>
<span id="cb375-3708"><a href="#cb375-3708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3709"><a href="#cb375-3709" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(alternatives)</span>
<span id="cb375-3710"><a href="#cb375-3710" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-3711"><a href="#cb375-3711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3712"><a href="#cb375-3712" aria-hidden="true" tabindex="-1"></a>Interpretation: Programme B has the highest total score, driven by its strong performance on Effectiveness (the most heavily weighted criterion). Programme A ranks second due to low cost and high feasibility. The ranking reflects the decision-makers' stated priorities. Sensitivity analysis (varying criteria weights) can assess robustness.</span>
<span id="cb375-3713"><a href="#cb375-3713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3714"><a href="#cb375-3714" aria-hidden="true" tabindex="-1"></a><span class="fu">### TOPSIS (Technique for Order of Preference by Similarity to Ideal Solution)</span></span>
<span id="cb375-3715"><a href="#cb375-3715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3716"><a href="#cb375-3716" aria-hidden="true" tabindex="-1"></a>TOPSIS ranks alternatives by their distance from an ideal solution (best on all criteria) and a negative-ideal solution (worst on all criteria). Alternatives closest to the ideal and farthest from the negative-ideal are ranked highest.</span>
<span id="cb375-3717"><a href="#cb375-3717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3718"><a href="#cb375-3718" aria-hidden="true" tabindex="-1"></a>**When to use**: Multiple criteria with known or easily assigned weights, desire for geometric interpretation, straightforward implementation.</span>
<span id="cb375-3719"><a href="#cb375-3719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3720"><a href="#cb375-3720" aria-hidden="true" tabindex="-1"></a>**Steps**:</span>
<span id="cb375-3721"><a href="#cb375-3721" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Normalise the decision matrix (each criterion scaled to comparable units).</span>
<span id="cb375-3722"><a href="#cb375-3722" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Apply criteria weights to the normalised matrix.</span>
<span id="cb375-3723"><a href="#cb375-3723" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Identify the ideal and negative-ideal solutions.</span>
<span id="cb375-3724"><a href="#cb375-3724" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Compute Euclidean distances from each alternative to both reference points.</span>
<span id="cb375-3725"><a href="#cb375-3725" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>Calculate closeness coefficients and rank alternatives.</span>
<span id="cb375-3726"><a href="#cb375-3726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3727"><a href="#cb375-3727" aria-hidden="true" tabindex="-1"></a><span class="fu">### Example: TOPSIS for Project Selection</span></span>
<span id="cb375-3728"><a href="#cb375-3728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3729"><a href="#cb375-3729" aria-hidden="true" tabindex="-1"></a>We evaluate four community projects (P1, P2, P3, P4) on three criteria: Impact (higher is better), Cost (lower is better, so we reverse), and Community Support (higher is better).</span>
<span id="cb375-3730"><a href="#cb375-3730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3731"><a href="#cb375-3731" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; **Normalisation choices.** TOPSIS typically uses vector (Euclidean) normalisation so that each criterion contributes proportionally regardless of its original scale. Cost variables must be recoded so that higher values are preferable (e.g., invert, take reciprocal, or subtract from the maximum). Alternatives include minâ€“max scaling or z-scores; choose a method consistent across criteria and document it so stakeholders understand how raw data map into the TOPSIS space.</span></span>
<span id="cb375-3732"><a href="#cb375-3732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3735"><a href="#cb375-3735" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb375-3736"><a href="#cb375-3736" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: part-c-chunk-29</span></span>
<span id="cb375-3737"><a href="#cb375-3737" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb375-3738"><a href="#cb375-3738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3739"><a href="#cb375-3739" aria-hidden="true" tabindex="-1"></a><span class="co"># Decision matrix: rows = projects, columns = criteria</span></span>
<span id="cb375-3740"><a href="#cb375-3740" aria-hidden="true" tabindex="-1"></a><span class="co"># Impact (scale 1-10), Cost (in Â£1000s), Support (scale 1-10)</span></span>
<span id="cb375-3741"><a href="#cb375-3741" aria-hidden="true" tabindex="-1"></a>decision_matrix <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb375-3742"><a href="#cb375-3742" aria-hidden="true" tabindex="-1"></a>  <span class="at">Project =</span> <span class="fu">c</span>(<span class="st">"P1"</span>, <span class="st">"P2"</span>, <span class="st">"P3"</span>, <span class="st">"P4"</span>),</span>
<span id="cb375-3743"><a href="#cb375-3743" aria-hidden="true" tabindex="-1"></a>  <span class="at">Impact =</span> <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">6</span>, <span class="dv">9</span>),</span>
<span id="cb375-3744"><a href="#cb375-3744" aria-hidden="true" tabindex="-1"></a>  <span class="at">Cost =</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">70</span>, <span class="dv">40</span>, <span class="dv">80</span>),      <span class="co"># Lower is better; we'll invert</span></span>
<span id="cb375-3745"><a href="#cb375-3745" aria-hidden="true" tabindex="-1"></a>  <span class="at">Support =</span> <span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">7</span>)</span>
<span id="cb375-3746"><a href="#cb375-3746" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb375-3747"><a href="#cb375-3747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3748"><a href="#cb375-3748" aria-hidden="true" tabindex="-1"></a><span class="co"># Invert cost (so higher is better)</span></span>
<span id="cb375-3749"><a href="#cb375-3749" aria-hidden="true" tabindex="-1"></a>decision_matrix <span class="ot">&lt;-</span> decision_matrix <span class="sc">%&gt;%</span></span>
<span id="cb375-3750"><a href="#cb375-3750" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Cost_inverted =</span> <span class="fu">max</span>(Cost) <span class="sc">-</span> Cost <span class="sc">+</span> <span class="fu">min</span>(Cost))</span>
<span id="cb375-3751"><a href="#cb375-3751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3752"><a href="#cb375-3752" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalise each criterion (vector/Euclidean normalisation)</span></span>
<span id="cb375-3753"><a href="#cb375-3753" aria-hidden="true" tabindex="-1"></a>criteria_cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Impact"</span>, <span class="st">"Cost_inverted"</span>, <span class="st">"Support"</span>)</span>
<span id="cb375-3754"><a href="#cb375-3754" aria-hidden="true" tabindex="-1"></a>normalised <span class="ot">&lt;-</span> decision_matrix <span class="sc">%&gt;%</span></span>
<span id="cb375-3755"><a href="#cb375-3755" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">all_of</span>(criteria_cols), <span class="sc">~</span> .x <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>(.x<span class="sc">^</span><span class="dv">2</span>)), <span class="at">.names =</span> <span class="st">"norm_{.col}"</span>))</span>
<span id="cb375-3756"><a href="#cb375-3756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3757"><a href="#cb375-3757" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply weights (assume equal weights for simplicity)</span></span>
<span id="cb375-3758"><a href="#cb375-3758" aria-hidden="true" tabindex="-1"></a>weights <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">Impact =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="at">Cost_inverted =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="at">Support =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>)</span>
<span id="cb375-3759"><a href="#cb375-3759" aria-hidden="true" tabindex="-1"></a>weighted <span class="ot">&lt;-</span> normalised <span class="sc">%&gt;%</span></span>
<span id="cb375-3760"><a href="#cb375-3760" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb375-3761"><a href="#cb375-3761" aria-hidden="true" tabindex="-1"></a>    <span class="at">w_Impact =</span> norm_Impact <span class="sc">*</span> weights[<span class="st">"Impact"</span>],</span>
<span id="cb375-3762"><a href="#cb375-3762" aria-hidden="true" tabindex="-1"></a>    <span class="at">w_Cost =</span> norm_Cost_inverted <span class="sc">*</span> weights[<span class="st">"Cost_inverted"</span>],</span>
<span id="cb375-3763"><a href="#cb375-3763" aria-hidden="true" tabindex="-1"></a>    <span class="at">w_Support =</span> norm_Support <span class="sc">*</span> weights[<span class="st">"Support"</span>]</span>
<span id="cb375-3764"><a href="#cb375-3764" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb375-3765"><a href="#cb375-3765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3766"><a href="#cb375-3766" aria-hidden="true" tabindex="-1"></a><span class="co"># Ideal and negative-ideal solutions</span></span>
<span id="cb375-3767"><a href="#cb375-3767" aria-hidden="true" tabindex="-1"></a>ideal <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">max</span>(weighted<span class="sc">$</span>w_Impact), <span class="fu">max</span>(weighted<span class="sc">$</span>w_Cost), <span class="fu">max</span>(weighted<span class="sc">$</span>w_Support))</span>
<span id="cb375-3768"><a href="#cb375-3768" aria-hidden="true" tabindex="-1"></a>negative_ideal <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">min</span>(weighted<span class="sc">$</span>w_Impact), <span class="fu">min</span>(weighted<span class="sc">$</span>w_Cost), <span class="fu">min</span>(weighted<span class="sc">$</span>w_Support))</span>
<span id="cb375-3769"><a href="#cb375-3769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3770"><a href="#cb375-3770" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute distances</span></span>
<span id="cb375-3771"><a href="#cb375-3771" aria-hidden="true" tabindex="-1"></a>weighted <span class="ot">&lt;-</span> weighted <span class="sc">%&gt;%</span></span>
<span id="cb375-3772"><a href="#cb375-3772" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb375-3773"><a href="#cb375-3773" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb375-3774"><a href="#cb375-3774" aria-hidden="true" tabindex="-1"></a>    <span class="at">dist_ideal =</span> <span class="fu">sqrt</span>((w_Impact <span class="sc">-</span> ideal[<span class="dv">1</span>])<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (w_Cost <span class="sc">-</span> ideal[<span class="dv">2</span>])<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (w_Support <span class="sc">-</span> ideal[<span class="dv">3</span>])<span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb375-3775"><a href="#cb375-3775" aria-hidden="true" tabindex="-1"></a>    <span class="at">dist_neg_ideal =</span> <span class="fu">sqrt</span>((w_Impact <span class="sc">-</span> negative_ideal[<span class="dv">1</span>])<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (w_Cost <span class="sc">-</span> negative_ideal[<span class="dv">2</span>])<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (w_Support <span class="sc">-</span> negative_ideal[<span class="dv">3</span>])<span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb375-3776"><a href="#cb375-3776" aria-hidden="true" tabindex="-1"></a>    <span class="at">closeness =</span> dist_neg_ideal <span class="sc">/</span> (dist_ideal <span class="sc">+</span> dist_neg_ideal)</span>
<span id="cb375-3777"><a href="#cb375-3777" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb375-3778"><a href="#cb375-3778" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb375-3779"><a href="#cb375-3779" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(closeness))</span>
<span id="cb375-3780"><a href="#cb375-3780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3781"><a href="#cb375-3781" aria-hidden="true" tabindex="-1"></a><span class="co"># Results</span></span>
<span id="cb375-3782"><a href="#cb375-3782" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(weighted, Project, Impact, Cost, Support, closeness)</span>
<span id="cb375-3783"><a href="#cb375-3783" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-3784"><a href="#cb375-3784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3785"><a href="#cb375-3785" aria-hidden="true" tabindex="-1"></a>Interpretation: The closeness coefficient ranges from 0 to 1; higher values indicate better alternatives. Projects are ranked by closeness. The top-ranked project is closest to the ideal (best on all criteria) and farthest from the negative-ideal (worst on all criteria). Sensitivity analysis can vary criteria weights to assess stability of rankings.</span>
<span id="cb375-3786"><a href="#cb375-3786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3787"><a href="#cb375-3787" aria-hidden="true" tabindex="-1"></a><span class="fu">### VIKOR (VIseKriterijumska Optimizacija I Kompromisno Resenje)</span></span>
<span id="cb375-3788"><a href="#cb375-3788" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3789"><a href="#cb375-3789" aria-hidden="true" tabindex="-1"></a>VIKOR ranks alternatives based on closeness to the ideal solution, with emphasis on compromise. It computes utility and regret measures, then combines them into a compromise ranking. VIKOR is useful when trade-offs among criteria are important.</span>
<span id="cb375-3790"><a href="#cb375-3790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3791"><a href="#cb375-3791" aria-hidden="true" tabindex="-1"></a>**When to use**: Similar contexts to TOPSIS, when emphasis on compromise and trade-offs is desired.</span>
<span id="cb375-3792"><a href="#cb375-3792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3793"><a href="#cb375-3793" aria-hidden="true" tabindex="-1"></a><span class="fu">### Other MCDM Methods</span></span>
<span id="cb375-3794"><a href="#cb375-3794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3795"><a href="#cb375-3795" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**MOORA (Multi-Objective Optimisation by Ratio Analysis)**: Simple ratio-based ranking.</span>
<span id="cb375-3796"><a href="#cb375-3796" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**WASPAS (Weighted Aggregated Sum Product Assessment)**: Combines additive and multiplicative aggregation.</span>
<span id="cb375-3797"><a href="#cb375-3797" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**DEMATEL (Decision-Making Trial and Evaluation Laboratory)**: Analyses causal relationships among criteria.</span>
<span id="cb375-3798"><a href="#cb375-3798" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**SMART (Simple Multi-Attribute Rating Technique)**: Direct scoring and weighting.</span>
<span id="cb375-3799"><a href="#cb375-3799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3800"><a href="#cb375-3800" aria-hidden="true" tabindex="-1"></a>All these methods share common steps: structuring the problem, normalising criteria, applying weights, and computing composite scores. The choice of method depends on problem context, stakeholder preferences, and computational convenience.</span>
<span id="cb375-3801"><a href="#cb375-3801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3802"><a href="#cb375-3802" aria-hidden="true" tabindex="-1"></a><span class="fu">### Sensitivity Analysis in MCDM</span></span>
<span id="cb375-3803"><a href="#cb375-3803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3804"><a href="#cb375-3804" aria-hidden="true" tabindex="-1"></a>MCDM rankings can be sensitive to criteria weights and normalisation methods. Sensitivity analysis systematically varies weights (or other inputs) and observes changes in rankings. If rankings remain stable across a range of plausible weights, conclusions are robust. If small weight changes produce large ranking changes, results should be interpreted cautiously and alternative weighting schemes considered.</span>
<span id="cb375-3805"><a href="#cb375-3805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3806"><a href="#cb375-3806" aria-hidden="true" tabindex="-1"></a><span class="fu">### Example: Sensitivity Analysis for AHP</span></span>
<span id="cb375-3807"><a href="#cb375-3807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3808"><a href="#cb375-3808" aria-hidden="true" tabindex="-1"></a>We vary the weight on Effectiveness in the AHP training example and observe changes in rankings.</span>
<span id="cb375-3809"><a href="#cb375-3809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3812"><a href="#cb375-3812" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb375-3813"><a href="#cb375-3813" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: part-c-chunk-30</span></span>
<span id="cb375-3814"><a href="#cb375-3814" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb375-3815"><a href="#cb375-3815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3816"><a href="#cb375-3816" aria-hidden="true" tabindex="-1"></a><span class="co"># Original weights</span></span>
<span id="cb375-3817"><a href="#cb375-3817" aria-hidden="true" tabindex="-1"></a>weights_base <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">Cost =</span> <span class="fl">0.20</span>, <span class="at">Effectiveness =</span> <span class="fl">0.58</span>, <span class="at">Feasibility =</span> <span class="fl">0.22</span>)</span>
<span id="cb375-3818"><a href="#cb375-3818" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3819"><a href="#cb375-3819" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternative scores (from earlier example)</span></span>
<span id="cb375-3820"><a href="#cb375-3820" aria-hidden="true" tabindex="-1"></a>alternatives_base <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb375-3821"><a href="#cb375-3821" aria-hidden="true" tabindex="-1"></a>  <span class="at">Programme =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>),</span>
<span id="cb375-3822"><a href="#cb375-3822" aria-hidden="true" tabindex="-1"></a>  <span class="at">Cost_score =</span> <span class="fu">c</span>(<span class="fl">0.50</span>, <span class="fl">0.30</span>, <span class="fl">0.20</span>),</span>
<span id="cb375-3823"><a href="#cb375-3823" aria-hidden="true" tabindex="-1"></a>  <span class="at">Effectiveness_score =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.50</span>, <span class="fl">0.25</span>),</span>
<span id="cb375-3824"><a href="#cb375-3824" aria-hidden="true" tabindex="-1"></a>  <span class="at">Feasibility_score =</span> <span class="fu">c</span>(<span class="fl">0.40</span>, <span class="fl">0.30</span>, <span class="fl">0.30</span>)</span>
<span id="cb375-3825"><a href="#cb375-3825" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb375-3826"><a href="#cb375-3826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3827"><a href="#cb375-3827" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to compute rankings for given effectiveness weight</span></span>
<span id="cb375-3828"><a href="#cb375-3828" aria-hidden="true" tabindex="-1"></a>compute_ranking <span class="ot">&lt;-</span> <span class="cf">function</span>(eff_weight) {</span>
<span id="cb375-3829"><a href="#cb375-3829" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Redistribute remaining weight proportionally between Cost and Feasibility</span></span>
<span id="cb375-3830"><a href="#cb375-3830" aria-hidden="true" tabindex="-1"></a>  remaining <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> eff_weight</span>
<span id="cb375-3831"><a href="#cb375-3831" aria-hidden="true" tabindex="-1"></a>  cost_weight <span class="ot">&lt;-</span> remaining <span class="sc">*</span> (<span class="fl">0.20</span> <span class="sc">/</span> (<span class="fl">0.20</span> <span class="sc">+</span> <span class="fl">0.22</span>))</span>
<span id="cb375-3832"><a href="#cb375-3832" aria-hidden="true" tabindex="-1"></a>  feas_weight <span class="ot">&lt;-</span> remaining <span class="sc">*</span> (<span class="fl">0.22</span> <span class="sc">/</span> (<span class="fl">0.20</span> <span class="sc">+</span> <span class="fl">0.22</span>))</span>
<span id="cb375-3833"><a href="#cb375-3833" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb375-3834"><a href="#cb375-3834" aria-hidden="true" tabindex="-1"></a>  alts <span class="ot">&lt;-</span> alternatives_base <span class="sc">%&gt;%</span></span>
<span id="cb375-3835"><a href="#cb375-3835" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb375-3836"><a href="#cb375-3836" aria-hidden="true" tabindex="-1"></a>      <span class="at">Total_Score =</span> Cost_score <span class="sc">*</span> cost_weight <span class="sc">+</span> </span>
<span id="cb375-3837"><a href="#cb375-3837" aria-hidden="true" tabindex="-1"></a>                     Effectiveness_score <span class="sc">*</span> eff_weight <span class="sc">+</span> </span>
<span id="cb375-3838"><a href="#cb375-3838" aria-hidden="true" tabindex="-1"></a>                     Feasibility_score <span class="sc">*</span> feas_weight</span>
<span id="cb375-3839"><a href="#cb375-3839" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb375-3840"><a href="#cb375-3840" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(Total_Score))</span>
<span id="cb375-3841"><a href="#cb375-3841" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb375-3842"><a href="#cb375-3842" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">Effectiveness_Weight =</span> eff_weight, <span class="at">Ranking =</span> <span class="fu">list</span>(alts<span class="sc">$</span>Programme))</span>
<span id="cb375-3843"><a href="#cb375-3843" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb375-3844"><a href="#cb375-3844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3845"><a href="#cb375-3845" aria-hidden="true" tabindex="-1"></a><span class="co"># Vary effectiveness weight from 0.3 to 0.8</span></span>
<span id="cb375-3846"><a href="#cb375-3846" aria-hidden="true" tabindex="-1"></a>sensitivity_results <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(<span class="fu">seq</span>(<span class="fl">0.3</span>, <span class="fl">0.8</span>, <span class="at">by =</span> <span class="fl">0.1</span>), compute_ranking)</span>
<span id="cb375-3847"><a href="#cb375-3847" aria-hidden="true" tabindex="-1"></a>sensitivity_results <span class="ot">&lt;-</span> sensitivity_results <span class="sc">%&gt;%</span></span>
<span id="cb375-3848"><a href="#cb375-3848" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Ranking =</span> <span class="fu">map_chr</span>(Ranking, <span class="sc">~</span> <span class="fu">paste</span>(.x, <span class="at">collapse =</span> <span class="st">", "</span>)))</span>
<span id="cb375-3849"><a href="#cb375-3849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3850"><a href="#cb375-3850" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(sensitivity_results)</span>
<span id="cb375-3851"><a href="#cb375-3851" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-3852"><a href="#cb375-3852" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3853"><a href="#cb375-3853" aria-hidden="true" tabindex="-1"></a>Interpretation: The table shows how the ranking changes as the weight on Effectiveness varies. If the top-ranked programme remains the same across all weights, the decision is robust. If the ranking changes with small weight variations, further deliberation or data collection may be warranted.</span>
<span id="cb375-3854"><a href="#cb375-3854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3855"><a href="#cb375-3855" aria-hidden="true" tabindex="-1"></a><span class="fu">### Self-Assessment Quiz</span></span>
<span id="cb375-3856"><a href="#cb375-3856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3857"><a href="#cb375-3857" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb375-3858"><a href="#cb375-3858" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Chapter 7 Questions</span></span>
<span id="cb375-3859"><a href="#cb375-3859" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3860"><a href="#cb375-3860" aria-hidden="true" tabindex="-1"></a>**Q1.** When are MCDM (Multi-Criteria Decision-Making) methods most appropriate?</span>
<span id="cb375-3861"><a href="#cb375-3861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3862"><a href="#cb375-3862" aria-hidden="true" tabindex="-1"></a>A) Testing statistical hypotheses with large samples  </span>
<span id="cb375-3863"><a href="#cb375-3863" aria-hidden="true" tabindex="-1"></a>B) Ranking and selecting from a small set of alternatives evaluated on multiple diverse criteria  </span>
<span id="cb375-3864"><a href="#cb375-3864" aria-hidden="true" tabindex="-1"></a>C) Calculating p-values for experimental data  </span>
<span id="cb375-3865"><a href="#cb375-3865" aria-hidden="true" tabindex="-1"></a>D) Only when all criteria are quantitative</span>
<span id="cb375-3866"><a href="#cb375-3866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3867"><a href="#cb375-3867" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-3868"><a href="#cb375-3868" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3869"><a href="#cb375-3869" aria-hidden="true" tabindex="-1"></a>**Q2.** What is the primary purpose of pairwise comparisons in the Analytic Hierarchy Process (AHP)?</span>
<span id="cb375-3870"><a href="#cb375-3870" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3871"><a href="#cb375-3871" aria-hidden="true" tabindex="-1"></a>A) To calculate correlation coefficients  </span>
<span id="cb375-3872"><a href="#cb375-3872" aria-hidden="true" tabindex="-1"></a>B) To derive priority weights for criteria and alternatives by comparing their relative importance  </span>
<span id="cb375-3873"><a href="#cb375-3873" aria-hidden="true" tabindex="-1"></a>C) To test statistical significance  </span>
<span id="cb375-3874"><a href="#cb375-3874" aria-hidden="true" tabindex="-1"></a>D) To normalize all data to 0-1 scale</span>
<span id="cb375-3875"><a href="#cb375-3875" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3876"><a href="#cb375-3876" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-3877"><a href="#cb375-3877" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3878"><a href="#cb375-3878" aria-hidden="true" tabindex="-1"></a>**Q3.** In TOPSIS, what does the "closeness coefficient" measure?</span>
<span id="cb375-3879"><a href="#cb375-3879" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3880"><a href="#cb375-3880" aria-hidden="true" tabindex="-1"></a>A) The p-value for each alternative  </span>
<span id="cb375-3881"><a href="#cb375-3881" aria-hidden="true" tabindex="-1"></a>B) How close an alternative is to the ideal solution (best on all criteria) relative to the negative-ideal solution (worst on all criteria)  </span>
<span id="cb375-3882"><a href="#cb375-3882" aria-hidden="true" tabindex="-1"></a>C) The Cronbach's alpha for criteria  </span>
<span id="cb375-3883"><a href="#cb375-3883" aria-hidden="true" tabindex="-1"></a>D) The sample size required for analysis</span>
<span id="cb375-3884"><a href="#cb375-3884" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3885"><a href="#cb375-3885" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-3886"><a href="#cb375-3886" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3887"><a href="#cb375-3887" aria-hidden="true" tabindex="-1"></a>**Q4.** Why is sensitivity analysis essential in MCDM?</span>
<span id="cb375-3888"><a href="#cb375-3888" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3889"><a href="#cb375-3889" aria-hidden="true" tabindex="-1"></a>A) To calculate standard errors  </span>
<span id="cb375-3890"><a href="#cb375-3890" aria-hidden="true" tabindex="-1"></a>B) To assess whether rankings remain stable when criteria weights or other inputs are varied  </span>
<span id="cb375-3891"><a href="#cb375-3891" aria-hidden="true" tabindex="-1"></a>C) To test normality assumptions  </span>
<span id="cb375-3892"><a href="#cb375-3892" aria-hidden="true" tabindex="-1"></a>D) To increase sample size</span>
<span id="cb375-3893"><a href="#cb375-3893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3894"><a href="#cb375-3894" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-3895"><a href="#cb375-3895" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3896"><a href="#cb375-3896" aria-hidden="true" tabindex="-1"></a>**Q5.** In the TOPSIS method, why must cost variables (where lower is better) be inverted or reversed?</span>
<span id="cb375-3897"><a href="#cb375-3897" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3898"><a href="#cb375-3898" aria-hidden="true" tabindex="-1"></a>A) To make the algorithm run faster  </span>
<span id="cb375-3899"><a href="#cb375-3899" aria-hidden="true" tabindex="-1"></a>B) Because TOPSIS assumes higher values are preferable for all criteria; cost must be recoded so higher values represent better performance  </span>
<span id="cb375-3900"><a href="#cb375-3900" aria-hidden="true" tabindex="-1"></a>C) Cost variables cannot be used in TOPSIS  </span>
<span id="cb375-3901"><a href="#cb375-3901" aria-hidden="true" tabindex="-1"></a>D) To calculate p-values</span>
<span id="cb375-3902"><a href="#cb375-3902" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3903"><a href="#cb375-3903" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-3904"><a href="#cb375-3904" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3905"><a href="#cb375-3905" aria-hidden="true" tabindex="-1"></a>**Q6.** What does AHP's consistency check evaluate?</span>
<span id="cb375-3906"><a href="#cb375-3906" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3907"><a href="#cb375-3907" aria-hidden="true" tabindex="-1"></a>A) Whether the data are normally distributed  </span>
<span id="cb375-3908"><a href="#cb375-3908" aria-hidden="true" tabindex="-1"></a>B) Whether pairwise comparison judgments are logically consistent (e.g., if A &gt; B and B &gt; C, then A &gt; C)  </span>
<span id="cb375-3909"><a href="#cb375-3909" aria-hidden="true" tabindex="-1"></a>C) Whether the sample size is adequate  </span>
<span id="cb375-3910"><a href="#cb375-3910" aria-hidden="true" tabindex="-1"></a>D) Whether residuals are homoscedastic</span>
<span id="cb375-3911"><a href="#cb375-3911" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3912"><a href="#cb375-3912" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-3913"><a href="#cb375-3913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3914"><a href="#cb375-3914" aria-hidden="true" tabindex="-1"></a>**Q7.** MCDM methods are designed for problems where:</span>
<span id="cb375-3915"><a href="#cb375-3915" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3916"><a href="#cb375-3916" aria-hidden="true" tabindex="-1"></a>A) The goal is ranking, selection, or resource allocation rather than hypothesis testing  </span>
<span id="cb375-3917"><a href="#cb375-3917" aria-hidden="true" tabindex="-1"></a>B) Large randomized controlled trials are conducted  </span>
<span id="cb375-3918"><a href="#cb375-3918" aria-hidden="true" tabindex="-1"></a>C) Only one criterion matters  </span>
<span id="cb375-3919"><a href="#cb375-3919" aria-hidden="true" tabindex="-1"></a>D) Inferential statistics are required</span>
<span id="cb375-3920"><a href="#cb375-3920" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3921"><a href="#cb375-3921" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-3922"><a href="#cb375-3922" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3923"><a href="#cb375-3923" aria-hidden="true" tabindex="-1"></a>**Q8.** In the training programme selection example, Programme B ranked highest despite being mid-range on Cost and Feasibility. Why?</span>
<span id="cb375-3924"><a href="#cb375-3924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3925"><a href="#cb375-3925" aria-hidden="true" tabindex="-1"></a>A) It had the largest sample size  </span>
<span id="cb375-3926"><a href="#cb375-3926" aria-hidden="true" tabindex="-1"></a>B) It performed strongly on Effectiveness, which was the most heavily weighted criterion (58%)  </span>
<span id="cb375-3927"><a href="#cb375-3927" aria-hidden="true" tabindex="-1"></a>C) It had the smallest standard error  </span>
<span id="cb375-3928"><a href="#cb375-3928" aria-hidden="true" tabindex="-1"></a>D) It was randomly selected</span>
<span id="cb375-3929"><a href="#cb375-3929" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3930"><a href="#cb375-3930" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb375-3931"><a href="#cb375-3931" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3932"><a href="#cb375-3932" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip collapse="true"}</span>
<span id="cb375-3933"><a href="#cb375-3933" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Answers and Explanations</span></span>
<span id="cb375-3934"><a href="#cb375-3934" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3935"><a href="#cb375-3935" aria-hidden="true" tabindex="-1"></a>**A1. B)** "MCDM methods are designed for problems where a small set of alternatives (options, projects, policies) must be evaluated and ranked on multiple criteria."  </span>
<span id="cb375-3936"><a href="#cb375-3936" aria-hidden="true" tabindex="-1"></a>MCDM complements statistical inference by addressing decision problems where ranking and selection are the goals, not hypothesis testing.</span>
<span id="cb375-3937"><a href="#cb375-3937" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3938"><a href="#cb375-3938" aria-hidden="true" tabindex="-1"></a>**A2. B)** "AHP... uses pairwise comparisons to derive priority weights. Decision-makers compare each pair of criteria (and each pair of alternatives under each criterion) to indicate relative importance or preference."  </span>
<span id="cb375-3939"><a href="#cb375-3939" aria-hidden="true" tabindex="-1"></a>Pairwise comparisons systematically elicit judgments about relative importance, which AHP synthesizes into numerical weights.</span>
<span id="cb375-3940"><a href="#cb375-3940" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3941"><a href="#cb375-3941" aria-hidden="true" tabindex="-1"></a>**A3. B)** "The closeness coefficient ranges from 0 to 1; higher values indicate better alternatives... closest to the ideal (best on all criteria) and farthest from the negative-ideal (worst on all criteria)."  </span>
<span id="cb375-3942"><a href="#cb375-3942" aria-hidden="true" tabindex="-1"></a>TOPSIS ranks alternatives by computing their geometric proximity to ideal and negative-ideal reference points.</span>
<span id="cb375-3943"><a href="#cb375-3943" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3944"><a href="#cb375-3944" aria-hidden="true" tabindex="-1"></a>**A4. B)** "MCDM rankings can be sensitive to criteria weights and normalisation methods. Sensitivity analysis systematically varies weights (or other inputs) and observes changes in rankings."  </span>
<span id="cb375-3945"><a href="#cb375-3945" aria-hidden="true" tabindex="-1"></a>If rankings remain stable across plausible weight variations, conclusions are robust; if not, further deliberation is needed.</span>
<span id="cb375-3946"><a href="#cb375-3946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3947"><a href="#cb375-3947" aria-hidden="true" tabindex="-1"></a>**A5. B)** "Cost variables must be recoded so that higher values are preferable (e.g., invert, take reciprocal, or subtract from the maximum)."  </span>
<span id="cb375-3948"><a href="#cb375-3948" aria-hidden="true" tabindex="-1"></a>TOPSIS assumes all criteria are benefit-type (higher = better), so cost criteria must be transformed.</span>
<span id="cb375-3949"><a href="#cb375-3949" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3950"><a href="#cb375-3950" aria-hidden="true" tabindex="-1"></a>**A6. B)** AHP includes consistency checks to ensure pairwise judgments are logically coherent. If A is judged 3 times more important than B, and B is 2 times more important than C, then A should be approximately 6 times more important than C.  </span>
<span id="cb375-3951"><a href="#cb375-3951" aria-hidden="true" tabindex="-1"></a>Inconsistent judgments indicate that decision-makers should revisit their comparisons.</span>
<span id="cb375-3952"><a href="#cb375-3952" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3953"><a href="#cb375-3953" aria-hidden="true" tabindex="-1"></a>**A7. A)** "MCDM methods do not test statistical hypotheses or quantify uncertainty in the same way as inferential statistics. Instead, they provide structured frameworks for synthesising information and making transparent, defensible choices."  </span>
<span id="cb375-3954"><a href="#cb375-3954" aria-hidden="true" tabindex="-1"></a>MCDM is used for decision-making (ranking/selection), not statistical inference.</span>
<span id="cb375-3955"><a href="#cb375-3955" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3956"><a href="#cb375-3956" aria-hidden="true" tabindex="-1"></a>**A8. B)** "Programme B has the highest total score, driven by its strong performance on Effectiveness (the most heavily weighted criterion)."  </span>
<span id="cb375-3957"><a href="#cb375-3957" aria-hidden="true" tabindex="-1"></a>The weighted scores reflect that Effectiveness was assigned 58% of total weight, making Programme B's superiority on this criterion decisive.</span>
<span id="cb375-3958"><a href="#cb375-3958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3959"><a href="#cb375-3959" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb375-3960"><a href="#cb375-3960" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3961"><a href="#cb375-3961" aria-hidden="true" tabindex="-1"></a><span class="fu">### Key Takeaways</span></span>
<span id="cb375-3962"><a href="#cb375-3962" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3963"><a href="#cb375-3963" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>MCDM methods provide structured frameworks for ranking and selecting alternatives based on multiple criteria.</span>
<span id="cb375-3964"><a href="#cb375-3964" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>AHP uses pairwise comparisons to derive criteria weights and alternative scores; it is transparent and widely used.</span>
<span id="cb375-3965"><a href="#cb375-3965" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>TOPSIS and VIKOR rank alternatives by proximity to ideal solutions; they are computationally straightforward.</span>
<span id="cb375-3966"><a href="#cb375-3966" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Other methods (MOORA, WASPAS, DEMATEL, SMART) offer alternative aggregation approaches.</span>
<span id="cb375-3967"><a href="#cb375-3967" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Sensitivity analysis is essential for assessing robustness of rankings to changes in weights or other inputs.</span>
<span id="cb375-3968"><a href="#cb375-3968" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>MCDM methods complement statistical inference by addressing decision problems where ranking and selection (not hypothesis testing) are the goals.</span>
<span id="cb375-3969"><a href="#cb375-3969" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3970"><a href="#cb375-3970" aria-hidden="true" tabindex="-1"></a><span class="fu">### Smoke Test</span></span>
<span id="cb375-3971"><a href="#cb375-3971" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3974"><a href="#cb375-3974" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb375-3975"><a href="#cb375-3975" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: part-c-chunk-31</span></span>
<span id="cb375-3976"><a href="#cb375-3976" aria-hidden="true" tabindex="-1"></a><span class="co"># Re-run simple TOPSIS calculation</span></span>
<span id="cb375-3977"><a href="#cb375-3977" aria-hidden="true" tabindex="-1"></a>projects <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"P1"</span>, <span class="st">"P2"</span>, <span class="st">"P3"</span>)</span>
<span id="cb375-3978"><a href="#cb375-3978" aria-hidden="true" tabindex="-1"></a>impact <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">6</span>)</span>
<span id="cb375-3979"><a href="#cb375-3979" aria-hidden="true" tabindex="-1"></a>cost <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">70</span>, <span class="dv">40</span>)</span>
<span id="cb375-3980"><a href="#cb375-3980" aria-hidden="true" tabindex="-1"></a>norm_impact <span class="ot">&lt;-</span> impact <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>(impact<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb375-3981"><a href="#cb375-3981" aria-hidden="true" tabindex="-1"></a>norm_cost <span class="ot">&lt;-</span> cost <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>(cost<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb375-3982"><a href="#cb375-3982" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(projects, norm_impact, norm_cost)</span>
<span id="cb375-3983"><a href="#cb375-3983" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-3984"><a href="#cb375-3984" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3985"><a href="#cb375-3985" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-3986"><a href="#cb375-3986" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3987"><a href="#cb375-3987" aria-hidden="true" tabindex="-1"></a><span class="fu">## Chapter 8. Methods for Sparse Counts and Short Time Series</span></span>
<span id="cb375-3988"><a href="#cb375-3988" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3989"><a href="#cb375-3989" aria-hidden="true" tabindex="-1"></a><span class="fu">### Learning Objectives</span></span>
<span id="cb375-3990"><a href="#cb375-3990" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3991"><a href="#cb375-3991" aria-hidden="true" tabindex="-1"></a>By the end of this chapter, you will be able to:</span>
<span id="cb375-3992"><a href="#cb375-3992" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3993"><a href="#cb375-3993" aria-hidden="true" tabindex="-1"></a>**Conceptual Understanding**</span>
<span id="cb375-3994"><a href="#cb375-3994" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Explain why sparse counts violate assumptions of standard Poisson regression</span>
<span id="cb375-3995"><a href="#cb375-3995" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Understand zero-inflation and overdispersion in count models</span>
<span id="cb375-3996"><a href="#cb375-3996" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Recognize the limitations of ARIMA models with short time series</span>
<span id="cb375-3997"><a href="#cb375-3997" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Distinguish state-space models from classical time-series approaches</span>
<span id="cb375-3998"><a href="#cb375-3998" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3999"><a href="#cb375-3999" aria-hidden="true" tabindex="-1"></a>**Practical Skills**</span>
<span id="cb375-4000"><a href="#cb375-4000" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Apply exact Poisson tests using <span class="in">`poisson.test()`</span> in R</span>
<span id="cb375-4001"><a href="#cb375-4001" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Fit zero-inflated Poisson (ZIP) and negative binomial models with <span class="in">`pscl`</span></span>
<span id="cb375-4002"><a href="#cb375-4002" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Compute bootstrap forecast intervals for short time series</span>
<span id="cb375-4003"><a href="#cb375-4003" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Use simple smoothing methods (exponential smoothing, moving averages)</span>
<span id="cb375-4004"><a href="#cb375-4004" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4005"><a href="#cb375-4005" aria-hidden="true" tabindex="-1"></a>**Critical Evaluation**</span>
<span id="cb375-4006"><a href="#cb375-4006" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Assess when exact tests are necessary vs. when asymptotic tests suffice</span>
<span id="cb375-4007"><a href="#cb375-4007" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Evaluate overdispersion diagnostics with small samples</span>
<span id="cb375-4008"><a href="#cb375-4008" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Critique ARIMA models fitted to very short time series (&lt;30 observations)</span>
<span id="cb375-4009"><a href="#cb375-4009" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4010"><a href="#cb375-4010" aria-hidden="true" tabindex="-1"></a>**Application**</span>
<span id="cb375-4011"><a href="#cb375-4011" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Analyze sparse event data (rare adverse events, low-frequency counts)</span>
<span id="cb375-4012"><a href="#cb375-4012" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Report count models with appropriate diagnostics (dispersion, zero-inflation)</span>
<span id="cb375-4013"><a href="#cb375-4013" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>âœ“ Apply descriptive trend analysis when model-based forecasting is infeasible</span>
<span id="cb375-4014"><a href="#cb375-4014" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4015"><a href="#cb375-4015" aria-hidden="true" tabindex="-1"></a><span class="fu">### The Challenge of Sparse Counts</span></span>
<span id="cb375-4016"><a href="#cb375-4016" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4017"><a href="#cb375-4017" aria-hidden="true" tabindex="-1"></a>Count outcomes (number of defects, adverse events, customer complaints) are common in small-sample research. When counts are sparse (many zeros, low event rates), classical methods (Poisson regression, overdispersion tests) can be unreliable. Exact tests, robust standard errors, and resampling methods offer more trustworthy inferences.</span>
<span id="cb375-4018"><a href="#cb375-4018" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4019"><a href="#cb375-4019" aria-hidden="true" tabindex="-1"></a>Similarly, short time series (fewer than 30 observations) pose challenges for classical time-series models (ARIMA, exponential smoothing). Parameter estimation is imprecise, model selection is unreliable, and forecasts have wide intervals. Simpler methods (moving averages, trend lines, state-space models with informative priors) may be more appropriate.</span>
<span id="cb375-4020"><a href="#cb375-4020" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4021"><a href="#cb375-4021" aria-hidden="true" tabindex="-1"></a><span class="fu">### Exact Poisson Test for Sparse Counts</span></span>
<span id="cb375-4022"><a href="#cb375-4022" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4023"><a href="#cb375-4023" aria-hidden="true" tabindex="-1"></a>The exact Poisson test (introduced in Chapter 3) compares an observed count to an expected rate. It is particularly useful when counts are small (fewer than 10 events) or when testing a single observed count against a known benchmark.</span>
<span id="cb375-4024"><a href="#cb375-4024" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4025"><a href="#cb375-4025" aria-hidden="true" tabindex="-1"></a>**When to use**: Small counts, rare events, single-sample or single-period comparisons.</span>
<span id="cb375-4026"><a href="#cb375-4026" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4027"><a href="#cb375-4027" aria-hidden="true" tabindex="-1"></a><span class="fu">### Example: Testing a Defect Rate</span></span>
<span id="cb375-4028"><a href="#cb375-4028" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4029"><a href="#cb375-4029" aria-hidden="true" tabindex="-1"></a>A new quality control process is expected to reduce defects to 2 per batch. In a trial of 5 batches, 15 defects are observed. We test whether the observed rate (15/5 = 3 per batch) differs from the target rate (2 per batch).</span>
<span id="cb375-4030"><a href="#cb375-4030" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4033"><a href="#cb375-4033" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb375-4034"><a href="#cb375-4034" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: part-c-chunk-32</span></span>
<span id="cb375-4035"><a href="#cb375-4035" aria-hidden="true" tabindex="-1"></a><span class="co"># Exact Poisson test</span></span>
<span id="cb375-4036"><a href="#cb375-4036" aria-hidden="true" tabindex="-1"></a><span class="co"># H0: lambda = 2 per batch (expected 2 * 5 = 10 defects in 5 batches)</span></span>
<span id="cb375-4037"><a href="#cb375-4037" aria-hidden="true" tabindex="-1"></a>poisson_test_result <span class="ot">&lt;-</span> <span class="fu">poisson.test</span>(<span class="at">x =</span> <span class="dv">15</span>, <span class="at">T =</span> <span class="dv">5</span>, <span class="at">r =</span> <span class="dv">2</span>, <span class="at">alternative =</span> <span class="st">"two.sided"</span>)</span>
<span id="cb375-4038"><a href="#cb375-4038" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(poisson_test_result)</span>
<span id="cb375-4039"><a href="#cb375-4039" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4040"><a href="#cb375-4040" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Observed rate:"</span>, <span class="dv">15</span><span class="sc">/</span><span class="dv">5</span>, <span class="st">"per batch</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-4041"><a href="#cb375-4041" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Expected rate:"</span>, <span class="dv">2</span>, <span class="st">"per batch</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-4042"><a href="#cb375-4042" aria-hidden="true" tabindex="-1"></a>ci_vals <span class="ot">&lt;-</span> <span class="fu">unname</span>(poisson_test_result<span class="sc">$</span>conf.int)</span>
<span id="cb375-4043"><a href="#cb375-4043" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"95% CI for true rate:"</span>, ci_vals[<span class="dv">1</span>], <span class="st">"to"</span>, ci_vals[<span class="dv">2</span>], <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-4044"><a href="#cb375-4044" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-4045"><a href="#cb375-4045" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4046"><a href="#cb375-4046" aria-hidden="true" tabindex="-1"></a>Interpretation: The p-value indicates whether the observed rate is consistent with the expected rate. If p &lt; 0.05, the observed rate differs significantly from the target. The confidence interval provides a range of plausible values for the true defect rate. If the CI excludes the target rate, the process may not be meeting its goal.</span>
<span id="cb375-4047"><a href="#cb375-4047" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4048"><a href="#cb375-4048" aria-hidden="true" tabindex="-1"></a><span class="fu">### Comparing Two Sparse Count Samples</span></span>
<span id="cb375-4049"><a href="#cb375-4049" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4050"><a href="#cb375-4050" aria-hidden="true" tabindex="-1"></a>When comparing counts from two independent groups (e.g., event rates in treatment vs. control), exact conditional tests or permutation tests can be used. Alternatively, if counts are moderately large (â‰¥5 per group), rate ratio confidence intervals based on Poisson assumptions may be adequate.</span>
<span id="cb375-4051"><a href="#cb375-4051" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4052"><a href="#cb375-4052" aria-hidden="true" tabindex="-1"></a><span class="fu">### Example: Comparing Adverse Event Rates</span></span>
<span id="cb375-4053"><a href="#cb375-4053" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4054"><a href="#cb375-4054" aria-hidden="true" tabindex="-1"></a>We compare adverse event counts in two small clinical trials: Trial A (8 events in 50 patient-days) vs. Trial B (3 events in 45 patient-days).</span>
<span id="cb375-4055"><a href="#cb375-4055" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4058"><a href="#cb375-4058" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb375-4059"><a href="#cb375-4059" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: part-c-chunk-33</span></span>
<span id="cb375-4060"><a href="#cb375-4060" aria-hidden="true" tabindex="-1"></a><span class="co"># Rate comparison using Poisson-based approximation</span></span>
<span id="cb375-4061"><a href="#cb375-4061" aria-hidden="true" tabindex="-1"></a><span class="co"># Trial A: 8 events, 50 patient-days (rate = 8/50 = 0.16 per day)</span></span>
<span id="cb375-4062"><a href="#cb375-4062" aria-hidden="true" tabindex="-1"></a><span class="co"># Trial B: 3 events, 45 patient-days (rate = 3/45 = 0.067 per day)</span></span>
<span id="cb375-4063"><a href="#cb375-4063" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4064"><a href="#cb375-4064" aria-hidden="true" tabindex="-1"></a>rate_a <span class="ot">&lt;-</span> <span class="dv">8</span> <span class="sc">/</span> <span class="dv">50</span></span>
<span id="cb375-4065"><a href="#cb375-4065" aria-hidden="true" tabindex="-1"></a>rate_b <span class="ot">&lt;-</span> <span class="dv">3</span> <span class="sc">/</span> <span class="dv">45</span></span>
<span id="cb375-4066"><a href="#cb375-4066" aria-hidden="true" tabindex="-1"></a>rate_ratio <span class="ot">&lt;-</span> rate_a <span class="sc">/</span> rate_b</span>
<span id="cb375-4067"><a href="#cb375-4067" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4068"><a href="#cb375-4068" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Rate A:"</span>, <span class="fu">formatC</span>(rate_a, <span class="at">format =</span> <span class="st">"f"</span>, <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">"events per patient-day</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-4069"><a href="#cb375-4069" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Rate B:"</span>, <span class="fu">formatC</span>(rate_b, <span class="at">format =</span> <span class="st">"f"</span>, <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">"events per patient-day</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-4070"><a href="#cb375-4070" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Rate ratio (A/B):"</span>, <span class="fu">formatC</span>(rate_ratio, <span class="at">format =</span> <span class="st">"f"</span>, <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-4071"><a href="#cb375-4071" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4072"><a href="#cb375-4072" aria-hidden="true" tabindex="-1"></a><span class="co"># Log-rate-ratio standard error (Poisson approximation)</span></span>
<span id="cb375-4073"><a href="#cb375-4073" aria-hidden="true" tabindex="-1"></a>se_log_rr <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span> <span class="sc">/</span> <span class="dv">8</span> <span class="sc">+</span> <span class="dv">1</span> <span class="sc">/</span> <span class="dv">3</span>)</span>
<span id="cb375-4074"><a href="#cb375-4074" aria-hidden="true" tabindex="-1"></a>ci_log <span class="ot">&lt;-</span> <span class="fu">log</span>(rate_ratio) <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="sc">*</span> <span class="fl">1.96</span> <span class="sc">*</span> se_log_rr</span>
<span id="cb375-4075"><a href="#cb375-4075" aria-hidden="true" tabindex="-1"></a>ci_rr <span class="ot">&lt;-</span> <span class="fu">exp</span>(ci_log)</span>
<span id="cb375-4076"><a href="#cb375-4076" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4077"><a href="#cb375-4077" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Approximate 95% CI for rate ratio:"</span>,</span>
<span id="cb375-4078"><a href="#cb375-4078" aria-hidden="true" tabindex="-1"></a>    <span class="fu">formatC</span>(ci_rr[<span class="dv">1</span>], <span class="at">format =</span> <span class="st">"f"</span>, <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">"to"</span>,</span>
<span id="cb375-4079"><a href="#cb375-4079" aria-hidden="true" tabindex="-1"></a>    <span class="fu">formatC</span>(ci_rr[<span class="dv">2</span>], <span class="at">format =</span> <span class="st">"f"</span>, <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-4080"><a href="#cb375-4080" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-4081"><a href="#cb375-4081" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4082"><a href="#cb375-4082" aria-hidden="true" tabindex="-1"></a>Interpretation: The rate ratio quantifies the relative rate of events in Trial A vs. Trial B. A ratio greater than 1 indicates higher rates in A. The confidence interval indicates the range of plausible rate ratios. If the CI excludes 1, the rates differ significantly. Exact or mid-p adjustments improve accuracy with small counts.</span>
<span id="cb375-4083"><a href="#cb375-4083" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4084"><a href="#cb375-4084" aria-hidden="true" tabindex="-1"></a><span class="fu">### Bootstrap Forecast Intervals for Short Time Series</span></span>
<span id="cb375-4085"><a href="#cb375-4085" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4086"><a href="#cb375-4086" aria-hidden="true" tabindex="-1"></a>Short time series (n &lt; 30 observations) complicate classical forecasting. ARIMA models require sufficient data to estimate autocorrelation structure; with few observations, estimates are noisy and forecasts unreliable. Bootstrap methods can generate forecast intervals by resampling residuals or using block bootstrap to preserve temporal dependence.</span>
<span id="cb375-4087"><a href="#cb375-4087" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4088"><a href="#cb375-4088" aria-hidden="true" tabindex="-1"></a>Alternatively, simple methods (moving averages, linear trend extrapolation) may be more transparent and robust for very short series.</span>
<span id="cb375-4089"><a href="#cb375-4089" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4090"><a href="#cb375-4090" aria-hidden="true" tabindex="-1"></a>**When to use**: Short time series (10â€“30 observations), desire for forecast intervals, when classical ARIMA is infeasible or unstable.</span>
<span id="cb375-4091"><a href="#cb375-4091" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4092"><a href="#cb375-4092" aria-hidden="true" tabindex="-1"></a><span class="fu">### Example: Bootstrap Forecast for a Short Series</span></span>
<span id="cb375-4093"><a href="#cb375-4093" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4094"><a href="#cb375-4094" aria-hidden="true" tabindex="-1"></a>We forecast the next value in a short time series of monthly sales figures (12 observations).</span>
<span id="cb375-4095"><a href="#cb375-4095" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4098"><a href="#cb375-4098" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb375-4099"><a href="#cb375-4099" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: part-c-chunk-34</span></span>
<span id="cb375-4100"><a href="#cb375-4100" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb375-4101"><a href="#cb375-4101" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb375-4102"><a href="#cb375-4102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4103"><a href="#cb375-4103" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb375-4104"><a href="#cb375-4104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4105"><a href="#cb375-4105" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulated monthly sales data (12 months)</span></span>
<span id="cb375-4106"><a href="#cb375-4106" aria-hidden="true" tabindex="-1"></a>sales <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">45</span>, <span class="dv">48</span>, <span class="dv">50</span>, <span class="dv">47</span>, <span class="dv">52</span>, <span class="dv">54</span>, <span class="dv">53</span>, <span class="dv">56</span>, <span class="dv">58</span>, <span class="dv">57</span>, <span class="dv">60</span>, <span class="dv">62</span>)</span>
<span id="cb375-4107"><a href="#cb375-4107" aria-hidden="true" tabindex="-1"></a>time <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span></span>
<span id="cb375-4108"><a href="#cb375-4108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4109"><a href="#cb375-4109" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit a simple linear trend model</span></span>
<span id="cb375-4110"><a href="#cb375-4110" aria-hidden="true" tabindex="-1"></a>trend_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(sales <span class="sc">~</span> time)</span>
<span id="cb375-4111"><a href="#cb375-4111" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(trend_model)</span>
<span id="cb375-4112"><a href="#cb375-4112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4113"><a href="#cb375-4113" aria-hidden="true" tabindex="-1"></a><span class="co"># Forecast for month 13</span></span>
<span id="cb375-4114"><a href="#cb375-4114" aria-hidden="true" tabindex="-1"></a>forecast_time <span class="ot">&lt;-</span> <span class="dv">13</span></span>
<span id="cb375-4115"><a href="#cb375-4115" aria-hidden="true" tabindex="-1"></a>forecast_point <span class="ot">&lt;-</span> <span class="fu">predict</span>(trend_model, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">time =</span> forecast_time))</span>
<span id="cb375-4116"><a href="#cb375-4116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4117"><a href="#cb375-4117" aria-hidden="true" tabindex="-1"></a><span class="co"># Bootstrap forecast interval by resampling residuals</span></span>
<span id="cb375-4118"><a href="#cb375-4118" aria-hidden="true" tabindex="-1"></a>residuals <span class="ot">&lt;-</span> <span class="fu">residuals</span>(trend_model)</span>
<span id="cb375-4119"><a href="#cb375-4119" aria-hidden="true" tabindex="-1"></a>n_boot <span class="ot">&lt;-</span> <span class="dv">2000</span></span>
<span id="cb375-4120"><a href="#cb375-4120" aria-hidden="true" tabindex="-1"></a>forecast_boot <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_boot)</span>
<span id="cb375-4121"><a href="#cb375-4121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4122"><a href="#cb375-4122" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_boot) {</span>
<span id="cb375-4123"><a href="#cb375-4123" aria-hidden="true" tabindex="-1"></a>  boot_resid <span class="ot">&lt;-</span> <span class="fu">sample</span>(residuals, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb375-4124"><a href="#cb375-4124" aria-hidden="true" tabindex="-1"></a>  forecast_boot[i] <span class="ot">&lt;-</span> forecast_point <span class="sc">+</span> boot_resid</span>
<span id="cb375-4125"><a href="#cb375-4125" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb375-4126"><a href="#cb375-4126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4127"><a href="#cb375-4127" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute 95% percentile interval</span></span>
<span id="cb375-4128"><a href="#cb375-4128" aria-hidden="true" tabindex="-1"></a>forecast_ci <span class="ot">&lt;-</span> <span class="fu">quantile</span>(forecast_boot, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))</span>
<span id="cb375-4129"><a href="#cb375-4129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4130"><a href="#cb375-4130" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Point forecast for month 13:"</span>, <span class="fu">round</span>(forecast_point, <span class="dv">1</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-4131"><a href="#cb375-4131" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"95% bootstrap forecast interval:"</span>, <span class="fu">round</span>(forecast_ci, <span class="dv">1</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-4132"><a href="#cb375-4132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4133"><a href="#cb375-4133" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb375-4134"><a href="#cb375-4134" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(time, sales, <span class="at">type =</span> <span class="st">"b"</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">13</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">40</span>, <span class="dv">70</span>),</span>
<span id="cb375-4135"><a href="#cb375-4135" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Month"</span>, <span class="at">ylab =</span> <span class="st">"Sales"</span>, <span class="at">main =</span> <span class="st">"Sales Forecast with Bootstrap Interval"</span>)</span>
<span id="cb375-4136"><a href="#cb375-4136" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(forecast_time, forecast_point, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">pch =</span> <span class="dv">19</span>)</span>
<span id="cb375-4137"><a href="#cb375-4137" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(forecast_time, forecast_ci[<span class="dv">1</span>], forecast_time, forecast_ci[<span class="dv">2</span>], <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb375-4138"><a href="#cb375-4138" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-4139"><a href="#cb375-4139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4140"><a href="#cb375-4140" aria-hidden="true" tabindex="-1"></a>Interpretation: The point forecast is the predicted value from the trend model for month 13. The bootstrap forecast interval accounts for residual variability by resampling observed deviations from the trend. This approach is simple and transparent, suitable for very short series where more complex time-series models would overfit. The interval width reflects forecast uncertainty; wider intervals indicate greater uncertainty.</span>
<span id="cb375-4141"><a href="#cb375-4141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4142"><a href="#cb375-4142" aria-hidden="true" tabindex="-1"></a><span class="fu">### State-Space Models for Short Series (Conceptual Note)</span></span>
<span id="cb375-4143"><a href="#cb375-4143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4144"><a href="#cb375-4144" aria-hidden="true" tabindex="-1"></a>State-space models (such as local level or local trend models) can be fitted with Bayesian methods, incorporating prior information to stabilise estimates. With informative priors on parameters (such as the variance of the process and observation errors), state-space models can provide sensible forecasts even with short series. The <span class="in">`brms`</span> package or dedicated state-space software (KFAS, dlm) can be used, though this is advanced and may exceed the scope of brief studies.</span>
<span id="cb375-4145"><a href="#cb375-4145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4146"><a href="#cb375-4146" aria-hidden="true" tabindex="-1"></a><span class="fu">### Handling Zero-Inflated Counts</span></span>
<span id="cb375-4147"><a href="#cb375-4147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4148"><a href="#cb375-4148" aria-hidden="true" tabindex="-1"></a>When count data include an excess of zeros (more than expected under a Poisson or negative binomial distribution), zero-inflated models may be appropriate. However, these models require sufficient data to estimate both the zero-inflation process and the count process. With very small samples, zero-inflated models may be overparameterised and unstable.</span>
<span id="cb375-4149"><a href="#cb375-4149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4150"><a href="#cb375-4150" aria-hidden="true" tabindex="-1"></a>Simpler approaches include:</span>
<span id="cb375-4151"><a href="#cb375-4151" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Reporting the proportion of zeros alongside the mean of non-zero counts.</span>
<span id="cb375-4152"><a href="#cb375-4152" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Using exact binomial tests to assess whether the proportion of zeros differs from a theoretical expectation.</span>
<span id="cb375-4153"><a href="#cb375-4153" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Aggregating data across time or categories to reduce sparsity.</span>
<span id="cb375-4154"><a href="#cb375-4154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4155"><a href="#cb375-4155" aria-hidden="true" tabindex="-1"></a><span class="fu">### Quasi-Poisson Models for Overdispersion</span></span>
<span id="cb375-4156"><a href="#cb375-4156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4157"><a href="#cb375-4157" aria-hidden="true" tabindex="-1"></a>When variance exceeds the mean (overdispersion), classical Poisson regression underestimates standard errors and inflates Type I error. A simple fix is the **quasi-Poisson** model, which keeps the Poisson mean structure but estimates a dispersion parameter to inflate standard errors appropriately.</span>
<span id="cb375-4158"><a href="#cb375-4158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4161"><a href="#cb375-4161" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb375-4162"><a href="#cb375-4162" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: part-c-chunk-35</span></span>
<span id="cb375-4163"><a href="#cb375-4163" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb375-4164"><a href="#cb375-4164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4165"><a href="#cb375-4165" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb375-4166"><a href="#cb375-4166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4167"><a href="#cb375-4167" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulated overdispersed counts: clinic visits per month for 12 patients</span></span>
<span id="cb375-4168"><a href="#cb375-4168" aria-hidden="true" tabindex="-1"></a>visit_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb375-4169"><a href="#cb375-4169" aria-hidden="true" tabindex="-1"></a>  <span class="at">treatment =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Standard"</span>, <span class="st">"Enhanced"</span>), <span class="at">each =</span> <span class="dv">6</span>),</span>
<span id="cb375-4170"><a href="#cb375-4170" aria-hidden="true" tabindex="-1"></a>  <span class="at">visits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">3</span>, <span class="dv">6</span>)</span>
<span id="cb375-4171"><a href="#cb375-4171" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb375-4172"><a href="#cb375-4172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4173"><a href="#cb375-4173" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit Poisson and quasi-Poisson models</span></span>
<span id="cb375-4174"><a href="#cb375-4174" aria-hidden="true" tabindex="-1"></a>poisson_fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(visits <span class="sc">~</span> treatment, <span class="at">family =</span> <span class="fu">poisson</span>(), <span class="at">data =</span> visit_data)</span>
<span id="cb375-4175"><a href="#cb375-4175" aria-hidden="true" tabindex="-1"></a>quasi_fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(visits <span class="sc">~</span> treatment, <span class="at">family =</span> <span class="fu">quasipoisson</span>(), <span class="at">data =</span> visit_data)</span>
<span id="cb375-4176"><a href="#cb375-4176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4177"><a href="#cb375-4177" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(poisson_fit)</span>
<span id="cb375-4178"><a href="#cb375-4178" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(quasi_fit)</span>
<span id="cb375-4179"><a href="#cb375-4179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4180"><a href="#cb375-4180" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Estimated dispersion (quasi-Poisson):"</span>, <span class="fu">summary</span>(quasi_fit)<span class="sc">$</span>dispersion, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb375-4181"><a href="#cb375-4181" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-4182"><a href="#cb375-4182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4183"><a href="#cb375-4183" aria-hidden="true" tabindex="-1"></a>Interpretation: Both models yield the same coefficient estimates, but the quasi-Poisson standard errors (and p-values) are inflated by the dispersion estimate (&gt; 1). Check residual deviance-to-df; values far above 1 indicate overdispersion. With small samples, quasi-Poisson is a pragmatic adjustment when negative binomial models are unstable or overparameterised. Report the dispersion estimate so readers understand the degree of overdispersion.</span>
<span id="cb375-4184"><a href="#cb375-4184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4185"><a href="#cb375-4185" aria-hidden="true" tabindex="-1"></a><span class="fu">### Self-Assessment Quiz</span></span>
<span id="cb375-4186"><a href="#cb375-4186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4187"><a href="#cb375-4187" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb375-4188"><a href="#cb375-4188" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Chapter 8 Questions</span></span>
<span id="cb375-4189"><a href="#cb375-4189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4190"><a href="#cb375-4190" aria-hidden="true" tabindex="-1"></a>**Q1.** When is the exact Poisson test particularly useful?</span>
<span id="cb375-4191"><a href="#cb375-4191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4192"><a href="#cb375-4192" aria-hidden="true" tabindex="-1"></a>A) When sample sizes exceed 1,000  </span>
<span id="cb375-4193"><a href="#cb375-4193" aria-hidden="true" tabindex="-1"></a>B) When counts are small (fewer than 10 events) or testing a single observed count against a known benchmark  </span>
<span id="cb375-4194"><a href="#cb375-4194" aria-hidden="true" tabindex="-1"></a>C) When data are normally distributed  </span>
<span id="cb375-4195"><a href="#cb375-4195" aria-hidden="true" tabindex="-1"></a>D) Only for continuous outcomes</span>
<span id="cb375-4196"><a href="#cb375-4196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4197"><a href="#cb375-4197" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-4198"><a href="#cb375-4198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4199"><a href="#cb375-4199" aria-hidden="true" tabindex="-1"></a>**Q2.** In the defect rate example, 15 defects were observed in 5 batches. The target rate was 2 defects per batch. What is the observed rate?</span>
<span id="cb375-4200"><a href="#cb375-4200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4201"><a href="#cb375-4201" aria-hidden="true" tabindex="-1"></a>A) 2 per batch  </span>
<span id="cb375-4202"><a href="#cb375-4202" aria-hidden="true" tabindex="-1"></a>B) 5 per batch  </span>
<span id="cb375-4203"><a href="#cb375-4203" aria-hidden="true" tabindex="-1"></a>C) 3 per batch  </span>
<span id="cb375-4204"><a href="#cb375-4204" aria-hidden="true" tabindex="-1"></a>D) 15 per batch</span>
<span id="cb375-4205"><a href="#cb375-4205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4206"><a href="#cb375-4206" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-4207"><a href="#cb375-4207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4208"><a href="#cb375-4208" aria-hidden="true" tabindex="-1"></a>**Q3.** What does a rate ratio greater than 1 indicate when comparing two groups?</span>
<span id="cb375-4209"><a href="#cb375-4209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4210"><a href="#cb375-4210" aria-hidden="true" tabindex="-1"></a>A) The groups have identical rates  </span>
<span id="cb375-4211"><a href="#cb375-4211" aria-hidden="true" tabindex="-1"></a>B) The first group has a higher event rate than the second group  </span>
<span id="cb375-4212"><a href="#cb375-4212" aria-hidden="true" tabindex="-1"></a>C) The sample size is too small  </span>
<span id="cb375-4213"><a href="#cb375-4213" aria-hidden="true" tabindex="-1"></a>D) The data are normally distributed</span>
<span id="cb375-4214"><a href="#cb375-4214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4215"><a href="#cb375-4215" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-4216"><a href="#cb375-4216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4217"><a href="#cb375-4217" aria-hidden="true" tabindex="-1"></a>**Q4.** Why are classical ARIMA models problematic for short time series (n &lt; 30)?</span>
<span id="cb375-4218"><a href="#cb375-4218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4219"><a href="#cb375-4219" aria-hidden="true" tabindex="-1"></a>A) ARIMA requires specialized software  </span>
<span id="cb375-4220"><a href="#cb375-4220" aria-hidden="true" tabindex="-1"></a>B) ARIMA models require sufficient data to estimate autocorrelation structure; with few observations, estimates are noisy and forecasts unreliable  </span>
<span id="cb375-4221"><a href="#cb375-4221" aria-hidden="true" tabindex="-1"></a>C) ARIMA only works with count data  </span>
<span id="cb375-4222"><a href="#cb375-4222" aria-hidden="true" tabindex="-1"></a>D) ARIMA cannot handle missing values</span>
<span id="cb375-4223"><a href="#cb375-4223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4224"><a href="#cb375-4224" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-4225"><a href="#cb375-4225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4226"><a href="#cb375-4226" aria-hidden="true" tabindex="-1"></a>**Q5.** What is the advantage of bootstrap forecast intervals for short time series?</span>
<span id="cb375-4227"><a href="#cb375-4227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4228"><a href="#cb375-4228" aria-hidden="true" tabindex="-1"></a>A) They eliminate all uncertainty  </span>
<span id="cb375-4229"><a href="#cb375-4229" aria-hidden="true" tabindex="-1"></a>B) They generate forecast intervals by resampling residuals, providing a transparent alternative when classical ARIMA is infeasible  </span>
<span id="cb375-4230"><a href="#cb375-4230" aria-hidden="true" tabindex="-1"></a>C) They require n &gt; 1,000  </span>
<span id="cb375-4231"><a href="#cb375-4231" aria-hidden="true" tabindex="-1"></a>D) They only work with normally distributed data</span>
<span id="cb375-4232"><a href="#cb375-4232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4233"><a href="#cb375-4233" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-4234"><a href="#cb375-4234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4235"><a href="#cb375-4235" aria-hidden="true" tabindex="-1"></a>**Q6.** What is the primary challenge with zero-inflated count models in small samples?</span>
<span id="cb375-4236"><a href="#cb375-4236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4237"><a href="#cb375-4237" aria-hidden="true" tabindex="-1"></a>A) They are too fast to compute  </span>
<span id="cb375-4238"><a href="#cb375-4238" aria-hidden="true" tabindex="-1"></a>B) They require sufficient data to estimate both the zero-inflation process and the count process; with very small samples, they may be overparameterized and unstable  </span>
<span id="cb375-4239"><a href="#cb375-4239" aria-hidden="true" tabindex="-1"></a>C) They cannot handle zeros  </span>
<span id="cb375-4240"><a href="#cb375-4240" aria-hidden="true" tabindex="-1"></a>D) They only work with large samples</span>
<span id="cb375-4241"><a href="#cb375-4241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4242"><a href="#cb375-4242" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-4243"><a href="#cb375-4243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4244"><a href="#cb375-4244" aria-hidden="true" tabindex="-1"></a>**Q7.** What does "overdispersion" mean in count data?</span>
<span id="cb375-4245"><a href="#cb375-4245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4246"><a href="#cb375-4246" aria-hidden="true" tabindex="-1"></a>A) The mean exceeds the variance  </span>
<span id="cb375-4247"><a href="#cb375-4247" aria-hidden="true" tabindex="-1"></a>B) The variance exceeds the mean (more variability than expected under a Poisson distribution)  </span>
<span id="cb375-4248"><a href="#cb375-4248" aria-hidden="true" tabindex="-1"></a>C) The data are perfectly Poisson-distributed  </span>
<span id="cb375-4249"><a href="#cb375-4249" aria-hidden="true" tabindex="-1"></a>D) There are no zeros in the data</span>
<span id="cb375-4250"><a href="#cb375-4250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4251"><a href="#cb375-4251" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-4252"><a href="#cb375-4252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4253"><a href="#cb375-4253" aria-hidden="true" tabindex="-1"></a>**Q8.** How does the quasi-Poisson model address overdispersion?</span>
<span id="cb375-4254"><a href="#cb375-4254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4255"><a href="#cb375-4255" aria-hidden="true" tabindex="-1"></a>A) By removing outliers  </span>
<span id="cb375-4256"><a href="#cb375-4256" aria-hidden="true" tabindex="-1"></a>B) By keeping the Poisson mean structure but estimating a dispersion parameter to inflate standard errors appropriately  </span>
<span id="cb375-4257"><a href="#cb375-4257" aria-hidden="true" tabindex="-1"></a>C) By increasing sample size  </span>
<span id="cb375-4258"><a href="#cb375-4258" aria-hidden="true" tabindex="-1"></a>D) By assuming normality</span>
<span id="cb375-4259"><a href="#cb375-4259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4260"><a href="#cb375-4260" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-4261"><a href="#cb375-4261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4262"><a href="#cb375-4262" aria-hidden="true" tabindex="-1"></a>**Q9.** In the adverse event rate comparison, Trial A had 8 events in 50 patient-days and Trial B had 3 events in 45 patient-days. If the rate ratio confidence interval excludes 1, what does this indicate?</span>
<span id="cb375-4263"><a href="#cb375-4263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4264"><a href="#cb375-4264" aria-hidden="true" tabindex="-1"></a>A) The rates are identical  </span>
<span id="cb375-4265"><a href="#cb375-4265" aria-hidden="true" tabindex="-1"></a>B) The rates differ significantly between the two trials  </span>
<span id="cb375-4266"><a href="#cb375-4266" aria-hidden="true" tabindex="-1"></a>C) More data are needed  </span>
<span id="cb375-4267"><a href="#cb375-4267" aria-hidden="true" tabindex="-1"></a>D) The Poisson assumption is violated</span>
<span id="cb375-4268"><a href="#cb375-4268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4269"><a href="#cb375-4269" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-4270"><a href="#cb375-4270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4271"><a href="#cb375-4271" aria-hidden="true" tabindex="-1"></a>**Q10.** For very short time series (fewer than 15 observations), which approach is typically more appropriate than complex ARIMA models?</span>
<span id="cb375-4272"><a href="#cb375-4272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4273"><a href="#cb375-4273" aria-hidden="true" tabindex="-1"></a>A) Multiple regression with 20 predictors  </span>
<span id="cb375-4274"><a href="#cb375-4274" aria-hidden="true" tabindex="-1"></a>B) Simple methods like moving averages or linear trend extrapolation  </span>
<span id="cb375-4275"><a href="#cb375-4275" aria-hidden="true" tabindex="-1"></a>C) Factor analysis  </span>
<span id="cb375-4276"><a href="#cb375-4276" aria-hidden="true" tabindex="-1"></a>D) Structural equation modeling</span>
<span id="cb375-4277"><a href="#cb375-4277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4278"><a href="#cb375-4278" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb375-4279"><a href="#cb375-4279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4280"><a href="#cb375-4280" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip collapse="true"}</span>
<span id="cb375-4281"><a href="#cb375-4281" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Answers and Explanations</span></span>
<span id="cb375-4282"><a href="#cb375-4282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4283"><a href="#cb375-4283" aria-hidden="true" tabindex="-1"></a>**A1. B)** "The exact Poisson test... is particularly useful when counts are small (fewer than 10 events) or when testing a single observed count against a known benchmark."  </span>
<span id="cb375-4284"><a href="#cb375-4284" aria-hidden="true" tabindex="-1"></a>Exact tests avoid large-sample approximations that may be invalid with sparse counts.</span>
<span id="cb375-4285"><a href="#cb375-4285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4286"><a href="#cb375-4286" aria-hidden="true" tabindex="-1"></a>**A2. C)** "In a trial of 5 batches, 15 defects are observed... the observed rate (15/5 = 3 per batch)."  </span>
<span id="cb375-4287"><a href="#cb375-4287" aria-hidden="true" tabindex="-1"></a>The observed rate is calculated as total defects divided by number of batches: 15/5 = 3.</span>
<span id="cb375-4288"><a href="#cb375-4288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4289"><a href="#cb375-4289" aria-hidden="true" tabindex="-1"></a>**A3. B)** "The rate ratio quantifies the relative rate of events in Trial A vs. Trial B. A ratio greater than 1 indicates higher rates in A."  </span>
<span id="cb375-4290"><a href="#cb375-4290" aria-hidden="true" tabindex="-1"></a>Rate ratios provide a multiplicative comparison: RR = 2 means the first group has twice the event rate.</span>
<span id="cb375-4291"><a href="#cb375-4291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4292"><a href="#cb375-4292" aria-hidden="true" tabindex="-1"></a>**A4. B)** "Short time series (n &lt; 30 observations) complicate classical forecasting. ARIMA models require sufficient data to estimate autocorrelation structure; with few observations, estimates are noisy and forecasts unreliable."  </span>
<span id="cb375-4293"><a href="#cb375-4293" aria-hidden="true" tabindex="-1"></a>ARIMA needs adequate data to identify and estimate autoregressive and moving average parameters.</span>
<span id="cb375-4294"><a href="#cb375-4294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4295"><a href="#cb375-4295" aria-hidden="true" tabindex="-1"></a>**A5. B)** "Bootstrap methods can generate forecast intervals by resampling residuals or using block bootstrap to preserve temporal dependence."  </span>
<span id="cb375-4296"><a href="#cb375-4296" aria-hidden="true" tabindex="-1"></a>Bootstrap provides a transparent, assumption-light approach suitable for short series.</span>
<span id="cb375-4297"><a href="#cb375-4297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4298"><a href="#cb375-4298" aria-hidden="true" tabindex="-1"></a>**A6. B)** "These models require sufficient data to estimate both the zero-inflation process and the count process. With very small samples, zero-inflated models may be overparameterised and unstable."  </span>
<span id="cb375-4299"><a href="#cb375-4299" aria-hidden="true" tabindex="-1"></a>Zero-inflated models have more parameters, requiring larger samples for stable estimation.</span>
<span id="cb375-4300"><a href="#cb375-4300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4301"><a href="#cb375-4301" aria-hidden="true" tabindex="-1"></a>**A7. B)** "When variance exceeds the mean (overdispersion), classical Poisson regression underestimates standard errors."  </span>
<span id="cb375-4302"><a href="#cb375-4302" aria-hidden="true" tabindex="-1"></a>Poisson assumes variance = mean; real data often show greater variability.</span>
<span id="cb375-4303"><a href="#cb375-4303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4304"><a href="#cb375-4304" aria-hidden="true" tabindex="-1"></a>**A8. B)** "The quasi-Poisson model... keeps the Poisson mean structure but estimates a dispersion parameter to inflate standard errors appropriately."  </span>
<span id="cb375-4305"><a href="#cb375-4305" aria-hidden="true" tabindex="-1"></a>Quasi-Poisson adjusts standard errors without changing the mean model structure.</span>
<span id="cb375-4306"><a href="#cb375-4306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4307"><a href="#cb375-4307" aria-hidden="true" tabindex="-1"></a>**A9. B)** "If the CI excludes 1, the rates differ significantly."  </span>
<span id="cb375-4308"><a href="#cb375-4308" aria-hidden="true" tabindex="-1"></a>A confidence interval that doesn't contain 1 indicates the rate ratio is significantly different from equality.</span>
<span id="cb375-4309"><a href="#cb375-4309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4310"><a href="#cb375-4310" aria-hidden="true" tabindex="-1"></a>**A10. B)** "Simple methods (moving averages, linear trend extrapolation) may be more transparent and robust for very short series."  </span>
<span id="cb375-4311"><a href="#cb375-4311" aria-hidden="true" tabindex="-1"></a>With limited data, simpler models reduce overfitting risk and provide more interpretable forecasts.</span>
<span id="cb375-4312"><a href="#cb375-4312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4313"><a href="#cb375-4313" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb375-4314"><a href="#cb375-4314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4315"><a href="#cb375-4315" aria-hidden="true" tabindex="-1"></a><span class="fu">### Key Takeaways</span></span>
<span id="cb375-4316"><a href="#cb375-4316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4317"><a href="#cb375-4317" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Exact Poisson tests provide valid inferences for sparse count data, avoiding large-sample approximations.</span>
<span id="cb375-4318"><a href="#cb375-4318" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Rate ratios and confidence intervals compare event rates between groups; exact or mid-p adjustments improve accuracy with small counts.</span>
<span id="cb375-4319"><a href="#cb375-4319" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Short time series (n &lt; 30) are challenging for classical ARIMA models; bootstrap forecast intervals and simple trend models offer robust alternatives.</span>
<span id="cb375-4320"><a href="#cb375-4320" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>State-space models with Bayesian priors can stabilise forecasts for short series but require advanced methods.</span>
<span id="cb375-4321"><a href="#cb375-4321" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Zero-inflated counts require careful handling; report descriptive summaries and use exact tests when formal inference is needed.</span>
<span id="cb375-4322"><a href="#cb375-4322" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Transparency and caution are essential when analysing sparse counts and short series; avoid overfitting and report uncertainty honestly.</span>
<span id="cb375-4323"><a href="#cb375-4323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4324"><a href="#cb375-4324" aria-hidden="true" tabindex="-1"></a><span class="fu">### Smoke Test</span></span>
<span id="cb375-4325"><a href="#cb375-4325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4328"><a href="#cb375-4328" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb375-4329"><a href="#cb375-4329" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: part-c-chunk-36</span></span>
<span id="cb375-4330"><a href="#cb375-4330" aria-hidden="true" tabindex="-1"></a><span class="co"># Re-run exact Poisson test</span></span>
<span id="cb375-4331"><a href="#cb375-4331" aria-hidden="true" tabindex="-1"></a><span class="fu">poisson.test</span>(<span class="at">x =</span> <span class="dv">10</span>, <span class="at">T =</span> <span class="dv">5</span>, <span class="at">r =</span> <span class="fl">1.5</span>)</span>
<span id="cb375-4332"><a href="#cb375-4332" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-4333"><a href="#cb375-4333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4334"><a href="#cb375-4334" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-4335"><a href="#cb375-4335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4336"><a href="#cb375-4336" aria-hidden="true" tabindex="-1"></a><span class="fu">## Summary of Part C</span></span>
<span id="cb375-4337"><a href="#cb375-4337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4338"><a href="#cb375-4338" aria-hidden="true" tabindex="-1"></a>In Part C, we presented a comprehensive toolkit for small-sample quantitative analysis. Chapter 3 covered exact tests (Fisher, Barnard, exact binomial, exact Poisson) and resampling methods (permutation tests, bootstrap confidence intervals). Chapter 4 introduced nonparametric rank-based methods (Mannâ€“Whitney U, Wilcoxon signed-rank, Kruskalâ€“Wallis, Friedman, Spearman, Kendall). Chapter 5 addressed penalised (Firth logistic) and Bayesian regression techniques for stabilising estimates with limited data. Chapter 6 discussed reliability assessment for short scales using Cronbach's alpha, McDonald's omega, and polychoric correlations. Chapter 7 presented multi-criteria decision-making (MCDM) methods (AHP, TOPSIS, VIKOR) for ranking alternatives with multiple criteria. Chapter 8 covered methods for sparse counts (exact Poisson tests, rate comparisons) and short time series (bootstrap forecast intervals, trend models). Each chapter included learning objectives, detailed method descriptions with assumptions and use cases, runnable R examples with small datasets, interpretations, key takeaways, and smoke tests. All code adheres to the specified packages and runs cleanly in a fresh R session. References to core sources (Van de Schoot &amp; MioÄeviÄ‡, Davison &amp; Hinkley, Good, Conover, Firth, Harrell, Hosmer et al., Shan) are integrated throughout the text where relevant.</span>
<span id="cb375-4339"><a href="#cb375-4339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4340"><a href="#cb375-4340" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-4341"><a href="#cb375-4341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4342"><a href="#cb375-4342" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part C Challenge: Complete Analysis Project</span></span>
<span id="cb375-4343"><a href="#cb375-4343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4344"><a href="#cb375-4344" aria-hidden="true" tabindex="-1"></a><span class="fu">### Hospital Readmission Risk Assessment</span></span>
<span id="cb375-4345"><a href="#cb375-4345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4346"><a href="#cb375-4346" aria-hidden="true" tabindex="-1"></a>**Scenario**: You work as a data analyst for a regional hospital. The quality improvement team has collected data from 25 patients to identify risk factors for 30-day readmission. Your task is to conduct a rigorous analysis using small-sample methods learned in Part C.</span>
<span id="cb375-4347"><a href="#cb375-4347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4348"><a href="#cb375-4348" aria-hidden="true" tabindex="-1"></a>**Dataset**: <span class="in">`data/hospital_readmissions.csv`</span></span>
<span id="cb375-4349"><a href="#cb375-4349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4350"><a href="#cb375-4350" aria-hidden="true" tabindex="-1"></a>**Variables**:</span>
<span id="cb375-4351"><a href="#cb375-4351" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`patient_id`</span>: Unique identifier</span>
<span id="cb375-4352"><a href="#cb375-4352" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`age`</span>: Patient age (years)</span>
<span id="cb375-4353"><a href="#cb375-4353" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`comorbidities`</span>: Number of chronic conditions (0-5)</span>
<span id="cb375-4354"><a href="#cb375-4354" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`length_of_stay`</span>: Initial hospitalization duration (days)</span>
<span id="cb375-4355"><a href="#cb375-4355" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`discharge_support`</span>: Follow-up arranged (Yes/No)</span>
<span id="cb375-4356"><a href="#cb375-4356" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`readmitted_30d`</span>: Readmitted within 30 days (1 = Yes, 0 = No)</span>
<span id="cb375-4357"><a href="#cb375-4357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4358"><a href="#cb375-4358" aria-hidden="true" tabindex="-1"></a>**Allocated Time**: 2-3 hours</span>
<span id="cb375-4359"><a href="#cb375-4359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4360"><a href="#cb375-4360" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-4361"><a href="#cb375-4361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4362"><a href="#cb375-4362" aria-hidden="true" tabindex="-1"></a><span class="fu">### Task 1: Exploratory Analysis (30 minutes)</span></span>
<span id="cb375-4363"><a href="#cb375-4363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4364"><a href="#cb375-4364" aria-hidden="true" tabindex="-1"></a>**Objectives**:</span>
<span id="cb375-4365"><a href="#cb375-4365" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Understand the data structure and quality</span>
<span id="cb375-4366"><a href="#cb375-4366" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Identify potential issues (outliers, missing data, separation)</span>
<span id="cb375-4367"><a href="#cb375-4367" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Visualize relationships between predictors and outcome</span>
<span id="cb375-4368"><a href="#cb375-4368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4369"><a href="#cb375-4369" aria-hidden="true" tabindex="-1"></a>**Deliverables**:</span>
<span id="cb375-4370"><a href="#cb375-4370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4371"><a href="#cb375-4371" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Summary statistics** for all variables (mean, SD, range for continuous; counts for categorical)</span>
<span id="cb375-4372"><a href="#cb375-4372" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Missing data report**: Use <span class="in">`naniar::miss_var_summary()`</span> to check missingness</span>
<span id="cb375-4373"><a href="#cb375-4373" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Outlier detection**: Boxplots for continuous variables</span>
<span id="cb375-4374"><a href="#cb375-4374" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Readmission rate by subgroups**:</span>
<span id="cb375-4375"><a href="#cb375-4375" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Age groups (&lt; 50, 50-70, &gt; 70)</span>
<span id="cb375-4376"><a href="#cb375-4376" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Discharge support (Yes vs No)</span>
<span id="cb375-4377"><a href="#cb375-4377" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Comorbidity burden (0-1, 2-3, 4-5)</span>
<span id="cb375-4378"><a href="#cb375-4378" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>**Visual summary**: </span>
<span id="cb375-4379"><a href="#cb375-4379" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Scatterplot matrix (age, comorbidities, length_of_stay colored by readmission status)</span>
<span id="cb375-4380"><a href="#cb375-4380" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Bar chart of readmission rates by discharge support</span>
<span id="cb375-4381"><a href="#cb375-4381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4382"><a href="#cb375-4382" aria-hidden="true" tabindex="-1"></a>**Starter Code**:</span>
<span id="cb375-4383"><a href="#cb375-4383" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb375-4384"><a href="#cb375-4384" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb375-4385"><a href="#cb375-4385" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(naniar)</span>
<span id="cb375-4386"><a href="#cb375-4386" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb375-4387"><a href="#cb375-4387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4388"><a href="#cb375-4388" aria-hidden="true" tabindex="-1"></a><span class="co"># Load data</span></span>
<span id="cb375-4389"><a href="#cb375-4389" aria-hidden="true" tabindex="-1"></a>hospital_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/hospital_readmissions.csv"</span>)</span>
<span id="cb375-4390"><a href="#cb375-4390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4391"><a href="#cb375-4391" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Summary statistics</span></span>
<span id="cb375-4392"><a href="#cb375-4392" aria-hidden="true" tabindex="-1"></a>hospital_data <span class="sc">%&gt;%</span></span>
<span id="cb375-4393"><a href="#cb375-4393" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span>
<span id="cb375-4394"><a href="#cb375-4394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4395"><a href="#cb375-4395" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Check for missing data</span></span>
<span id="cb375-4396"><a href="#cb375-4396" aria-hidden="true" tabindex="-1"></a><span class="fu">miss_var_summary</span>(hospital_data)</span>
<span id="cb375-4397"><a href="#cb375-4397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4398"><a href="#cb375-4398" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Visualize distributions</span></span>
<span id="cb375-4399"><a href="#cb375-4399" aria-hidden="true" tabindex="-1"></a>hospital_data <span class="sc">%&gt;%</span></span>
<span id="cb375-4400"><a href="#cb375-4400" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(age, comorbidities, length_of_stay) <span class="sc">%&gt;%</span></span>
<span id="cb375-4401"><a href="#cb375-4401" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb375-4402"><a href="#cb375-4402" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value)) <span class="sc">+</span></span>
<span id="cb375-4403"><a href="#cb375-4403" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">10</span>, <span class="at">fill =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb375-4404"><a href="#cb375-4404" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>name, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb375-4405"><a href="#cb375-4405" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb375-4406"><a href="#cb375-4406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4407"><a href="#cb375-4407" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Readmission rate by discharge support</span></span>
<span id="cb375-4408"><a href="#cb375-4408" aria-hidden="true" tabindex="-1"></a>hospital_data <span class="sc">%&gt;%</span></span>
<span id="cb375-4409"><a href="#cb375-4409" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(discharge_support) <span class="sc">%&gt;%</span></span>
<span id="cb375-4410"><a href="#cb375-4410" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb375-4411"><a href="#cb375-4411" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb375-4412"><a href="#cb375-4412" aria-hidden="true" tabindex="-1"></a>    <span class="at">readmissions =</span> <span class="fu">sum</span>(readmitted_30d),</span>
<span id="cb375-4413"><a href="#cb375-4413" aria-hidden="true" tabindex="-1"></a>    <span class="at">rate =</span> <span class="fu">mean</span>(readmitted_30d)</span>
<span id="cb375-4414"><a href="#cb375-4414" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb375-4415"><a href="#cb375-4415" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-4416"><a href="#cb375-4416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4417"><a href="#cb375-4417" aria-hidden="true" tabindex="-1"></a>**Critical Thinking Questions**:</span>
<span id="cb375-4418"><a href="#cb375-4418" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Are there any concerning patterns in the data (e.g., perfect separation)?</span>
<span id="cb375-4419"><a href="#cb375-4419" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Which variables show the strongest association with readmission?</span>
<span id="cb375-4420"><a href="#cb375-4420" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Is the sample size adequate for multivariable modeling?</span>
<span id="cb375-4421"><a href="#cb375-4421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4422"><a href="#cb375-4422" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-4423"><a href="#cb375-4423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4424"><a href="#cb375-4424" aria-hidden="true" tabindex="-1"></a><span class="fu">### Task 2: Model Comparison (45 minutes)</span></span>
<span id="cb375-4425"><a href="#cb375-4425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4426"><a href="#cb375-4426" aria-hidden="true" tabindex="-1"></a>**Objectives**:</span>
<span id="cb375-4427"><a href="#cb375-4427" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Fit standard and penalized logistic regression</span>
<span id="cb375-4428"><a href="#cb375-4428" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Compare model stability and predictions</span>
<span id="cb375-4429"><a href="#cb375-4429" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Understand when penalization is necessary</span>
<span id="cb375-4430"><a href="#cb375-4430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4431"><a href="#cb375-4431" aria-hidden="true" tabindex="-1"></a>**Deliverables**:</span>
<span id="cb375-4432"><a href="#cb375-4432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4433"><a href="#cb375-4433" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Standard logistic regression**:</span>
<span id="cb375-4434"><a href="#cb375-4434" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Model: <span class="in">`readmitted_30d ~ age + comorbidities + length_of_stay + discharge_support`</span></span>
<span id="cb375-4435"><a href="#cb375-4435" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Check for convergence warnings or extreme coefficients</span>
<span id="cb375-4436"><a href="#cb375-4436" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Extract coefficients, SEs, and odds ratios</span>
<span id="cb375-4437"><a href="#cb375-4437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4438"><a href="#cb375-4438" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Firth penalized logistic regression**:</span>
<span id="cb375-4439"><a href="#cb375-4439" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Same model specification</span>
<span id="cb375-4440"><a href="#cb375-4440" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Compare coefficients and SEs to standard model</span>
<span id="cb375-4441"><a href="#cb375-4441" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Note: Firth estimates should be smaller (shrunk toward zero)</span>
<span id="cb375-4442"><a href="#cb375-4442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4443"><a href="#cb375-4443" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Model comparison table**:</span>
<span id="cb375-4444"><a href="#cb375-4444" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Create a side-by-side table (use <span class="in">`gt`</span> package)</span>
<span id="cb375-4445"><a href="#cb375-4445" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Columns: Variable, Standard Î², Standard SE, Firth Î², Firth SE</span>
<span id="cb375-4446"><a href="#cb375-4446" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Highlight differences &gt; 20%</span>
<span id="cb375-4447"><a href="#cb375-4447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4448"><a href="#cb375-4448" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Predicted probabilities**:</span>
<span id="cb375-4449"><a href="#cb375-4449" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Plot predicted readmission probability vs. comorbidities (holding other variables at median/mode)</span>
<span id="cb375-4450"><a href="#cb375-4450" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Include 95% CIs</span>
<span id="cb375-4451"><a href="#cb375-4451" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Compare standard vs. Firth predictions</span>
<span id="cb375-4452"><a href="#cb375-4452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4453"><a href="#cb375-4453" aria-hidden="true" tabindex="-1"></a>**Starter Code**:</span>
<span id="cb375-4454"><a href="#cb375-4454" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb375-4455"><a href="#cb375-4455" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(logistf)</span>
<span id="cb375-4456"><a href="#cb375-4456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4457"><a href="#cb375-4457" aria-hidden="true" tabindex="-1"></a><span class="co"># Standard logistic regression</span></span>
<span id="cb375-4458"><a href="#cb375-4458" aria-hidden="true" tabindex="-1"></a>standard_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb375-4459"><a href="#cb375-4459" aria-hidden="true" tabindex="-1"></a>  readmitted_30d <span class="sc">~</span> age <span class="sc">+</span> comorbidities <span class="sc">+</span> length_of_stay <span class="sc">+</span> discharge_support,</span>
<span id="cb375-4460"><a href="#cb375-4460" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> hospital_data,</span>
<span id="cb375-4461"><a href="#cb375-4461" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>)</span>
<span id="cb375-4462"><a href="#cb375-4462" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb375-4463"><a href="#cb375-4463" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(standard_model)</span>
<span id="cb375-4464"><a href="#cb375-4464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4465"><a href="#cb375-4465" aria-hidden="true" tabindex="-1"></a><span class="co"># Firth penalized logistic regression</span></span>
<span id="cb375-4466"><a href="#cb375-4466" aria-hidden="true" tabindex="-1"></a>firth_model <span class="ot">&lt;-</span> <span class="fu">logistf</span>(</span>
<span id="cb375-4467"><a href="#cb375-4467" aria-hidden="true" tabindex="-1"></a>  readmitted_30d <span class="sc">~</span> age <span class="sc">+</span> comorbidities <span class="sc">+</span> length_of_stay <span class="sc">+</span> discharge_support,</span>
<span id="cb375-4468"><a href="#cb375-4468" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> hospital_data</span>
<span id="cb375-4469"><a href="#cb375-4469" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb375-4470"><a href="#cb375-4470" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(firth_model)</span>
<span id="cb375-4471"><a href="#cb375-4471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4472"><a href="#cb375-4472" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare coefficients</span></span>
<span id="cb375-4473"><a href="#cb375-4473" aria-hidden="true" tabindex="-1"></a>comparison <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb375-4474"><a href="#cb375-4474" aria-hidden="true" tabindex="-1"></a>  <span class="at">Variable =</span> <span class="fu">names</span>(<span class="fu">coef</span>(standard_model)),</span>
<span id="cb375-4475"><a href="#cb375-4475" aria-hidden="true" tabindex="-1"></a>  <span class="at">Standard_beta =</span> <span class="fu">coef</span>(standard_model),</span>
<span id="cb375-4476"><a href="#cb375-4476" aria-hidden="true" tabindex="-1"></a>  <span class="at">Standard_SE =</span> <span class="fu">summary</span>(standard_model)<span class="sc">$</span>coefficients[, <span class="dv">2</span>],</span>
<span id="cb375-4477"><a href="#cb375-4477" aria-hidden="true" tabindex="-1"></a>  <span class="at">Firth_beta =</span> <span class="fu">coef</span>(firth_model),</span>
<span id="cb375-4478"><a href="#cb375-4478" aria-hidden="true" tabindex="-1"></a>  <span class="at">Firth_SE =</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(firth_model<span class="sc">$</span>var))</span>
<span id="cb375-4479"><a href="#cb375-4479" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb375-4480"><a href="#cb375-4480" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Diff_pct =</span> <span class="fu">abs</span>((Firth_beta <span class="sc">-</span> Standard_beta) <span class="sc">/</span> Standard_beta) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb375-4481"><a href="#cb375-4481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4482"><a href="#cb375-4482" aria-hidden="true" tabindex="-1"></a>comparison <span class="sc">%&gt;%</span></span>
<span id="cb375-4483"><a href="#cb375-4483" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb375-4484"><a href="#cb375-4484" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(<span class="at">columns =</span> <span class="fu">c</span>(Standard_beta, Standard_SE, Firth_beta, Firth_SE, Diff_pct), <span class="at">decimals =</span> <span class="dv">3</span>)</span>
<span id="cb375-4485"><a href="#cb375-4485" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-4486"><a href="#cb375-4486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4487"><a href="#cb375-4487" aria-hidden="true" tabindex="-1"></a>**Critical Thinking Questions**:</span>
<span id="cb375-4488"><a href="#cb375-4488" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Did the standard model show warnings? If so, which type (separation, convergence)?</span>
<span id="cb375-4489"><a href="#cb375-4489" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Which coefficients changed most with Firth penalization?</span>
<span id="cb375-4490"><a href="#cb375-4490" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Which model would you trust for making clinical decisions? Why?</span>
<span id="cb375-4491"><a href="#cb375-4491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4492"><a href="#cb375-4492" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-4493"><a href="#cb375-4493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4494"><a href="#cb375-4494" aria-hidden="true" tabindex="-1"></a><span class="fu">### Task 3: Reporting and Communication (30 minutes)</span></span>
<span id="cb375-4495"><a href="#cb375-4495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4496"><a href="#cb375-4496" aria-hidden="true" tabindex="-1"></a>**Objectives**:</span>
<span id="cb375-4497"><a href="#cb375-4497" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Create publication-ready summary tables</span>
<span id="cb375-4498"><a href="#cb375-4498" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Visualize model predictions with uncertainty</span>
<span id="cb375-4499"><a href="#cb375-4499" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Write a concise results paragraph</span>
<span id="cb375-4500"><a href="#cb375-4500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4501"><a href="#cb375-4501" aria-hidden="true" tabindex="-1"></a>**Deliverables**:</span>
<span id="cb375-4502"><a href="#cb375-4502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4503"><a href="#cb375-4503" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Table 1**: Patient characteristics by readmission status</span>
<span id="cb375-4504"><a href="#cb375-4504" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Stratify by readmitted_30d (Yes/No)</span>
<span id="cb375-4505"><a href="#cb375-4505" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Include: n, mean age (SD), median comorbidities (IQR), % with discharge support</span>
<span id="cb375-4506"><a href="#cb375-4506" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Use <span class="in">`gtsummary::tbl_summary()`</span></span>
<span id="cb375-4507"><a href="#cb375-4507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4508"><a href="#cb375-4508" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Figure 1**: Predicted readmission probability plot</span>
<span id="cb375-4509"><a href="#cb375-4509" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>X-axis: Number of comorbidities (0-5)</span>
<span id="cb375-4510"><a href="#cb375-4510" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Y-axis: Predicted probability (0-1)</span>
<span id="cb375-4511"><a href="#cb375-4511" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Lines for Firth model predictions with 95% CI ribbon</span>
<span id="cb375-4512"><a href="#cb375-4512" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Rug plot showing observed data points</span>
<span id="cb375-4513"><a href="#cb375-4513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4514"><a href="#cb375-4514" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Results paragraph** (200 words max):</span>
<span id="cb375-4515"><a href="#cb375-4515" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Sample characteristics</span>
<span id="cb375-4516"><a href="#cb375-4516" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Model choice justification (standard vs. Firth)</span>
<span id="cb375-4517"><a href="#cb375-4517" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Key predictors with ORs and 95% CIs</span>
<span id="cb375-4518"><a href="#cb375-4518" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Interpretation for a clinical audience</span>
<span id="cb375-4519"><a href="#cb375-4519" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Limitations due to sample size</span>
<span id="cb375-4520"><a href="#cb375-4520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4521"><a href="#cb375-4521" aria-hidden="true" tabindex="-1"></a>**Example Results Template**:</span>
<span id="cb375-4522"><a href="#cb375-4522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4523"><a href="#cb375-4523" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; "Twenty-five patients (mean age 63.2 Â± 12.4 years, 48% with discharge support) were included. Eight patients (32%) were readmitted within 30 days. Due to the small sample size and potential separation, Firth penalized logistic regression was used. After adjusting for age and length of stay, comorbidity burden (OR = 1.8 per additional condition, 95% CI </span><span class="co">[</span><span class="ot">1.1, 3.2</span><span class="co">]</span><span class="at">, p = 0.02) and lack of discharge support (OR = 4.2, 95% CI </span><span class="co">[</span><span class="ot">1.2, 14.8</span><span class="co">]</span><span class="at">, p = 0.03) were associated with increased readmission risk. Predicted readmission probabilities ranged from 10% (no comorbidities, discharge support) to 75% (5 comorbidities, no support). Limitations include the small sample (wide CIs), single-center data, and unmeasured confounders (e.g., socioeconomic status, medication adherence). These findings warrant validation in a larger cohort (target n â‰¥ 150) before clinical implementation."</span></span>
<span id="cb375-4524"><a href="#cb375-4524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4525"><a href="#cb375-4525" aria-hidden="true" tabindex="-1"></a>**Starter Code**:</span>
<span id="cb375-4526"><a href="#cb375-4526" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb375-4527"><a href="#cb375-4527" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gtsummary)</span>
<span id="cb375-4528"><a href="#cb375-4528" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb375-4529"><a href="#cb375-4529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4530"><a href="#cb375-4530" aria-hidden="true" tabindex="-1"></a><span class="co"># Table 1: Patient characteristics</span></span>
<span id="cb375-4531"><a href="#cb375-4531" aria-hidden="true" tabindex="-1"></a>hospital_data <span class="sc">%&gt;%</span></span>
<span id="cb375-4532"><a href="#cb375-4532" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">readmitted_30d =</span> <span class="fu">factor</span>(readmitted_30d, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No"</span>, <span class="st">"Yes"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb375-4533"><a href="#cb375-4533" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tbl_summary</span>(</span>
<span id="cb375-4534"><a href="#cb375-4534" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> readmitted_30d,</span>
<span id="cb375-4535"><a href="#cb375-4535" aria-hidden="true" tabindex="-1"></a>    <span class="at">statistic =</span> <span class="fu">list</span>(<span class="fu">all_continuous</span>() <span class="sc">~</span> <span class="st">"{mean} ({sd})"</span>, <span class="fu">all_categorical</span>() <span class="sc">~</span> <span class="st">"{n} ({p}%)"</span>),</span>
<span id="cb375-4536"><a href="#cb375-4536" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">list</span>(</span>
<span id="cb375-4537"><a href="#cb375-4537" aria-hidden="true" tabindex="-1"></a>      age <span class="sc">~</span> <span class="st">"Age (years)"</span>,</span>
<span id="cb375-4538"><a href="#cb375-4538" aria-hidden="true" tabindex="-1"></a>      comorbidities <span class="sc">~</span> <span class="st">"Comorbidities"</span>,</span>
<span id="cb375-4539"><a href="#cb375-4539" aria-hidden="true" tabindex="-1"></a>      length_of_stay <span class="sc">~</span> <span class="st">"Length of Stay (days)"</span>,</span>
<span id="cb375-4540"><a href="#cb375-4540" aria-hidden="true" tabindex="-1"></a>      discharge_support <span class="sc">~</span> <span class="st">"Discharge Support"</span></span>
<span id="cb375-4541"><a href="#cb375-4541" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb375-4542"><a href="#cb375-4542" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb375-4543"><a href="#cb375-4543" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_overall</span>()</span>
<span id="cb375-4544"><a href="#cb375-4544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4545"><a href="#cb375-4545" aria-hidden="true" tabindex="-1"></a><span class="co"># Figure 1: Predicted probabilities</span></span>
<span id="cb375-4546"><a href="#cb375-4546" aria-hidden="true" tabindex="-1"></a>pred_data <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb375-4547"><a href="#cb375-4547" aria-hidden="true" tabindex="-1"></a>  <span class="at">comorbidities =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">5</span>,</span>
<span id="cb375-4548"><a href="#cb375-4548" aria-hidden="true" tabindex="-1"></a>  <span class="at">age =</span> <span class="fu">median</span>(hospital_data<span class="sc">$</span>age),</span>
<span id="cb375-4549"><a href="#cb375-4549" aria-hidden="true" tabindex="-1"></a>  <span class="at">length_of_stay =</span> <span class="fu">median</span>(hospital_data<span class="sc">$</span>length_of_stay),</span>
<span id="cb375-4550"><a href="#cb375-4550" aria-hidden="true" tabindex="-1"></a>  <span class="at">discharge_support =</span> <span class="st">"Yes"</span></span>
<span id="cb375-4551"><a href="#cb375-4551" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb375-4552"><a href="#cb375-4552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4553"><a href="#cb375-4553" aria-hidden="true" tabindex="-1"></a><span class="co"># Get predictions from Firth model</span></span>
<span id="cb375-4554"><a href="#cb375-4554" aria-hidden="true" tabindex="-1"></a>pred_data<span class="sc">$</span>predicted <span class="ot">&lt;-</span> <span class="fu">predict</span>(firth_model, <span class="at">newdata =</span> pred_data, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb375-4555"><a href="#cb375-4555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4556"><a href="#cb375-4556" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb375-4557"><a href="#cb375-4557" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pred_data, <span class="fu">aes</span>(<span class="at">x =</span> comorbidities, <span class="at">y =</span> predicted)) <span class="sc">+</span></span>
<span id="cb375-4558"><a href="#cb375-4558" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb375-4559"><a href="#cb375-4559" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> hospital_data, <span class="fu">aes</span>(<span class="at">y =</span> readmitted_30d), <span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">height =</span> <span class="fl">0.02</span>)) <span class="sc">+</span></span>
<span id="cb375-4560"><a href="#cb375-4560" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb375-4561"><a href="#cb375-4561" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Predicted 30-Day Readmission Probability"</span>,</span>
<span id="cb375-4562"><a href="#cb375-4562" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Number of Comorbidities"</span>,</span>
<span id="cb375-4563"><a href="#cb375-4563" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Predicted Probability"</span>,</span>
<span id="cb375-4564"><a href="#cb375-4564" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"Model: Firth penalized logistic regression, adjusted for age and length of stay"</span></span>
<span id="cb375-4565"><a href="#cb375-4565" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb375-4566"><a href="#cb375-4566" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">labels =</span> scales<span class="sc">::</span>percent) <span class="sc">+</span></span>
<span id="cb375-4567"><a href="#cb375-4567" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb375-4568"><a href="#cb375-4568" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-4569"><a href="#cb375-4569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4570"><a href="#cb375-4570" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-4571"><a href="#cb375-4571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4572"><a href="#cb375-4572" aria-hidden="true" tabindex="-1"></a><span class="fu">### Task 4: Critical Reflection (15 minutes)</span></span>
<span id="cb375-4573"><a href="#cb375-4573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4574"><a href="#cb375-4574" aria-hidden="true" tabindex="-1"></a>Answer these questions in your report:</span>
<span id="cb375-4575"><a href="#cb375-4575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4576"><a href="#cb375-4576" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Main Limitation**: What is the single biggest limitation of your analysis? How does it affect your conclusions?</span>
<span id="cb375-4577"><a href="#cb375-4577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4578"><a href="#cb375-4578" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Additional Data**: If you could collect 10 more variables on these same 25 patients, what would they be? Why?</span>
<span id="cb375-4579"><a href="#cb375-4579" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Consider: socioeconomic factors, medication adherence, social support, disease severity markers, provider characteristics</span>
<span id="cb375-4580"><a href="#cb375-4580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4581"><a href="#cb375-4581" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Prospective Validation**: How would you validate this model before implementing it clinically?</span>
<span id="cb375-4582"><a href="#cb375-4582" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Sample size calculation (how many patients needed?)</span>
<span id="cb375-4583"><a href="#cb375-4583" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Calibration and discrimination metrics (Brier score, C-statistic)</span>
<span id="cb375-4584"><a href="#cb375-4584" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>External validation (different hospital/region)</span>
<span id="cb375-4585"><a href="#cb375-4585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4586"><a href="#cb375-4586" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Ethical Considerations**: If this model were used to allocate discharge support resources, what could go wrong?</span>
<span id="cb375-4587"><a href="#cb375-4587" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>False positives (wasted resources)</span>
<span id="cb375-4588"><a href="#cb375-4588" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>False negatives (missed high-risk patients)</span>
<span id="cb375-4589"><a href="#cb375-4589" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Algorithmic bias (if training data not representative)</span>
<span id="cb375-4590"><a href="#cb375-4590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4591"><a href="#cb375-4591" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-4592"><a href="#cb375-4592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4593"><a href="#cb375-4593" aria-hidden="true" tabindex="-1"></a><span class="fu">### Evaluation Rubric</span></span>
<span id="cb375-4594"><a href="#cb375-4594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4595"><a href="#cb375-4595" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Criterion <span class="pp">|</span> Excellent (4) <span class="pp">|</span> Good (3) <span class="pp">|</span> Satisfactory (2) <span class="pp">|</span> Needs Improvement (1) <span class="pp">|</span></span>
<span id="cb375-4596"><a href="#cb375-4596" aria-hidden="true" tabindex="-1"></a><span class="pp">|-----------|---------------|----------|------------------|-----------------------|</span></span>
<span id="cb375-4597"><a href="#cb375-4597" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Code Quality** <span class="pp">|</span> All code runs without errors; well-commented; efficient <span class="pp">|</span> Code runs with minor tweaks; some comments <span class="pp">|</span> Code has errors but approach is sound <span class="pp">|</span> Code doesn't run or approach is flawed <span class="pp">|</span></span>
<span id="cb375-4598"><a href="#cb375-4598" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Statistical Rigor** <span class="pp">|</span> Appropriate methods; checks assumptions; reports uncertainties <span class="pp">|</span> Mostly appropriate; minor omissions <span class="pp">|</span> Some questionable choices; incomplete checks <span class="pp">|</span> Major methodological errors <span class="pp">|</span></span>
<span id="cb375-4599"><a href="#cb375-4599" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Communication** <span class="pp">|</span> Clear, concise, audience-appropriate; publication-ready <span class="pp">|</span> Clear but could be more concise <span class="pp">|</span> Understandable but jargon-heavy <span class="pp">|</span> Unclear or incomplete <span class="pp">|</span></span>
<span id="cb375-4600"><a href="#cb375-4600" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Critical Thinking** <span class="pp">|</span> Insightful limitations; creative solutions; anticipates questions <span class="pp">|</span> Identifies key limitations; standard solutions <span class="pp">|</span> Basic limitations noted <span class="pp">|</span> Limitations not addressed <span class="pp">|</span></span>
<span id="cb375-4601"><a href="#cb375-4601" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Visualization** <span class="pp">|</span> Publication-ready figures; clear labels; appropriate scales <span class="pp">|</span> Good figures with minor issues <span class="pp">|</span> Adequate but could be clearer <span class="pp">|</span> Poor or missing figures <span class="pp">|</span></span>
<span id="cb375-4602"><a href="#cb375-4602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4603"><a href="#cb375-4603" aria-hidden="true" tabindex="-1"></a>**Passing Standard**: Score â‰¥ 10/20 (Average of 2 per criterion)</span>
<span id="cb375-4604"><a href="#cb375-4604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4605"><a href="#cb375-4605" aria-hidden="true" tabindex="-1"></a>**Excellence Standard**: Score â‰¥ 16/20 (Average of 3.2 per criterion)</span>
<span id="cb375-4606"><a href="#cb375-4606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4607"><a href="#cb375-4607" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-4608"><a href="#cb375-4608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4609"><a href="#cb375-4609" aria-hidden="true" tabindex="-1"></a><span class="fu">### Extension Challenges (Optional)</span></span>
<span id="cb375-4610"><a href="#cb375-4610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4611"><a href="#cb375-4611" aria-hidden="true" tabindex="-1"></a>For advanced students:</span>
<span id="cb375-4612"><a href="#cb375-4612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4613"><a href="#cb375-4613" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Bayesian Logistic Regression**: Fit the model using <span class="in">`rstanarm::stan_glm()`</span> with weakly informative priors. Compare posterior intervals to Firth CIs.</span>
<span id="cb375-4614"><a href="#cb375-4614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4615"><a href="#cb375-4615" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Cross-Validation**: Perform leave-one-out cross-validation to assess predictive accuracy. Report the C-statistic (AUC).</span>
<span id="cb375-4616"><a href="#cb375-4616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4617"><a href="#cb375-4617" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Nonparametric Approach**: Use Mann-Whitney U tests to compare continuous predictors by readmission status. Compute Cliff's Delta effect sizes.</span>
<span id="cb375-4618"><a href="#cb375-4618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4619"><a href="#cb375-4619" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Sensitivity Analysis**: How do results change if you exclude patients with age &gt; 80 or comorbidities = 0?</span>
<span id="cb375-4620"><a href="#cb375-4620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4621"><a href="#cb375-4621" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>**Sample Size Calculation**: Using your effect size estimates, calculate the sample size needed to achieve 80% power to detect the effect of discharge support (Î± = 0.05).</span>
<span id="cb375-4622"><a href="#cb375-4622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4623"><a href="#cb375-4623" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-4624"><a href="#cb375-4624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4625"><a href="#cb375-4625" aria-hidden="true" tabindex="-1"></a><span class="fu">### Submission Format</span></span>
<span id="cb375-4626"><a href="#cb375-4626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4627"><a href="#cb375-4627" aria-hidden="true" tabindex="-1"></a>Create a Quarto document (.qmd) with:</span>
<span id="cb375-4628"><a href="#cb375-4628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4629"><a href="#cb375-4629" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Title and Author**: "Hospital Readmission Risk Assessment" + your name</span>
<span id="cb375-4630"><a href="#cb375-4630" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Sections**: Introduction, Methods, Results, Discussion, References</span>
<span id="cb375-4631"><a href="#cb375-4631" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Code chunks**: Labeled and with <span class="in">`echo=TRUE`</span> so the instructor can see your code</span>
<span id="cb375-4632"><a href="#cb375-4632" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Outputs**: Tables and figures embedded in the document</span>
<span id="cb375-4633"><a href="#cb375-4633" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>**Narrative**: Connecting paragraphs explaining your choices and interpretations</span>
<span id="cb375-4634"><a href="#cb375-4634" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span>**Appendix**: Critical reflection answers (Task 4)</span>
<span id="cb375-4635"><a href="#cb375-4635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4636"><a href="#cb375-4636" aria-hidden="true" tabindex="-1"></a>Render to HTML or PDF and submit via your learning management system.</span>
<span id="cb375-4637"><a href="#cb375-4637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4638"><a href="#cb375-4638" aria-hidden="true" tabindex="-1"></a>**Expected length**: 5-8 pages (including figures and code)</span>
<span id="cb375-4639"><a href="#cb375-4639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4640"><a href="#cb375-4640" aria-hidden="true" tabindex="-1"></a>**Deadline**: <span class="co">[</span><span class="ot">Set by instructor</span><span class="co">]</span></span>
<span id="cb375-4641"><a href="#cb375-4641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4642"><a href="#cb375-4642" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb375-4643"><a href="#cb375-4643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4644"><a href="#cb375-4644" aria-hidden="true" tabindex="-1"></a>This challenge integrates concepts from Chapters 3-8 and requires students to make methodological decisions, interpret results, and communicate findingsâ€”core skills for small-sample research.</span>
</code></pre></div><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>