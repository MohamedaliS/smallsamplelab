<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.24">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Part G: Guided Lab Practicals – Quantitative Analysis with Small Samples</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../chapters/part-h-instructors-manual.html" rel="next">
<link href="../chapters/part-f-technical-appendices.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dc55a5b9e770e841cd82e46aadbfb9b0.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-fc52e084097f5e82659c47ea4c4460c4.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../chapters/part-g-lab-practicals.html">Part G: Guided Lab Practicals</a></li><li class="breadcrumb-item"><a href="../chapters/part-g-lab-practicals.html">Part G: Guided Lab Practicals</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="../index.html" class="sidebar-logo-link">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Quantitative Analysis with Small Samples</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Part A: Foundations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/part-a-foundations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Part A: Foundations</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Part B: Data Collection and Preparation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/part-b-data-collection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Part B: Data Collection and Preparation</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Part C: Analysis Methods</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/part-c-analysis-methods.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Part C: Analysis Methods</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Part D: Reporting and Interpretation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/part-d-reporting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Part D: Reporting and Interpretation</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Part E: Worked Projects</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/part-e-worked-projects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Part E: Worked Projects</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">Part F: Technical Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/part-f-technical-appendices.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Part F: Technical Appendices</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">Part G: Guided Lab Practicals</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/part-g-lab-practicals.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Part G: Guided Lab Practicals</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true">
 <span class="menu-text">Part H: Instructor’s Manual</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/part-h-instructors-manual.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Part H: Instructor’s Manual</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#lab-1-fishers-exact-test-chapter-3" id="toc-lab-1-fishers-exact-test-chapter-3" class="nav-link active" data-scroll-target="#lab-1-fishers-exact-test-chapter-3">Lab 1: Fisher’s Exact Test (Chapter 3)</a></li>
  <li><a href="#lab-practical-1-fishers-exact-test-step-by-step" id="toc-lab-practical-1-fishers-exact-test-step-by-step" class="nav-link" data-scroll-target="#lab-practical-1-fishers-exact-test-step-by-step">🧪 Lab Practical 1: Fisher’s Exact Test Step-by-Step</a>
  <ul class="collapse">
  <li><a href="#scenario" id="toc-scenario" class="nav-link" data-scroll-target="#scenario">Scenario</a></li>
  <li><a href="#step-1-set-up-your-workspace" id="toc-step-1-set-up-your-workspace" class="nav-link" data-scroll-target="#step-1-set-up-your-workspace">Step 1: Set Up Your Workspace</a></li>
  <li><a href="#step-2-create-the-22-table" id="toc-step-2-create-the-22-table" class="nav-link" data-scroll-target="#step-2-create-the-22-table">Step 2: Create the 2×2 Table</a></li>
  <li><a href="#step-3-visual-inspection" id="toc-step-3-visual-inspection" class="nav-link" data-scroll-target="#step-3-visual-inspection">Step 3: Visual Inspection</a></li>
  <li><a href="#step-4-check-expected-cell-counts" id="toc-step-4-check-expected-cell-counts" class="nav-link" data-scroll-target="#step-4-check-expected-cell-counts">Step 4: Check Expected Cell Counts</a></li>
  <li><a href="#step-5-run-fishers-exact-test" id="toc-step-5-run-fishers-exact-test" class="nav-link" data-scroll-target="#step-5-run-fishers-exact-test">Step 5: Run Fisher’s Exact Test</a></li>
  <li><a href="#step-6-extract-and-interpret-key-values" id="toc-step-6-extract-and-interpret-key-values" class="nav-link" data-scroll-target="#step-6-extract-and-interpret-key-values">Step 6: Extract and Interpret Key Values</a></li>
  <li><a href="#step-7-compare-with-chi-square-educational" id="toc-step-7-compare-with-chi-square-educational" class="nav-link" data-scroll-target="#step-7-compare-with-chi-square-educational">Step 7: Compare with Chi-Square (Educational)</a></li>
  <li><a href="#step-8-create-a-publication-ready-table" id="toc-step-8-create-a-publication-ready-table" class="nav-link" data-scroll-target="#step-8-create-a-publication-ready-table">Step 8: Create a Publication-Ready Table</a></li>
  <li><a href="#discussion-questions" id="toc-discussion-questions" class="nav-link" data-scroll-target="#discussion-questions">❓ Discussion Questions</a></li>
  <li><a href="#key-takeaways" id="toc-key-takeaways" class="nav-link" data-scroll-target="#key-takeaways">💡 Key Takeaways</a></li>
  <li><a href="#homework-exercise" id="toc-homework-exercise" class="nav-link" data-scroll-target="#homework-exercise">🏠 Homework Exercise</a></li>
  <li><a href="#lab-2-bootstrap-confidence-intervals-chapter-3" id="toc-lab-2-bootstrap-confidence-intervals-chapter-3" class="nav-link" data-scroll-target="#lab-2-bootstrap-confidence-intervals-chapter-3">Lab 2: Bootstrap Confidence Intervals (Chapter 3)</a></li>
  </ul></li>
  <li><a href="#lab-practical-2-bootstrap-confidence-intervals" id="toc-lab-practical-2-bootstrap-confidence-intervals" class="nav-link" data-scroll-target="#lab-practical-2-bootstrap-confidence-intervals">🧪 Lab Practical 2: Bootstrap Confidence Intervals</a>
  <ul class="collapse">
  <li><a href="#scenario-1" id="toc-scenario-1" class="nav-link" data-scroll-target="#scenario-1">Scenario</a></li>
  <li><a href="#step-1-load-data-and-visualize-distribution" id="toc-step-1-load-data-and-visualize-distribution" class="nav-link" data-scroll-target="#step-1-load-data-and-visualize-distribution">Step 1: Load Data and Visualize Distribution</a></li>
  <li><a href="#step-2-calculate-parametric-ci-for-comparison" id="toc-step-2-calculate-parametric-ci-for-comparison" class="nav-link" data-scroll-target="#step-2-calculate-parametric-ci-for-comparison">Step 2: Calculate Parametric CI (For Comparison)</a></li>
  <li><a href="#step-3-bootstrap-the-median-manual-method" id="toc-step-3-bootstrap-the-median-manual-method" class="nav-link" data-scroll-target="#step-3-bootstrap-the-median-manual-method">Step 3: Bootstrap the Median (Manual Method)</a></li>
  <li><a href="#step-4-calculate-percentile-bootstrap-ci" id="toc-step-4-calculate-percentile-bootstrap-ci" class="nav-link" data-scroll-target="#step-4-calculate-percentile-bootstrap-ci">Step 4: Calculate Percentile Bootstrap CI</a></li>
  <li><a href="#step-5-use-boot-package-for-bca-ci" id="toc-step-5-use-boot-package-for-bca-ci" class="nav-link" data-scroll-target="#step-5-use-boot-package-for-bca-ci">Step 5: Use boot Package for BCa CI</a></li>
  <li><a href="#step-6-compare-all-methods" id="toc-step-6-compare-all-methods" class="nav-link" data-scroll-target="#step-6-compare-all-methods">Step 6: Compare All Methods</a></li>
  <li><a href="#step-7-diagnostic-checks" id="toc-step-7-diagnostic-checks" class="nav-link" data-scroll-target="#step-7-diagnostic-checks">Step 7: Diagnostic Checks</a></li>
  <li><a href="#step-8-publication-ready-figure" id="toc-step-8-publication-ready-figure" class="nav-link" data-scroll-target="#step-8-publication-ready-figure">Step 8: Publication-Ready Figure</a></li>
  <li><a href="#discussion-questions-1" id="toc-discussion-questions-1" class="nav-link" data-scroll-target="#discussion-questions-1">❓ Discussion Questions</a></li>
  <li><a href="#key-takeaways-1" id="toc-key-takeaways-1" class="nav-link" data-scroll-target="#key-takeaways-1">💡 Key Takeaways</a></li>
  <li><a href="#homework-exercise-1" id="toc-homework-exercise-1" class="nav-link" data-scroll-target="#homework-exercise-1">🏠 Homework Exercise</a></li>
  <li><a href="#lab-3-mann-whitney-u-test-chapter-4" id="toc-lab-3-mann-whitney-u-test-chapter-4" class="nav-link" data-scroll-target="#lab-3-mann-whitney-u-test-chapter-4">Lab 3: Mann-Whitney U Test (Chapter 4)</a></li>
  </ul></li>
  <li><a href="#lab-practical-3-mann-whitney-u-test" id="toc-lab-practical-3-mann-whitney-u-test" class="nav-link" data-scroll-target="#lab-practical-3-mann-whitney-u-test">🧪 Lab Practical 3: Mann-Whitney U Test</a>
  <ul class="collapse">
  <li><a href="#scenario-2" id="toc-scenario-2" class="nav-link" data-scroll-target="#scenario-2">Scenario</a></li>
  <li><a href="#step-1-load-and-visualize-data" id="toc-step-1-load-and-visualize-data" class="nav-link" data-scroll-target="#step-1-load-and-visualize-data">Step 1: Load and Visualize Data</a></li>
  <li><a href="#step-2-check-normality-for-educational-purposes" id="toc-step-2-check-normality-for-educational-purposes" class="nav-link" data-scroll-target="#step-2-check-normality-for-educational-purposes">Step 2: Check Normality (For Educational Purposes)</a></li>
  <li><a href="#step-3-run-mann-whitney-u-test" id="toc-step-3-run-mann-whitney-u-test" class="nav-link" data-scroll-target="#step-3-run-mann-whitney-u-test">Step 3: Run Mann-Whitney U Test</a></li>
  <li><a href="#step-4-calculate-hodges-lehmann-estimate-manually" id="toc-step-4-calculate-hodges-lehmann-estimate-manually" class="nav-link" data-scroll-target="#step-4-calculate-hodges-lehmann-estimate-manually">Step 4: Calculate Hodges-Lehmann Estimate Manually</a></li>
  <li><a href="#step-5-calculate-effect-size-rank-biserial-correlation" id="toc-step-5-calculate-effect-size-rank-biserial-correlation" class="nav-link" data-scroll-target="#step-5-calculate-effect-size-rank-biserial-correlation">Step 5: Calculate Effect Size (Rank-Biserial Correlation)</a></li>
  <li><a href="#step-6-compare-with-t-test-educational" id="toc-step-6-compare-with-t-test-educational" class="nav-link" data-scroll-target="#step-6-compare-with-t-test-educational">Step 6: Compare with t-test (Educational)</a></li>
  <li><a href="#step-7-create-publication-table" id="toc-step-7-create-publication-table" class="nav-link" data-scroll-target="#step-7-create-publication-table">Step 7: Create Publication Table</a></li>
  <li><a href="#step-8-visualize-effect-with-rank-plot" id="toc-step-8-visualize-effect-with-rank-plot" class="nav-link" data-scroll-target="#step-8-visualize-effect-with-rank-plot">Step 8: Visualize Effect with Rank Plot</a></li>
  <li><a href="#discussion-questions-2" id="toc-discussion-questions-2" class="nav-link" data-scroll-target="#discussion-questions-2">❓ Discussion Questions</a></li>
  <li><a href="#key-takeaways-2" id="toc-key-takeaways-2" class="nav-link" data-scroll-target="#key-takeaways-2">💡 Key Takeaways</a></li>
  <li><a href="#homework-exercise-2" id="toc-homework-exercise-2" class="nav-link" data-scroll-target="#homework-exercise-2">🏠 Homework Exercise</a></li>
  <li><a href="#lab-4-wilcoxon-signed-rank-test-chapter-4" id="toc-lab-4-wilcoxon-signed-rank-test-chapter-4" class="nav-link" data-scroll-target="#lab-4-wilcoxon-signed-rank-test-chapter-4">Lab 4: Wilcoxon Signed-Rank Test (Chapter 4)</a></li>
  </ul></li>
  <li><a href="#lab-practical-4-wilcoxon-signed-rank-test" id="toc-lab-practical-4-wilcoxon-signed-rank-test" class="nav-link" data-scroll-target="#lab-practical-4-wilcoxon-signed-rank-test">🧪 Lab Practical 4: Wilcoxon Signed-Rank Test</a>
  <ul class="collapse">
  <li><a href="#scenario-3" id="toc-scenario-3" class="nav-link" data-scroll-target="#scenario-3">Scenario</a></li>
  <li><a href="#step-1-create-and-visualize-paired-data" id="toc-step-1-create-and-visualize-paired-data" class="nav-link" data-scroll-target="#step-1-create-and-visualize-paired-data">Step 1: Create and Visualize Paired Data</a></li>
  <li><a href="#step-2-calculate-and-visualize-differences" id="toc-step-2-calculate-and-visualize-differences" class="nav-link" data-scroll-target="#step-2-calculate-and-visualize-differences">Step 2: Calculate and Visualize Differences</a></li>
  <li><a href="#step-3-run-wilcoxon-signed-rank-test" id="toc-step-3-run-wilcoxon-signed-rank-test" class="nav-link" data-scroll-target="#step-3-run-wilcoxon-signed-rank-test">Step 3: Run Wilcoxon Signed-Rank Test</a></li>
  <li><a href="#step-4-calculate-effect-size-r" id="toc-step-4-calculate-effect-size-r" class="nav-link" data-scroll-target="#step-4-calculate-effect-size-r">Step 4: Calculate Effect Size (r)</a></li>
  <li><a href="#step-5-compare-with-paired-t-test" id="toc-step-5-compare-with-paired-t-test" class="nav-link" data-scroll-target="#step-5-compare-with-paired-t-test">Step 5: Compare with Paired t-test</a></li>
  <li><a href="#step-6-check-for-outliers-in-differences" id="toc-step-6-check-for-outliers-in-differences" class="nav-link" data-scroll-target="#step-6-check-for-outliers-in-differences">Step 6: Check for Outliers in Differences</a></li>
  <li><a href="#step-7-create-publication-table-1" id="toc-step-7-create-publication-table-1" class="nav-link" data-scroll-target="#step-7-create-publication-table-1">Step 7: Create Publication Table</a></li>
  <li><a href="#step-8-individual-client-profile-plot" id="toc-step-8-individual-client-profile-plot" class="nav-link" data-scroll-target="#step-8-individual-client-profile-plot">Step 8: Individual Client Profile Plot</a></li>
  <li><a href="#discussion-questions-3" id="toc-discussion-questions-3" class="nav-link" data-scroll-target="#discussion-questions-3">❓ Discussion Questions</a></li>
  <li><a href="#key-takeaways-3" id="toc-key-takeaways-3" class="nav-link" data-scroll-target="#key-takeaways-3">💡 Key Takeaways</a></li>
  <li><a href="#homework-exercise-3" id="toc-homework-exercise-3" class="nav-link" data-scroll-target="#homework-exercise-3">🏠 Homework Exercise</a></li>
  <li><a href="#lab-firth" id="toc-lab-firth" class="nav-link" data-scroll-target="#lab-firth">Lab 5: Firth’s Penalized Logistic Regression</a>
  <ul class="collapse">
  <li><a href="#step-1-set-up-and-load-data" id="toc-step-1-set-up-and-load-data" class="nav-link" data-scroll-target="#step-1-set-up-and-load-data">Step 1: Set Up and Load Data</a></li>
  <li><a href="#step-2-attempt-standard-logistic-regression" id="toc-step-2-attempt-standard-logistic-regression" class="nav-link" data-scroll-target="#step-2-attempt-standard-logistic-regression">Step 2: Attempt Standard Logistic Regression</a></li>
  <li><a href="#step-3-apply-firths-penalized-logistic-regression" id="toc-step-3-apply-firths-penalized-logistic-regression" class="nav-link" data-scroll-target="#step-3-apply-firths-penalized-logistic-regression">Step 3: Apply Firth’s Penalized Logistic Regression</a></li>
  <li><a href="#step-4-compare-methods-side-by-side" id="toc-step-4-compare-methods-side-by-side" class="nav-link" data-scroll-target="#step-4-compare-methods-side-by-side">Step 4: Compare Methods Side-by-Side</a></li>
  <li><a href="#step-5-assess-model-fit" id="toc-step-5-assess-model-fit" class="nav-link" data-scroll-target="#step-5-assess-model-fit">Step 5: Assess Model Fit</a></li>
  <li><a href="#step-6-predicted-probabilities" id="toc-step-6-predicted-probabilities" class="nav-link" data-scroll-target="#step-6-predicted-probabilities">Step 6: Predicted Probabilities</a></li>
  <li><a href="#step-7-create-publication-table-2" id="toc-step-7-create-publication-table-2" class="nav-link" data-scroll-target="#step-7-create-publication-table-2">Step 7: Create Publication Table</a></li>
  <li><a href="#step-8-interpret-and-report" id="toc-step-8-interpret-and-report" class="nav-link" data-scroll-target="#step-8-interpret-and-report">Step 8: Interpret and Report</a></li>
  <li><a href="#discussion-questions-4" id="toc-discussion-questions-4" class="nav-link" data-scroll-target="#discussion-questions-4">Discussion Questions</a></li>
  <li><a href="#key-takeaways-4" id="toc-key-takeaways-4" class="nav-link" data-scroll-target="#key-takeaways-4">Key Takeaways</a></li>
  <li><a href="#homework-exercise-4" id="toc-homework-exercise-4" class="nav-link" data-scroll-target="#homework-exercise-4">Homework Exercise</a></li>
  </ul></li>
  <li><a href="#lab-bayesian" id="toc-lab-bayesian" class="nav-link" data-scroll-target="#lab-bayesian">Lab 6: Bayesian Regression with Small Samples</a>
  <ul class="collapse">
  <li><a href="#step-1-set-up-and-load-data-1" id="toc-step-1-set-up-and-load-data-1" class="nav-link" data-scroll-target="#step-1-set-up-and-load-data-1">Step 1: Set Up and Load Data</a></li>
  <li><a href="#step-2-specify-priors" id="toc-step-2-specify-priors" class="nav-link" data-scroll-target="#step-2-specify-priors">Step 2: Specify Priors</a></li>
  <li><a href="#step-3-fit-bayesian-model" id="toc-step-3-fit-bayesian-model" class="nav-link" data-scroll-target="#step-3-fit-bayesian-model">Step 3: Fit Bayesian Model</a></li>
  <li><a href="#step-4-check-mcmc-diagnostics" id="toc-step-4-check-mcmc-diagnostics" class="nav-link" data-scroll-target="#step-4-check-mcmc-diagnostics">Step 4: Check MCMC Diagnostics</a></li>
  <li><a href="#step-5-extract-and-visualize-posteriors" id="toc-step-5-extract-and-visualize-posteriors" class="nav-link" data-scroll-target="#step-5-extract-and-visualize-posteriors">Step 5: Extract and Visualize Posteriors</a></li>
  <li><a href="#step-6-posterior-predictive-checks" id="toc-step-6-posterior-predictive-checks" class="nav-link" data-scroll-target="#step-6-posterior-predictive-checks">Step 6: Posterior Predictive Checks</a></li>
  <li><a href="#step-7-compare-with-frequentist-approach" id="toc-step-7-compare-with-frequentist-approach" class="nav-link" data-scroll-target="#step-7-compare-with-frequentist-approach">Step 7: Compare with Frequentist Approach</a></li>
  <li><a href="#step-8-interpret-and-report-1" id="toc-step-8-interpret-and-report-1" class="nav-link" data-scroll-target="#step-8-interpret-and-report-1">Step 8: Interpret and Report</a></li>
  <li><a href="#discussion-questions-5" id="toc-discussion-questions-5" class="nav-link" data-scroll-target="#discussion-questions-5">Discussion Questions</a></li>
  <li><a href="#key-takeaways-5" id="toc-key-takeaways-5" class="nav-link" data-scroll-target="#key-takeaways-5">Key Takeaways</a></li>
  <li><a href="#homework-exercise-5" id="toc-homework-exercise-5" class="nav-link" data-scroll-target="#homework-exercise-5">Homework Exercise</a></li>
  </ul></li>
  <li><a href="#lab-reliability" id="toc-lab-reliability" class="nav-link" data-scroll-target="#lab-reliability">Lab 7: Reliability Analysis with Cronbach’s Alpha</a>
  <ul class="collapse">
  <li><a href="#step-1-set-up-and-load-data-2" id="toc-step-1-set-up-and-load-data-2" class="nav-link" data-scroll-target="#step-1-set-up-and-load-data-2">Step 1: Set Up and Load Data</a></li>
  <li><a href="#step-2-visualize-inter-item-correlations" id="toc-step-2-visualize-inter-item-correlations" class="nav-link" data-scroll-target="#step-2-visualize-inter-item-correlations">Step 2: Visualize Inter-Item Correlations</a></li>
  <li><a href="#step-3-calculate-cronbachs-alpha" id="toc-step-3-calculate-cronbachs-alpha" class="nav-link" data-scroll-target="#step-3-calculate-cronbachs-alpha">Step 3: Calculate Cronbach’s Alpha</a></li>
  <li><a href="#step-4-item-total-correlations" id="toc-step-4-item-total-correlations" class="nav-link" data-scroll-target="#step-4-item-total-correlations">Step 4: Item-Total Correlations</a></li>
  <li><a href="#step-5-alpha-if-item-deleted-analysis" id="toc-step-5-alpha-if-item-deleted-analysis" class="nav-link" data-scroll-target="#step-5-alpha-if-item-deleted-analysis">Step 5: “Alpha if Item Deleted” Analysis</a></li>
  <li><a href="#step-6-recompute-alpha-without-problematic-item" id="toc-step-6-recompute-alpha-without-problematic-item" class="nav-link" data-scroll-target="#step-6-recompute-alpha-without-problematic-item">Step 6: Recompute Alpha Without Problematic Item</a></li>
  <li><a href="#step-7-final-scale-scoring" id="toc-step-7-final-scale-scoring" class="nav-link" data-scroll-target="#step-7-final-scale-scoring">Step 7: Final Scale Scoring</a></li>
  <li><a href="#step-8-create-publication-table" id="toc-step-8-create-publication-table" class="nav-link" data-scroll-target="#step-8-create-publication-table">Step 8: Create Publication Table</a></li>
  <li><a href="#discussion-questions-6" id="toc-discussion-questions-6" class="nav-link" data-scroll-target="#discussion-questions-6">Discussion Questions</a></li>
  <li><a href="#key-takeaways-6" id="toc-key-takeaways-6" class="nav-link" data-scroll-target="#key-takeaways-6">Key Takeaways</a></li>
  <li><a href="#homework-exercise-6" id="toc-homework-exercise-6" class="nav-link" data-scroll-target="#homework-exercise-6">Homework Exercise</a></li>
  </ul></li>
  <li><a href="#lab-power" id="toc-lab-power" class="nav-link" data-scroll-target="#lab-power">Lab 8: Power Analysis for Study Planning</a>
  <ul class="collapse">
  <li><a href="#step-1-set-up-and-define-parameters" id="toc-step-1-set-up-and-define-parameters" class="nav-link" data-scroll-target="#step-1-set-up-and-define-parameters">Step 1: Set Up and Define Parameters</a></li>
  <li><a href="#step-2-calculate-required-sample-size" id="toc-step-2-calculate-required-sample-size" class="nav-link" data-scroll-target="#step-2-calculate-required-sample-size">Step 2: Calculate Required Sample Size</a></li>
  <li><a href="#step-3-create-power-curves" id="toc-step-3-create-power-curves" class="nav-link" data-scroll-target="#step-3-create-power-curves">Step 3: Create Power Curves</a></li>
  <li><a href="#step-4-explore-effect-of-alpha-on-power" id="toc-step-4-explore-effect-of-alpha-on-power" class="nav-link" data-scroll-target="#step-4-explore-effect-of-alpha-on-power">Step 4: Explore Effect of Alpha on Power</a></li>
  <li><a href="#step-5-anova-power-analysis" id="toc-step-5-anova-power-analysis" class="nav-link" data-scroll-target="#step-5-anova-power-analysis">Step 5: ANOVA Power Analysis</a></li>
  <li><a href="#step-6-post-hoc-power-analysis-observed-effect" id="toc-step-6-post-hoc-power-analysis-observed-effect" class="nav-link" data-scroll-target="#step-6-post-hoc-power-analysis-observed-effect">Step 6: Post-Hoc Power Analysis (Observed Effect)</a></li>
  <li><a href="#step-7-sensitivity-analysis" id="toc-step-7-sensitivity-analysis" class="nav-link" data-scroll-target="#step-7-sensitivity-analysis">Step 7: Sensitivity Analysis</a></li>
  <li><a href="#step-8-create-sample-size-justification" id="toc-step-8-create-sample-size-justification" class="nav-link" data-scroll-target="#step-8-create-sample-size-justification">Step 8: Create Sample Size Justification</a></li>
  <li><a href="#discussion-questions-7" id="toc-discussion-questions-7" class="nav-link" data-scroll-target="#discussion-questions-7">Discussion Questions</a></li>
  <li><a href="#key-takeaways-7" id="toc-key-takeaways-7" class="nav-link" data-scroll-target="#key-takeaways-7">Key Takeaways</a></li>
  <li><a href="#homework-exercise-7" id="toc-homework-exercise-7" class="nav-link" data-scroll-target="#homework-exercise-7">Homework Exercise</a></li>
  </ul></li>
  <li><a href="#lab-mice" id="toc-lab-mice" class="nav-link" data-scroll-target="#lab-mice">Lab 9: Multiple Imputation with MICE</a>
  <ul class="collapse">
  <li><a href="#step-1-set-up-and-create-data-with-missing-values" id="toc-step-1-set-up-and-create-data-with-missing-values" class="nav-link" data-scroll-target="#step-1-set-up-and-create-data-with-missing-values">Step 1: Set Up and Create Data with Missing Values</a></li>
  <li><a href="#step-2-visualize-missing-data-patterns" id="toc-step-2-visualize-missing-data-patterns" class="nav-link" data-scroll-target="#step-2-visualize-missing-data-patterns">Step 2: Visualize Missing Data Patterns</a></li>
  <li><a href="#step-3-perform-multiple-imputation" id="toc-step-3-perform-multiple-imputation" class="nav-link" data-scroll-target="#step-3-perform-multiple-imputation">Step 3: Perform Multiple Imputation</a></li>
  <li><a href="#step-4-check-convergence-diagnostics" id="toc-step-4-check-convergence-diagnostics" class="nav-link" data-scroll-target="#step-4-check-convergence-diagnostics">Step 4: Check Convergence Diagnostics</a></li>
  <li><a href="#step-5-inspect-imputed-values" id="toc-step-5-inspect-imputed-values" class="nav-link" data-scroll-target="#step-5-inspect-imputed-values">Step 5: Inspect Imputed Values</a></li>
  <li><a href="#step-6-analyze-imputed-data-and-pool-results" id="toc-step-6-analyze-imputed-data-and-pool-results" class="nav-link" data-scroll-target="#step-6-analyze-imputed-data-and-pool-results">Step 6: Analyze Imputed Data and Pool Results</a></li>
  <li><a href="#step-7-compare-with-complete-case-analysis" id="toc-step-7-compare-with-complete-case-analysis" class="nav-link" data-scroll-target="#step-7-compare-with-complete-case-analysis">Step 7: Compare with Complete-Case Analysis</a></li>
  <li><a href="#step-8-report-imputation-procedures" id="toc-step-8-report-imputation-procedures" class="nav-link" data-scroll-target="#step-8-report-imputation-procedures">Step 8: Report Imputation Procedures</a></li>
  <li><a href="#discussion-questions-8" id="toc-discussion-questions-8" class="nav-link" data-scroll-target="#discussion-questions-8">Discussion Questions</a></li>
  <li><a href="#key-takeaways-8" id="toc-key-takeaways-8" class="nav-link" data-scroll-target="#key-takeaways-8">Key Takeaways</a></li>
  <li><a href="#homework-exercise-8" id="toc-homework-exercise-8" class="nav-link" data-scroll-target="#homework-exercise-8">Homework Exercise</a></li>
  </ul></li>
  <li><a href="#lab-screening" id="toc-lab-screening" class="nav-link" data-scroll-target="#lab-screening">Lab 10: Data Screening and Outlier Detection</a>
  <ul class="collapse">
  <li><a href="#step-1-set-up-and-load-data-3" id="toc-step-1-set-up-and-load-data-3" class="nav-link" data-scroll-target="#step-1-set-up-and-load-data-3">Step 1: Set Up and Load Data</a></li>
  <li><a href="#step-2-univariate-outlier-detection-with-z-scores" id="toc-step-2-univariate-outlier-detection-with-z-scores" class="nav-link" data-scroll-target="#step-2-univariate-outlier-detection-with-z-scores">Step 2: Univariate Outlier Detection with Z-Scores</a></li>
  <li><a href="#step-3-tukey-fences-boxplot-method" id="toc-step-3-tukey-fences-boxplot-method" class="nav-link" data-scroll-target="#step-3-tukey-fences-boxplot-method">Step 3: Tukey Fences (Boxplot Method)</a></li>
  <li><a href="#step-4-multivariate-outlier-detection-mahalanobis-distance" id="toc-step-4-multivariate-outlier-detection-mahalanobis-distance" class="nav-link" data-scroll-target="#step-4-multivariate-outlier-detection-mahalanobis-distance">Step 4: Multivariate Outlier Detection (Mahalanobis Distance)</a></li>
  <li><a href="#step-5-influential-cases-cooks-distance" id="toc-step-5-influential-cases-cooks-distance" class="nav-link" data-scroll-target="#step-5-influential-cases-cooks-distance">Step 5: Influential Cases (Cook’s Distance)</a></li>
  <li><a href="#step-6-assess-normality-assumptions" id="toc-step-6-assess-normality-assumptions" class="nav-link" data-scroll-target="#step-6-assess-normality-assumptions">Step 6: Assess Normality Assumptions</a></li>
  <li><a href="#step-7-compare-analyses-withwithout-outliers" id="toc-step-7-compare-analyses-withwithout-outliers" class="nav-link" data-scroll-target="#step-7-compare-analyses-withwithout-outliers">Step 7: Compare Analyses With/Without Outliers</a></li>
  <li><a href="#step-8-document-screening-decisions" id="toc-step-8-document-screening-decisions" class="nav-link" data-scroll-target="#step-8-document-screening-decisions">Step 8: Document Screening Decisions</a></li>
  <li><a href="#discussion-questions-9" id="toc-discussion-questions-9" class="nav-link" data-scroll-target="#discussion-questions-9">Discussion Questions</a></li>
  <li><a href="#key-takeaways-9" id="toc-key-takeaways-9" class="nav-link" data-scroll-target="#key-takeaways-9">Key Takeaways</a></li>
  <li><a href="#homework-exercise-9" id="toc-homework-exercise-9" class="nav-link" data-scroll-target="#homework-exercise-9">Homework Exercise</a></li>
  </ul></li>
  <li><a href="#lab-effect-sizes" id="toc-lab-effect-sizes" class="nav-link" data-scroll-target="#lab-effect-sizes">Lab 11: Effect Sizes and Confidence Intervals</a>
  <ul class="collapse">
  <li><a href="#step-1-set-up-and-load-data-4" id="toc-step-1-set-up-and-load-data-4" class="nav-link" data-scroll-target="#step-1-set-up-and-load-data-4">Step 1: Set Up and Load Data</a></li>
  <li><a href="#step-2-calculate-cohens-d" id="toc-step-2-calculate-cohens-d" class="nav-link" data-scroll-target="#step-2-calculate-cohens-d">Step 2: Calculate Cohen’s d</a></li>
  <li><a href="#step-3-compute-confidence-interval-for-d" id="toc-step-3-compute-confidence-interval-for-d" class="nav-link" data-scroll-target="#step-3-compute-confidence-interval-for-d">Step 3: Compute Confidence Interval for d</a></li>
  <li><a href="#step-4-calculate-alternative-effect-sizes" id="toc-step-4-calculate-alternative-effect-sizes" class="nav-link" data-scroll-target="#step-4-calculate-alternative-effect-sizes">Step 4: Calculate Alternative Effect Sizes</a></li>
  <li><a href="#step-5-statistical-vs-practical-significance" id="toc-step-5-statistical-vs-practical-significance" class="nav-link" data-scroll-target="#step-5-statistical-vs-practical-significance">Step 5: Statistical vs Practical Significance</a></li>
  <li><a href="#step-6-effect-sizes-for-categorical-outcomes" id="toc-step-6-effect-sizes-for-categorical-outcomes" class="nav-link" data-scroll-target="#step-6-effect-sizes-for-categorical-outcomes">Step 6: Effect Sizes for Categorical Outcomes</a></li>
  <li><a href="#step-7-create-forest-plot" id="toc-step-7-create-forest-plot" class="nav-link" data-scroll-target="#step-7-create-forest-plot">Step 7: Create Forest Plot</a></li>
  <li><a href="#step-8-report-effect-sizes-apa-style" id="toc-step-8-report-effect-sizes-apa-style" class="nav-link" data-scroll-target="#step-8-report-effect-sizes-apa-style">Step 8: Report Effect Sizes (APA Style)</a></li>
  <li><a href="#discussion-questions-10" id="toc-discussion-questions-10" class="nav-link" data-scroll-target="#discussion-questions-10">Discussion Questions</a></li>
  <li><a href="#key-takeaways-10" id="toc-key-takeaways-10" class="nav-link" data-scroll-target="#key-takeaways-10">Key Takeaways</a></li>
  <li><a href="#homework-exercise-10" id="toc-homework-exercise-10" class="nav-link" data-scroll-target="#homework-exercise-10">Homework Exercise</a></li>
  </ul></li>
  <li><a href="#lab-visualization" id="toc-lab-visualization" class="nav-link" data-scroll-target="#lab-visualization">Lab 12: Visualization Best Practices for Small Samples</a>
  <ul class="collapse">
  <li><a href="#step-1-set-up-and-load-data-5" id="toc-step-1-set-up-and-load-data-5" class="nav-link" data-scroll-target="#step-1-set-up-and-load-data-5">Step 1: Set Up and Load Data</a></li>
  <li><a href="#step-2-bad-practices-vs-good-practices" id="toc-step-2-bad-practices-vs-good-practices" class="nav-link" data-scroll-target="#step-2-bad-practices-vs-good-practices">Step 2: Bad Practices vs Good Practices</a></li>
  <li><a href="#step-3-effective-within-subjects-visualization" id="toc-step-3-effective-within-subjects-visualization" class="nav-link" data-scroll-target="#step-3-effective-within-subjects-visualization">Step 3: Effective Within-Subjects Visualization</a></li>
  <li><a href="#step-4-uncertainty-visualization" id="toc-step-4-uncertainty-visualization" class="nav-link" data-scroll-target="#step-4-uncertainty-visualization">Step 4: Uncertainty Visualization</a></li>
  <li><a href="#step-5-publication-ready-formatting" id="toc-step-5-publication-ready-formatting" class="nav-link" data-scroll-target="#step-5-publication-ready-formatting">Step 5: Publication-Ready Formatting</a></li>
  <li><a href="#step-6-small-sample-specific-techniques" id="toc-step-6-small-sample-specific-techniques" class="nav-link" data-scroll-target="#step-6-small-sample-specific-techniques">Step 6: Small Sample Specific Techniques</a></li>
  <li><a href="#step-7-avoid-common-pitfalls" id="toc-step-7-avoid-common-pitfalls" class="nav-link" data-scroll-target="#step-7-avoid-common-pitfalls">Step 7: Avoid Common Pitfalls</a></li>
  <li><a href="#step-8-create-multi-panel-publication-figure" id="toc-step-8-create-multi-panel-publication-figure" class="nav-link" data-scroll-target="#step-8-create-multi-panel-publication-figure">Step 8: Create Multi-Panel Publication Figure</a></li>
  <li><a href="#discussion-questions-11" id="toc-discussion-questions-11" class="nav-link" data-scroll-target="#discussion-questions-11">Discussion Questions</a></li>
  <li><a href="#key-takeaways-11" id="toc-key-takeaways-11" class="nav-link" data-scroll-target="#key-takeaways-11">Key Takeaways</a></li>
  <li><a href="#homework-exercise-11" id="toc-homework-exercise-11" class="nav-link" data-scroll-target="#homework-exercise-11">Homework Exercise</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../chapters/part-g-lab-practicals.html">Part G: Guided Lab Practicals</a></li><li class="breadcrumb-item"><a href="../chapters/part-g-lab-practicals.html">Part G: Guided Lab Practicals</a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Part G: Guided Lab Practicals</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>This section provides hands-on, step-by-step lab walkthroughs for key statistical methods covered in the book. Each lab includes:</p>
<ul>
<li><strong>Clear learning objectives</strong> for what you’ll master</li>
<li><strong>Realistic scenarios</strong> with small-sample data</li>
<li><strong>Checkpoints</strong> to verify your code is working correctly</li>
<li><strong>Discussion questions</strong> to deepen understanding</li>
<li><strong>Homework exercises</strong> to practice independently</li>
</ul>
<p><strong>How to Use These Labs:</strong></p>
<ol type="1">
<li><strong>Work through each step sequentially</strong> - don’t skip ahead!</li>
<li><strong>Type the code yourself</strong> rather than copy-pasting (better learning)</li>
<li><strong>Check your output</strong> at each checkpoint before proceeding</li>
<li><strong>Attempt discussion questions</strong> before looking at solutions</li>
<li><strong>Complete homework exercises</strong> to reinforce skills</li>
</ol>
<p><strong>Lab Schedule:</strong></p>
<ul>
<li><strong>Lab 1</strong>: Fisher’s Exact Test (Chapter 3)</li>
<li><strong>Lab 2</strong>: Bootstrap Confidence Intervals (Chapter 3)</li>
<li><strong>Lab 3</strong>: Mann-Whitney U Test (Chapter 4)</li>
<li><strong>Lab 4</strong>: Wilcoxon Signed-Rank Test (Chapter 4)</li>
<li><strong>Lab 5</strong>: Firth’s Logistic Regression (Chapter 5)</li>
<li><strong>Lab 6</strong>: Bayesian Regression with brms (Chapter 5)</li>
<li><strong>Lab 7</strong>: Reliability Analysis with Cronbach’s Alpha (Chapter 6)</li>
<li><strong>Lab 8</strong>: Power Analysis and Sample Size Planning (Chapter 2)</li>
<li><strong>Lab 9</strong>: Multiple Imputation for Missing Data (Chapter 12)</li>
<li><strong>Lab 10</strong>: Data Screening and Outlier Detection (Chapter 11)</li>
<li><strong>Lab 11</strong>: Effect Sizes and Confidence Intervals (Chapter 13)</li>
<li><strong>Lab 12</strong>: Visualizing Small-Sample Results (Chapter 16)</li>
</ul>
<hr>
<section id="lab-1-fishers-exact-test-chapter-3" class="level2">
<h2 class="anchored" data-anchor-id="lab-1-fishers-exact-test-chapter-3">Lab 1: Fisher’s Exact Test (Chapter 3)</h2>
</section>
<section id="lab-practical-1-fishers-exact-test-step-by-step" class="level1">
<h1>🧪 Lab Practical 1: Fisher’s Exact Test Step-by-Step</h1>
<p><strong>Learning Objectives:</strong> - Construct 2×2 contingency tables in R - Perform Fisher’s exact test - Interpret odds ratios and confidence intervals - Compare with chi-square to understand when exact tests are necessary</p>
<hr>
<section id="scenario" class="level3">
<h3 class="anchored" data-anchor-id="scenario">Scenario</h3>
<p>A small clinic tests a new pain relief protocol. They randomly assign 16 patients: - <strong>New Protocol</strong>: 7 reported significant relief, 1 did not - <strong>Standard Care</strong>: 2 reported significant relief, 6 did not</p>
<p><strong>Research Question</strong>: Is the new protocol more effective than standard care?</p>
<hr>
</section>
<section id="step-1-set-up-your-workspace" class="level3">
<h3 class="anchored" data-anchor-id="step-1-set-up-your-workspace">Step 1: Set Up Your Workspace</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load required packages</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Set seed for reproducibility</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p><strong>✋ Checkpoint 1:</strong> - Packages loaded? You should see no error messages. - If <code>tidyverse</code> fails: run <code>install.packages("tidyverse")</code></p>
<hr>
</section>
<section id="step-2-create-the-22-table" class="level3">
<h3 class="anchored" data-anchor-id="step-2-create-the-22-table">Step 2: Create the 2×2 Table</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create contingency table</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Rows: Treatment (New Protocol, Standard)</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Columns: Outcome (Relief, No Relief)</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>pain_relief <span class="ot">&lt;-</span> <span class="fu">matrix</span>(</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">1</span>,    <span class="co"># New Protocol: 7 relief, 1 no relief</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span>, <span class="dv">6</span>),   <span class="co"># Standard Care: 2 relief, 6 no relief</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">nrow =</span> <span class="dv">2</span>,</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">byrow =</span> <span class="cn">TRUE</span>,</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">dimnames =</span> <span class="fu">list</span>(</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">Treatment =</span> <span class="fu">c</span>(<span class="st">"New Protocol"</span>, <span class="st">"Standard Care"</span>),</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">Outcome =</span> <span class="fu">c</span>(<span class="st">"Relief"</span>, <span class="st">"No Relief"</span>)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the table</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pain_relief)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>               Outcome
Treatment       Relief No Relief
  New Protocol       7         1
  Standard Care      2         6</code></pre>
</div>
</div>
<p><strong>Expected Output:</strong></p>
<pre><code>              Outcome
Treatment      Relief No Relief
  New Protocol      7         1
  Standard Care     2         6</code></pre>
<p><strong>✋ Checkpoint 2:</strong> - Does your table match the expected output? - Check: Top-left cell should be 7 (New Protocol successes)</p>
<hr>
</section>
<section id="step-3-visual-inspection" class="level3">
<h3 class="anchored" data-anchor-id="step-3-visual-inspection">Step 3: Visual Inspection</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to data frame for plotting</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>pain_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">as.table</span>(pain_relief))</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pain_df, <span class="fu">aes</span>(<span class="at">x =</span> Treatment, <span class="at">y =</span> Freq, <span class="at">fill =</span> Outcome)) <span class="sc">+</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Pain Relief by Treatment"</span>,</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Number of Patients"</span>) <span class="sc">+</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set2"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="part-g-lab-practicals_files/figure-html/lab1-step3-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Pain relief outcomes by treatment group</figcaption>
</figure>
</div>
</div>
</div>
<p><strong>❓ Question 1:</strong> Looking at the plot, does the new protocol appear more effective?</p>
<hr>
</section>
<section id="step-4-check-expected-cell-counts" class="level3">
<h3 class="anchored" data-anchor-id="step-4-check-expected-cell-counts">Step 4: Check Expected Cell Counts</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Chi-square test (just to check expected frequencies)</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>chisq_test <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(pain_relief)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Expected counts</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Expected cell counts:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Expected cell counts:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(chisq_test<span class="sc">$</span>expected)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>               Outcome
Treatment       Relief No Relief
  New Protocol     4.5       3.5
  Standard Care    4.5       3.5</code></pre>
</div>
</div>
<p><strong>✋ Checkpoint 3:</strong> - Are ANY expected counts &lt; 5? (They should be!) - Expected output: Several cells will have counts around 2-4</p>
<p><strong>💡 Teaching Point:</strong> When any expected cell count is &lt; 5, chi-square approximations break down. Fisher’s exact test is mandatory.</p>
<hr>
</section>
<section id="step-5-run-fishers-exact-test" class="level3">
<h3 class="anchored" data-anchor-id="step-5-run-fishers-exact-test">Step 5: Run Fisher’s Exact Test</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fisher's exact test</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>fisher_result <span class="ot">&lt;-</span> <span class="fu">fisher.test</span>(pain_relief)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Print full results</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fisher_result)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Fisher's Exact Test for Count Data

data:  pain_relief
p-value = 0.04
alternative hypothesis: true odds ratio is not equal to 1
95 percent confidence interval:
    1.088 1088.437
sample estimates:
odds ratio 
      16.2 </code></pre>
</div>
</div>
<p><strong>Expected Output:</strong></p>
<pre><code>Fisher's Exact Test for Count Data

data:  pain_relief
p-value = 0.0206
alternative hypothesis: true odds ratio is not equal to 1
95 percent confidence interval:
  1.195  165.626
sample estimates:
odds ratio 
     18.97</code></pre>
<p><strong>✋ Checkpoint 4:</strong> - Is p-value &lt; 0.05? (Yes, approximately 0.02) - What is the odds ratio? (Around 19)</p>
<hr>
</section>
<section id="step-6-extract-and-interpret-key-values" class="level3">
<h3 class="anchored" data-anchor-id="step-6-extract-and-interpret-key-values">Step 6: Extract and Interpret Key Values</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract components for reporting</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>or_estimate <span class="ot">&lt;-</span> fisher_result<span class="sc">$</span>estimate</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>or_ci_lower <span class="ot">&lt;-</span> fisher_result<span class="sc">$</span>conf.int[<span class="dv">1</span>]</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>or_ci_upper <span class="ot">&lt;-</span> fisher_result<span class="sc">$</span>conf.int[<span class="dv">2</span>]</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>p_value <span class="ot">&lt;-</span> fisher_result<span class="sc">$</span>p.value</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Print interpretation</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"==========================================</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>==========================================</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"INTERPRETATION</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>INTERPRETATION</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"==========================================</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>==========================================</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"1. Odds Ratio ="</span>, <span class="fu">round</span>(or_estimate, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>1. Odds Ratio = 16.2 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"   → Odds of pain relief are"</span>, <span class="fu">round</span>(or_estimate, <span class="dv">1</span>), </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"times higher with new protocol</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>   → Odds of pain relief are 16.2 times higher with new protocol</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"2. 95% CI: ["</span>, <span class="fu">round</span>(or_ci_lower, <span class="dv">2</span>), <span class="st">","</span>, </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(or_ci_upper, <span class="dv">2</span>), <span class="st">"]</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>2. 95% CI: [ 1.09 , 1088 ]</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"   → Wide CI reflects small sample size (n=16)</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>   → Wide CI reflects small sample size (n=16)</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"   → CI excludes 1, consistent with p&lt;0.05</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>   → CI excludes 1, consistent with p&lt;0.05</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"3. p-value ="</span>, <span class="fu">round</span>(p_value, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>3. p-value = 0.0406 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"   → Statistically significant at α=0.05</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>   → Statistically significant at α=0.05</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"4. Conclusion:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>4. Conclusion:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"   The new protocol shows promise (OR=19),</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>   The new protocol shows promise (OR=19),</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"   suggesting substantially higher odds of relief.</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>   suggesting substantially higher odds of relief.</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"   However, the wide CI (1.2 to 166!) reflects</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>   However, the wide CI (1.2 to 166!) reflects</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"   substantial uncertainty due to small sample.</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>   substantial uncertainty due to small sample.</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"   A larger trial is warranted.</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>   A larger trial is warranted.</code></pre>
</div>
</div>
<hr>
</section>
<section id="step-7-compare-with-chi-square-educational" class="level3">
<h3 class="anchored" data-anchor-id="step-7-compare-with-chi-square-educational">Step 7: Compare with Chi-Square (Educational)</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run chi-square despite small expected counts</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="co"># (Just to see the warning!)</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>chisq_result <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(pain_relief)</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(chisq_result)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test with Yates' continuity correction

data:  pain_relief
X-squared = 4.1, df = 1, p-value = 0.04</code></pre>
</div>
</div>
<p><strong>Expected Warning:</strong></p>
<pre><code>Warning: Chi-squared approximation may be incorrect</code></pre>
<p><strong>❓ Question 2:</strong> What happens to the chi-square p-value? Is it similar to Fisher’s?</p>
<p><strong>💡 Teaching Point:</strong> With small cell counts: - Chi-square gives unreliable p-values - Fisher’s exact test is gold standard - In this case, both suggest significance, but Fisher’s is trustworthy</p>
<hr>
</section>
<section id="step-8-create-a-publication-ready-table" class="level3">
<h3 class="anchored" data-anchor-id="step-8-create-a-publication-ready-table">Step 8: Create a Publication-Ready Table</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary table</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>results_table <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Treatment =</span> <span class="fu">c</span>(<span class="st">"New Protocol"</span>, <span class="st">"Standard Care"</span>),</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">n</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">8</span>, <span class="dv">8</span>),</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Relief (%)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"7 (88%)"</span>, <span class="st">"2 (25%)"</span>),</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">No Relief (%)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"1 (12%)"</span>, <span class="st">"6 (75%)"</span>)</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>results_table <span class="sc">%&gt;%</span></span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Pain Relief by Treatment Group"</span>,</span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Fisher's Exact Test: p = 0.021, OR = 18.97 (95% CI: 1.20–165.63)"</span></span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_footnote</span>(</span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">footnote =</span> <span class="st">"Odds ratio indicates 19-fold higher odds of relief with new protocol"</span>,</span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_title</span>()</span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="mldzawjmql" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#mldzawjmql table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#mldzawjmql thead, #mldzawjmql tbody, #mldzawjmql tfoot, #mldzawjmql tr, #mldzawjmql td, #mldzawjmql th {
  border-style: none;
}

#mldzawjmql p {
  margin: 0;
  padding: 0;
}

#mldzawjmql .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#mldzawjmql .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#mldzawjmql .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#mldzawjmql .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#mldzawjmql .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mldzawjmql .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mldzawjmql .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mldzawjmql .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#mldzawjmql .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#mldzawjmql .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#mldzawjmql .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#mldzawjmql .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#mldzawjmql .gt_spanner_row {
  border-bottom-style: hidden;
}

#mldzawjmql .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#mldzawjmql .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#mldzawjmql .gt_from_md > :first-child {
  margin-top: 0;
}

#mldzawjmql .gt_from_md > :last-child {
  margin-bottom: 0;
}

#mldzawjmql .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#mldzawjmql .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#mldzawjmql .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#mldzawjmql .gt_row_group_first td {
  border-top-width: 2px;
}

#mldzawjmql .gt_row_group_first th {
  border-top-width: 2px;
}

#mldzawjmql .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mldzawjmql .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#mldzawjmql .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#mldzawjmql .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mldzawjmql .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mldzawjmql .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#mldzawjmql .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#mldzawjmql .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#mldzawjmql .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mldzawjmql .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mldzawjmql .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mldzawjmql .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mldzawjmql .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mldzawjmql .gt_left {
  text-align: left;
}

#mldzawjmql .gt_center {
  text-align: center;
}

#mldzawjmql .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#mldzawjmql .gt_font_normal {
  font-weight: normal;
}

#mldzawjmql .gt_font_bold {
  font-weight: bold;
}

#mldzawjmql .gt_font_italic {
  font-style: italic;
}

#mldzawjmql .gt_super {
  font-size: 65%;
}

#mldzawjmql .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#mldzawjmql .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#mldzawjmql .gt_indent_1 {
  text-indent: 5px;
}

#mldzawjmql .gt_indent_2 {
  text-indent: 10px;
}

#mldzawjmql .gt_indent_3 {
  text-indent: 15px;
}

#mldzawjmql .gt_indent_4 {
  text-indent: 20px;
}

#mldzawjmql .gt_indent_5 {
  text-indent: 25px;
}

#mldzawjmql .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#mldzawjmql div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading header">
<td colspan="4" class="gt_heading gt_title gt_font_normal">Pain Relief by Treatment Group<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></td>
</tr>
<tr class="gt_heading even">
<td colspan="4" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border">Fisher's Exact Test: p = 0.021, OR = 18.97 (95% CI: 1.20–165.63)<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></td>
</tr>
<tr class="gt_col_headings header">
<th id="Treatment" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Treatment</th>
<th id="n" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">n</th>
<th id="Relief-(%)" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Relief (%)</th>
<th id="No-Relief-(%)" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">No Relief (%)</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="Treatment">New Protocol</td>
<td class="gt_row gt_right" headers="n">8</td>
<td class="gt_row gt_right" headers="Relief (%)">7 (88%)</td>
<td class="gt_row gt_right" headers="No Relief (%)">1 (12%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Treatment">Standard Care</td>
<td class="gt_row gt_right" headers="n">8</td>
<td class="gt_row gt_right" headers="Relief (%)">2 (25%)</td>
<td class="gt_row gt_right" headers="No Relief (%)">6 (75%)</td>
</tr>
</tbody><tfoot class="gt_footnotes">
<tr class="odd">
<td colspan="4" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> Odds ratio indicates 19-fold higher odds of relief with new protocol</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
<hr>
</section>
<section id="discussion-questions" class="level3">
<h3 class="anchored" data-anchor-id="discussion-questions">❓ Discussion Questions</h3>
<ol type="1">
<li><strong>Why is the confidence interval so wide?</strong>
<ul>
<li>Small sample size (n=8 per group)</li>
<li>Sparse data (only 1 failure in new protocol)</li>
<li>Uncertainty about true population OR</li>
</ul></li>
<li><strong>What does OR=19 mean in practical terms?</strong>
<ul>
<li>The odds (not risk!) of relief are 19 times higher with new protocol</li>
<li>In this sample: New protocol 88% relief vs.&nbsp;Standard 25% relief</li>
<li>Odds (New) = 7/1 = 7; Odds (Standard) = 2/6 = 0.33; OR = 7/0.33 ≈ 21</li>
</ul></li>
<li><strong>Should the clinic adopt the new protocol based on this study?</strong>
<ul>
<li>Promising signal, but n=16 is too small for definitive conclusions</li>
<li>Wide CI indicates substantial uncertainty</li>
<li>Recommendation: Conduct larger RCT (n=50+ per group)</li>
</ul></li>
<li><strong>How would results change with n=50 per group?</strong>
<ul>
<li>CI would narrow dramatically</li>
<li>If true OR≈19, would almost certainly reach significance</li>
<li>Could detect smaller (but still meaningful) effects</li>
</ul></li>
</ol>
<hr>
</section>
<section id="key-takeaways" class="level3">
<h3 class="anchored" data-anchor-id="key-takeaways">💡 Key Takeaways</h3>
<p>✅ <strong>When to use Fisher’s exact test:</strong> - Small sample sizes (n&lt;30) - 2×2 contingency tables - ANY expected cell count &lt; 5</p>
<p>✅ <strong>How to interpret OR:</strong> - OR &gt; 1: Higher odds in first group - OR = 1: No difference - OR &lt; 1: Lower odds in first group</p>
<p>✅ <strong>Report all three components:</strong> - Point estimate (OR = 18.97) - Confidence interval (1.20 to 165.63) - p-value (0.021)</p>
<p>✅ <strong>Always acknowledge limitations:</strong> - Small samples → wide CIs - Statistical significance ≠ clinical certainty - Replication needed</p>
<hr>
</section>
<section id="homework-exercise" class="level3">
<h3 class="anchored" data-anchor-id="homework-exercise">🏠 Homework Exercise</h3>
<p>Using the same code structure, analyze this 2×2 table:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Treatment</th>
<th>Success</th>
<th>Failure</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Drug A</td>
<td>9</td>
<td>3</td>
</tr>
<tr class="even">
<td>Drug B</td>
<td>4</td>
<td>8</td>
</tr>
</tbody>
</table>
<p><strong>Tasks:</strong> 1. Create the contingency table 2. Run Fisher’s exact test 3. Interpret OR and CI 4. Write a 3-sentence results paragraph</p>
<p><strong>Expected OR</strong>: ~6 (verify your calculation!)</p>
<hr>
</section>
<section id="lab-2-bootstrap-confidence-intervals-chapter-3" class="level2">
<h2 class="anchored" data-anchor-id="lab-2-bootstrap-confidence-intervals-chapter-3">Lab 2: Bootstrap Confidence Intervals (Chapter 3)</h2>
</section>
</section>
<section id="lab-practical-2-bootstrap-confidence-intervals" class="level1">
<h1>🧪 Lab Practical 2: Bootstrap Confidence Intervals</h1>
<p><strong>Learning Objectives:</strong> - Understand when bootstrap is preferred over parametric methods - Implement bootstrap resampling in R - Calculate percentile and BCa confidence intervals - Compare bootstrap CIs with t-based CIs</p>
<hr>
<section id="scenario-1" class="level3">
<h3 class="anchored" data-anchor-id="scenario-1">Scenario</h3>
<p>A nutritionist measures vitamin D levels (ng/mL) in 15 elderly patients after a 3-month supplement intervention. The data are skewed, with one very high value. Traditional t-based CIs assume normality—will they be accurate?</p>
<p><strong>Data</strong>: 12, 18, 22, 25, 19, 31, 16, 28, 21, 23, 45, 20, 24, 17, 26</p>
<p><strong>Research Question</strong>: What is the 95% CI for the median vitamin D level?</p>
<hr>
</section>
<section id="step-1-load-data-and-visualize-distribution" class="level3">
<h3 class="anchored" data-anchor-id="step-1-load-data-and-visualize-distribution">Step 1: Load Data and Visualize Distribution</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Vitamin D data (ng/mL)</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>vit_d <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">12</span>, <span class="dv">18</span>, <span class="dv">22</span>, <span class="dv">25</span>, <span class="dv">19</span>, <span class="dv">31</span>, <span class="dv">16</span>, <span class="dv">28</span>, <span class="dv">21</span>, <span class="dv">23</span>, <span class="dv">45</span>, <span class="dv">20</span>, <span class="dv">24</span>, <span class="dv">17</span>, <span class="dv">26</span>)</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize distribution</span></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(vit_d) <span class="sc">%&gt;%</span></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> vit_d)) <span class="sc">+</span></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">5</span>, <span class="at">fill =</span> <span class="st">"steelblue"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> <span class="fu">median</span>(vit_d)), </span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Vitamin D Levels (n=15)"</span>,</span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Red line = median"</span>,</span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Vitamin D (ng/mL)"</span>,</span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="part-g-lab-practicals_files/figure-html/lab2-step1-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Distribution of vitamin D levels showing right skew</figcaption>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary statistics</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Summary Statistics:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Summary Statistics:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Mean ="</span>, <span class="fu">round</span>(<span class="fu">mean</span>(vit_d), <span class="dv">2</span>), <span class="st">"ng/mL</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mean = 23.13 ng/mL</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Median ="</span>, <span class="fu">median</span>(vit_d), <span class="st">"ng/mL</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Median = 22 ng/mL</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"SD ="</span>, <span class="fu">round</span>(<span class="fu">sd</span>(vit_d), <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>SD = 7.78 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Skewness = Positive (note the 45 value)</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Skewness = Positive (note the 45 value)</code></pre>
</div>
</div>
<p><strong>✋ Checkpoint 1:</strong> - Do you see right skew? (One high value at 45) - Median &lt; Mean? (Yes, confirming positive skew)</p>
<p><strong>💡 Teaching Point:</strong> Skewed data violate normality assumptions for t-tests. Bootstrap makes no distributional assumptions!</p>
<hr>
</section>
<section id="step-2-calculate-parametric-ci-for-comparison" class="level3">
<h3 class="anchored" data-anchor-id="step-2-calculate-parametric-ci-for-comparison">Step 2: Calculate Parametric CI (For Comparison)</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Parametric 95% CI for the mean (assumes normality)</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>mean_val <span class="ot">&lt;-</span> <span class="fu">mean</span>(vit_d)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>se_mean <span class="ot">&lt;-</span> <span class="fu">sd</span>(vit_d) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">length</span>(vit_d))</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>t_crit <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="fl">0.975</span>, <span class="at">df =</span> <span class="fu">length</span>(vit_d) <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>ci_lower_param <span class="ot">&lt;-</span> mean_val <span class="sc">-</span> t_crit <span class="sc">*</span> se_mean</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>ci_upper_param <span class="ot">&lt;-</span> mean_val <span class="sc">+</span> t_crit <span class="sc">*</span> se_mean</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Parametric 95% CI for Mean (t-based):</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Parametric 95% CI for Mean (t-based):</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"["</span>, <span class="fu">round</span>(ci_lower_param, <span class="dv">2</span>), <span class="st">","</span>, <span class="fu">round</span>(ci_upper_param, <span class="dv">2</span>), <span class="st">"]</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[ 18.82 , 27.44 ]</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"⚠️ Problem: This CI assumes normality!</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>⚠️ Problem: This CI assumes normality!</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"   With skewed data and n=15, this assumption is violated.</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>   With skewed data and n=15, this assumption is violated.</code></pre>
</div>
</div>
<p><strong>❓ Question 1:</strong> Why can’t we easily get a parametric CI for the median?</p>
<hr>
</section>
<section id="step-3-bootstrap-the-median-manual-method" class="level3">
<h3 class="anchored" data-anchor-id="step-3-bootstrap-the-median-manual-method">Step 3: Bootstrap the Median (Manual Method)</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Manual bootstrap (for teaching purposes)</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>n_boot <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>boot_medians <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_boot)</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_boot) {</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Resample with replacement</span></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>  boot_sample <span class="ot">&lt;-</span> <span class="fu">sample</span>(vit_d, <span class="at">size =</span> <span class="fu">length</span>(vit_d), <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>  boot_medians[i] <span class="ot">&lt;-</span> <span class="fu">median</span>(boot_sample)</span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize bootstrap distribution</span></span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(boot_medians) <span class="sc">%&gt;%</span></span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> boot_medians)) <span class="sc">+</span></span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">30</span>, <span class="at">fill =</span> <span class="st">"darkorange"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> <span class="fu">median</span>(vit_d)), </span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Bootstrap Distribution of Median (5000 resamples)"</span>,</span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Red line = observed median"</span>,</span>
<span id="cb68-19"><a href="#cb68-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Bootstrap Median"</span>,</span>
<span id="cb68-20"><a href="#cb68-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb68-21"><a href="#cb68-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="part-g-lab-practicals_files/figure-html/lab2-step3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>✋ Checkpoint 2:</strong> - Does the bootstrap distribution look approximately normal? - Is it centered around the observed median (22)?</p>
<p><strong>💡 Teaching Point:</strong> The bootstrap distribution approximates the sampling distribution of the statistic!</p>
<hr>
</section>
<section id="step-4-calculate-percentile-bootstrap-ci" class="level3">
<h3 class="anchored" data-anchor-id="step-4-calculate-percentile-bootstrap-ci">Step 4: Calculate Percentile Bootstrap CI</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Percentile method: 2.5th and 97.5th percentiles</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>ci_lower_boot <span class="ot">&lt;-</span> <span class="fu">quantile</span>(boot_medians, <span class="fl">0.025</span>)</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>ci_upper_boot <span class="ot">&lt;-</span> <span class="fu">quantile</span>(boot_medians, <span class="fl">0.975</span>)</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Bootstrap 95% CI for Median (Percentile Method):</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Bootstrap 95% CI for Median (Percentile Method):</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"["</span>, ci_lower_boot, <span class="st">","</span>, ci_upper_boot, <span class="st">"]</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[ 18 , 26 ]</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Observed median:"</span>, <span class="fu">median</span>(vit_d), <span class="st">"ng/mL</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Observed median: 22 ng/mL</code></pre>
</div>
</div>
<p><strong>❓ Question 2:</strong> Is the CI symmetric around the median? Why or why not?</p>
<hr>
</section>
<section id="step-5-use-boot-package-for-bca-ci" class="level3">
<h3 class="anchored" data-anchor-id="step-5-use-boot-package-for-bca-ci">Step 5: Use boot Package for BCa CI</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define statistic function for boot package</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>median_func <span class="ot">&lt;-</span> <span class="cf">function</span>(data, indices) {</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">median</span>(data[indices]))</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Run bootstrap</span></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>boot_result <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data =</span> vit_d, <span class="at">statistic =</span> median_func, <span class="at">R =</span> <span class="dv">5000</span>)</span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a><span class="co"># BCa confidence interval (bias-corrected and accelerated)</span></span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>boot_ci <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(boot_result, <span class="at">type =</span> <span class="fu">c</span>(<span class="st">"perc"</span>, <span class="st">"bca"</span>))</span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(boot_ci)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
Based on 5000 bootstrap replicates

CALL : 
boot.ci(boot.out = boot_result, type = c("perc", "bca"))

Intervals : 
Level     Percentile            BCa          
95%   (18, 26 )   (18, 25 )  
Calculations and Intervals on Original Scale</code></pre>
</div>
</div>
<p><strong>✋ Checkpoint 3:</strong> - Do you see both “Percentile” and “BCa” intervals? - BCa should be slightly different from percentile (adjusts for bias and skewness)</p>
<p><strong>💡 Teaching Point:</strong> BCa intervals are theoretically superior but require more computation. With small samples, differences are often modest.</p>
<hr>
</section>
<section id="step-6-compare-all-methods" class="level3">
<h3 class="anchored" data-anchor-id="step-6-compare-all-methods">Step 6: Compare All Methods</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create comparison table</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>comparison <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Method =</span> <span class="fu">c</span>(<span class="st">"Parametric (mean)"</span>, <span class="st">"Bootstrap Percentile (median)"</span>, <span class="st">"Bootstrap BCa (median)"</span>),</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Estimate =</span> <span class="fu">c</span>(<span class="fu">mean</span>(vit_d), <span class="fu">median</span>(vit_d), <span class="fu">median</span>(vit_d)),</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">CI_Lower =</span> <span class="fu">c</span>(ci_lower_param, </span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>               <span class="fu">as.numeric</span>(<span class="fu">quantile</span>(boot_medians, <span class="fl">0.025</span>)),</span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>               boot_ci<span class="sc">$</span>bca[<span class="dv">4</span>]),</span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">CI_Upper =</span> <span class="fu">c</span>(ci_upper_param,</span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>               <span class="fu">as.numeric</span>(<span class="fu">quantile</span>(boot_medians, <span class="fl">0.975</span>)),</span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>               boot_ci<span class="sc">$</span>bca[<span class="dv">5</span>]),</span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">CI_Width =</span> CI_Upper <span class="sc">-</span> CI_Lower</span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true" tabindex="-1"></a>comparison <span class="sc">%&gt;%</span></span>
<span id="cb77-15"><a href="#cb77-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">round</span>(.x, <span class="dv">2</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb77-16"><a href="#cb77-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb77-17"><a href="#cb77-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(<span class="at">title =</span> <span class="st">"Comparison of Confidence Interval Methods"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="rendmsnhgj" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#rendmsnhgj table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#rendmsnhgj thead, #rendmsnhgj tbody, #rendmsnhgj tfoot, #rendmsnhgj tr, #rendmsnhgj td, #rendmsnhgj th {
  border-style: none;
}

#rendmsnhgj p {
  margin: 0;
  padding: 0;
}

#rendmsnhgj .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#rendmsnhgj .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#rendmsnhgj .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#rendmsnhgj .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#rendmsnhgj .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rendmsnhgj .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rendmsnhgj .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rendmsnhgj .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#rendmsnhgj .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#rendmsnhgj .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#rendmsnhgj .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#rendmsnhgj .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#rendmsnhgj .gt_spanner_row {
  border-bottom-style: hidden;
}

#rendmsnhgj .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#rendmsnhgj .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#rendmsnhgj .gt_from_md > :first-child {
  margin-top: 0;
}

#rendmsnhgj .gt_from_md > :last-child {
  margin-bottom: 0;
}

#rendmsnhgj .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#rendmsnhgj .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#rendmsnhgj .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#rendmsnhgj .gt_row_group_first td {
  border-top-width: 2px;
}

#rendmsnhgj .gt_row_group_first th {
  border-top-width: 2px;
}

#rendmsnhgj .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rendmsnhgj .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#rendmsnhgj .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#rendmsnhgj .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rendmsnhgj .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rendmsnhgj .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#rendmsnhgj .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#rendmsnhgj .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#rendmsnhgj .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rendmsnhgj .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rendmsnhgj .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rendmsnhgj .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rendmsnhgj .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rendmsnhgj .gt_left {
  text-align: left;
}

#rendmsnhgj .gt_center {
  text-align: center;
}

#rendmsnhgj .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#rendmsnhgj .gt_font_normal {
  font-weight: normal;
}

#rendmsnhgj .gt_font_bold {
  font-weight: bold;
}

#rendmsnhgj .gt_font_italic {
  font-style: italic;
}

#rendmsnhgj .gt_super {
  font-size: 65%;
}

#rendmsnhgj .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#rendmsnhgj .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#rendmsnhgj .gt_indent_1 {
  text-indent: 5px;
}

#rendmsnhgj .gt_indent_2 {
  text-indent: 10px;
}

#rendmsnhgj .gt_indent_3 {
  text-indent: 15px;
}

#rendmsnhgj .gt_indent_4 {
  text-indent: 20px;
}

#rendmsnhgj .gt_indent_5 {
  text-indent: 25px;
}

#rendmsnhgj .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#rendmsnhgj div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading header">
<td colspan="5" class="gt_heading gt_title gt_font_normal gt_bottom_border">Comparison of Confidence Interval Methods</td>
</tr>
<tr class="gt_col_headings even">
<th id="Method" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Method</th>
<th id="Estimate" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Estimate</th>
<th id="CI_Lower" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">CI_Lower</th>
<th id="CI_Upper" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">CI_Upper</th>
<th id="CI_Width" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">CI_Width</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="Method">Parametric (mean)</td>
<td class="gt_row gt_right" headers="Estimate">23.13</td>
<td class="gt_row gt_right" headers="CI_Lower">18.82</td>
<td class="gt_row gt_right" headers="CI_Upper">27.44</td>
<td class="gt_row gt_right" headers="CI_Width">8.62</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Method">Bootstrap Percentile (median)</td>
<td class="gt_row gt_right" headers="Estimate">22.00</td>
<td class="gt_row gt_right" headers="CI_Lower">18.00</td>
<td class="gt_row gt_right" headers="CI_Upper">26.00</td>
<td class="gt_row gt_right" headers="CI_Width">8.00</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Method">Bootstrap BCa (median)</td>
<td class="gt_row gt_right" headers="Estimate">22.00</td>
<td class="gt_row gt_right" headers="CI_Lower">18.00</td>
<td class="gt_row gt_right" headers="CI_Upper">25.00</td>
<td class="gt_row gt_right" headers="CI_Width">7.00</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p><strong>❓ Question 3:</strong> Which method gives the narrowest CI? Why might that be misleading?</p>
<hr>
</section>
<section id="step-7-diagnostic-checks" class="level3">
<h3 class="anchored" data-anchor-id="step-7-diagnostic-checks">Step 7: Diagnostic Checks</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for duplicate bootstrap samples (quality check)</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>unique_samples <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">unique</span>(boot_medians))</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Unique bootstrap medians:"</span>, unique_samples, <span class="st">"out of"</span>, n_boot, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Unique bootstrap medians: 13 out of 5000 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Proportion unique:"</span>, <span class="fu">round</span>(unique_samples <span class="sc">/</span> n_boot, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Proportion unique: 0.003 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Standard error of the median from bootstrap</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>se_median_boot <span class="ot">&lt;-</span> <span class="fu">sd</span>(boot_medians)</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Bootstrap SE of median:"</span>, <span class="fu">round</span>(se_median_boot, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Bootstrap SE of median: 1.88 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Bias estimate</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>bias <span class="ot">&lt;-</span> <span class="fu">mean</span>(boot_medians) <span class="sc">-</span> <span class="fu">median</span>(vit_d)</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Bootstrap bias:"</span>, <span class="fu">round</span>(bias, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Bootstrap bias: 0.052 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"(Small bias is expected; large bias suggests problems)</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Small bias is expected; large bias suggests problems)</code></pre>
</div>
</div>
<p><strong>✋ Checkpoint 4:</strong> - Is bias close to zero? (Should be &lt; 1) - Are most samples unique? (Yes, with 5000 resamples)</p>
<hr>
</section>
<section id="step-8-publication-ready-figure" class="level3">
<h3 class="anchored" data-anchor-id="step-8-publication-ready-figure">Step 8: Publication-Ready Figure</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Box plot with bootstrap CI overlay</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(vit_d) <span class="sc">%&gt;%</span></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> vit_d)) <span class="sc">+</span></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">"lightblue"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">median</span>(vit_d)), <span class="at">size =</span> <span class="dv">5</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> ci_lower_boot, <span class="at">ymax =</span> ci_upper_boot),</span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Vitamin D Levels with Bootstrap 95% CI"</span>,</span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste0</span>(<span class="st">"Median = "</span>, <span class="fu">median</span>(vit_d), <span class="st">" ng/mL ["</span>, </span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a>                        ci_lower_boot, <span class="st">", "</span>, ci_upper_boot, <span class="st">"]"</span>),</span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb88-13"><a href="#cb88-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Vitamin D (ng/mL)"</span>) <span class="sc">+</span></span>
<span id="cb88-14"><a href="#cb88-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb88-15"><a href="#cb88-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb88-16"><a href="#cb88-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>())</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="part-g-lab-practicals_files/figure-html/lab2-step8-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Vitamin D levels with bootstrap 95% CI for median</figcaption>
</figure>
</div>
</div>
</div>
<hr>
</section>
<section id="discussion-questions-1" class="level3">
<h3 class="anchored" data-anchor-id="discussion-questions-1">❓ Discussion Questions</h3>
<ol type="1">
<li><strong>Why use median instead of mean for skewed data?</strong>
<ul>
<li>Median is robust to outliers (45 doesn’t distort it)</li>
<li>More representative of “typical” value</li>
<li>Mean = 24.4; Median = 22 (mean pulled upward by outlier)</li>
</ul></li>
<li><strong>When would parametric CI be acceptable?</strong>
<ul>
<li>Large samples (n &gt; 30) where CLT applies</li>
<li>Truly normal data</li>
<li>When analyzing the mean (not median) is appropriate</li>
</ul></li>
<li><strong>Why are BCa CIs preferred over percentile CIs?</strong>
<ul>
<li>Adjusts for bias in the bootstrap distribution</li>
<li>Adjusts for skewness</li>
<li>Better coverage properties (closer to nominal 95%)</li>
</ul></li>
<li><strong>What if we increased bootstrap resamples to 10,000?</strong>
<ul>
<li>More stable CI estimates</li>
<li>Smoother bootstrap distribution</li>
<li>Minimal change to CI (already stable at 5,000)</li>
</ul></li>
</ol>
<hr>
</section>
<section id="key-takeaways-1" class="level3">
<h3 class="anchored" data-anchor-id="key-takeaways-1">💡 Key Takeaways</h3>
<p>✅ <strong>Bootstrap is ideal when:</strong> - Small samples (n &lt; 30) - Non-normal distributions (skew, outliers) - No parametric formula exists (e.g., CI for median) - Robust inference needed</p>
<p>✅ <strong>How bootstrap works:</strong> 1. Resample data with replacement 2. Calculate statistic for each resample 3. Use percentiles of bootstrap distribution as CI</p>
<p>✅ <strong>Minimum resamples:</strong> - Percentile CI: 1,000–5,000 resamples - BCa CI: 2,000–10,000 resamples - More is better, but diminishing returns after 5,000</p>
<p>✅ <strong>Bootstrap assumptions:</strong> - Original sample is representative of population - Independence of observations - No assumptions about distribution shape!</p>
<hr>
</section>
<section id="homework-exercise-1" class="level3">
<h3 class="anchored" data-anchor-id="homework-exercise-1">🏠 Homework Exercise</h3>
<p>Analyze this dataset of reaction times (milliseconds) for 12 participants:</p>
<pre><code>reaction_time &lt;- c(245, 298, 312, 267, 289, 305, 411, 278, 293, 301, 285, 319)</code></pre>
<p><strong>Tasks:</strong> 1. Plot the distribution—is it symmetric? 2. Calculate parametric 95% CI for the mean 3. Calculate bootstrap 95% CI for the median (5,000 resamples) 4. Which CI is more trustworthy? Why? 5. Write a 2-sentence interpretation</p>
<p><strong>Hint:</strong> The 411 ms value is unusual—how does it affect the mean vs.&nbsp;median?</p>
<hr>
</section>
<section id="lab-3-mann-whitney-u-test-chapter-4" class="level2">
<h2 class="anchored" data-anchor-id="lab-3-mann-whitney-u-test-chapter-4">Lab 3: Mann-Whitney U Test (Chapter 4)</h2>
</section>
</section>
<section id="lab-practical-3-mann-whitney-u-test" class="level1">
<h1>🧪 Lab Practical 3: Mann-Whitney U Test</h1>
<p><strong>Learning Objectives:</strong> - Understand when to use Mann-Whitney instead of t-test - Perform Mann-Whitney U test in R - Calculate and interpret Hodges-Lehmann estimate - Compute rank-biserial correlation as effect size</p>
<hr>
<section id="scenario-2" class="level3">
<h3 class="anchored" data-anchor-id="scenario-2">Scenario</h3>
<p>A physical therapist compares recovery times (days) for two treatments in 20 patients. The data are right-skewed with some outliers, making t-test assumptions questionable.</p>
<ul>
<li><strong>Treatment A</strong> (n=10): 14, 18, 21, 16, 19, 25, 17, 22, 31, 20</li>
<li><strong>Treatment B</strong> (n=10): 22, 28, 35, 24, 30, 26, 42, 29, 33, 27</li>
</ul>
<p><strong>Research Question</strong>: Do the two treatments differ in typical recovery time?</p>
<hr>
</section>
<section id="step-1-load-and-visualize-data" class="level3">
<h3 class="anchored" data-anchor-id="step-1-load-and-visualize-data">Step 1: Load and Visualize Data</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstatix)</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data</span></span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>recovery_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">treatment =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Treatment A"</span>, <span class="st">"Treatment B"</span>), <span class="at">each =</span> <span class="dv">10</span>),</span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">days =</span> <span class="fu">c</span>(<span class="dv">14</span>, <span class="dv">18</span>, <span class="dv">21</span>, <span class="dv">16</span>, <span class="dv">19</span>, <span class="dv">25</span>, <span class="dv">17</span>, <span class="dv">22</span>, <span class="dv">31</span>, <span class="dv">20</span>,</span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a>           <span class="dv">22</span>, <span class="dv">28</span>, <span class="dv">35</span>, <span class="dv">24</span>, <span class="dv">30</span>, <span class="dv">26</span>, <span class="dv">42</span>, <span class="dv">29</span>, <span class="dv">33</span>, <span class="dv">27</span>)</span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-13"><a href="#cb90-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Box plot with individual points</span></span>
<span id="cb90-14"><a href="#cb90-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(recovery_data, <span class="fu">aes</span>(<span class="at">x =</span> treatment, <span class="at">y =</span> days, <span class="at">fill =</span> treatment)) <span class="sc">+</span></span>
<span id="cb90-15"><a href="#cb90-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb90-16"><a href="#cb90-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb90-17"><a href="#cb90-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Recovery Times by Treatment"</span>,</span>
<span id="cb90-18"><a href="#cb90-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Days to Recovery"</span>) <span class="sc">+</span></span>
<span id="cb90-19"><a href="#cb90-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb90-20"><a href="#cb90-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="part-g-lab-practicals_files/figure-html/lab3-step1-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Recovery time distributions by treatment group</figcaption>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary statistics</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>recovery_data <span class="sc">%&gt;%</span></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(treatment) <span class="sc">%&gt;%</span></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean =</span> <span class="fu">round</span>(<span class="fu">mean</span>(days), <span class="dv">1</span>),</span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">median =</span> <span class="fu">median</span>(days),</span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd =</span> <span class="fu">round</span>(<span class="fu">sd</span>(days), <span class="dv">1</span>),</span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">min =</span> <span class="fu">min</span>(days),</span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">max =</span> <span class="fu">max</span>(days)</span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 7
  treatment       n  mean median    sd   min   max
  &lt;chr&gt;       &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 Treatment A    10  20.3   19.5   4.9    14    31
2 Treatment B    10  29.6   28.5   5.8    22    42</code></pre>
</div>
</div>
<p><strong>✋ Checkpoint 1:</strong> - Does Treatment B have longer recovery times? - Are there outliers? (Yes: 31 in A, 42 in B)</p>
<p><strong>💡 Teaching Point:</strong> Outliers and skewness violate t-test assumptions. Mann-Whitney uses ranks, making it robust!</p>
<hr>
</section>
<section id="step-2-check-normality-for-educational-purposes" class="level3">
<h3 class="anchored" data-anchor-id="step-2-check-normality-for-educational-purposes">Step 2: Check Normality (For Educational Purposes)</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Shapiro-Wilk test for normality</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>shapiro_a <span class="ot">&lt;-</span> <span class="fu">shapiro.test</span>(recovery_data<span class="sc">$</span>days[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>])</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>shapiro_b <span class="ot">&lt;-</span> <span class="fu">shapiro.test</span>(recovery_data<span class="sc">$</span>days[<span class="dv">11</span><span class="sc">:</span><span class="dv">20</span>])</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Normality Tests:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Normality Tests:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Treatment A: W ="</span>, <span class="fu">round</span>(shapiro_a<span class="sc">$</span>statistic, <span class="dv">3</span>), </span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">", p ="</span>, <span class="fu">round</span>(shapiro_a<span class="sc">$</span>p.value, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Treatment A: W = 0.932 , p = 0.471 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Treatment B: W ="</span>, <span class="fu">round</span>(shapiro_b<span class="sc">$</span>statistic, <span class="dv">3</span>), </span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">", p ="</span>, <span class="fu">round</span>(shapiro_b<span class="sc">$</span>p.value, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Treatment B: W = 0.943 , p = 0.592 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Interpretation:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Interpretation:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- p &gt; 0.05 suggests data consistent with normality</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>- p &gt; 0.05 suggests data consistent with normality</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- But with n=10, Shapiro-Wilk has low power</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>- But with n=10, Shapiro-Wilk has low power</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Visual inspection (box plots) more informative</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>- Visual inspection (box plots) more informative</code></pre>
</div>
</div>
<p><strong>❓ Question 1:</strong> Even if normality tests pass, why might Mann-Whitney be preferred here?</p>
<hr>
</section>
<section id="step-3-run-mann-whitney-u-test" class="level3">
<h3 class="anchored" data-anchor-id="step-3-run-mann-whitney-u-test">Step 3: Run Mann-Whitney U Test</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Mann-Whitney U test (also called Wilcoxon rank-sum test)</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>mw_result <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(days <span class="sc">~</span> treatment, </span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">data =</span> recovery_data,</span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">exact =</span> <span class="cn">TRUE</span>,</span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>                         <span class="at">conf.int =</span> <span class="cn">TRUE</span>)</span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(mw_result)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum test with continuity correction

data:  days by treatment
W = 9.5, p-value = 0.002
alternative hypothesis: true location shift is not equal to 0
95 percent confidence interval:
 -14  -4
sample estimates:
difference in location 
                    -9 </code></pre>
</div>
</div>
<p><strong>✋ Checkpoint 2:</strong> - Is p-value &lt; 0.05? (Yes, significant difference) - Note the “confidence interval” reported—this is for the shift parameter</p>
<p><strong>💡 Teaching Point:</strong> The CI is for the Hodges-Lehmann estimate (pseudo-median difference), not the difference in medians!</p>
<hr>
</section>
<section id="step-4-calculate-hodges-lehmann-estimate-manually" class="level3">
<h3 class="anchored" data-anchor-id="step-4-calculate-hodges-lehmann-estimate-manually">Step 4: Calculate Hodges-Lehmann Estimate Manually</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Hodges-Lehmann estimate: median of all pairwise differences</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>days_a <span class="ot">&lt;-</span> recovery_data<span class="sc">$</span>days[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>days_b <span class="ot">&lt;-</span> recovery_data<span class="sc">$</span>days[<span class="dv">11</span><span class="sc">:</span><span class="dv">20</span>]</span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a><span class="co"># All pairwise differences (B - A)</span></span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a>pairwise_diffs <span class="ot">&lt;-</span> <span class="fu">outer</span>(days_b, days_a, <span class="st">"-"</span>)</span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Hodges-Lehmann estimate</span></span>
<span id="cb109-9"><a href="#cb109-9" aria-hidden="true" tabindex="-1"></a>hl_estimate <span class="ot">&lt;-</span> <span class="fu">median</span>(pairwise_diffs)</span>
<span id="cb109-10"><a href="#cb109-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-11"><a href="#cb109-11" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Hodges-Lehmann Estimate:"</span>, hl_estimate, <span class="st">"days</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Hodges-Lehmann Estimate: 9 days</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"95% CI from Mann-Whitney:"</span>, </span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(mw_result<span class="sc">$</span>conf.int[<span class="dv">1</span>], <span class="dv">1</span>), <span class="st">"to"</span>, </span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(mw_result<span class="sc">$</span>conf.int[<span class="dv">2</span>], <span class="dv">1</span>), <span class="st">"days</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>95% CI from Mann-Whitney: -14 to -4 days</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Interpretation:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Interpretation:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Treatment B takes ~"</span>, <span class="fu">abs</span>(hl_estimate), </span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">" days longer to recover (typical shift)</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Treatment B takes ~ 9  days longer to recover (typical shift)</code></pre>
</div>
</div>
<p><strong>❓ Question 2:</strong> How does the Hodges-Lehmann estimate compare to the difference in medians?</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>median_a <span class="ot">&lt;-</span> <span class="fu">median</span>(days_a)</span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>median_b <span class="ot">&lt;-</span> <span class="fu">median</span>(days_b)</span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>median_diff <span class="ot">&lt;-</span> median_b <span class="sc">-</span> median_a</span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Median (Treatment A):"</span>, median_a, <span class="st">"days</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Median (Treatment A): 19.5 days</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Median (Treatment B):"</span>, median_b, <span class="st">"days</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Median (Treatment B): 28.5 days</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Difference in medians:"</span>, median_diff, <span class="st">"days</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Difference in medians: 9 days</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Hodges-Lehmann estimate:"</span>, hl_estimate, <span class="st">"days</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Hodges-Lehmann estimate: 9 days</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"→ They're close but not identical!</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>→ They're close but not identical!</code></pre>
</div>
</div>
<hr>
</section>
<section id="step-5-calculate-effect-size-rank-biserial-correlation" class="level3">
<h3 class="anchored" data-anchor-id="step-5-calculate-effect-size-rank-biserial-correlation">Step 5: Calculate Effect Size (Rank-Biserial Correlation)</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using rstatix package</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>effect_size <span class="ot">&lt;-</span> <span class="fu">wilcox_effsize</span>(recovery_data, days <span class="sc">~</span> treatment)</span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(effect_size)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 7
  .y.   group1      group2      effsize    n1    n2 magnitude
* &lt;chr&gt; &lt;chr&gt;       &lt;chr&gt;         &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;ord&gt;    
1 days  Treatment A Treatment B   0.685    10    10 large    </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Interpretation of rank-biserial correlation:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Interpretation of rank-biserial correlation:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"r ="</span>, <span class="fu">round</span>(effect_size<span class="sc">$</span>effsize, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>r = 0.685 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Ranges from -1 to +1</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>- Ranges from -1 to +1</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- |r| &lt; 0.3: small effect</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>- |r| &lt; 0.3: small effect</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- |r| = 0.3-0.5: medium effect</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>- |r| = 0.3-0.5: medium effect</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- |r| &gt; 0.5: large effect</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>- |r| &gt; 0.5: large effect</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">abs</span>(effect_size<span class="sc">$</span>effsize) <span class="sc">&lt;</span> <span class="fl">0.3</span>) {</span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"→ Effect size is SMALL</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">abs</span>(effect_size<span class="sc">$</span>effsize) <span class="sc">&lt;</span> <span class="fl">0.5</span>) {</span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"→ Effect size is MEDIUM</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb141-6"><a href="#cb141-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"→ Effect size is LARGE</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb141-7"><a href="#cb141-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>→ Effect size is LARGE</code></pre>
</div>
</div>
<p><strong>✋ Checkpoint 3:</strong> - Effect size magnitude appropriate for interpretation? - Matches visual impression from box plot?</p>
<hr>
</section>
<section id="step-6-compare-with-t-test-educational" class="level3">
<h3 class="anchored" data-anchor-id="step-6-compare-with-t-test-educational">Step 6: Compare with t-test (Educational)</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run t-test for comparison</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>t_result <span class="ot">&lt;-</span> <span class="fu">t.test</span>(days <span class="sc">~</span> treatment, <span class="at">data =</span> recovery_data)</span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"=== Comparison: Mann-Whitney vs. t-test ===</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>=== Comparison: Mann-Whitney vs. t-test ===</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Mann-Whitney:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mann-Whitney:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  p-value ="</span>, <span class="fu">round</span>(mw_result<span class="sc">$</span>p.value, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  p-value = 0.0025 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Effect size (r) ="</span>, <span class="fu">round</span>(effect_size<span class="sc">$</span>effsize, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Effect size (r) = 0.685 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"t-test:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>t-test:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  p-value ="</span>, <span class="fu">round</span>(t_result<span class="sc">$</span>p.value, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  p-value = 0.0012 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Cohen's d ="</span>, <span class="fu">round</span>(<span class="fu">cohens_d</span>(recovery_data, days <span class="sc">~</span> treatment)<span class="sc">$</span>effsize, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Cohen's d = -1.726 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Both tests agree on significance, but:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Both tests agree on significance, but:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Mann-Whitney is robust to outliers</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>- Mann-Whitney is robust to outliers</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- t-test assumes normality and equal variance</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>- t-test assumes normality and equal variance</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- With small samples + skew, trust Mann-Whitney!</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>- With small samples + skew, trust Mann-Whitney!</code></pre>
</div>
</div>
<p><strong>❓ Question 3:</strong> What happens if we remove the outliers (31 and 42)? Would the t-test be more appropriate?</p>
<hr>
</section>
<section id="step-7-create-publication-table" class="level3">
<h3 class="anchored" data-anchor-id="step-7-create-publication-table">Step 7: Create Publication Table</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary table</span></span>
<span id="cb165-4"><a href="#cb165-4" aria-hidden="true" tabindex="-1"></a>summary_table <span class="ot">&lt;-</span> recovery_data <span class="sc">%&gt;%</span></span>
<span id="cb165-5"><a href="#cb165-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(treatment) <span class="sc">%&gt;%</span></span>
<span id="cb165-6"><a href="#cb165-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb165-7"><a href="#cb165-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">N =</span> <span class="fu">n</span>(),</span>
<span id="cb165-8"><a href="#cb165-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Median =</span> <span class="fu">median</span>(days),</span>
<span id="cb165-9"><a href="#cb165-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">IQR =</span> <span class="fu">paste0</span>(<span class="fu">quantile</span>(days, <span class="fl">0.25</span>), <span class="st">"–"</span>, <span class="fu">quantile</span>(days, <span class="fl">0.75</span>)),</span>
<span id="cb165-10"><a href="#cb165-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">Range =</span> <span class="fu">paste0</span>(<span class="fu">min</span>(days), <span class="st">"–"</span>, <span class="fu">max</span>(days))</span>
<span id="cb165-11"><a href="#cb165-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb165-12"><a href="#cb165-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-13"><a href="#cb165-13" aria-hidden="true" tabindex="-1"></a>summary_table <span class="sc">%&gt;%</span></span>
<span id="cb165-14"><a href="#cb165-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb165-15"><a href="#cb165-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb165-16"><a href="#cb165-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Recovery Times by Treatment Group"</span>,</span>
<span id="cb165-17"><a href="#cb165-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">sprintf</span>(<span class="st">"Mann-Whitney U test: p = %.3f, r = %.2f, Hodges-Lehmann = %.1f days"</span>,</span>
<span id="cb165-18"><a href="#cb165-18" aria-hidden="true" tabindex="-1"></a>                      mw_result<span class="sc">$</span>p.value, effect_size<span class="sc">$</span>effsize, hl_estimate)</span>
<span id="cb165-19"><a href="#cb165-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb165-20"><a href="#cb165-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_footnote</span>(</span>
<span id="cb165-21"><a href="#cb165-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">footnote =</span> <span class="st">"Rank-biserial correlation indicates medium-to-large effect"</span>,</span>
<span id="cb165-22"><a href="#cb165-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_title</span>()</span>
<span id="cb165-23"><a href="#cb165-23" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="dzawjmqldw" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#dzawjmqldw table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#dzawjmqldw thead, #dzawjmqldw tbody, #dzawjmqldw tfoot, #dzawjmqldw tr, #dzawjmqldw td, #dzawjmqldw th {
  border-style: none;
}

#dzawjmqldw p {
  margin: 0;
  padding: 0;
}

#dzawjmqldw .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#dzawjmqldw .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#dzawjmqldw .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#dzawjmqldw .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#dzawjmqldw .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dzawjmqldw .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dzawjmqldw .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dzawjmqldw .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#dzawjmqldw .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#dzawjmqldw .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#dzawjmqldw .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#dzawjmqldw .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#dzawjmqldw .gt_spanner_row {
  border-bottom-style: hidden;
}

#dzawjmqldw .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#dzawjmqldw .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#dzawjmqldw .gt_from_md > :first-child {
  margin-top: 0;
}

#dzawjmqldw .gt_from_md > :last-child {
  margin-bottom: 0;
}

#dzawjmqldw .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#dzawjmqldw .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#dzawjmqldw .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#dzawjmqldw .gt_row_group_first td {
  border-top-width: 2px;
}

#dzawjmqldw .gt_row_group_first th {
  border-top-width: 2px;
}

#dzawjmqldw .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#dzawjmqldw .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#dzawjmqldw .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#dzawjmqldw .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dzawjmqldw .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#dzawjmqldw .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#dzawjmqldw .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#dzawjmqldw .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#dzawjmqldw .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dzawjmqldw .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dzawjmqldw .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#dzawjmqldw .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dzawjmqldw .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#dzawjmqldw .gt_left {
  text-align: left;
}

#dzawjmqldw .gt_center {
  text-align: center;
}

#dzawjmqldw .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#dzawjmqldw .gt_font_normal {
  font-weight: normal;
}

#dzawjmqldw .gt_font_bold {
  font-weight: bold;
}

#dzawjmqldw .gt_font_italic {
  font-style: italic;
}

#dzawjmqldw .gt_super {
  font-size: 65%;
}

#dzawjmqldw .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#dzawjmqldw .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#dzawjmqldw .gt_indent_1 {
  text-indent: 5px;
}

#dzawjmqldw .gt_indent_2 {
  text-indent: 10px;
}

#dzawjmqldw .gt_indent_3 {
  text-indent: 15px;
}

#dzawjmqldw .gt_indent_4 {
  text-indent: 20px;
}

#dzawjmqldw .gt_indent_5 {
  text-indent: 25px;
}

#dzawjmqldw .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#dzawjmqldw div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading header">
<td colspan="5" class="gt_heading gt_title gt_font_normal">Recovery Times by Treatment Group<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></td>
</tr>
<tr class="gt_heading even">
<td colspan="5" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border">Mann-Whitney U test: p = 0.002, r = 0.68, Hodges-Lehmann = 9.0 days<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></td>
</tr>
<tr class="gt_col_headings header">
<th id="treatment" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">treatment</th>
<th id="N" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">N</th>
<th id="Median" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Median</th>
<th id="IQR" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">IQR</th>
<th id="Range" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Range</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="treatment">Treatment A</td>
<td class="gt_row gt_right" headers="N">10</td>
<td class="gt_row gt_right" headers="Median">19.5</td>
<td class="gt_row gt_left" headers="IQR">17.25–21.75</td>
<td class="gt_row gt_left" headers="Range">14–31</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="treatment">Treatment B</td>
<td class="gt_row gt_right" headers="N">10</td>
<td class="gt_row gt_right" headers="Median">28.5</td>
<td class="gt_row gt_left" headers="IQR">26.25–32.25</td>
<td class="gt_row gt_left" headers="Range">22–42</td>
</tr>
</tbody><tfoot class="gt_footnotes">
<tr class="odd">
<td colspan="5" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> Rank-biserial correlation indicates medium-to-large effect</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
<hr>
</section>
<section id="step-8-visualize-effect-with-rank-plot" class="level3">
<h3 class="anchored" data-anchor-id="step-8-visualize-effect-with-rank-plot">Step 8: Visualize Effect with Rank Plot</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add ranks for visualization</span></span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a>recovery_ranked <span class="ot">&lt;-</span> recovery_data <span class="sc">%&gt;%</span></span>
<span id="cb166-3"><a href="#cb166-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rank =</span> <span class="fu">rank</span>(days))</span>
<span id="cb166-4"><a href="#cb166-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-5"><a href="#cb166-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(recovery_ranked, <span class="fu">aes</span>(<span class="at">x =</span> rank, <span class="at">y =</span> days, <span class="at">color =</span> treatment, <span class="at">shape =</span> treatment)) <span class="sc">+</span></span>
<span id="cb166-6"><a href="#cb166-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb166-7"><a href="#cb166-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="fu">aes</span>(<span class="at">yintercept =</span> <span class="fu">median</span>(days[treatment <span class="sc">==</span> <span class="st">"Treatment A"</span>])),</span>
<span id="cb166-8"><a href="#cb166-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"#F8766D"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb166-9"><a href="#cb166-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="fu">aes</span>(<span class="at">yintercept =</span> <span class="fu">median</span>(days[treatment <span class="sc">==</span> <span class="st">"Treatment B"</span>])),</span>
<span id="cb166-10"><a href="#cb166-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"#00BFC4"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb166-11"><a href="#cb166-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Recovery Times Ranked"</span>,</span>
<span id="cb166-12"><a href="#cb166-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Dashed lines = medians"</span>,</span>
<span id="cb166-13"><a href="#cb166-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Rank (1 = shortest recovery)"</span>,</span>
<span id="cb166-14"><a href="#cb166-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Days to Recovery"</span>) <span class="sc">+</span></span>
<span id="cb166-15"><a href="#cb166-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="part-g-lab-practicals_files/figure-html/lab3-step8-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Ranked recovery times showing treatment separation</figcaption>
</figure>
</div>
</div>
</div>
<hr>
</section>
<section id="discussion-questions-2" class="level3">
<h3 class="anchored" data-anchor-id="discussion-questions-2">❓ Discussion Questions</h3>
<ol type="1">
<li><strong>Why is Mann-Whitney called a “rank-based” test?</strong>
<ul>
<li>It ranks all observations from both groups together</li>
<li>Tests whether ranks are systematically higher in one group</li>
<li>Makes no assumptions about distribution shape</li>
</ul></li>
<li><strong>When would you use t-test instead of Mann-Whitney?</strong>
<ul>
<li>Large samples (n &gt; 30 per group) where CLT applies</li>
<li>Truly normal data with no outliers</li>
<li>When you need to test means specifically (not medians/shifts)</li>
</ul></li>
<li><strong>What’s the difference between median difference and Hodges-Lehmann?</strong>
<ul>
<li>Median difference: simple subtraction of group medians</li>
<li>Hodges-Lehmann: median of ALL pairwise differences between groups</li>
<li>HL is often preferred as it uses more information</li>
</ul></li>
<li><strong>How would results change if we added more data?</strong>
<ul>
<li>Narrower confidence intervals</li>
<li>More precise effect size estimate</li>
<li>Could detect smaller differences</li>
</ul></li>
</ol>
<hr>
</section>
<section id="key-takeaways-2" class="level3">
<h3 class="anchored" data-anchor-id="key-takeaways-2">💡 Key Takeaways</h3>
<p>✅ <strong>Use Mann-Whitney when:</strong> - Independent groups (unpaired data) - Ordinal or continuous outcome - Non-normal distributions or outliers - Small samples (n &lt; 30 per group)</p>
<p>✅ <strong>Mann-Whitney tests:</strong> - Whether distributions differ in location - NOT just medians (common misconception!) - Robust to outliers and skewness</p>
<p>✅ <strong>Report these components:</strong> - Medians and IQRs for each group - Mann-Whitney p-value - Hodges-Lehmann estimate with CI - Rank-biserial correlation (effect size)</p>
<p>✅ <strong>Remember:</strong> - Exact test for small samples (n &lt; 30) - Large-sample approximation for n ≥ 30 - Always visualize with box plots + points</p>
<hr>
</section>
<section id="homework-exercise-2" class="level3">
<h3 class="anchored" data-anchor-id="homework-exercise-2">🏠 Homework Exercise</h3>
<p>Analyze satisfaction scores (1-7 scale) for two app interfaces:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a>interface_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">interface =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Design A"</span>, <span class="st">"Design B"</span>), <span class="at">each =</span> <span class="dv">12</span>),</span>
<span id="cb167-3"><a href="#cb167-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">satisfaction =</span> <span class="fu">c</span>(</span>
<span id="cb167-4"><a href="#cb167-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Design A</span></span>
<span id="cb167-5"><a href="#cb167-5" aria-hidden="true" tabindex="-1"></a>    <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">7</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">5</span>, <span class="dv">4</span>,</span>
<span id="cb167-6"><a href="#cb167-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Design B</span></span>
<span id="cb167-7"><a href="#cb167-7" aria-hidden="true" tabindex="-1"></a>    <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">6</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">5</span>, <span class="dv">6</span></span>
<span id="cb167-8"><a href="#cb167-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb167-9"><a href="#cb167-9" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Tasks:</strong> 1. Create box plots with individual points 2. Calculate medians and IQRs for each group 3. Run Mann-Whitney U test 4. Calculate rank-biserial correlation 5. Interpret Hodges-Lehmann estimate 6. Write a 4-sentence results paragraph including: - Descriptive statistics - Test statistic and p-value - Effect size interpretation - Practical conclusion</p>
<p><strong>Expected results:</strong> Design B should have higher satisfaction with moderate effect size.</p>
<hr>
</section>
<section id="lab-4-wilcoxon-signed-rank-test-chapter-4" class="level2">
<h2 class="anchored" data-anchor-id="lab-4-wilcoxon-signed-rank-test-chapter-4">Lab 4: Wilcoxon Signed-Rank Test (Chapter 4)</h2>
</section>
</section>
<section id="lab-practical-4-wilcoxon-signed-rank-test" class="level1">
<h1>🧪 Lab Practical 4: Wilcoxon Signed-Rank Test</h1>
<p><strong>Learning Objectives:</strong> - Understand paired vs.&nbsp;independent designs - Perform Wilcoxon signed-rank test - Calculate effect size for paired nonparametric tests - Interpret results with paired data visualizations</p>
<hr>
<section id="scenario-3" class="level3">
<h3 class="anchored" data-anchor-id="scenario-3">Scenario</h3>
<p>A wellness coach measures anxiety scores (0-100 scale) for 14 clients before and after a 4-week mindfulness program. Since the same clients are measured twice, data are paired.</p>
<p><strong>Research Question</strong>: Does the mindfulness program reduce anxiety?</p>
<hr>
</section>
<section id="step-1-create-and-visualize-paired-data" class="level3">
<h3 class="anchored" data-anchor-id="step-1-create-and-visualize-paired-data">Step 1: Create and Visualize Paired Data</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstatix)</span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-4"><a href="#cb168-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb168-5"><a href="#cb168-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-6"><a href="#cb168-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Paired data</span></span>
<span id="cb168-7"><a href="#cb168-7" aria-hidden="true" tabindex="-1"></a>anxiety_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb168-8"><a href="#cb168-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">client_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">14</span>,</span>
<span id="cb168-9"><a href="#cb168-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">before =</span> <span class="fu">c</span>(<span class="dv">68</span>, <span class="dv">72</span>, <span class="dv">65</span>, <span class="dv">78</span>, <span class="dv">70</span>, <span class="dv">63</span>, <span class="dv">75</span>, <span class="dv">81</span>, <span class="dv">69</span>, <span class="dv">74</span>, <span class="dv">66</span>, <span class="dv">71</span>, <span class="dv">77</span>, <span class="dv">73</span>),</span>
<span id="cb168-10"><a href="#cb168-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">after =</span> <span class="fu">c</span>(<span class="dv">61</span>, <span class="dv">65</span>, <span class="dv">62</span>, <span class="dv">70</span>, <span class="dv">64</span>, <span class="dv">60</span>, <span class="dv">68</span>, <span class="dv">72</span>, <span class="dv">65</span>, <span class="dv">67</span>, <span class="dv">63</span>, <span class="dv">66</span>, <span class="dv">71</span>, <span class="dv">68</span>)</span>
<span id="cb168-11"><a href="#cb168-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb168-12"><a href="#cb168-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-13"><a href="#cb168-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to long format for plotting</span></span>
<span id="cb168-14"><a href="#cb168-14" aria-hidden="true" tabindex="-1"></a>anxiety_long <span class="ot">&lt;-</span> anxiety_data <span class="sc">%&gt;%</span></span>
<span id="cb168-15"><a href="#cb168-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(before, after),</span>
<span id="cb168-16"><a href="#cb168-16" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"timepoint"</span>,</span>
<span id="cb168-17"><a href="#cb168-17" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"anxiety"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb168-18"><a href="#cb168-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">timepoint =</span> <span class="fu">factor</span>(timepoint, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"before"</span>, <span class="st">"after"</span>)))</span>
<span id="cb168-19"><a href="#cb168-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-20"><a href="#cb168-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Paired plot</span></span>
<span id="cb168-21"><a href="#cb168-21" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(anxiety_long, <span class="fu">aes</span>(<span class="at">x =</span> timepoint, <span class="at">y =</span> anxiety, <span class="at">group =</span> client_id)) <span class="sc">+</span></span>
<span id="cb168-22"><a href="#cb168-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">color =</span> <span class="st">"gray60"</span>) <span class="sc">+</span></span>
<span id="cb168-23"><a href="#cb168-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> timepoint), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb168-24"><a href="#cb168-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Anxiety Scores: Before vs. After Mindfulness"</span>,</span>
<span id="cb168-25"><a href="#cb168-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Each line represents one client"</span>,</span>
<span id="cb168-26"><a href="#cb168-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Timepoint"</span>,</span>
<span id="cb168-27"><a href="#cb168-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Anxiety Score (0-100)"</span>) <span class="sc">+</span></span>
<span id="cb168-28"><a href="#cb168-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb168-29"><a href="#cb168-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="part-g-lab-practicals_files/figure-html/lab4-step1-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Anxiety scores before and after mindfulness program</figcaption>
</figure>
</div>
</div>
</div>
<p><strong>✋ Checkpoint 1:</strong> - Do most lines slope downward? (Yes = anxiety decreased) - Any clients with increased anxiety?</p>
<p><strong>💡 Teaching Point:</strong> Paired data show individual change—much more powerful than comparing independent groups!</p>
<hr>
</section>
<section id="step-2-calculate-and-visualize-differences" class="level3">
<h3 class="anchored" data-anchor-id="step-2-calculate-and-visualize-differences">Step 2: Calculate and Visualize Differences</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate differences (after - before)</span></span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a>anxiety_data <span class="ot">&lt;-</span> anxiety_data <span class="sc">%&gt;%</span></span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">difference =</span> after <span class="sc">-</span> before)</span>
<span id="cb169-4"><a href="#cb169-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-5"><a href="#cb169-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Histogram of differences</span></span>
<span id="cb169-6"><a href="#cb169-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(anxiety_data, <span class="fu">aes</span>(<span class="at">x =</span> difference)) <span class="sc">+</span></span>
<span id="cb169-7"><a href="#cb169-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">2</span>, <span class="at">fill =</span> <span class="st">"steelblue"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb169-8"><a href="#cb169-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> <span class="dv">0</span>), <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb169-9"><a href="#cb169-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> <span class="fu">median</span>(difference)), </span>
<span id="cb169-10"><a href="#cb169-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"darkblue"</span>, <span class="at">linetype =</span> <span class="st">"solid"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb169-11"><a href="#cb169-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Change Scores"</span>,</span>
<span id="cb169-12"><a href="#cb169-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Red dashed = no change; Blue solid = median change"</span>,</span>
<span id="cb169-13"><a href="#cb169-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Change in Anxiety (after - before)"</span>,</span>
<span id="cb169-14"><a href="#cb169-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb169-15"><a href="#cb169-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="part-g-lab-practicals_files/figure-html/lab4-step2-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Distribution of anxiety score changes</figcaption>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb170"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary of differences</span></span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Summary of Changes:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Summary of Changes:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Mean change:"</span>, <span class="fu">round</span>(<span class="fu">mean</span>(anxiety_data<span class="sc">$</span>difference), <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mean change: -5.71 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Median change:"</span>, <span class="fu">median</span>(anxiety_data<span class="sc">$</span>difference), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Median change: -6 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"SD of change:"</span>, <span class="fu">round</span>(<span class="fu">sd</span>(anxiety_data<span class="sc">$</span>difference), <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>SD of change: 1.94 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Clients improved:"</span>, <span class="fu">sum</span>(anxiety_data<span class="sc">$</span>difference <span class="sc">&lt;</span> <span class="dv">0</span>), <span class="st">"out of"</span>, <span class="fu">nrow</span>(anxiety_data), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Clients improved: 14 out of 14 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb180"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Clients worsened:"</span>, <span class="fu">sum</span>(anxiety_data<span class="sc">$</span>difference <span class="sc">&gt;</span> <span class="dv">0</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Clients worsened: 0 </code></pre>
</div>
</div>
<p><strong>❓ Question 1:</strong> Why do we focus on differences rather than before/after separately?</p>
<hr>
</section>
<section id="step-3-run-wilcoxon-signed-rank-test" class="level3">
<h3 class="anchored" data-anchor-id="step-3-run-wilcoxon-signed-rank-test">Step 3: Run Wilcoxon Signed-Rank Test</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb182"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Wilcoxon signed-rank test</span></span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a>wilcox_result <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(anxiety_data<span class="sc">$</span>after, </span>
<span id="cb182-3"><a href="#cb182-3" aria-hidden="true" tabindex="-1"></a>                              anxiety_data<span class="sc">$</span>before,</span>
<span id="cb182-4"><a href="#cb182-4" aria-hidden="true" tabindex="-1"></a>                              <span class="at">paired =</span> <span class="cn">TRUE</span>,</span>
<span id="cb182-5"><a href="#cb182-5" aria-hidden="true" tabindex="-1"></a>                              <span class="at">exact =</span> <span class="cn">TRUE</span>,</span>
<span id="cb182-6"><a href="#cb182-6" aria-hidden="true" tabindex="-1"></a>                              <span class="at">conf.int =</span> <span class="cn">TRUE</span>)</span>
<span id="cb182-7"><a href="#cb182-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-8"><a href="#cb182-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(wilcox_result)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon signed rank test with continuity correction

data:  anxiety_data$after and anxiety_data$before
V = 0, p-value = 0.001
alternative hypothesis: true location shift is not equal to 0
95 percent confidence interval:
 -7.0 -4.5
sample estimates:
(pseudo)median 
            -6 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb184"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== Interpretation ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== Interpretation ===</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb186"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"V statistic:"</span>, wilcox_result<span class="sc">$</span>statistic, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>V statistic: 0 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb188"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"p-value:"</span>, <span class="fu">round</span>(wilcox_result<span class="sc">$</span>p.value, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>p-value: 0.001 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb190"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"95% CI for pseudo-median:"</span>, </span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(wilcox_result<span class="sc">$</span>conf.int[<span class="dv">1</span>], <span class="dv">1</span>), <span class="st">"to"</span>,</span>
<span id="cb190-3"><a href="#cb190-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(wilcox_result<span class="sc">$</span>conf.int[<span class="dv">2</span>], <span class="dv">1</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>95% CI for pseudo-median: -7 to -4.5 </code></pre>
</div>
</div>
<p><strong>✋ Checkpoint 2:</strong> - Is p &lt; 0.05? (Yes, significant reduction) - What does the “V statistic” represent? (Sum of positive ranks)</p>
<p><strong>💡 Teaching Point:</strong> Wilcoxon signed-rank tests whether the distribution of differences is symmetric around zero.</p>
<hr>
</section>
<section id="step-4-calculate-effect-size-r" class="level3">
<h3 class="anchored" data-anchor-id="step-4-calculate-effect-size-r">Step 4: Calculate Effect Size (r)</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb192"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Effect size using rstatix</span></span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a>effect_size <span class="ot">&lt;-</span> <span class="fu">wilcox_effsize</span>(anxiety_long, anxiety <span class="sc">~</span> timepoint, <span class="at">paired =</span> <span class="cn">TRUE</span>)</span>
<span id="cb192-3"><a href="#cb192-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-4"><a href="#cb192-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(effect_size)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 7
  .y.     group1 group2 effsize    n1    n2 magnitude
* &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt;    &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;ord&gt;    
1 anxiety before after    0.884    14    14 large    </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb194"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Effect Size Interpretation:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Effect Size Interpretation:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb196"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"r ="</span>, <span class="fu">round</span>(effect_size<span class="sc">$</span>effsize, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>r = 0.884 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb198"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Small: |r| &lt; 0.3</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>- Small: |r| &lt; 0.3</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb200"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Medium: |r| = 0.3-0.5</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>- Medium: |r| = 0.3-0.5</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb202"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Large: |r| &gt; 0.5</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>- Large: |r| &gt; 0.5</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb204"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">abs</span>(effect_size<span class="sc">$</span>effsize) <span class="sc">&gt;</span> <span class="fl">0.5</span>) {</span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"→ LARGE effect: Mindfulness program shows substantial benefit</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb204-3"><a href="#cb204-3" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">abs</span>(effect_size<span class="sc">$</span>effsize) <span class="sc">&gt;</span> <span class="fl">0.3</span>) {</span>
<span id="cb204-4"><a href="#cb204-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"→ MEDIUM effect: Mindfulness program shows moderate benefit</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb204-5"><a href="#cb204-5" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb204-6"><a href="#cb204-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"→ SMALL effect: Mindfulness program shows modest benefit</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb204-7"><a href="#cb204-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>→ LARGE effect: Mindfulness program shows substantial benefit</code></pre>
</div>
</div>
<hr>
</section>
<section id="step-5-compare-with-paired-t-test" class="level3">
<h3 class="anchored" data-anchor-id="step-5-compare-with-paired-t-test">Step 5: Compare with Paired t-test</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb206"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Paired t-test for comparison</span></span>
<span id="cb206-2"><a href="#cb206-2" aria-hidden="true" tabindex="-1"></a>t_result <span class="ot">&lt;-</span> <span class="fu">t.test</span>(anxiety_data<span class="sc">$</span>after, anxiety_data<span class="sc">$</span>before, <span class="at">paired =</span> <span class="cn">TRUE</span>)</span>
<span id="cb206-3"><a href="#cb206-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-4"><a href="#cb206-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Cohen's d for paired data</span></span>
<span id="cb206-5"><a href="#cb206-5" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">mean</span>(anxiety_data<span class="sc">$</span>difference) <span class="sc">/</span> <span class="fu">sd</span>(anxiety_data<span class="sc">$</span>difference)</span>
<span id="cb206-6"><a href="#cb206-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-7"><a href="#cb206-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"=== Wilcoxon vs. Paired t-test ===</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>=== Wilcoxon vs. Paired t-test ===</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb208"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Wilcoxon Signed-Rank:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Wilcoxon Signed-Rank:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb210"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  p ="</span>, <span class="fu">round</span>(wilcox_result<span class="sc">$</span>p.value, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  p = 0.001 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb212"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  r ="</span>, <span class="fu">round</span>(effect_size<span class="sc">$</span>effsize, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  r = 0.884 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb214"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Paired t-test:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Paired t-test:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb216"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  p ="</span>, <span class="fu">round</span>(t_result<span class="sc">$</span>p.value, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  p = 0 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb218"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Cohen's d ="</span>, <span class="fu">round</span>(d, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Cohen's d = -2.948 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb220"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  95% CI for mean diff:"</span>, </span>
<span id="cb220-2"><a href="#cb220-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(t_result<span class="sc">$</span>conf.int[<span class="dv">1</span>], <span class="dv">1</span>), <span class="st">"to"</span>,</span>
<span id="cb220-3"><a href="#cb220-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(t_result<span class="sc">$</span>conf.int[<span class="dv">2</span>], <span class="dv">1</span>), <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  95% CI for mean diff: -6.8 to -4.6 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb222"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Conclusion: Both tests agree on significance!</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Conclusion: Both tests agree on significance!</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb224"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"With n=14, Wilcoxon is safer (fewer assumptions)</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>With n=14, Wilcoxon is safer (fewer assumptions)</code></pre>
</div>
</div>
<p><strong>❓ Question 2:</strong> When would the two tests disagree?</p>
<hr>
</section>
<section id="step-6-check-for-outliers-in-differences" class="level3">
<h3 class="anchored" data-anchor-id="step-6-check-for-outliers-in-differences">Step 6: Check for Outliers in Differences</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb226"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(anxiety_data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> difference)) <span class="sc">+</span></span>
<span id="cb226-2"><a href="#cb226-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">"lightblue"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb226-3"><a href="#cb226-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb226-4"><a href="#cb226-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb226-5"><a href="#cb226-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Change Scores with Outlier Detection"</span>,</span>
<span id="cb226-6"><a href="#cb226-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Change in Anxiety (after - before)"</span>,</span>
<span id="cb226-7"><a href="#cb226-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb226-8"><a href="#cb226-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="part-g-lab-practicals_files/figure-html/lab4-step6-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Box plot of change scores identifying outliers</figcaption>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb227"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify outliers</span></span>
<span id="cb227-2"><a href="#cb227-2" aria-hidden="true" tabindex="-1"></a>Q1 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(anxiety_data<span class="sc">$</span>difference, <span class="fl">0.25</span>)</span>
<span id="cb227-3"><a href="#cb227-3" aria-hidden="true" tabindex="-1"></a>Q3 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(anxiety_data<span class="sc">$</span>difference, <span class="fl">0.75</span>)</span>
<span id="cb227-4"><a href="#cb227-4" aria-hidden="true" tabindex="-1"></a>IQR_val <span class="ot">&lt;-</span> <span class="fu">IQR</span>(anxiety_data<span class="sc">$</span>difference)</span>
<span id="cb227-5"><a href="#cb227-5" aria-hidden="true" tabindex="-1"></a>outliers <span class="ot">&lt;-</span> anxiety_data <span class="sc">%&gt;%</span></span>
<span id="cb227-6"><a href="#cb227-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(difference <span class="sc">&lt;</span> Q1 <span class="sc">-</span> <span class="fl">1.5</span> <span class="sc">*</span> IQR_val <span class="sc">|</span> difference <span class="sc">&gt;</span> Q3 <span class="sc">+</span> <span class="fl">1.5</span> <span class="sc">*</span> IQR_val)</span>
<span id="cb227-7"><a href="#cb227-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-8"><a href="#cb227-8" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">nrow</span>(outliers) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb227-9"><a href="#cb227-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Outliers detected:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb227-10"><a href="#cb227-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(outliers)</span>
<span id="cb227-11"><a href="#cb227-11" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb227-12"><a href="#cb227-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"No outliers detected</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb227-13"><a href="#cb227-13" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>No outliers detected</code></pre>
</div>
</div>
<p><strong>💡 Teaching Point:</strong> Wilcoxon is robust to outliers—one reason to prefer it over paired t-test!</p>
<hr>
</section>
<section id="step-7-create-publication-table-1" class="level3">
<h3 class="anchored" data-anchor-id="step-7-create-publication-table-1">Step 7: Create Publication Table</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb229"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb229-2"><a href="#cb229-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-3"><a href="#cb229-3" aria-hidden="true" tabindex="-1"></a>summary_table <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb229-4"><a href="#cb229-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Timepoint =</span> <span class="fu">c</span>(<span class="st">"Before"</span>, <span class="st">"After"</span>, <span class="st">"Change"</span>),</span>
<span id="cb229-5"><a href="#cb229-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">N =</span> <span class="fu">c</span>(<span class="dv">14</span>, <span class="dv">14</span>, <span class="dv">14</span>),</span>
<span id="cb229-6"><a href="#cb229-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Median =</span> <span class="fu">c</span>(<span class="fu">median</span>(anxiety_data<span class="sc">$</span>before),</span>
<span id="cb229-7"><a href="#cb229-7" aria-hidden="true" tabindex="-1"></a>             <span class="fu">median</span>(anxiety_data<span class="sc">$</span>after),</span>
<span id="cb229-8"><a href="#cb229-8" aria-hidden="true" tabindex="-1"></a>             <span class="fu">median</span>(anxiety_data<span class="sc">$</span>difference)),</span>
<span id="cb229-9"><a href="#cb229-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">IQR =</span> <span class="fu">c</span>(</span>
<span id="cb229-10"><a href="#cb229-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="fu">quantile</span>(anxiety_data<span class="sc">$</span>before, <span class="fl">0.25</span>), <span class="st">"–"</span>, </span>
<span id="cb229-11"><a href="#cb229-11" aria-hidden="true" tabindex="-1"></a>           <span class="fu">quantile</span>(anxiety_data<span class="sc">$</span>before, <span class="fl">0.75</span>)),</span>
<span id="cb229-12"><a href="#cb229-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="fu">quantile</span>(anxiety_data<span class="sc">$</span>after, <span class="fl">0.25</span>), <span class="st">"–"</span>, </span>
<span id="cb229-13"><a href="#cb229-13" aria-hidden="true" tabindex="-1"></a>           <span class="fu">quantile</span>(anxiety_data<span class="sc">$</span>after, <span class="fl">0.75</span>)),</span>
<span id="cb229-14"><a href="#cb229-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="fu">quantile</span>(anxiety_data<span class="sc">$</span>difference, <span class="fl">0.25</span>), <span class="st">"–"</span>, </span>
<span id="cb229-15"><a href="#cb229-15" aria-hidden="true" tabindex="-1"></a>           <span class="fu">quantile</span>(anxiety_data<span class="sc">$</span>difference, <span class="fl">0.75</span>))</span>
<span id="cb229-16"><a href="#cb229-16" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb229-17"><a href="#cb229-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb229-18"><a href="#cb229-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-19"><a href="#cb229-19" aria-hidden="true" tabindex="-1"></a>summary_table <span class="sc">%&gt;%</span></span>
<span id="cb229-20"><a href="#cb229-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb229-21"><a href="#cb229-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb229-22"><a href="#cb229-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Anxiety Scores Before and After Mindfulness Program"</span>,</span>
<span id="cb229-23"><a href="#cb229-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">sprintf</span>(<span class="st">"Wilcoxon signed-rank: p = %.4f, r = %.2f (large effect)"</span>,</span>
<span id="cb229-24"><a href="#cb229-24" aria-hidden="true" tabindex="-1"></a>                      wilcox_result<span class="sc">$</span>p.value, effect_size<span class="sc">$</span>effsize)</span>
<span id="cb229-25"><a href="#cb229-25" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb229-26"><a href="#cb229-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_footnote</span>(</span>
<span id="cb229-27"><a href="#cb229-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">footnote =</span> <span class="st">"Negative change indicates anxiety reduction"</span>,</span>
<span id="cb229-28"><a href="#cb229-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_body</span>(<span class="at">columns =</span> Median, <span class="at">rows =</span> <span class="dv">3</span>)</span>
<span id="cb229-29"><a href="#cb229-29" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="dzawjmqldw" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#dzawjmqldw table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#dzawjmqldw thead, #dzawjmqldw tbody, #dzawjmqldw tfoot, #dzawjmqldw tr, #dzawjmqldw td, #dzawjmqldw th {
  border-style: none;
}

#dzawjmqldw p {
  margin: 0;
  padding: 0;
}

#dzawjmqldw .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#dzawjmqldw .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#dzawjmqldw .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#dzawjmqldw .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#dzawjmqldw .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dzawjmqldw .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dzawjmqldw .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dzawjmqldw .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#dzawjmqldw .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#dzawjmqldw .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#dzawjmqldw .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#dzawjmqldw .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#dzawjmqldw .gt_spanner_row {
  border-bottom-style: hidden;
}

#dzawjmqldw .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#dzawjmqldw .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#dzawjmqldw .gt_from_md > :first-child {
  margin-top: 0;
}

#dzawjmqldw .gt_from_md > :last-child {
  margin-bottom: 0;
}

#dzawjmqldw .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#dzawjmqldw .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#dzawjmqldw .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#dzawjmqldw .gt_row_group_first td {
  border-top-width: 2px;
}

#dzawjmqldw .gt_row_group_first th {
  border-top-width: 2px;
}

#dzawjmqldw .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#dzawjmqldw .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#dzawjmqldw .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#dzawjmqldw .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dzawjmqldw .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#dzawjmqldw .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#dzawjmqldw .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#dzawjmqldw .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#dzawjmqldw .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dzawjmqldw .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dzawjmqldw .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#dzawjmqldw .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dzawjmqldw .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#dzawjmqldw .gt_left {
  text-align: left;
}

#dzawjmqldw .gt_center {
  text-align: center;
}

#dzawjmqldw .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#dzawjmqldw .gt_font_normal {
  font-weight: normal;
}

#dzawjmqldw .gt_font_bold {
  font-weight: bold;
}

#dzawjmqldw .gt_font_italic {
  font-style: italic;
}

#dzawjmqldw .gt_super {
  font-size: 65%;
}

#dzawjmqldw .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#dzawjmqldw .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#dzawjmqldw .gt_indent_1 {
  text-indent: 5px;
}

#dzawjmqldw .gt_indent_2 {
  text-indent: 10px;
}

#dzawjmqldw .gt_indent_3 {
  text-indent: 15px;
}

#dzawjmqldw .gt_indent_4 {
  text-indent: 20px;
}

#dzawjmqldw .gt_indent_5 {
  text-indent: 25px;
}

#dzawjmqldw .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#dzawjmqldw div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading header">
<td colspan="4" class="gt_heading gt_title gt_font_normal">Anxiety Scores Before and After Mindfulness Program</td>
</tr>
<tr class="gt_heading even">
<td colspan="4" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border">Wilcoxon signed-rank: p = 0.0010, r = 0.88 (large effect)</td>
</tr>
<tr class="gt_col_headings header">
<th id="Timepoint" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Timepoint</th>
<th id="N" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">N</th>
<th id="Median" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Median</th>
<th id="IQR" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">IQR</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="Timepoint">Before</td>
<td class="gt_row gt_right" headers="N">14</td>
<td class="gt_row gt_right" headers="Median">71.5</td>
<td class="gt_row gt_left" headers="IQR">68.25–74.75</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Timepoint">After</td>
<td class="gt_row gt_right" headers="N">14</td>
<td class="gt_row gt_right" headers="Median">65.5</td>
<td class="gt_row gt_left" headers="IQR">63.25–68</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Timepoint">Change</td>
<td class="gt_row gt_right" headers="N">14</td>
<td class="gt_row gt_right" headers="Median"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span>&nbsp;-6.0</td>
<td class="gt_row gt_left" headers="IQR">-7–-4.25</td>
</tr>
</tbody><tfoot class="gt_footnotes">
<tr class="odd">
<td colspan="4" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> Negative change indicates anxiety reduction</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
<hr>
</section>
<section id="step-8-individual-client-profile-plot" class="level3">
<h3 class="anchored" data-anchor-id="step-8-individual-client-profile-plot">Step 8: Individual Client Profile Plot</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb230"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify clients with largest improvements</span></span>
<span id="cb230-2"><a href="#cb230-2" aria-hidden="true" tabindex="-1"></a>top_improvers <span class="ot">&lt;-</span> anxiety_data <span class="sc">%&gt;%</span></span>
<span id="cb230-3"><a href="#cb230-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(difference) <span class="sc">%&gt;%</span></span>
<span id="cb230-4"><a href="#cb230-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb230-5"><a href="#cb230-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(client_id)</span>
<span id="cb230-6"><a href="#cb230-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb230-7"><a href="#cb230-7" aria-hidden="true" tabindex="-1"></a>anxiety_long <span class="sc">%&gt;%</span></span>
<span id="cb230-8"><a href="#cb230-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">highlight =</span> <span class="fu">ifelse</span>(client_id <span class="sc">%in%</span> top_improvers, <span class="st">"Top 3"</span>, <span class="st">"Other"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb230-9"><a href="#cb230-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> timepoint, <span class="at">y =</span> anxiety, <span class="at">group =</span> client_id)) <span class="sc">+</span></span>
<span id="cb230-10"><a href="#cb230-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> highlight, <span class="at">linewidth =</span> highlight, <span class="at">alpha =</span> highlight)) <span class="sc">+</span></span>
<span id="cb230-11"><a href="#cb230-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> highlight), <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb230-12"><a href="#cb230-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Top 3"</span> <span class="ot">=</span> <span class="st">"darkgreen"</span>, <span class="st">"Other"</span> <span class="ot">=</span> <span class="st">"gray70"</span>)) <span class="sc">+</span></span>
<span id="cb230-13"><a href="#cb230-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linewidth_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Top 3"</span> <span class="ot">=</span> <span class="fl">1.2</span>, <span class="st">"Other"</span> <span class="ot">=</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb230-14"><a href="#cb230-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_alpha_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Top 3"</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">"Other"</span> <span class="ot">=</span> <span class="fl">0.3</span>)) <span class="sc">+</span></span>
<span id="cb230-15"><a href="#cb230-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Client Anxiety Trajectories"</span>,</span>
<span id="cb230-16"><a href="#cb230-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Green lines = top 3 improvers"</span>,</span>
<span id="cb230-17"><a href="#cb230-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Timepoint"</span>,</span>
<span id="cb230-18"><a href="#cb230-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Anxiety Score"</span>) <span class="sc">+</span></span>
<span id="cb230-19"><a href="#cb230-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="part-g-lab-practicals_files/figure-html/lab4-step8-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Individual client anxiety trajectories</figcaption>
</figure>
</div>
</div>
</div>
<hr>
</section>
<section id="discussion-questions-3" class="level3">
<h3 class="anchored" data-anchor-id="discussion-questions-3">❓ Discussion Questions</h3>
<ol type="1">
<li><strong>Why is paired design more powerful than independent groups?</strong>
<ul>
<li>Controls for individual differences</li>
<li>Each person is their own control</li>
<li>Reduces variability due to between-person differences</li>
</ul></li>
<li><strong>What does “V statistic” mean in Wilcoxon signed-rank?</strong>
<ul>
<li>Sum of ranks for positive differences</li>
<li>Large V → most differences are positive</li>
<li>Small V → most differences are negative</li>
</ul></li>
<li><strong>When would you use paired t-test instead?</strong>
<ul>
<li>Large samples (n &gt; 30 pairs)</li>
<li>Differences are normally distributed</li>
<li>No outliers in difference scores</li>
</ul></li>
<li><strong>What if some clients had zero change?</strong>
<ul>
<li>Wilcoxon ignores ties at zero</li>
<li>Reduces sample size for test</li>
<li>Report number of ties</li>
</ul></li>
</ol>
<hr>
</section>
<section id="key-takeaways-3" class="level3">
<h3 class="anchored" data-anchor-id="key-takeaways-3">💡 Key Takeaways</h3>
<p>✅ <strong>Use Wilcoxon signed-rank when:</strong> - Paired/matched data - Non-normal difference scores - Outliers present - Small samples (n &lt; 30 pairs)</p>
<p>✅ <strong>Wilcoxon tests:</strong> - Whether median difference ≠ 0 - Ranks absolute differences, preserving sign - Robust to outliers and skewness</p>
<p>✅ <strong>Report these components:</strong> - Medians before and after - Median difference with IQR - Wilcoxon p-value and V statistic - Effect size (r) - Number improved vs.&nbsp;worsened</p>
<p>✅ <strong>Paired data advantages:</strong> - More statistical power - Smaller sample sizes needed - Controls for individual variability</p>
<hr>
</section>
<section id="homework-exercise-3" class="level3">
<h3 class="anchored" data-anchor-id="homework-exercise-3">🏠 Homework Exercise</h3>
<p>Analyze blood pressure changes after medication for 16 patients:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb231"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a>bp_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb231-2"><a href="#cb231-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">patient =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">16</span>,</span>
<span id="cb231-3"><a href="#cb231-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">baseline =</span> <span class="fu">c</span>(<span class="dv">142</span>, <span class="dv">138</span>, <span class="dv">145</span>, <span class="dv">140</span>, <span class="dv">136</span>, <span class="dv">148</span>, <span class="dv">141</span>, <span class="dv">139</span>, </span>
<span id="cb231-4"><a href="#cb231-4" aria-hidden="true" tabindex="-1"></a>               <span class="dv">143</span>, <span class="dv">137</span>, <span class="dv">146</span>, <span class="dv">144</span>, <span class="dv">140</span>, <span class="dv">142</span>, <span class="dv">139</span>, <span class="dv">141</span>),</span>
<span id="cb231-5"><a href="#cb231-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">followup =</span> <span class="fu">c</span>(<span class="dv">136</span>, <span class="dv">135</span>, <span class="dv">140</span>, <span class="dv">136</span>, <span class="dv">133</span>, <span class="dv">142</span>, <span class="dv">138</span>, <span class="dv">136</span>,</span>
<span id="cb231-6"><a href="#cb231-6" aria-hidden="true" tabindex="-1"></a>               <span class="dv">139</span>, <span class="dv">134</span>, <span class="dv">143</span>, <span class="dv">140</span>, <span class="dv">137</span>, <span class="dv">139</span>, <span class="dv">136</span>, <span class="dv">138</span>)</span>
<span id="cb231-7"><a href="#cb231-7" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Tasks:</strong> 1. Create a paired plot (before-after lines) 2. Calculate and visualize difference scores 3. Run Wilcoxon signed-rank test 4. Calculate effect size 5. Compare with paired t-test results 6. Create a summary table 7. Write a 5-sentence results section including: - Descriptive stats (medians before/after) - Number of patients who improved - Test results and p-value - Effect size interpretation - Clinical conclusion</p>
<p><strong>Expected finding:</strong> Significant blood pressure reduction with large effect size.</p>
<p><strong>Bonus:</strong> What percentage of patients improved? Is this clinically meaningful?</p>
<hr>
</section>
<section id="lab-firth" class="level2">
<h2 class="anchored" data-anchor-id="lab-firth">Lab 5: Firth’s Penalized Logistic Regression</h2>
<p><strong>Learning Objectives:</strong></p>
<ul>
<li>Recognize complete/quasi-complete separation in logistic regression</li>
<li>Apply Firth’s penalized likelihood method to handle separation</li>
<li>Compare standard and penalized logistic regression results</li>
<li>Interpret odds ratios and confidence intervals with small samples</li>
<li>Create publication-ready tables for logistic regression</li>
</ul>
<p><strong>Scenario:</strong> You’re analyzing pilot data (n=18) from a clinical trial where patients received a new treatment (Yes/No) and the outcome is remission (Yes/No). The treatment group has 10 patients (9 remission, 1 no remission), and the control group has 8 patients (2 remission, 6 no remission).</p>
<section id="step-1-set-up-and-load-data" class="level3">
<h3 class="anchored" data-anchor-id="step-1-set-up-and-load-data">Step 1: Set Up and Load Data</h3>
<p>Create the dataset and visualize the contingency table:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb232"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb232-2"><a href="#cb232-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(logistf)  <span class="co"># Firth's logistic regression</span></span>
<span id="cb232-3"><a href="#cb232-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb232-4"><a href="#cb232-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb232-5"><a href="#cb232-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create dataset with separation problem</span></span>
<span id="cb232-6"><a href="#cb232-6" aria-hidden="true" tabindex="-1"></a>clinical_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb232-7"><a href="#cb232-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">patient_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">18</span>,</span>
<span id="cb232-8"><a href="#cb232-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">treatment =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Control"</span>, <span class="st">"Treatment"</span>), <span class="fu">c</span>(<span class="dv">8</span>, <span class="dv">10</span>)),</span>
<span id="cb232-9"><a href="#cb232-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">remission =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,  <span class="co"># Control: 2/8 remission</span></span>
<span id="cb232-10"><a href="#cb232-10" aria-hidden="true" tabindex="-1"></a>                <span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>)  <span class="co"># Treatment: 9/10 remission</span></span>
<span id="cb232-11"><a href="#cb232-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb232-12"><a href="#cb232-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb232-13"><a href="#cb232-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Contingency table</span></span>
<span id="cb232-14"><a href="#cb232-14" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(clinical_data<span class="sc">$</span>treatment, clinical_data<span class="sc">$</span>remission)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>           
            0 1
  Control   6 2
  Treatment 1 9</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb234"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization</span></span>
<span id="cb234-2"><a href="#cb234-2" aria-hidden="true" tabindex="-1"></a>clinical_data <span class="sc">%&gt;%</span></span>
<span id="cb234-3"><a href="#cb234-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(treatment, remission) <span class="sc">%&gt;%</span></span>
<span id="cb234-4"><a href="#cb234-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treatment, <span class="at">y =</span> n, <span class="at">fill =</span> <span class="fu">factor</span>(remission))) <span class="sc">+</span></span>
<span id="cb234-5"><a href="#cb234-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"stack"</span>) <span class="sc">+</span></span>
<span id="cb234-6"><a href="#cb234-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Treatment vs Remission Outcomes"</span>,</span>
<span id="cb234-7"><a href="#cb234-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>, <span class="at">fill =</span> <span class="st">"Remission"</span>) <span class="sc">+</span></span>
<span id="cb234-8"><a href="#cb234-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="part-g-lab-practicals_files/figure-html/lab5-data-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Checkpoint:</strong> You should see near-complete separation (9/10 vs 2/8).</p>
<hr>
</section>
<section id="step-2-attempt-standard-logistic-regression" class="level3">
<h3 class="anchored" data-anchor-id="step-2-attempt-standard-logistic-regression">Step 2: Attempt Standard Logistic Regression</h3>
<p>Try fitting standard logistic regression to see the separation problem:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb235"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Attempt standard logistic regression</span></span>
<span id="cb235-2"><a href="#cb235-2" aria-hidden="true" tabindex="-1"></a>standard_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(remission <span class="sc">~</span> treatment, </span>
<span id="cb235-3"><a href="#cb235-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> clinical_data,</span>
<span id="cb235-4"><a href="#cb235-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>))</span>
<span id="cb235-5"><a href="#cb235-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb235-6"><a href="#cb235-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for warning signs</span></span>
<span id="cb235-7"><a href="#cb235-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(standard_model)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = remission ~ treatment, family = binomial(link = "logit"), 
    data = clinical_data)

Coefficients:
                   Estimate Std. Error z value Pr(&gt;|z|)  
(Intercept)          -1.099      0.816   -1.35    0.178  
treatmentTreatment    3.296      1.333    2.47    0.013 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 24.057  on 17  degrees of freedom
Residual deviance: 15.499  on 16  degrees of freedom
AIC: 19.5

Number of Fisher Scoring iterations: 4</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb237"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract coefficients</span></span>
<span id="cb237-2"><a href="#cb237-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(standard_model, <span class="at">exponentiate =</span> <span class="cn">TRUE</span>, <span class="at">conf.int =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 7
  term               estimate std.error statistic p.value conf.low conf.high
  &lt;chr&gt;                 &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept)           0.333     0.816     -1.35  0.178    0.0488      1.45
2 treatmentTreatment   27.0       1.33       2.47  0.0134   2.71      709.  </code></pre>
</div>
</div>
<p><strong>Checkpoint:</strong> Notice extremely large coefficient, very wide confidence interval, or convergence warnings indicating separation.</p>
<p><strong>Discussion:</strong> What happens to the odds ratio estimate? Why are the standard errors so large?</p>
<hr>
</section>
<section id="step-3-apply-firths-penalized-logistic-regression" class="level3">
<h3 class="anchored" data-anchor-id="step-3-apply-firths-penalized-logistic-regression">Step 3: Apply Firth’s Penalized Logistic Regression</h3>
<p>Use Firth’s method to obtain reliable estimates:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb239"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb239-1"><a href="#cb239-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Firth's penalized logistic regression</span></span>
<span id="cb239-2"><a href="#cb239-2" aria-hidden="true" tabindex="-1"></a>firth_model <span class="ot">&lt;-</span> <span class="fu">logistf</span>(remission <span class="sc">~</span> treatment, </span>
<span id="cb239-3"><a href="#cb239-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">data =</span> clinical_data)</span>
<span id="cb239-4"><a href="#cb239-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb239-5"><a href="#cb239-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary</span></span>
<span id="cb239-6"><a href="#cb239-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(firth_model)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>logistf(formula = remission ~ treatment, data = clinical_data)

Model fitted by Penalized ML
Coefficients:
                      coef se(coef) lower 0.95 upper 0.95 Chisq        p method
(Intercept)        -0.9555   0.7442    -2.6494     0.4073 1.841 0.174777      2
treatmentTreatment  2.8013   1.1514     0.7496     5.4382 7.523 0.006093      2

Method: 1-Wald, 2-Profile penalized log-likelihood, 3-None

Likelihood ratio test=7.523 on 1 df, p=0.006093, n=18
Wald test = 6.062 on 1 df, p = 0.01381</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb241"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb241-1"><a href="#cb241-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract coefficients (manual conversion to OR)</span></span>
<span id="cb241-2"><a href="#cb241-2" aria-hidden="true" tabindex="-1"></a>firth_coef <span class="ot">&lt;-</span> <span class="fu">coef</span>(firth_model)[<span class="dv">2</span>]</span>
<span id="cb241-3"><a href="#cb241-3" aria-hidden="true" tabindex="-1"></a>firth_or <span class="ot">&lt;-</span> <span class="fu">exp</span>(firth_coef)</span>
<span id="cb241-4"><a href="#cb241-4" aria-hidden="true" tabindex="-1"></a>firth_ci <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">confint</span>(firth_model)[<span class="dv">2</span>, ])</span>
<span id="cb241-5"><a href="#cb241-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb241-6"><a href="#cb241-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Firth's Odds Ratio:"</span>, <span class="fu">round</span>(firth_or, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Firth's Odds Ratio: 16.47 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb243"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb243-1"><a href="#cb243-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"95% CI:"</span>, <span class="fu">round</span>(firth_ci, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>95% CI: 2.12 230 </code></pre>
</div>
</div>
<p><strong>Checkpoint:</strong> Firth’s OR should be more reasonable (e.g., 10-30) with narrower CI compared to standard method.</p>
<hr>
</section>
<section id="step-4-compare-methods-side-by-side" class="level3">
<h3 class="anchored" data-anchor-id="step-4-compare-methods-side-by-side">Step 4: Compare Methods Side-by-Side</h3>
<p>Create a comparison table:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb245"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb245-1"><a href="#cb245-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Standard GLM results</span></span>
<span id="cb245-2"><a href="#cb245-2" aria-hidden="true" tabindex="-1"></a>standard_or <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">coef</span>(standard_model)[<span class="dv">2</span>])</span>
<span id="cb245-3"><a href="#cb245-3" aria-hidden="true" tabindex="-1"></a>standard_ci <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">confint.default</span>(standard_model)[<span class="dv">2</span>, ])</span>
<span id="cb245-4"><a href="#cb245-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb245-5"><a href="#cb245-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Comparison tibble</span></span>
<span id="cb245-6"><a href="#cb245-6" aria-hidden="true" tabindex="-1"></a>comparison <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb245-7"><a href="#cb245-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Method =</span> <span class="fu">c</span>(<span class="st">"Standard GLM"</span>, <span class="st">"Firth's Penalized"</span>),</span>
<span id="cb245-8"><a href="#cb245-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">OR =</span> <span class="fu">c</span>(standard_or, firth_or),</span>
<span id="cb245-9"><a href="#cb245-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">CI_Lower =</span> <span class="fu">c</span>(standard_ci[<span class="dv">1</span>], firth_ci[<span class="dv">1</span>]),</span>
<span id="cb245-10"><a href="#cb245-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">CI_Upper =</span> <span class="fu">c</span>(standard_ci[<span class="dv">2</span>], firth_ci[<span class="dv">2</span>]),</span>
<span id="cb245-11"><a href="#cb245-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">CI_Width =</span> CI_Upper <span class="sc">-</span> CI_Lower</span>
<span id="cb245-12"><a href="#cb245-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb245-13"><a href="#cb245-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb245-14"><a href="#cb245-14" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(comparison)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 5
  Method               OR CI_Lower CI_Upper CI_Width
  &lt;chr&gt;             &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
1 Standard GLM       27.0     1.98     368.     366.
2 Firth's Penalized  16.5     2.12     230.     228.</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb247"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb247-1"><a href="#cb247-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization</span></span>
<span id="cb247-2"><a href="#cb247-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(comparison, <span class="fu">aes</span>(<span class="at">x =</span> Method, <span class="at">y =</span> OR)) <span class="sc">+</span></span>
<span id="cb247-3"><a href="#cb247-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb247-4"><a href="#cb247-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> CI_Lower, <span class="at">ymax =</span> CI_Upper), </span>
<span id="cb247-5"><a href="#cb247-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb247-6"><a href="#cb247-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb247-7"><a href="#cb247-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Standard vs Firth's Logistic Regression"</span>,</span>
<span id="cb247-8"><a href="#cb247-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Odds Ratio (log scale)"</span>) <span class="sc">+</span></span>
<span id="cb247-9"><a href="#cb247-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="part-g-lab-practicals_files/figure-html/lab5-comparison-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Checkpoint:</strong> Firth’s method produces more conservative (lower) OR and much narrower CI.</p>
<hr>
</section>
<section id="step-5-assess-model-fit" class="level3">
<h3 class="anchored" data-anchor-id="step-5-assess-model-fit">Step 5: Assess Model Fit</h3>
<p>Check diagnostics for the Firth model:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb248"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb248-1"><a href="#cb248-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Profile likelihood ratio test for treatment effect</span></span>
<span id="cb248-2"><a href="#cb248-2" aria-hidden="true" tabindex="-1"></a>firth_model<span class="sc">$</span>prob  <span class="co"># Profile penalized LR p-value</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>       (Intercept) treatmentTreatment 
          0.174777           0.006093 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb250"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb250-1"><a href="#cb250-1" aria-hidden="true" tabindex="-1"></a><span class="co"># AIC comparison (lower is better)</span></span>
<span id="cb250-2"><a href="#cb250-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Standard GLM AIC:"</span>, <span class="fu">AIC</span>(standard_model), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Standard GLM AIC: 19.5 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb252"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb252-1"><a href="#cb252-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Firth's AIC:"</span>, firth_model<span class="sc">$</span>aic, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Firth's AIC: </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb254"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Raw data proportions</span></span>
<span id="cb254-2"><a href="#cb254-2" aria-hidden="true" tabindex="-1"></a>clinical_data <span class="sc">%&gt;%</span></span>
<span id="cb254-3"><a href="#cb254-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(treatment) <span class="sc">%&gt;%</span></span>
<span id="cb254-4"><a href="#cb254-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb254-5"><a href="#cb254-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb254-6"><a href="#cb254-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">remission =</span> <span class="fu">sum</span>(remission),</span>
<span id="cb254-7"><a href="#cb254-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">proportion =</span> <span class="fu">mean</span>(remission)</span>
<span id="cb254-8"><a href="#cb254-8" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  treatment     n remission proportion
  &lt;chr&gt;     &lt;int&gt;     &lt;dbl&gt;      &lt;dbl&gt;
1 Control       8         2          2
2 Treatment    10         9          9</code></pre>
</div>
</div>
<p><strong>Checkpoint:</strong> Firth’s p-value should indicate significant treatment effect, with better model fit than standard GLM.</p>
<hr>
</section>
<section id="step-6-predicted-probabilities" class="level3">
<h3 class="anchored" data-anchor-id="step-6-predicted-probabilities">Step 6: Predicted Probabilities</h3>
<p>Calculate predicted remission probabilities:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb256"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb256-1"><a href="#cb256-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create prediction data</span></span>
<span id="cb256-2"><a href="#cb256-2" aria-hidden="true" tabindex="-1"></a>pred_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">treatment =</span> <span class="fu">c</span>(<span class="st">"Control"</span>, <span class="st">"Treatment"</span>))</span>
<span id="cb256-3"><a href="#cb256-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb256-4"><a href="#cb256-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Firth's predicted probabilities</span></span>
<span id="cb256-5"><a href="#cb256-5" aria-hidden="true" tabindex="-1"></a>pred_probs <span class="ot">&lt;-</span> <span class="fu">predict</span>(firth_model, </span>
<span id="cb256-6"><a href="#cb256-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">newdata =</span> pred_data,</span>
<span id="cb256-7"><a href="#cb256-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb256-8"><a href="#cb256-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb256-9"><a href="#cb256-9" aria-hidden="true" tabindex="-1"></a>pred_results <span class="ot">&lt;-</span> pred_data <span class="sc">%&gt;%</span></span>
<span id="cb256-10"><a href="#cb256-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">predicted_prob =</span> pred_probs)</span>
<span id="cb256-11"><a href="#cb256-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb256-12"><a href="#cb256-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pred_results)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  treatment predicted_prob
  &lt;chr&gt;              &lt;dbl&gt;
1 Control            0.278
2 Treatment          0.864</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb258"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb258-1"><a href="#cb258-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare with observed proportions</span></span>
<span id="cb258-2"><a href="#cb258-2" aria-hidden="true" tabindex="-1"></a>clinical_data <span class="sc">%&gt;%</span></span>
<span id="cb258-3"><a href="#cb258-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(treatment) <span class="sc">%&gt;%</span></span>
<span id="cb258-4"><a href="#cb258-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">observed_prob =</span> <span class="fu">mean</span>(remission)) <span class="sc">%&gt;%</span></span>
<span id="cb258-5"><a href="#cb258-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(pred_results, <span class="at">by =</span> <span class="st">"treatment"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  treatment observed_prob predicted_prob
  &lt;chr&gt;             &lt;dbl&gt;          &lt;dbl&gt;
1 Control            0.25          0.278
2 Treatment          0.9           0.864</code></pre>
</div>
</div>
<p><strong>Checkpoint:</strong> Predicted probabilities should be close to observed proportions (0.25 control, 0.90 treatment).</p>
<hr>
</section>
<section id="step-7-create-publication-table-2" class="level3">
<h3 class="anchored" data-anchor-id="step-7-create-publication-table-2">Step 7: Create Publication Table</h3>
<p>Format results for publication:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb260"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb260-1"><a href="#cb260-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb260-2"><a href="#cb260-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-3"><a href="#cb260-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create publication-ready table</span></span>
<span id="cb260-4"><a href="#cb260-4" aria-hidden="true" tabindex="-1"></a>pub_table <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb260-5"><a href="#cb260-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Predictor =</span> <span class="st">"Treatment (vs Control)"</span>,</span>
<span id="cb260-6"><a href="#cb260-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Log OR</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sprintf</span>(<span class="st">"%.2f"</span>, firth_coef),</span>
<span id="cb260-7"><a href="#cb260-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">SE =</span> <span class="fu">sprintf</span>(<span class="st">"%.2f"</span>, <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcov</span>(firth_model)))[<span class="dv">2</span>]),</span>
<span id="cb260-8"><a href="#cb260-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">OR</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sprintf</span>(<span class="st">"%.2f"</span>, firth_or),</span>
<span id="cb260-9"><a href="#cb260-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">95% CI</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sprintf</span>(<span class="st">"%.2f-%.2f"</span>, firth_ci[<span class="dv">1</span>], firth_ci[<span class="dv">2</span>]),</span>
<span id="cb260-10"><a href="#cb260-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">p-value</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sprintf</span>(<span class="st">"%.3f"</span>, firth_model<span class="sc">$</span>prob[<span class="dv">2</span>])</span>
<span id="cb260-11"><a href="#cb260-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb260-12"><a href="#cb260-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-13"><a href="#cb260-13" aria-hidden="true" tabindex="-1"></a>pub_table <span class="sc">%&gt;%</span></span>
<span id="cb260-14"><a href="#cb260-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb260-15"><a href="#cb260-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb260-16"><a href="#cb260-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Firth's Penalized Logistic Regression"</span>,</span>
<span id="cb260-17"><a href="#cb260-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Predicting Clinical Remission (n=18)"</span></span>
<span id="cb260-18"><a href="#cb260-18" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb260-19"><a href="#cb260-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_footnote</span>(</span>
<span id="cb260-20"><a href="#cb260-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">footnote =</span> <span class="st">"Firth's method used due to quasi-complete separation"</span>,</span>
<span id="cb260-21"><a href="#cb260-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_column_labels</span>(<span class="at">columns =</span> <span class="st">"OR"</span>)</span>
<span id="cb260-22"><a href="#cb260-22" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="uwkneayvxc" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#uwkneayvxc table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#uwkneayvxc thead, #uwkneayvxc tbody, #uwkneayvxc tfoot, #uwkneayvxc tr, #uwkneayvxc td, #uwkneayvxc th {
  border-style: none;
}

#uwkneayvxc p {
  margin: 0;
  padding: 0;
}

#uwkneayvxc .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#uwkneayvxc .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#uwkneayvxc .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#uwkneayvxc .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#uwkneayvxc .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#uwkneayvxc .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#uwkneayvxc .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#uwkneayvxc .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#uwkneayvxc .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#uwkneayvxc .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#uwkneayvxc .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#uwkneayvxc .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#uwkneayvxc .gt_spanner_row {
  border-bottom-style: hidden;
}

#uwkneayvxc .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#uwkneayvxc .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#uwkneayvxc .gt_from_md > :first-child {
  margin-top: 0;
}

#uwkneayvxc .gt_from_md > :last-child {
  margin-bottom: 0;
}

#uwkneayvxc .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#uwkneayvxc .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#uwkneayvxc .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#uwkneayvxc .gt_row_group_first td {
  border-top-width: 2px;
}

#uwkneayvxc .gt_row_group_first th {
  border-top-width: 2px;
}

#uwkneayvxc .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#uwkneayvxc .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#uwkneayvxc .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#uwkneayvxc .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#uwkneayvxc .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#uwkneayvxc .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#uwkneayvxc .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#uwkneayvxc .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#uwkneayvxc .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#uwkneayvxc .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#uwkneayvxc .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#uwkneayvxc .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#uwkneayvxc .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#uwkneayvxc .gt_left {
  text-align: left;
}

#uwkneayvxc .gt_center {
  text-align: center;
}

#uwkneayvxc .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#uwkneayvxc .gt_font_normal {
  font-weight: normal;
}

#uwkneayvxc .gt_font_bold {
  font-weight: bold;
}

#uwkneayvxc .gt_font_italic {
  font-style: italic;
}

#uwkneayvxc .gt_super {
  font-size: 65%;
}

#uwkneayvxc .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#uwkneayvxc .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#uwkneayvxc .gt_indent_1 {
  text-indent: 5px;
}

#uwkneayvxc .gt_indent_2 {
  text-indent: 10px;
}

#uwkneayvxc .gt_indent_3 {
  text-indent: 15px;
}

#uwkneayvxc .gt_indent_4 {
  text-indent: 20px;
}

#uwkneayvxc .gt_indent_5 {
  text-indent: 25px;
}

#uwkneayvxc .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#uwkneayvxc div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading header">
<td colspan="6" class="gt_heading gt_title gt_font_normal">Firth's Penalized Logistic Regression</td>
</tr>
<tr class="gt_heading even">
<td colspan="6" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border">Predicting Clinical Remission (n=18)</td>
</tr>
<tr class="gt_col_headings header">
<th id="Predictor" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Predictor</th>
<th id="Log-OR" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Log OR</th>
<th id="SE" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">SE</th>
<th id="OR" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">OR<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="a95%-CI" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">95% CI</th>
<th id="p-value" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">p-value</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="Predictor">Treatment (vs Control)</td>
<td class="gt_row gt_right" headers="Log OR">2.80</td>
<td class="gt_row gt_right" headers="SE">1.15</td>
<td class="gt_row gt_right" headers="OR">16.47</td>
<td class="gt_row gt_right" headers="95% CI">2.12-230.04</td>
<td class="gt_row gt_right" headers="p-value">0.006</td>
</tr>
</tbody><tfoot class="gt_footnotes">
<tr class="odd">
<td colspan="6" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> Firth's method used due to quasi-complete separation</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
<p><strong>Checkpoint:</strong> Professional table with OR, CI, and p-value formatted for journal submission.</p>
<hr>
</section>
<section id="step-8-interpret-and-report" class="level3">
<h3 class="anchored" data-anchor-id="step-8-interpret-and-report">Step 8: Interpret and Report</h3>
<p>Summarize the clinical findings:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb261"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb261-1"><a href="#cb261-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Effect size interpretation</span></span>
<span id="cb261-2"><a href="#cb261-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Interpretation:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Interpretation:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb263"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb263-1"><a href="#cb263-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Treatment increases remission odds by"</span>, </span>
<span id="cb263-2"><a href="#cb263-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(firth_or, <span class="dv">1</span>), <span class="st">"times</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>- Treatment increases remission odds by 16.5 times</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb265"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb265-1"><a href="#cb265-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- 95% CI:"</span>, <span class="fu">round</span>(firth_ci, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>- 95% CI: 2.12 230 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb267"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb267-1"><a href="#cb267-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Treatment group: 90% remission</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>- Treatment group: 90% remission</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb269"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb269-1"><a href="#cb269-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Control group: 25% remission</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>- Control group: 25% remission</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb271"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb271-1"><a href="#cb271-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Risk difference: 65 percentage points</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>- Risk difference: 65 percentage points</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb273"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb273-1"><a href="#cb273-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample statement</span></span>
<span id="cb273-2"><a href="#cb273-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Sample Results Statement:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Sample Results Statement:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb275"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb275-1"><a href="#cb275-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Due to quasi-complete separation in the contingency table,</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Due to quasi-complete separation in the contingency table,</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb277"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb277-1"><a href="#cb277-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"we used Firth's penalized logistic regression. Treatment</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>we used Firth's penalized logistic regression. Treatment</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb279"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb279-1"><a href="#cb279-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"significantly increased remission odds (OR ="</span>, <span class="fu">round</span>(firth_or, <span class="dv">2</span>), </span>
<span id="cb279-2"><a href="#cb279-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">", 95% CI:"</span>, <span class="fu">paste</span>(<span class="fu">round</span>(firth_ci, <span class="dv">2</span>), <span class="at">collapse =</span> <span class="st">"-"</span>), </span>
<span id="cb279-3"><a href="#cb279-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">", p ="</span>, <span class="fu">round</span>(firth_model<span class="sc">$</span>prob[<span class="dv">2</span>], <span class="dv">3</span>), <span class="st">").</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>significantly increased remission odds (OR = 16.47 , 95% CI: 2.12-230.04 , p = 0.006 ).</code></pre>
</div>
</div>
<p><strong>Checkpoint:</strong> Clear interpretation acknowledging the separation problem and reporting penalized estimates.</p>
<hr>
</section>
<section id="discussion-questions-4" class="level3">
<h3 class="anchored" data-anchor-id="discussion-questions-4">Discussion Questions</h3>
<ol type="1">
<li><p><strong>Separation Detection:</strong> How can you identify complete or quasi-complete separation in your data before modeling?</p>
<p><em>Answer: Check contingency tables for cells with 0 counts, examine coefficient estimates for very large values (&gt;10 in absolute value), look for extremely wide confidence intervals, and watch for convergence warnings.</em></p></li>
<li><p><strong>Why Firth’s Method:</strong> How does Firth’s penalized likelihood reduce bias in small samples?</p>
<p><em>Answer: Firth’s method adds a penalty term that shrinks estimates toward zero, reducing the finite-sample bias and preventing infinite estimates that occur with separation.</em></p></li>
<li><p><strong>Interpretation:</strong> Is the Firth’s OR of 20 (example) more reliable than the standard OR of 500?</p>
<p><em>Answer: Yes, Firth’s OR is more realistic and stable. The standard OR is inflated due to separation and has a very wide, unreliable CI. Firth’s estimate is appropriately conservative.</em></p></li>
<li><p><strong>Clinical vs Statistical:</strong> The p-value is significant, but should we conclude the treatment is effective?</p>
<p><em>Answer: The pilot data are promising (90% vs 25% remission), but n=18 is too small for definitive conclusions. A larger confirmatory trial is needed, though Firth’s method provides the best available estimate from these data.</em></p></li>
<li><p><strong>Alternative Approaches:</strong> When might you use exact logistic regression instead of Firth’s method?</p>
<p><em>Answer: Exact logistic regression (e.g., <code>elrm</code> package) is preferred when sample size is very small (n&lt;20 total) and you want exact p-values. Firth’s method is faster and preferred for moderately small samples (n=20-50).</em></p></li>
</ol>
<hr>
</section>
<section id="key-takeaways-4" class="level3">
<h3 class="anchored" data-anchor-id="key-takeaways-4">Key Takeaways</h3>
<p>✓ <strong>Separation is common in small-sample logistic regression</strong> with unbalanced outcomes<br>
✓ <strong>Standard logistic regression fails</strong> with separation (infinite estimates, huge CIs)<br>
✓ <strong>Firth’s penalized method</strong> provides finite, stable estimates by adding penalty term<br>
✓ <strong>Always check for separation</strong> before fitting logistic models in small samples<br>
✓ <strong>Report the method used</strong> and acknowledge limitations in pilot data<br>
✓ <strong>Firth’s estimates are more realistic</strong> but still require cautious interpretation</p>
<hr>
</section>
<section id="homework-exercise-4" class="level3">
<h3 class="anchored" data-anchor-id="homework-exercise-4">Homework Exercise</h3>
<p><strong>Dataset:</strong> A pilot study (n=22) examined whether a new surgical technique (Technique = “New” vs “Standard”) predicts successful outcome (Success = 1 for success, 0 for failure).</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb281"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb281-1"><a href="#cb281-1" aria-hidden="true" tabindex="-1"></a>surgery_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb281-2"><a href="#cb281-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">patient_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">22</span>,</span>
<span id="cb281-3"><a href="#cb281-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">technique =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Standard"</span>, <span class="st">"New"</span>), <span class="fu">c</span>(<span class="dv">11</span>, <span class="dv">11</span>)),</span>
<span id="cb281-4"><a href="#cb281-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">success =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,  <span class="co"># Standard: 6/11 success</span></span>
<span id="cb281-5"><a href="#cb281-5" aria-hidden="true" tabindex="-1"></a>              <span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>)  <span class="co"># New: 10/11 success</span></span>
<span id="cb281-6"><a href="#cb281-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p><strong>Your Tasks:</strong></p>
<ol type="1">
<li>Create a contingency table and visualize the technique×success relationship</li>
<li>Attempt standard logistic regression and note any separation issues</li>
<li>Fit Firth’s penalized logistic regression</li>
<li>Create a comparison table showing standard vs Firth’s OR and 95% CI</li>
<li>Calculate predicted success probabilities for each technique</li>
<li>Create a publication-ready results table</li>
<li>Write a 2-3 sentence results statement reporting Firth’s estimates</li>
</ol>
<p><strong>Expected Results:</strong></p>
<ul>
<li>Quasi-complete separation (10/11 vs 6/11)</li>
<li>Standard glm produces inflated OR (possibly &gt;50) with very wide CI</li>
<li>Firth’s OR should be approximately 5-10 with narrower CI</li>
<li>Predicted probabilities: ~55% (Standard), ~90% (New)</li>
<li>Significant p-value (&lt;0.05) from profile likelihood ratio test</li>
</ul>
<p><strong>Hint:</strong> Check <code>firth_model$prob</code> for p-values, and use <code>exp(coef())</code> and <code>exp(confint())</code> to convert log-odds to odds ratios.</p>
<p><strong>Bonus:</strong> What is the risk difference (percentage point difference in success rates)? How does this compare to the OR interpretation?</p>
<hr>
</section>
</section>
<section id="lab-bayesian" class="level2">
<h2 class="anchored" data-anchor-id="lab-bayesian">Lab 6: Bayesian Regression with Small Samples</h2>
<p><strong>Learning Objectives:</strong></p>
<ul>
<li>Specify weakly informative priors for Bayesian regression</li>
<li>Fit Bayesian models using <code>brms</code> package</li>
<li>Interpret posterior distributions and credible intervals</li>
<li>Assess MCMC convergence diagnostics (R-hat, effective sample size)</li>
<li>Compare Bayesian and frequentist approaches for small samples</li>
</ul>
<p><strong>Scenario:</strong> You have n=20 participants in a pilot study examining the relationship between study hours (predictor) and exam score (outcome). You’ll use Bayesian regression to estimate this relationship with appropriate uncertainty quantification.</p>
<section id="step-1-set-up-and-load-data-1" class="level3">
<h3 class="anchored" data-anchor-id="step-1-set-up-and-load-data-1">Step 1: Set Up and Load Data</h3>
<p>Create the dataset and visualize:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb282"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb282-1"><a href="#cb282-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb282-2"><a href="#cb282-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(brms)</span>
<span id="cb282-3"><a href="#cb282-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bayesplot)</span>
<span id="cb282-4"><a href="#cb282-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidybayes)</span>
<span id="cb282-5"><a href="#cb282-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb282-6"><a href="#cb282-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Set seed for reproducibility</span></span>
<span id="cb282-7"><a href="#cb282-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb282-8"><a href="#cb282-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb282-9"><a href="#cb282-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Small sample data</span></span>
<span id="cb282-10"><a href="#cb282-10" aria-hidden="true" tabindex="-1"></a>study_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb282-11"><a href="#cb282-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">student_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>,</span>
<span id="cb282-12"><a href="#cb282-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">study_hours =</span> <span class="fu">round</span>(<span class="fu">runif</span>(<span class="dv">20</span>, <span class="dv">5</span>, <span class="dv">25</span>), <span class="dv">1</span>),</span>
<span id="cb282-13"><a href="#cb282-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">exam_score =</span> <span class="fu">round</span>(<span class="dv">50</span> <span class="sc">+</span> <span class="fl">1.5</span> <span class="sc">*</span> study_hours <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="dv">0</span>, <span class="dv">8</span>), <span class="dv">1</span>)</span>
<span id="cb282-14"><a href="#cb282-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb282-15"><a href="#cb282-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb282-16"><a href="#cb282-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Descriptive statistics</span></span>
<span id="cb282-17"><a href="#cb282-17" aria-hidden="true" tabindex="-1"></a>study_data <span class="sc">%&gt;%</span></span>
<span id="cb282-18"><a href="#cb282-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb282-19"><a href="#cb282-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb282-20"><a href="#cb282-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_hours =</span> <span class="fu">mean</span>(study_hours),</span>
<span id="cb282-21"><a href="#cb282-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd_hours =</span> <span class="fu">sd</span>(study_hours),</span>
<span id="cb282-22"><a href="#cb282-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_score =</span> <span class="fu">mean</span>(exam_score),</span>
<span id="cb282-23"><a href="#cb282-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd_score =</span> <span class="fu">sd</span>(exam_score)</span>
<span id="cb282-24"><a href="#cb282-24" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 5
      n mean_hours sd_hours mean_score sd_score
  &lt;int&gt;      &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;    &lt;dbl&gt;
1    20       15.7     5.17       74.7     11.7</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb284"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb284-1"><a href="#cb284-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter plot</span></span>
<span id="cb284-2"><a href="#cb284-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(study_data, <span class="fu">aes</span>(<span class="at">x =</span> study_hours, <span class="at">y =</span> exam_score)) <span class="sc">+</span></span>
<span id="cb284-3"><a href="#cb284-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb284-4"><a href="#cb284-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb284-5"><a href="#cb284-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Study Hours vs Exam Score (n=20)"</span>,</span>
<span id="cb284-6"><a href="#cb284-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Study Hours"</span>, <span class="at">y =</span> <span class="st">"Exam Score"</span>) <span class="sc">+</span></span>
<span id="cb284-7"><a href="#cb284-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="part-g-lab-practicals_files/figure-html/lab6-data-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Checkpoint:</strong> You should see n=20 observations with positive relationship between hours and score.</p>
<hr>
</section>
<section id="step-2-specify-priors" class="level3">
<h3 class="anchored" data-anchor-id="step-2-specify-priors">Step 2: Specify Priors</h3>
<p>Define weakly informative priors appropriate for the scale of your data:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb285"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb285-1"><a href="#cb285-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine data scale to inform priors</span></span>
<span id="cb285-2"><a href="#cb285-2" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(study_data<span class="sc">$</span>exam_score)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  57.7 100.0</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb287"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb287-1"><a href="#cb287-1" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(study_data<span class="sc">$</span>study_hours)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  5.5 24.0</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb289"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb289-1"><a href="#cb289-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define priors</span></span>
<span id="cb289-2"><a href="#cb289-2" aria-hidden="true" tabindex="-1"></a>priors <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb289-3"><a href="#cb289-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Intercept: exam scores range 50-100, centered around 70</span></span>
<span id="cb289-4"><a href="#cb289-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">70</span>, <span class="dv">20</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb289-5"><a href="#cb289-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb289-6"><a href="#cb289-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Slope: expect positive but uncertain, allow ±10 points per hour</span></span>
<span id="cb289-7"><a href="#cb289-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">5</span>), <span class="at">class =</span> b),</span>
<span id="cb289-8"><a href="#cb289-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb289-9"><a href="#cb289-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Residual SD: exam scores vary, allow reasonable range</span></span>
<span id="cb289-10"><a href="#cb289-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">student_t</span>(<span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">10</span>), <span class="at">class =</span> sigma)</span>
<span id="cb289-11"><a href="#cb289-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb289-12"><a href="#cb289-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb289-13"><a href="#cb289-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Prior predictive check (simulate data from priors)</span></span>
<span id="cb289-14"><a href="#cb289-14" aria-hidden="true" tabindex="-1"></a>prior_model <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb289-15"><a href="#cb289-15" aria-hidden="true" tabindex="-1"></a>  exam_score <span class="sc">~</span> study_hours,</span>
<span id="cb289-16"><a href="#cb289-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> study_data,</span>
<span id="cb289-17"><a href="#cb289-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior =</span> priors,</span>
<span id="cb289-18"><a href="#cb289-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">gaussian</span>(),</span>
<span id="cb289-19"><a href="#cb289-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">sample_prior =</span> <span class="st">"only"</span>,  <span class="co"># Only sample from priors</span></span>
<span id="cb289-20"><a href="#cb289-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">2</span>,</span>
<span id="cb289-21"><a href="#cb289-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter =</span> <span class="dv">2000</span>,</span>
<span id="cb289-22"><a href="#cb289-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">refresh =</span> <span class="dv">0</span>  <span class="co"># Suppress iteration messages</span></span>
<span id="cb289-23"><a href="#cb289-23" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb289-24"><a href="#cb289-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb289-25"><a href="#cb289-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize prior predictions</span></span>
<span id="cb289-26"><a href="#cb289-26" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(prior_model, <span class="at">ndraws =</span> <span class="dv">50</span>) <span class="sc">+</span></span>
<span id="cb289-27"><a href="#cb289-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Prior Predictive Check"</span>,</span>
<span id="cb289-28"><a href="#cb289-28" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Do priors allow reasonable exam scores?"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="part-g-lab-practicals_files/figure-html/lab6-priors-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Checkpoint:</strong> Prior predictions should span 0-100 range but not produce absurd values (e.g., negative scores or scores &gt;150).</p>
<p><strong>Discussion:</strong> Are your priors too informative or too vague? Adjust if prior predictions are unrealistic.</p>
<hr>
</section>
<section id="step-3-fit-bayesian-model" class="level3">
<h3 class="anchored" data-anchor-id="step-3-fit-bayesian-model">Step 3: Fit Bayesian Model</h3>
<p>Fit the model with MCMC sampling:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb290"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb290-1"><a href="#cb290-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit Bayesian model</span></span>
<span id="cb290-2"><a href="#cb290-2" aria-hidden="true" tabindex="-1"></a>bayes_model <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb290-3"><a href="#cb290-3" aria-hidden="true" tabindex="-1"></a>  exam_score <span class="sc">~</span> study_hours,</span>
<span id="cb290-4"><a href="#cb290-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> study_data,</span>
<span id="cb290-5"><a href="#cb290-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior =</span> priors,</span>
<span id="cb290-6"><a href="#cb290-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">gaussian</span>(),</span>
<span id="cb290-7"><a href="#cb290-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>,           <span class="co"># Run 4 chains</span></span>
<span id="cb290-8"><a href="#cb290-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter =</span> <span class="dv">4000</span>,          <span class="co"># 4000 iterations per chain</span></span>
<span id="cb290-9"><a href="#cb290-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">warmup =</span> <span class="dv">2000</span>,        <span class="co"># 2000 warmup (burn-in)</span></span>
<span id="cb290-10"><a href="#cb290-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">2025</span>,</span>
<span id="cb290-11"><a href="#cb290-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">refresh =</span> <span class="dv">0</span></span>
<span id="cb290-12"><a href="#cb290-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb290-13"><a href="#cb290-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb290-14"><a href="#cb290-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary</span></span>
<span id="cb290-15"><a href="#cb290-15" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bayes_model)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity 
Formula: exam_score ~ study_hours 
   Data: study_data (Number of observations: 20) 
  Draws: 4 chains, each with iter = 4000; warmup = 2000; thin = 1;
         total post-warmup draws = 8000

Regression Coefficients:
            Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept      52.66      7.26    38.41    66.96 1.00     7497     5277
study_hours     1.39      0.44     0.51     2.24 1.00     7695     5135

Further Distributional Parameters:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     9.77      1.67     7.17    13.59 1.00     6733     6053

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
<p><strong>Checkpoint:</strong> Model should converge (Rhat ≈ 1.00, ESS &gt; 1000). Posterior mean for slope should be positive.</p>
<hr>
</section>
<section id="step-4-check-mcmc-diagnostics" class="level3">
<h3 class="anchored" data-anchor-id="step-4-check-mcmc-diagnostics">Step 4: Check MCMC Diagnostics</h3>
<p>Assess convergence and mixing:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb292"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb292-1"><a href="#cb292-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check convergence summary from brms</span></span>
<span id="cb292-2"><a href="#cb292-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bayes_model)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity 
Formula: exam_score ~ study_hours 
   Data: study_data (Number of observations: 20) 
  Draws: 4 chains, each with iter = 4000; warmup = 2000; thin = 1;
         total post-warmup draws = 8000

Regression Coefficients:
            Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept      52.66      7.26    38.41    66.96 1.00     7497     5277
study_hours     1.39      0.44     0.51     2.24 1.00     7695     5135

Further Distributional Parameters:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     9.77      1.67     7.17    13.59 1.00     6733     6053

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb294"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb294-1"><a href="#cb294-1" aria-hidden="true" tabindex="-1"></a><span class="co"># R-hat values (should be &lt; 1.01) - extract from summary</span></span>
<span id="cb294-2"><a href="#cb294-2" aria-hidden="true" tabindex="-1"></a>rhat_values <span class="ot">&lt;-</span> brms<span class="sc">::</span><span class="fu">rhat</span>(bayes_model)</span>
<span id="cb294-3"><a href="#cb294-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(rhat_values)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  b_Intercept b_study_hours         sigma     Intercept        lprior 
       1.0002        0.9997        1.0013        1.0004        1.0013 
         lp__ 
       1.0010 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb296"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb296-1"><a href="#cb296-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Effective sample size - extract from summary</span></span>
<span id="cb296-2"><a href="#cb296-2" aria-hidden="true" tabindex="-1"></a>ess_values <span class="ot">&lt;-</span> brms<span class="sc">::</span><span class="fu">neff_ratio</span>(bayes_model)</span>
<span id="cb296-3"><a href="#cb296-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(ess_values)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  b_Intercept b_study_hours         sigma     Intercept        lprior 
       0.6596        0.6419        0.7567        0.6366        0.6984 
         lp__ 
       0.4583 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb298"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb298-1"><a href="#cb298-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Trace plots (chains should mix well)</span></span>
<span id="cb298-2"><a href="#cb298-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(bayes_model, <span class="at">pars =</span> <span class="fu">c</span>(<span class="st">"b_Intercept"</span>, <span class="st">"b_study_hours"</span>, <span class="st">"sigma"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="part-g-lab-practicals_files/figure-html/lab6-diagnostics-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Checkpoint:</strong> - All Rhat values &lt; 1.01 (convergence achieved) - ESS ratios &gt; 0.5 (sufficient effective samples) - Trace plots show “hairy caterpillar” (good mixing) - Rank plots show uniform overlap (no divergences)</p>
<hr>
</section>
<section id="step-5-extract-and-visualize-posteriors" class="level3">
<h3 class="anchored" data-anchor-id="step-5-extract-and-visualize-posteriors">Step 5: Extract and Visualize Posteriors</h3>
<p>Examine posterior distributions:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb299"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb299-1"><a href="#cb299-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract posterior draws</span></span>
<span id="cb299-2"><a href="#cb299-2" aria-hidden="true" tabindex="-1"></a>posterior_draws <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(bayes_model)</span>
<span id="cb299-3"><a href="#cb299-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-4"><a href="#cb299-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize posteriors</span></span>
<span id="cb299-5"><a href="#cb299-5" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_areas</span>(bayes_model, </span>
<span id="cb299-6"><a href="#cb299-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">pars =</span> <span class="fu">c</span>(<span class="st">"b_Intercept"</span>, <span class="st">"b_study_hours"</span>),</span>
<span id="cb299-7"><a href="#cb299-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">prob =</span> <span class="fl">0.95</span>) <span class="sc">+</span></span>
<span id="cb299-8"><a href="#cb299-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Posterior Distributions with 95% Credible Intervals"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="part-g-lab-practicals_files/figure-html/lab6-posteriors-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb300"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb300-1"><a href="#cb300-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary statistics</span></span>
<span id="cb300-2"><a href="#cb300-2" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior_summary</span>(bayes_model, <span class="at">pars =</span> <span class="fu">c</span>(<span class="st">"b_Intercept"</span>, <span class="st">"b_study_hours"</span>, <span class="st">"sigma"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>              Estimate Est.Error    Q2.5  Q97.5
b_Intercept     52.664    7.2567 38.4094 66.959
b_study_hours    1.392    0.4382  0.5079  2.237
sigma            9.774    1.6694  7.1705 13.585</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb302"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb302-1"><a href="#cb302-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Interpretation</span></span>
<span id="cb302-2"><a href="#cb302-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"For each additional study hour, exam scores increase by:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>For each additional study hour, exam scores increase by:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb304"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb304-1"><a href="#cb304-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Median:"</span>, <span class="fu">round</span>(<span class="fu">median</span>(posterior_draws<span class="sc">$</span>b_study_hours), <span class="dv">2</span>), <span class="st">"points</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Median: 1.4 points</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb306"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb306-1"><a href="#cb306-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"95% Credible Interval:"</span>, </span>
<span id="cb306-2"><a href="#cb306-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">quantile</span>(posterior_draws<span class="sc">$</span>b_study_hours, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>)), <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>95% Credible Interval: 0.51 2.24 </code></pre>
</div>
</div>
<p><strong>Checkpoint:</strong> Posterior for slope should be clearly positive (95% CI excludes zero), indicating reliable relationship.</p>
<hr>
</section>
<section id="step-6-posterior-predictive-checks" class="level3">
<h3 class="anchored" data-anchor-id="step-6-posterior-predictive-checks">Step 6: Posterior Predictive Checks</h3>
<p>Assess model fit:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb308"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb308-1"><a href="#cb308-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Posterior predictive check</span></span>
<span id="cb308-2"><a href="#cb308-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(bayes_model, <span class="at">ndraws =</span> <span class="dv">50</span>) <span class="sc">+</span></span>
<span id="cb308-3"><a href="#cb308-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Posterior Predictive Check"</span>,</span>
<span id="cb308-4"><a href="#cb308-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Does model reproduce observed data distribution?"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="part-g-lab-practicals_files/figure-html/lab6-ppc-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb309"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb309-1"><a href="#cb309-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Individual data points</span></span>
<span id="cb309-2"><a href="#cb309-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(bayes_model, <span class="at">type =</span> <span class="st">"scatter_avg"</span>) <span class="sc">+</span></span>
<span id="cb309-3"><a href="#cb309-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Observed vs Predicted Exam Scores"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="part-g-lab-practicals_files/figure-html/lab6-ppc-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb310"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb310-1"><a href="#cb310-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prediction intervals for new data</span></span>
<span id="cb310-2"><a href="#cb310-2" aria-hidden="true" tabindex="-1"></a>new_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">study_hours =</span> <span class="fu">seq</span>(<span class="dv">5</span>, <span class="dv">25</span>, <span class="at">by =</span> <span class="dv">5</span>))</span>
<span id="cb310-3"><a href="#cb310-3" aria-hidden="true" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">posterior_predict</span>(bayes_model, <span class="at">newdata =</span> new_data)</span>
<span id="cb310-4"><a href="#cb310-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb310-5"><a href="#cb310-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize with uncertainty</span></span>
<span id="cb310-6"><a href="#cb310-6" aria-hidden="true" tabindex="-1"></a>new_data <span class="sc">%&gt;%</span></span>
<span id="cb310-7"><a href="#cb310-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb310-8"><a href="#cb310-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">median_score =</span> <span class="fu">apply</span>(predictions, <span class="dv">2</span>, median),</span>
<span id="cb310-9"><a href="#cb310-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">lower =</span> <span class="fu">apply</span>(predictions, <span class="dv">2</span>, quantile, <span class="fl">0.025</span>),</span>
<span id="cb310-10"><a href="#cb310-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">upper =</span> <span class="fu">apply</span>(predictions, <span class="dv">2</span>, quantile, <span class="fl">0.975</span>)</span>
<span id="cb310-11"><a href="#cb310-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb310-12"><a href="#cb310-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> study_hours)) <span class="sc">+</span></span>
<span id="cb310-13"><a href="#cb310-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> lower, <span class="at">ymax =</span> upper), <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb310-14"><a href="#cb310-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> median_score), <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb310-15"><a href="#cb310-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> study_data, <span class="fu">aes</span>(<span class="at">y =</span> exam_score), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb310-16"><a href="#cb310-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Bayesian Regression with 95% Prediction Intervals"</span>,</span>
<span id="cb310-17"><a href="#cb310-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Study Hours"</span>, <span class="at">y =</span> <span class="st">"Exam Score"</span>) <span class="sc">+</span></span>
<span id="cb310-18"><a href="#cb310-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="part-g-lab-practicals_files/figure-html/lab6-ppc-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Checkpoint:</strong> Model should reproduce the observed data distribution well. Prediction intervals should capture most observed points.</p>
<hr>
</section>
<section id="step-7-compare-with-frequentist-approach" class="level3">
<h3 class="anchored" data-anchor-id="step-7-compare-with-frequentist-approach">Step 7: Compare with Frequentist Approach</h3>
<p>Contrast Bayesian and frequentist results:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb311"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb311-1"><a href="#cb311-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit frequentist model</span></span>
<span id="cb311-2"><a href="#cb311-2" aria-hidden="true" tabindex="-1"></a>freq_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(exam_score <span class="sc">~</span> study_hours, <span class="at">data =</span> study_data)</span>
<span id="cb311-3"><a href="#cb311-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-4"><a href="#cb311-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Comparison table</span></span>
<span id="cb311-5"><a href="#cb311-5" aria-hidden="true" tabindex="-1"></a>comparison <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb311-6"><a href="#cb311-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Parameter =</span> <span class="fu">c</span>(<span class="st">"Intercept"</span>, <span class="st">"Slope (study_hours)"</span>, <span class="st">"Residual SD"</span>),</span>
<span id="cb311-7"><a href="#cb311-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Frequentist_Estimate =</span> <span class="fu">c</span>(<span class="fu">coef</span>(freq_model)[<span class="dv">1</span>], </span>
<span id="cb311-8"><a href="#cb311-8" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">coef</span>(freq_model)[<span class="dv">2</span>], </span>
<span id="cb311-9"><a href="#cb311-9" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">sigma</span>(freq_model)),</span>
<span id="cb311-10"><a href="#cb311-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">Frequentist_SE =</span> <span class="fu">c</span>(<span class="fu">summary</span>(freq_model)<span class="sc">$</span>coef[<span class="dv">1</span>, <span class="dv">2</span>],</span>
<span id="cb311-11"><a href="#cb311-11" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">summary</span>(freq_model)<span class="sc">$</span>coef[<span class="dv">2</span>, <span class="dv">2</span>],</span>
<span id="cb311-12"><a href="#cb311-12" aria-hidden="true" tabindex="-1"></a>                     <span class="cn">NA</span>),</span>
<span id="cb311-13"><a href="#cb311-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">Bayesian_Median =</span> <span class="fu">c</span>(<span class="fu">median</span>(posterior_draws<span class="sc">$</span>b_Intercept),</span>
<span id="cb311-14"><a href="#cb311-14" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">median</span>(posterior_draws<span class="sc">$</span>b_study_hours),</span>
<span id="cb311-15"><a href="#cb311-15" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">median</span>(posterior_draws<span class="sc">$</span>sigma)),</span>
<span id="cb311-16"><a href="#cb311-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">Bayesian_MAD =</span> <span class="fu">c</span>(<span class="fu">mad</span>(posterior_draws<span class="sc">$</span>b_Intercept),</span>
<span id="cb311-17"><a href="#cb311-17" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mad</span>(posterior_draws<span class="sc">$</span>b_study_hours),</span>
<span id="cb311-18"><a href="#cb311-18" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mad</span>(posterior_draws<span class="sc">$</span>sigma))</span>
<span id="cb311-19"><a href="#cb311-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb311-20"><a href="#cb311-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-21"><a href="#cb311-21" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(comparison)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
  Parameter     Frequentist_Estimate Frequentist_SE Bayesian_Median Bayesian_MAD
  &lt;chr&gt;                        &lt;dbl&gt;          &lt;dbl&gt;           &lt;dbl&gt;        &lt;dbl&gt;
1 Intercept                    52.5           6.92            52.6         7.01 
2 Slope (study…                 1.41          0.418            1.40        0.431
3 Residual SD                   9.42         NA                9.58        1.58 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb313"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb313-1"><a href="#cb313-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Credible vs Confidence Intervals</span></span>
<span id="cb313-2"><a href="#cb313-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">95% Confidence Interval (Frequentist):</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
95% Confidence Interval (Frequentist):</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb315"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb315-1"><a href="#cb315-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">confint</span>(freq_model))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>              2.5 % 97.5 %
(Intercept) 38.0148 67.072
study_hours  0.5262  2.284</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb317"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb317-1"><a href="#cb317-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">95% Credible Interval (Bayesian):</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
95% Credible Interval (Bayesian):</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb319"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb319-1"><a href="#cb319-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Intercept:"</span>, <span class="fu">quantile</span>(posterior_draws<span class="sc">$</span>b_Intercept, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>)), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Intercept: 38.41 66.96 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb321"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb321-1"><a href="#cb321-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Slope:"</span>, <span class="fu">quantile</span>(posterior_draws<span class="sc">$</span>b_study_hours, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>)), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Slope: 0.5079 2.237 </code></pre>
</div>
</div>
<p><strong>Checkpoint:</strong> Bayesian and frequentist estimates should be very similar with weakly informative priors. Bayesian approach provides full posterior distribution, not just point estimates.</p>
<hr>
</section>
<section id="step-8-interpret-and-report-1" class="level3">
<h3 class="anchored" data-anchor-id="step-8-interpret-and-report-1">Step 8: Interpret and Report</h3>
<p>Summarize findings:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb323"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb323-1"><a href="#cb323-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate probability of positive effect</span></span>
<span id="cb323-2"><a href="#cb323-2" aria-hidden="true" tabindex="-1"></a>prob_positive <span class="ot">&lt;-</span> <span class="fu">mean</span>(posterior_draws<span class="sc">$</span>b_study_hours <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb323-3"><a href="#cb323-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb323-4"><a href="#cb323-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Interpretation:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Interpretation:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb325"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb325-1"><a href="#cb325-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Median slope:"</span>, <span class="fu">round</span>(<span class="fu">median</span>(posterior_draws<span class="sc">$</span>b_study_hours), <span class="dv">2</span>), </span>
<span id="cb325-2"><a href="#cb325-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"points per hour</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>- Median slope: 1.4 points per hour</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb327"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb327-1"><a href="#cb327-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- 95% Credible Interval:"</span>, </span>
<span id="cb327-2"><a href="#cb327-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">quantile</span>(posterior_draws<span class="sc">$</span>b_study_hours, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>)), <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>- 95% Credible Interval: 0.51 2.24 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb329"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb329-1"><a href="#cb329-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Probability that slope &gt; 0:"</span>, <span class="fu">round</span>(prob_positive, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>- Probability that slope &gt; 0: 0.998 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb331"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb331-1"><a href="#cb331-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Interpretation: For each additional study hour, exam scores</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>- Interpretation: For each additional study hour, exam scores</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb333"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb333-1"><a href="#cb333-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  increase by approximately"</span>, </span>
<span id="cb333-2"><a href="#cb333-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">median</span>(posterior_draws<span class="sc">$</span>b_study_hours), <span class="dv">1</span>), </span>
<span id="cb333-3"><a href="#cb333-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"points (95% CI:"</span>, </span>
<span id="cb333-4"><a href="#cb333-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste</span>(<span class="fu">round</span>(<span class="fu">quantile</span>(posterior_draws<span class="sc">$</span>b_study_hours, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>)), <span class="dv">1</span>), </span>
<span id="cb333-5"><a href="#cb333-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">collapse =</span> <span class="st">" to "</span>), <span class="st">").</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  increase by approximately 1.4 points (95% CI: 0.5 to 2.2 ).</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb335"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb335-1"><a href="#cb335-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample results statement</span></span>
<span id="cb335-2"><a href="#cb335-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Sample Results Statement:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Sample Results Statement:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb337"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb337-1"><a href="#cb337-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"We used Bayesian linear regression with weakly informative priors</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>We used Bayesian linear regression with weakly informative priors</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb339"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb339-1"><a href="#cb339-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"(n=20, 4 chains, 8000 iterations). MCMC diagnostics indicated adequate</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>(n=20, 4 chains, 8000 iterations). MCMC diagnostics indicated adequate</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb341"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb341-1"><a href="#cb341-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"convergence (all Rhat &lt; 1.01, ESS &gt; 1000). Study hours positively</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>convergence (all Rhat &lt; 1.01, ESS &gt; 1000). Study hours positively</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb343"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb343-1"><a href="#cb343-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"predicted exam scores (β ="</span>, <span class="fu">round</span>(<span class="fu">median</span>(posterior_draws<span class="sc">$</span>b_study_hours), <span class="dv">2</span>),</span>
<span id="cb343-2"><a href="#cb343-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">", 95% CrI ["</span>, <span class="fu">paste</span>(<span class="fu">round</span>(<span class="fu">quantile</span>(posterior_draws<span class="sc">$</span>b_study_hours, </span>
<span id="cb343-3"><a href="#cb343-3" aria-hidden="true" tabindex="-1"></a>                                         <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>)), <span class="dv">2</span>), <span class="at">collapse =</span> <span class="st">", "</span>),</span>
<span id="cb343-4"><a href="#cb343-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"], P(β &gt; 0) = "</span>, <span class="fu">round</span>(prob_positive, <span class="dv">3</span>), <span class="st">").</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>predicted exam scores (β = 1.4 , 95% CrI [ 0.51, 2.24 ], P(β &gt; 0) =  0.998 ).</code></pre>
</div>
</div>
<p><strong>Checkpoint:</strong> Clear interpretation with credible intervals and probability statements that are unique to Bayesian approach.</p>
<hr>
</section>
<section id="discussion-questions-5" class="level3">
<h3 class="anchored" data-anchor-id="discussion-questions-5">Discussion Questions</h3>
<ol type="1">
<li><p><strong>Prior Sensitivity:</strong> How would results change with more informative priors (e.g., prior(normal(2, 1), class = b))?</p>
<p><em>Answer: More informative priors would pull estimates toward the prior mean (2), resulting in less influence from data. With n=20, data should dominate weakly informative priors, but stronger priors would shrink estimates.</em></p></li>
<li><p><strong>Credible vs Confidence:</strong> What’s the difference between a 95% credible interval and a 95% confidence interval?</p>
<p><em>Answer: A 95% credible interval says “the parameter has 95% probability of being in this range” (Bayesian). A 95% confidence interval says “if we repeated the study many times, 95% of intervals would contain the true parameter” (frequentist). Credible intervals are more intuitive.</em></p></li>
<li><p><strong>Small Sample Advantage:</strong> Why might Bayesian methods be preferred for small samples?</p>
<p><em>Answer: Bayesian methods explicitly quantify uncertainty, incorporate prior information to stabilize estimates, don’t rely on asymptotic approximations (which fail in small samples), and provide probability statements about parameters.</em></p></li>
<li><p><strong>MCMC Diagnostics:</strong> What would you do if Rhat &gt; 1.01 or ESS &lt; 400?</p>
<p><em>Answer: Increase iterations (e.g., iter=10000), increase warmup (e.g., warmup=5000), check for divergent transitions (indicating prior-likelihood conflict), consider reparameterization, or use stronger priors to improve geometry.</em></p></li>
<li><p><strong>Reporting:</strong> What information should you include when reporting Bayesian regression results?</p>
<p><em>Answer: Prior specifications, MCMC settings (chains, iterations, warmup), convergence diagnostics (Rhat, ESS), posterior summaries (median or mean, credible intervals), and interpretation using probability statements.</em></p></li>
</ol>
<hr>
</section>
<section id="key-takeaways-5" class="level3">
<h3 class="anchored" data-anchor-id="key-takeaways-5">Key Takeaways</h3>
<p>✓ <strong>Bayesian regression provides full uncertainty quantification</strong> through posterior distributions<br>
✓ <strong>Weakly informative priors</strong> regularize estimates without dominating small-sample data<br>
✓ <strong>MCMC diagnostics are critical</strong>: Always check Rhat, ESS, trace plots, and divergences<br>
✓ <strong>Posterior predictive checks</strong> assess model fit and identify misspecification<br>
✓ <strong>Credible intervals have intuitive interpretation</strong>: Direct probability statements about parameters<br>
✓ <strong>Bayesian methods excel in small samples</strong> where frequentist asymptotics break down</p>
<hr>
</section>
<section id="homework-exercise-5" class="level3">
<h3 class="anchored" data-anchor-id="homework-exercise-5">Homework Exercise</h3>
<p><strong>Dataset:</strong> A pilot study (n=18) examined whether training hours predict performance scores.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb345"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb345-1"><a href="#cb345-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb345-2"><a href="#cb345-2" aria-hidden="true" tabindex="-1"></a>training_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb345-3"><a href="#cb345-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">employee_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">18</span>,</span>
<span id="cb345-4"><a href="#cb345-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">training_hours =</span> <span class="fu">round</span>(<span class="fu">runif</span>(<span class="dv">18</span>, <span class="dv">10</span>, <span class="dv">40</span>), <span class="dv">1</span>),</span>
<span id="cb345-5"><a href="#cb345-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">performance_score =</span> <span class="fu">round</span>(<span class="dv">60</span> <span class="sc">+</span> <span class="fl">0.8</span> <span class="sc">*</span> training_hours <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">18</span>, <span class="dv">0</span>, <span class="dv">6</span>), <span class="dv">1</span>)</span>
<span id="cb345-6"><a href="#cb345-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p><strong>Your Tasks:</strong></p>
<ol type="1">
<li>Create a scatter plot of training hours vs performance score</li>
<li>Specify weakly informative priors (justify your choices)</li>
<li>Fit a Bayesian linear regression model with brms (4 chains, 4000 iterations)</li>
<li>Check MCMC diagnostics (Rhat, ESS, trace plots)</li>
<li>Visualize posterior distributions for intercept and slope</li>
<li>Perform posterior predictive checks</li>
<li>Compare Bayesian and frequentist estimates</li>
<li>Calculate P(slope &gt; 0) and interpret</li>
<li>Create a plot with median regression line and 95% credible intervals</li>
<li>Write a results statement reporting Bayesian estimates</li>
</ol>
<p><strong>Expected Results:</strong></p>
<ul>
<li>Positive relationship between training and performance</li>
<li>Slope posterior: median ≈ 0.7-0.9, 95% CrI roughly [0.4, 1.2]</li>
<li>All Rhat &lt; 1.01, ESS &gt; 1000 (good convergence)</li>
<li>P(slope &gt; 0) &gt; 0.99 (strong evidence for positive effect)</li>
<li>Bayesian and frequentist estimates very similar</li>
</ul>
<p><strong>Hints:</strong> - For priors: performance scores range 60-90, training hours range 10-40 - Use <code>prior(normal(75, 20), class = Intercept)</code> and <code>prior(normal(0, 2), class = b)</code> - Extract posteriors with <code>as_draws_df(model)</code> and calculate probabilities with <code>mean(posterior_draws$parameter &gt; value)</code></p>
<p><strong>Bonus:</strong> Re-fit the model with more informative priors (e.g., prior(normal(1, 0.5), class = b) assuming we expect slopes near 1). How much do results change? What does this reveal about data vs prior influence with n=18?</p>
<hr>
</section>
</section>
<section id="lab-reliability" class="level2">
<h2 class="anchored" data-anchor-id="lab-reliability">Lab 7: Reliability Analysis with Cronbach’s Alpha</h2>
<p><strong>Learning Objectives:</strong></p>
<ul>
<li>Calculate Cronbach’s alpha for internal consistency</li>
<li>Conduct item-total correlation analysis</li>
<li>Interpret “alpha if item deleted” diagnostics</li>
<li>Identify and remove problematic scale items</li>
<li>Report reliability estimates with confidence intervals</li>
</ul>
<p><strong>Scenario:</strong> You’re developing a 6-item Job Satisfaction Scale in a pilot sample (n=25 employees). You need to assess internal consistency, identify any poor items, and refine the scale.</p>
<section id="step-1-set-up-and-load-data-2" class="level3">
<h3 class="anchored" data-anchor-id="step-1-set-up-and-load-data-2">Step 1: Set Up and Load Data</h3>
<p>Create pilot data with responses to 6 job satisfaction items:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb346"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb346-1"><a href="#cb346-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb346-2"><a href="#cb346-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb346-3"><a href="#cb346-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb346-4"><a href="#cb346-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb346-5"><a href="#cb346-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Set seed for reproducibility</span></span>
<span id="cb346-6"><a href="#cb346-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb346-7"><a href="#cb346-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb346-8"><a href="#cb346-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate 6-item scale responses (1=Strongly Disagree, 5=Strongly Agree)</span></span>
<span id="cb346-9"><a href="#cb346-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Item 3 is intentionally problematic (reverse-coded but not reversed)</span></span>
<span id="cb346-10"><a href="#cb346-10" aria-hidden="true" tabindex="-1"></a>job_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb346-11"><a href="#cb346-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">employee_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>,</span>
<span id="cb346-12"><a href="#cb346-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">item1 =</span> <span class="fu">sample</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">25</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.3</span>, <span class="fl">0.4</span>, <span class="fl">0.2</span>)),</span>
<span id="cb346-13"><a href="#cb346-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">item2 =</span> <span class="fu">sample</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">25</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span>)),</span>
<span id="cb346-14"><a href="#cb346-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">item3 =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">25</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.3</span>, <span class="fl">0.4</span>, <span class="fl">0.2</span>, <span class="fl">0.1</span>)),  <span class="co"># Problematic</span></span>
<span id="cb346-15"><a href="#cb346-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">item4 =</span> <span class="fu">sample</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">25</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.4</span>, <span class="fl">0.3</span>)),</span>
<span id="cb346-16"><a href="#cb346-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">item5 =</span> <span class="fu">sample</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">25</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span>)),</span>
<span id="cb346-17"><a href="#cb346-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">item6 =</span> <span class="fu">sample</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">25</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span>))</span>
<span id="cb346-18"><a href="#cb346-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb346-19"><a href="#cb346-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb346-20"><a href="#cb346-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Item descriptions</span></span>
<span id="cb346-21"><a href="#cb346-21" aria-hidden="true" tabindex="-1"></a>item_labels <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb346-22"><a href="#cb346-22" aria-hidden="true" tabindex="-1"></a>  <span class="st">"item1"</span> <span class="ot">=</span> <span class="st">"I enjoy my work tasks"</span>,</span>
<span id="cb346-23"><a href="#cb346-23" aria-hidden="true" tabindex="-1"></a>  <span class="st">"item2"</span> <span class="ot">=</span> <span class="st">"I feel valued by my employer"</span>,</span>
<span id="cb346-24"><a href="#cb346-24" aria-hidden="true" tabindex="-1"></a>  <span class="st">"item3"</span> <span class="ot">=</span> <span class="st">"I often feel stressed at work (R)"</span>,  <span class="co"># Reverse-coded</span></span>
<span id="cb346-25"><a href="#cb346-25" aria-hidden="true" tabindex="-1"></a>  <span class="st">"item4"</span> <span class="ot">=</span> <span class="st">"I would recommend this workplace"</span>,</span>
<span id="cb346-26"><a href="#cb346-26" aria-hidden="true" tabindex="-1"></a>  <span class="st">"item5"</span> <span class="ot">=</span> <span class="st">"My work is meaningful"</span>,</span>
<span id="cb346-27"><a href="#cb346-27" aria-hidden="true" tabindex="-1"></a>  <span class="st">"item6"</span> <span class="ot">=</span> <span class="st">"I have good work-life balance"</span></span>
<span id="cb346-28"><a href="#cb346-28" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb346-29"><a href="#cb346-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb346-30"><a href="#cb346-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Descriptive statistics</span></span>
<span id="cb346-31"><a href="#cb346-31" aria-hidden="true" tabindex="-1"></a>job_data <span class="sc">%&gt;%</span></span>
<span id="cb346-32"><a href="#cb346-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"item"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb346-33"><a href="#cb346-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>     item1          item2         item3          item4         item5     
 Min.   :2.00   Min.   :2.0   Min.   :1.00   Min.   :2.0   Min.   :2.00  
 1st Qu.:3.00   1st Qu.:3.0   1st Qu.:2.00   1st Qu.:3.0   1st Qu.:3.00  
 Median :4.00   Median :4.0   Median :2.00   Median :4.0   Median :5.00  
 Mean   :3.84   Mean   :3.6   Mean   :2.16   Mean   :3.8   Mean   :4.12  
 3rd Qu.:5.00   3rd Qu.:5.0   3rd Qu.:3.00   3rd Qu.:5.0   3rd Qu.:5.00  
 Max.   :5.00   Max.   :5.0   Max.   :4.00   Max.   :5.0   Max.   :5.00  
     item6     
 Min.   :2.00  
 1st Qu.:3.00  
 Median :4.00  
 Mean   :3.64  
 3rd Qu.:5.00  
 Max.   :5.00  </code></pre>
</div>
</div>
<p><strong>Checkpoint:</strong> You should have n=25 employees with responses to 6 items on a 1-5 scale.</p>
<hr>
</section>
<section id="step-2-visualize-inter-item-correlations" class="level3">
<h3 class="anchored" data-anchor-id="step-2-visualize-inter-item-correlations">Step 2: Visualize Inter-Item Correlations</h3>
<p>Examine correlation matrix:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb348"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb348-1"><a href="#cb348-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract item columns</span></span>
<span id="cb348-2"><a href="#cb348-2" aria-hidden="true" tabindex="-1"></a>items <span class="ot">&lt;-</span> job_data <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"item"</span>))</span>
<span id="cb348-3"><a href="#cb348-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb348-4"><a href="#cb348-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Correlation matrix</span></span>
<span id="cb348-5"><a href="#cb348-5" aria-hidden="true" tabindex="-1"></a>cor_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(items)</span>
<span id="cb348-6"><a href="#cb348-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(cor_matrix, <span class="dv">2</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>      item1 item2 item3 item4 item5 item6
item1  1.00  0.02 -0.18 -0.04  0.24  0.10
item2  0.02  1.00  0.03 -0.34  0.04  0.21
item3 -0.18  0.03  1.00 -0.21  0.02 -0.07
item4 -0.04 -0.34 -0.21  1.00  0.02 -0.03
item5  0.24  0.04  0.02  0.02  1.00  0.38
item6  0.10  0.21 -0.07 -0.03  0.38  1.00</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb350"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb350-1"><a href="#cb350-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize correlations</span></span>
<span id="cb350-2"><a href="#cb350-2" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(cor_matrix, </span>
<span id="cb350-3"><a href="#cb350-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">method =</span> <span class="st">"color"</span>, </span>
<span id="cb350-4"><a href="#cb350-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">type =</span> <span class="st">"upper"</span>,</span>
<span id="cb350-5"><a href="#cb350-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">addCoef.col =</span> <span class="st">"black"</span>,</span>
<span id="cb350-6"><a href="#cb350-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">tl.col =</span> <span class="st">"black"</span>,</span>
<span id="cb350-7"><a href="#cb350-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">tl.srt =</span> <span class="dv">45</span>,</span>
<span id="cb350-8"><a href="#cb350-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">title =</span> <span class="st">"Inter-Item Correlations"</span>,</span>
<span id="cb350-9"><a href="#cb350-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">0</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="part-g-lab-practicals_files/figure-html/lab7-correlations-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb351"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb351-1"><a href="#cb351-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify problematic correlations</span></span>
<span id="cb351-2"><a href="#cb351-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Items with low/negative correlations:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Items with low/negative correlations:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb353"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb353-1"><a href="#cb353-1" aria-hidden="true" tabindex="-1"></a><span class="fu">which</span>(cor_matrix <span class="sc">&lt;</span> <span class="fl">0.2</span> <span class="sc">&amp;</span> cor_matrix <span class="sc">&lt;</span> <span class="dv">1</span>, <span class="at">arr.ind =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>      row col
item2   2   1
item3   3   1
item4   4   1
item6   6   1
item1   1   2
item3   3   2
item4   4   2
item5   5   2
item1   1   3
item2   2   3
item4   4   3
item5   5   3
item6   6   3
item1   1   4
item2   2   4
item3   3   4
item5   5   4
item6   6   4
item2   2   5
item3   3   5
item4   4   5
item1   1   6
item3   3   6
item4   4   6</code></pre>
</div>
</div>
<p><strong>Checkpoint:</strong> Most items should correlate positively (r &gt; 0.3). Item 3 likely shows weak or negative correlations.</p>
<p><strong>Discussion:</strong> Why do we want items to be positively correlated? What do low/negative correlations suggest?</p>
<hr>
</section>
<section id="step-3-calculate-cronbachs-alpha" class="level3">
<h3 class="anchored" data-anchor-id="step-3-calculate-cronbachs-alpha">Step 3: Calculate Cronbach’s Alpha</h3>
<p>Compute reliability for the full 6-item scale:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb355"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb355-1"><a href="#cb355-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cronbach's alpha with detailed output</span></span>
<span id="cb355-2"><a href="#cb355-2" aria-hidden="true" tabindex="-1"></a>alpha_result <span class="ot">&lt;-</span> psych<span class="sc">::</span><span class="fu">alpha</span>(items)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Some items ( item3 item4 ) were negatively correlated with the first principal component and 
probably should be reversed.  
To do this, run the function again with the 'check.keys=TRUE' option</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb357"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb357-1"><a href="#cb357-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print full output</span></span>
<span id="cb357-2"><a href="#cb357-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(alpha_result)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Reliability analysis   
Call: psych::alpha(x = items)

  raw_alpha std.alpha G6(smc) average_r   S/N  ase mean   sd median_r
      0.13     0.078     0.2     0.014 0.085 0.25  3.5 0.44    0.024

    95% confidence boundaries 
         lower alpha upper
Feldt    -0.53  0.13  0.57
Duhachek -0.37  0.13  0.63

 Reliability if an item is dropped:
      raw_alpha std.alpha G6(smc) average_r    S/N alpha se var.r   med.r
item1     0.087     0.033   0.162    0.0068  0.034     0.27 0.039  0.0240
item2     0.172     0.114   0.200    0.0252  0.129     0.25 0.032 -0.0026
item3     0.258     0.246   0.310    0.0614  0.327     0.23 0.037  0.0331
item4     0.339     0.301   0.327    0.0793  0.430     0.20 0.026  0.0344
item5    -0.237    -0.315  -0.128   -0.0504 -0.240     0.37 0.025 -0.0330
item6    -0.213    -0.229  -0.057   -0.0387 -0.186     0.37 0.026  0.0202

 Item statistics 
       n raw.r std.r  r.cor  r.drop mean   sd
item1 25  0.42  0.45  0.211  0.0824  3.8 0.90
item2 25  0.42  0.38  0.097 -0.0062  3.6 1.12
item3 25  0.17  0.23 -0.272 -0.1490  2.2 0.85
item4 25  0.15  0.16 -0.370 -0.2212  3.8 1.00
item5 25  0.68  0.68  0.795  0.3605  4.1 1.05
item6 25  0.68  0.63  0.685  0.3133  3.6 1.15

Non missing response frequency for each item
        1    2    3    4    5 miss
item1 0.0 0.04 0.36 0.32 0.28    0
item2 0.0 0.20 0.28 0.24 0.28    0
item3 0.2 0.52 0.20 0.08 0.00    0
item4 0.0 0.12 0.24 0.36 0.28    0
item5 0.0 0.08 0.24 0.16 0.52    0
item6 0.0 0.20 0.28 0.20 0.32    0</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb359"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb359-1"><a href="#cb359-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract key statistics safely using as.numeric() to ensure atomic values</span></span>
<span id="cb359-2"><a href="#cb359-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Cronbach's Alpha:"</span>, <span class="fu">round</span>(<span class="fu">as.numeric</span>(alpha_result<span class="sc">$</span>total<span class="sc">$</span>raw_alpha), <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Cronbach's Alpha: 0.131 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb361"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb361-1"><a href="#cb361-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Standardized Alpha:"</span>, <span class="fu">round</span>(<span class="fu">as.numeric</span>(alpha_result<span class="sc">$</span>total<span class="sc">$</span>std.alpha), <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Standardized Alpha: 0.078 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb363"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb363-1"><a href="#cb363-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Number of items:"</span>, <span class="fu">as.numeric</span>(alpha_result<span class="sc">$</span>total<span class="sc">$</span>nvar), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Number of items:  </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb365"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb365-1"><a href="#cb365-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Sample size:"</span>, <span class="fu">as.numeric</span>(alpha_result<span class="sc">$</span>total<span class="sc">$</span>n), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Sample size:  </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb367"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb367-1"><a href="#cb367-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 95% Confidence interval for alpha (if available)</span></span>
<span id="cb367-2"><a href="#cb367-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(alpha_result<span class="sc">$</span>feldt) <span class="sc">&amp;&amp;</span> <span class="fu">is.data.frame</span>(alpha_result<span class="sc">$</span>feldt) <span class="sc">&amp;&amp;</span> <span class="fu">nrow</span>(alpha_result<span class="sc">$</span>feldt) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb367-3"><a href="#cb367-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"95% CI for Alpha:"</span>, </span>
<span id="cb367-4"><a href="#cb367-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">round</span>(<span class="fu">as.numeric</span>(alpha_result<span class="sc">$</span>feldt<span class="sc">$</span>lower.ci), <span class="dv">3</span>), <span class="st">"-"</span>,</span>
<span id="cb367-5"><a href="#cb367-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">round</span>(<span class="fu">as.numeric</span>(alpha_result<span class="sc">$</span>feldt<span class="sc">$</span>upper.ci), <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb367-6"><a href="#cb367-6" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p><strong>Checkpoint:</strong> Initial alpha should be moderate (0.60-0.75), with wide CI due to small sample.</p>
<hr>
</section>
<section id="step-4-item-total-correlations" class="level3">
<h3 class="anchored" data-anchor-id="step-4-item-total-correlations">Step 4: Item-Total Correlations</h3>
<p>Examine how each item relates to total score:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb368"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb368-1"><a href="#cb368-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Item statistics</span></span>
<span id="cb368-2"><a href="#cb368-2" aria-hidden="true" tabindex="-1"></a>item_stats <span class="ot">&lt;-</span> alpha_result<span class="sc">$</span>item.stats</span>
<span id="cb368-3"><a href="#cb368-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb368-4"><a href="#cb368-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(item_stats)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>       n  raw.r  std.r    r.cor    r.drop mean     sd
item1 25 0.4153 0.4503  0.21130  0.082375 3.84 0.8981
item2 25 0.4177 0.3779  0.09653 -0.006213 3.60 1.1180
item3 25 0.1737 0.2349 -0.27174 -0.149026 2.16 0.8505
item4 25 0.1546 0.1644 -0.36962 -0.221168 3.80 1.0000
item5 25 0.6817 0.6760  0.79483  0.360496 4.12 1.0536
item6 25 0.6781 0.6300  0.68457  0.313344 3.64 1.1504</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb370"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb370-1"><a href="#cb370-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize item-total correlations</span></span>
<span id="cb370-2"><a href="#cb370-2" aria-hidden="true" tabindex="-1"></a>item_stats <span class="sc">%&gt;%</span></span>
<span id="cb370-3"><a href="#cb370-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"item"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb370-4"><a href="#cb370-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> item, <span class="at">y =</span> r.cor)) <span class="sc">+</span></span>
<span id="cb370-5"><a href="#cb370-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb370-6"><a href="#cb370-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.3</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb370-7"><a href="#cb370-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Corrected Item-Total Correlations"</span>,</span>
<span id="cb370-8"><a href="#cb370-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Red line = 0.30 threshold"</span>,</span>
<span id="cb370-9"><a href="#cb370-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Item"</span>, <span class="at">y =</span> <span class="st">"Correlation with Total"</span>) <span class="sc">+</span></span>
<span id="cb370-10"><a href="#cb370-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb370-11"><a href="#cb370-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="part-g-lab-practicals_files/figure-html/lab7-item-total-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Checkpoint:</strong> Item 3 should show low corrected item-total correlation (r &lt; 0.30), flagging it as problematic.</p>
<p><strong>Discussion:</strong> What does a low item-total correlation mean? Should we remove this item?</p>
<hr>
</section>
<section id="step-5-alpha-if-item-deleted-analysis" class="level3">
<h3 class="anchored" data-anchor-id="step-5-alpha-if-item-deleted-analysis">Step 5: “Alpha if Item Deleted” Analysis</h3>
<p>See how alpha changes if each item is removed:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb371"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb371-1"><a href="#cb371-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract "alpha if item deleted"</span></span>
<span id="cb371-2"><a href="#cb371-2" aria-hidden="true" tabindex="-1"></a>alpha_if_deleted <span class="ot">&lt;-</span> alpha_result<span class="sc">$</span>alpha.drop</span>
<span id="cb371-3"><a href="#cb371-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb371-4"><a href="#cb371-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(alpha_if_deleted)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>      raw_alpha std.alpha  G6(smc) average_r      S/N alpha se   var.r
item1   0.08678   0.03325  0.16233  0.006832  0.03439   0.2742 0.03904
item2   0.17226   0.11438  0.20042  0.025180  0.12915   0.2467 0.03237
item3   0.25783   0.24649  0.30968  0.061407  0.32712   0.2269 0.03740
item4   0.33943   0.30090  0.32746  0.079260  0.43041   0.2002 0.02617
item5  -0.23699  -0.31525 -0.12752 -0.050351 -0.23969   0.3745 0.02492
item6  -0.21349  -0.22895 -0.05668 -0.038702 -0.18630   0.3750 0.02633
          med.r
item1  0.023955
item2 -0.002624
item3  0.033088
item4  0.034370
item5 -0.033045
item6  0.020163</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb373"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb373-1"><a href="#cb373-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize impact</span></span>
<span id="cb373-2"><a href="#cb373-2" aria-hidden="true" tabindex="-1"></a>alpha_if_deleted <span class="sc">%&gt;%</span></span>
<span id="cb373-3"><a href="#cb373-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"item"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb373-4"><a href="#cb373-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> item, <span class="at">y =</span> raw_alpha)) <span class="sc">+</span></span>
<span id="cb373-5"><a href="#cb373-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">"coral"</span>) <span class="sc">+</span></span>
<span id="cb373-6"><a href="#cb373-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> alpha_result<span class="sc">$</span>total<span class="sc">$</span>raw_alpha, </span>
<span id="cb373-7"><a href="#cb373-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb373-8"><a href="#cb373-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Alpha if Item Deleted"</span>,</span>
<span id="cb373-9"><a href="#cb373-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Blue line = Current alpha"</span>,</span>
<span id="cb373-10"><a href="#cb373-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Item"</span>, <span class="at">y =</span> <span class="st">"Alpha without this item"</span>) <span class="sc">+</span></span>
<span id="cb373-11"><a href="#cb373-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb373-12"><a href="#cb373-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="part-g-lab-practicals_files/figure-html/lab7-alpha-deleted-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb374"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb374-1"><a href="#cb374-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify items that improve alpha if deleted</span></span>
<span id="cb374-2"><a href="#cb374-2" aria-hidden="true" tabindex="-1"></a>items_to_consider <span class="ot">&lt;-</span> alpha_if_deleted <span class="sc">%&gt;%</span></span>
<span id="cb374-3"><a href="#cb374-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(raw_alpha <span class="sc">&gt;</span> alpha_result<span class="sc">$</span>total<span class="sc">$</span>raw_alpha)</span>
<span id="cb374-4"><a href="#cb374-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb374-5"><a href="#cb374-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">nrow</span>(items_to_consider) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb374-6"><a href="#cb374-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Removing these items would INCREASE alpha:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb374-7"><a href="#cb374-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">rownames</span>(items_to_consider))</span>
<span id="cb374-8"><a href="#cb374-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Removing these items would INCREASE alpha:
[1] "item2" "item3" "item4"</code></pre>
</div>
</div>
<p><strong>Checkpoint:</strong> Removing item 3 should increase alpha, suggesting it should be deleted.</p>
<hr>
</section>
<section id="step-6-recompute-alpha-without-problematic-item" class="level3">
<h3 class="anchored" data-anchor-id="step-6-recompute-alpha-without-problematic-item">Step 6: Recompute Alpha Without Problematic Item</h3>
<p>Remove item 3 and reassess reliability:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb376"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb376-1"><a href="#cb376-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove item 3</span></span>
<span id="cb376-2"><a href="#cb376-2" aria-hidden="true" tabindex="-1"></a>items_revised <span class="ot">&lt;-</span> items <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>item3)</span>
<span id="cb376-3"><a href="#cb376-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb376-4"><a href="#cb376-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Recompute alpha</span></span>
<span id="cb376-5"><a href="#cb376-5" aria-hidden="true" tabindex="-1"></a>alpha_revised <span class="ot">&lt;-</span> psych<span class="sc">::</span><span class="fu">alpha</span>(items_revised)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Some items ( item4 ) were negatively correlated with the first principal component and 
probably should be reversed.  
To do this, run the function again with the 'check.keys=TRUE' option</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb378"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb378-1"><a href="#cb378-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(alpha_revised)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Reliability analysis   
Call: psych::alpha(x = items_revised)

  raw_alpha std.alpha G6(smc) average_r  S/N  ase mean   sd median_r
      0.26      0.25    0.31     0.061 0.33 0.23  3.8 0.53    0.033

    95% confidence boundaries 
         lower alpha upper
Feldt    -0.33  0.26  0.63
Duhachek -0.19  0.26  0.70

 Reliability if an item is dropped:
      raw_alpha std.alpha G6(smc) average_r    S/N alpha se var.r   med.r
item1     0.192     0.169   0.257    0.0483  0.203     0.25 0.058  0.0331
item2     0.350     0.339   0.329    0.1138  0.514     0.21 0.028  0.0635
item4     0.446     0.442   0.410    0.1653  0.792     0.18 0.019  0.1553
item5    -0.032    -0.051   0.048   -0.0124 -0.049     0.33 0.034 -0.0062
item6    -0.059    -0.033   0.066   -0.0081 -0.032     0.34 0.035  0.0202

 Item statistics 
       n raw.r std.r r.cor r.drop mean  sd
item1 25  0.48  0.53  0.28  0.151  3.8 0.9
item2 25  0.41  0.37  0.06 -0.016  3.6 1.1
item4 25  0.22  0.25 -0.19 -0.160  3.8 1.0
item5 25  0.68  0.68  0.63  0.351  4.1 1.1
item6 25  0.70  0.67  0.61  0.349  3.6 1.2

Non missing response frequency for each item
         2    3    4    5 miss
item1 0.04 0.36 0.32 0.28    0
item2 0.20 0.28 0.24 0.28    0
item4 0.12 0.24 0.36 0.28    0
item5 0.08 0.24 0.16 0.52    0
item6 0.20 0.28 0.20 0.32    0</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb380"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb380-1"><a href="#cb380-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare original vs revised</span></span>
<span id="cb380-2"><a href="#cb380-2" aria-hidden="true" tabindex="-1"></a>comparison <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb380-3"><a href="#cb380-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Version =</span> <span class="fu">c</span>(<span class="st">"Original (6 items)"</span>, <span class="st">"Revised (5 items)"</span>),</span>
<span id="cb380-4"><a href="#cb380-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Alpha =</span> <span class="fu">c</span>(alpha_result<span class="sc">$</span>total<span class="sc">$</span>raw_alpha, </span>
<span id="cb380-5"><a href="#cb380-5" aria-hidden="true" tabindex="-1"></a>            alpha_revised<span class="sc">$</span>total<span class="sc">$</span>raw_alpha),</span>
<span id="cb380-6"><a href="#cb380-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">CI_Lower =</span> <span class="fu">c</span>(alpha_result<span class="sc">$</span>feldt<span class="sc">$</span>lower.ci,</span>
<span id="cb380-7"><a href="#cb380-7" aria-hidden="true" tabindex="-1"></a>               alpha_revised<span class="sc">$</span>feldt<span class="sc">$</span>lower.ci),</span>
<span id="cb380-8"><a href="#cb380-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">CI_Upper =</span> <span class="fu">c</span>(alpha_result<span class="sc">$</span>feldt<span class="sc">$</span>upper.ci,</span>
<span id="cb380-9"><a href="#cb380-9" aria-hidden="true" tabindex="-1"></a>               alpha_revised<span class="sc">$</span>feldt<span class="sc">$</span>upper.ci),</span>
<span id="cb380-10"><a href="#cb380-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">Mean_r =</span> <span class="fu">c</span>(alpha_result<span class="sc">$</span>total<span class="sc">$</span>average_r,</span>
<span id="cb380-11"><a href="#cb380-11" aria-hidden="true" tabindex="-1"></a>             alpha_revised<span class="sc">$</span>total<span class="sc">$</span>average_r)</span>
<span id="cb380-12"><a href="#cb380-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb380-13"><a href="#cb380-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb380-14"><a href="#cb380-14" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(comparison)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 5
  Version            Alpha CI_Lower     CI_Upper     Mean_r
  &lt;chr&gt;              &lt;dbl&gt; &lt;named list&gt; &lt;named list&gt;  &lt;dbl&gt;
1 Original (6 items) 0.131 &lt;dbl [1]&gt;    &lt;dbl [1]&gt;    0.0139
2 Revised (5 items)  0.258 &lt;dbl [1]&gt;    &lt;dbl [1]&gt;    0.0614</code></pre>
</div>
</div>
<p><strong>Checkpoint:</strong> Revised alpha should improve (e.g., from 0.65 to 0.78), with all item-total correlations now &gt; 0.30.</p>
<hr>
</section>
<section id="step-7-final-scale-scoring" class="level3">
<h3 class="anchored" data-anchor-id="step-7-final-scale-scoring">Step 7: Final Scale Scoring</h3>
<p>Calculate total scores for the refined 5-item scale:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb382"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb382-1"><a href="#cb382-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate total scores</span></span>
<span id="cb382-2"><a href="#cb382-2" aria-hidden="true" tabindex="-1"></a>job_data_scored <span class="ot">&lt;-</span> job_data <span class="sc">%&gt;%</span></span>
<span id="cb382-3"><a href="#cb382-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb382-4"><a href="#cb382-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_score_original =</span> <span class="fu">rowSums</span>(<span class="fu">select</span>(., <span class="fu">starts_with</span>(<span class="st">"item"</span>))),</span>
<span id="cb382-5"><a href="#cb382-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_score_revised =</span> <span class="fu">rowSums</span>(<span class="fu">select</span>(., item1, item2, item4, item5, item6)),</span>
<span id="cb382-6"><a href="#cb382-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_score_revised =</span> total_score_revised <span class="sc">/</span> <span class="dv">5</span></span>
<span id="cb382-7"><a href="#cb382-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb382-8"><a href="#cb382-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb382-9"><a href="#cb382-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Descriptive statistics for final scale</span></span>
<span id="cb382-10"><a href="#cb382-10" aria-hidden="true" tabindex="-1"></a>job_data_scored <span class="sc">%&gt;%</span></span>
<span id="cb382-11"><a href="#cb382-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb382-12"><a href="#cb382-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb382-13"><a href="#cb382-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean =</span> <span class="fu">mean</span>(mean_score_revised),</span>
<span id="cb382-14"><a href="#cb382-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd =</span> <span class="fu">sd</span>(mean_score_revised),</span>
<span id="cb382-15"><a href="#cb382-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">min =</span> <span class="fu">min</span>(mean_score_revised),</span>
<span id="cb382-16"><a href="#cb382-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">max =</span> <span class="fu">max</span>(mean_score_revised)</span>
<span id="cb382-17"><a href="#cb382-17" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 5
      n  mean    sd   min   max
  &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1    25   3.8 0.526   2.6   4.6</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb384"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb384-1"><a href="#cb384-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Distribution of scores</span></span>
<span id="cb384-2"><a href="#cb384-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(job_data_scored, <span class="fu">aes</span>(<span class="at">x =</span> mean_score_revised)) <span class="sc">+</span></span>
<span id="cb384-3"><a href="#cb384-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">10</span>, <span class="at">fill =</span> <span class="st">"skyblue"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb384-4"><a href="#cb384-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Job Satisfaction Scores (Revised Scale)"</span>,</span>
<span id="cb384-5"><a href="#cb384-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Mean Score (1-5)"</span>, <span class="at">y =</span> <span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb384-6"><a href="#cb384-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="part-g-lab-practicals_files/figure-html/lab7-scoring-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Checkpoint:</strong> Mean satisfaction score should be in reasonable range (e.g., 2.5-4.0 on 1-5 scale).</p>
<hr>
</section>
<section id="step-8-create-publication-table" class="level3">
<h3 class="anchored" data-anchor-id="step-8-create-publication-table">Step 8: Create Publication Table</h3>
<p>Summarize reliability analysis for reporting:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb385"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb385-1"><a href="#cb385-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb385-2"><a href="#cb385-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb385-3"><a href="#cb385-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Item-level summary for revised scale</span></span>
<span id="cb385-4"><a href="#cb385-4" aria-hidden="true" tabindex="-1"></a>item_summary <span class="ot">&lt;-</span> alpha_revised<span class="sc">$</span>item.stats <span class="sc">%&gt;%</span></span>
<span id="cb385-5"><a href="#cb385-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"item"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb385-6"><a href="#cb385-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb385-7"><a href="#cb385-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Item_Label =</span> item_labels[item],</span>
<span id="cb385-8"><a href="#cb385-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">M =</span> <span class="fu">round</span>(mean, <span class="dv">2</span>),</span>
<span id="cb385-9"><a href="#cb385-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">SD =</span> <span class="fu">round</span>(sd, <span class="dv">2</span>),</span>
<span id="cb385-10"><a href="#cb385-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">r (item-total)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(r.cor, <span class="dv">2</span>)</span>
<span id="cb385-11"><a href="#cb385-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb385-12"><a href="#cb385-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(item, Item_Label, M, SD, <span class="st">`</span><span class="at">r (item-total)</span><span class="st">`</span>)</span>
<span id="cb385-13"><a href="#cb385-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb385-14"><a href="#cb385-14" aria-hidden="true" tabindex="-1"></a>item_summary <span class="sc">%&gt;%</span></span>
<span id="cb385-15"><a href="#cb385-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb385-16"><a href="#cb385-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb385-17"><a href="#cb385-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Job Satisfaction Scale: Item Analysis"</span>,</span>
<span id="cb385-18"><a href="#cb385-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Revised 5-Item Scale (n=25)"</span></span>
<span id="cb385-19"><a href="#cb385-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb385-20"><a href="#cb385-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_footnote</span>(</span>
<span id="cb385-21"><a href="#cb385-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">footnote =</span> <span class="fu">sprintf</span>(<span class="st">"Cronbach's α = %.2f, 95%% CI [%.2f, %.2f]"</span>,</span>
<span id="cb385-22"><a href="#cb385-22" aria-hidden="true" tabindex="-1"></a>                       alpha_revised<span class="sc">$</span>total<span class="sc">$</span>raw_alpha,</span>
<span id="cb385-23"><a href="#cb385-23" aria-hidden="true" tabindex="-1"></a>                       alpha_revised<span class="sc">$</span>feldt<span class="sc">$</span>lower.ci,</span>
<span id="cb385-24"><a href="#cb385-24" aria-hidden="true" tabindex="-1"></a>                       alpha_revised<span class="sc">$</span>feldt<span class="sc">$</span>upper.ci),</span>
<span id="cb385-25"><a href="#cb385-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_column_labels</span>(<span class="at">columns =</span> <span class="st">"r (item-total)"</span>)</span>
<span id="cb385-26"><a href="#cb385-26" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb385-27"><a href="#cb385-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_footnote</span>(</span>
<span id="cb385-28"><a href="#cb385-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">footnote =</span> <span class="st">"Item 3 removed due to low item-total correlation"</span>,</span>
<span id="cb385-29"><a href="#cb385-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_title</span>()</span>
<span id="cb385-30"><a href="#cb385-30" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="yzvsxrwtnu" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#yzvsxrwtnu table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#yzvsxrwtnu thead, #yzvsxrwtnu tbody, #yzvsxrwtnu tfoot, #yzvsxrwtnu tr, #yzvsxrwtnu td, #yzvsxrwtnu th {
  border-style: none;
}

#yzvsxrwtnu p {
  margin: 0;
  padding: 0;
}

#yzvsxrwtnu .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#yzvsxrwtnu .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#yzvsxrwtnu .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#yzvsxrwtnu .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#yzvsxrwtnu .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#yzvsxrwtnu .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yzvsxrwtnu .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#yzvsxrwtnu .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#yzvsxrwtnu .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#yzvsxrwtnu .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#yzvsxrwtnu .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#yzvsxrwtnu .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#yzvsxrwtnu .gt_spanner_row {
  border-bottom-style: hidden;
}

#yzvsxrwtnu .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#yzvsxrwtnu .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#yzvsxrwtnu .gt_from_md > :first-child {
  margin-top: 0;
}

#yzvsxrwtnu .gt_from_md > :last-child {
  margin-bottom: 0;
}

#yzvsxrwtnu .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#yzvsxrwtnu .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#yzvsxrwtnu .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#yzvsxrwtnu .gt_row_group_first td {
  border-top-width: 2px;
}

#yzvsxrwtnu .gt_row_group_first th {
  border-top-width: 2px;
}

#yzvsxrwtnu .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#yzvsxrwtnu .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#yzvsxrwtnu .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#yzvsxrwtnu .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yzvsxrwtnu .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#yzvsxrwtnu .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#yzvsxrwtnu .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#yzvsxrwtnu .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#yzvsxrwtnu .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yzvsxrwtnu .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#yzvsxrwtnu .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#yzvsxrwtnu .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#yzvsxrwtnu .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#yzvsxrwtnu .gt_left {
  text-align: left;
}

#yzvsxrwtnu .gt_center {
  text-align: center;
}

#yzvsxrwtnu .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#yzvsxrwtnu .gt_font_normal {
  font-weight: normal;
}

#yzvsxrwtnu .gt_font_bold {
  font-weight: bold;
}

#yzvsxrwtnu .gt_font_italic {
  font-style: italic;
}

#yzvsxrwtnu .gt_super {
  font-size: 65%;
}

#yzvsxrwtnu .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#yzvsxrwtnu .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#yzvsxrwtnu .gt_indent_1 {
  text-indent: 5px;
}

#yzvsxrwtnu .gt_indent_2 {
  text-indent: 10px;
}

#yzvsxrwtnu .gt_indent_3 {
  text-indent: 15px;
}

#yzvsxrwtnu .gt_indent_4 {
  text-indent: 20px;
}

#yzvsxrwtnu .gt_indent_5 {
  text-indent: 25px;
}

#yzvsxrwtnu .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#yzvsxrwtnu div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading header">
<td colspan="5" class="gt_heading gt_title gt_font_normal">Job Satisfaction Scale: Item Analysis<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></td>
</tr>
<tr class="gt_heading even">
<td colspan="5" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border">Revised 5-Item Scale (n=25)<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></td>
</tr>
<tr class="gt_col_headings header">
<th id="item" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">item</th>
<th id="Item_Label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Item_Label</th>
<th id="M" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">M</th>
<th id="SD" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">SD</th>
<th id="r-(item-total)" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">r (item-total)<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>2</sup></span></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="item">item1</td>
<td class="gt_row gt_left" headers="Item_Label">I enjoy my work tasks</td>
<td class="gt_row gt_right" headers="M">3.84</td>
<td class="gt_row gt_right" headers="SD">0.90</td>
<td class="gt_row gt_right" headers="r (item-total)">0.28</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="item">item2</td>
<td class="gt_row gt_left" headers="Item_Label">I feel valued by my employer</td>
<td class="gt_row gt_right" headers="M">3.60</td>
<td class="gt_row gt_right" headers="SD">1.12</td>
<td class="gt_row gt_right" headers="r (item-total)">0.06</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="item">item4</td>
<td class="gt_row gt_left" headers="Item_Label">I would recommend this workplace</td>
<td class="gt_row gt_right" headers="M">3.80</td>
<td class="gt_row gt_right" headers="SD">1.00</td>
<td class="gt_row gt_right" headers="r (item-total)">-0.19</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="item">item5</td>
<td class="gt_row gt_left" headers="Item_Label">My work is meaningful</td>
<td class="gt_row gt_right" headers="M">4.12</td>
<td class="gt_row gt_right" headers="SD">1.05</td>
<td class="gt_row gt_right" headers="r (item-total)">0.63</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="item">item6</td>
<td class="gt_row gt_left" headers="Item_Label">I have good work-life balance</td>
<td class="gt_row gt_right" headers="M">3.64</td>
<td class="gt_row gt_right" headers="SD">1.15</td>
<td class="gt_row gt_right" headers="r (item-total)">0.61</td>
</tr>
</tbody><tfoot class="gt_footnotes">
<tr class="odd">
<td colspan="5" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> Item 3 removed due to low item-total correlation</td>
</tr>
<tr class="even">
<td colspan="5" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>2</sup></span> Cronbach's α = 0.26, 95% CI [-0.33, 0.63]</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
<p><strong>Checkpoint:</strong> Professional table showing item statistics and reliability for the refined scale.</p>
<hr>
</section>
<section id="discussion-questions-6" class="level3">
<h3 class="anchored" data-anchor-id="discussion-questions-6">Discussion Questions</h3>
<ol type="1">
<li><p><strong>Acceptability Thresholds:</strong> Is α = 0.78 acceptable for a pilot scale with n=25?</p>
<p><em>Answer: Yes. For pilot research, α &gt; 0.70 is acceptable. The value 0.78 suggests adequate internal consistency. However, the wide CI (e.g., 0.65-0.88) reflects uncertainty due to small n.</em></p></li>
<li><p><strong>Item Deletion:</strong> Should you always remove items with low item-total correlations?</p>
<p><em>Answer: Not automatically. Consider (1) theoretical importance of the item, (2) whether it measures a different facet, (3) whether reverse-coding was done correctly, (4) impact on content validity. Sometimes low correlations indicate multidimensionality rather than bad items.</em></p></li>
<li><p><strong>Sample Size:</strong> How does n=25 affect reliability estimates?</p>
<p><em>Answer: Small samples produce wider confidence intervals and less stable estimates. Alpha can be inflated or deflated. Ideally, n&gt;100 for reliability studies, but pilot data (n=25-50) provide initial evidence.</em></p></li>
<li><p><strong>Alpha Limitations:</strong> What are weaknesses of Cronbach’s alpha?</p>
<p><em>Answer: Assumes tau-equivalent model (equal item-total correlations), sensitive to number of items (more items → higher alpha), doesn’t detect multidimensionality, can be high even with low inter-item correlations if many items.</em></p></li>
<li><p><strong>Reporting:</strong> What should you include when reporting reliability?</p>
<p><em>Answer: Cronbach’s alpha, 95% CI, sample size, number of items, mean inter-item correlation, item-total correlations, and whether any items were deleted (with justification).</em></p></li>
</ol>
<hr>
</section>
<section id="key-takeaways-6" class="level3">
<h3 class="anchored" data-anchor-id="key-takeaways-6">Key Takeaways</h3>
<p>✓ <strong>Cronbach’s alpha assesses internal consistency</strong> (typical goal: α &gt; 0.70)<br>
✓ <strong>Item-total correlations</strong> identify problematic items (threshold: r &gt; 0.30)<br>
✓ <strong>“Alpha if deleted” analysis</strong> guides scale refinement decisions<br>
✓ <strong>Small samples (n&lt;50) produce wide CIs</strong> for reliability estimates<br>
✓ <strong>Item deletion must be justified theoretically</strong>, not just statistically<br>
✓ <strong>Always report confidence intervals</strong> and sample size with alpha</p>
<hr>
</section>
<section id="homework-exercise-6" class="level3">
<h3 class="anchored" data-anchor-id="homework-exercise-6">Homework Exercise</h3>
<p><strong>Dataset:</strong> A 5-item Self-Efficacy Scale piloted with n=30 students.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb386"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb386-1"><a href="#cb386-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">456</span>)</span>
<span id="cb386-2"><a href="#cb386-2" aria-hidden="true" tabindex="-1"></a>efficacy_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb386-3"><a href="#cb386-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">student_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>,</span>
<span id="cb386-4"><a href="#cb386-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">item1 =</span> <span class="fu">sample</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">30</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.3</span>, <span class="fl">0.4</span>, <span class="fl">0.2</span>)),</span>
<span id="cb386-5"><a href="#cb386-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">item2 =</span> <span class="fu">sample</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">30</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.4</span>, <span class="fl">0.3</span>)),</span>
<span id="cb386-6"><a href="#cb386-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">item3 =</span> <span class="fu">sample</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">30</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span>)),</span>
<span id="cb386-7"><a href="#cb386-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">item4 =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">30</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>)),  <span class="co"># Potentially problematic</span></span>
<span id="cb386-8"><a href="#cb386-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">item5 =</span> <span class="fu">sample</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">30</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.3</span>, <span class="fl">0.4</span>))</span>
<span id="cb386-9"><a href="#cb386-9" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p><strong>Your Tasks:</strong></p>
<ol type="1">
<li>Create a correlation matrix heatmap for the 5 items</li>
<li>Calculate Cronbach’s alpha for the full 5-item scale</li>
<li>Report alpha with 95% confidence interval</li>
<li>Create a bar chart of corrected item-total correlations</li>
<li>Identify items with r &lt; 0.30</li>
<li>Examine “alpha if item deleted” – would removing any item increase alpha?</li>
<li>If needed, recompute alpha with problematic item(s) removed</li>
<li>Create a comparison table (original vs revised scale)</li>
<li>Calculate mean self-efficacy scores for the final scale</li>
<li>Create a publication-ready table with item statistics and alpha</li>
</ol>
<p><strong>Expected Results:</strong></p>
<ul>
<li>Original alpha approximately 0.72-0.78</li>
<li>Item 4 may show lower item-total correlation (r ≈ 0.25-0.35)</li>
<li>Removing item 4 might increase alpha to ~0.80-0.85</li>
<li>Mean self-efficacy score: 3.0-3.5 on 1-5 scale</li>
</ul>
<p><strong>Hints:</strong> - Use <code>psych::alpha(items)</code> for comprehensive output - Check <code>alpha_result$item.stats</code> for item-total correlations - Check <code>alpha_result$alpha.drop</code> for “alpha if deleted” - Use <code>corrplot()</code> for visualization</p>
<p><strong>Bonus:</strong> Calculate standardized alpha vs raw alpha. When are they different, and which should you report? How does scale length (number of items) affect alpha?</p>
<hr>
</section>
</section>
<section id="lab-power" class="level2">
<h2 class="anchored" data-anchor-id="lab-power">Lab 8: Power Analysis for Study Planning</h2>
<p><strong>Learning Objectives:</strong></p>
<ul>
<li>Calculate statistical power for t-tests and ANOVA</li>
<li>Determine required sample size for desired power</li>
<li>Create power curves visualizing power-sample size trade-offs</li>
<li>Justify sample size decisions in research proposals</li>
<li>Understand effect size estimation and Cohen’s benchmarks</li>
</ul>
<p><strong>Scenario:</strong> You’re planning a randomized trial comparing a new therapy (treatment) vs standard care (control) on depression scores. You need to determine the required sample size to detect a meaningful effect with 80% power.</p>
<section id="step-1-set-up-and-define-parameters" class="level3">
<h3 class="anchored" data-anchor-id="step-1-set-up-and-define-parameters">Step 1: Set Up and Define Parameters</h3>
<p>Specify effect size and significance level:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb387"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb387-1"><a href="#cb387-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb387-2"><a href="#cb387-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pwr)</span>
<span id="cb387-3"><a href="#cb387-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb387-4"><a href="#cb387-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Define study parameters</span></span>
<span id="cb387-5"><a href="#cb387-5" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span>        <span class="co"># Significance level (two-tailed)</span></span>
<span id="cb387-6"><a href="#cb387-6" aria-hidden="true" tabindex="-1"></a>power_target <span class="ot">&lt;-</span> <span class="fl">0.80</span>  <span class="co"># Desired power (80%)</span></span>
<span id="cb387-7"><a href="#cb387-7" aria-hidden="true" tabindex="-1"></a>effect_size <span class="ot">&lt;-</span> <span class="fl">0.5</span>    <span class="co"># Cohen's d = 0.5 (medium effect)</span></span>
<span id="cb387-8"><a href="#cb387-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb387-9"><a href="#cb387-9" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Study Planning Parameters:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Study Planning Parameters:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb389"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb389-1"><a href="#cb389-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Significance level (α):"</span>, alpha, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>- Significance level (α): 0.05 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb391"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb391-1"><a href="#cb391-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Desired power (1-β):"</span>, power_target, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>- Desired power (1-β): 0.8 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb393"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb393-1"><a href="#cb393-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Expected effect size (Cohen's d):"</span>, effect_size, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>- Expected effect size (Cohen's d): 0.5 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb395"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb395-1"><a href="#cb395-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Test type: Two-sample t-test (two-tailed)</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>- Test type: Two-sample t-test (two-tailed)</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb397"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb397-1"><a href="#cb397-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cohen's effect size benchmarks</span></span>
<span id="cb397-2"><a href="#cb397-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(</span>
<span id="cb397-3"><a href="#cb397-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Magnitude =</span> <span class="fu">c</span>(<span class="st">"Small"</span>, <span class="st">"Medium"</span>, <span class="st">"Large"</span>),</span>
<span id="cb397-4"><a href="#cb397-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Cohen's d</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.5</span>, <span class="fl">0.8</span>),</span>
<span id="cb397-5"><a href="#cb397-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Cohen's f (ANOVA)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.10</span>, <span class="fl">0.25</span>, <span class="fl">0.40</span>),</span>
<span id="cb397-6"><a href="#cb397-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">R² (Regression)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.09</span>, <span class="fl">0.25</span>)</span>
<span id="cb397-7"><a href="#cb397-7" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 4
  Magnitude `Cohen's d` `Cohen's f (ANOVA)` `R² (Regression)`
  &lt;chr&gt;           &lt;dbl&gt;               &lt;dbl&gt;             &lt;dbl&gt;
1 Small             0.2                0.1               0.01
2 Medium            0.5                0.25              0.09
3 Large             0.8                0.4               0.25</code></pre>
</div>
</div>
<p><strong>Checkpoint:</strong> You’ve defined α=0.05, power=0.80, and d=0.5 for planning.</p>
<hr>
</section>
<section id="step-2-calculate-required-sample-size" class="level3">
<h3 class="anchored" data-anchor-id="step-2-calculate-required-sample-size">Step 2: Calculate Required Sample Size</h3>
<p>Determine n per group for target power:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb399"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb399-1"><a href="#cb399-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Power analysis for two-sample t-test</span></span>
<span id="cb399-2"><a href="#cb399-2" aria-hidden="true" tabindex="-1"></a>power_result <span class="ot">&lt;-</span> <span class="fu">pwr.t.test</span>(</span>
<span id="cb399-3"><a href="#cb399-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">d =</span> effect_size,</span>
<span id="cb399-4"><a href="#cb399-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">sig.level =</span> alpha,</span>
<span id="cb399-5"><a href="#cb399-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">power =</span> power_target,</span>
<span id="cb399-6"><a href="#cb399-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"two.sample"</span>,</span>
<span id="cb399-7"><a href="#cb399-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">alternative =</span> <span class="st">"two.sided"</span></span>
<span id="cb399-8"><a href="#cb399-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb399-9"><a href="#cb399-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb399-10"><a href="#cb399-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(power_result)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Two-sample t test power calculation 

              n = 63.77
              d = 0.5
      sig.level = 0.05
          power = 0.8
    alternative = two.sided

NOTE: n is number in *each* group</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb401"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb401-1"><a href="#cb401-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract required n per group</span></span>
<span id="cb401-2"><a href="#cb401-2" aria-hidden="true" tabindex="-1"></a>n_per_group <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(power_result<span class="sc">$</span>n)</span>
<span id="cb401-3"><a href="#cb401-3" aria-hidden="true" tabindex="-1"></a>total_n <span class="ot">&lt;-</span> n_per_group <span class="sc">*</span> <span class="dv">2</span></span>
<span id="cb401-4"><a href="#cb401-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb401-5"><a href="#cb401-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Required Sample Size:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Required Sample Size:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb403"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb403-1"><a href="#cb403-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Per group:"</span>, n_per_group, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>- Per group: 64 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb405"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb405-1"><a href="#cb405-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Total:"</span>, total_n, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>- Total: 128 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb407"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb407-1"><a href="#cb407-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"- To detect d=%.1f with %.0f%% power at α=%.2f</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb407-2"><a href="#cb407-2" aria-hidden="true" tabindex="-1"></a>            effect_size, power_target<span class="sc">*</span><span class="dv">100</span>, alpha))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>- To detect d=0.5 with 80% power at α=0.05</code></pre>
</div>
</div>
<p><strong>Checkpoint:</strong> For d=0.5, you should need approximately n=64 per group (128 total).</p>
<hr>
</section>
<section id="step-3-create-power-curves" class="level3">
<h3 class="anchored" data-anchor-id="step-3-create-power-curves">Step 3: Create Power Curves</h3>
<p>Visualize power as a function of sample size:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb409"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb409-1"><a href="#cb409-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate power curves for different effect sizes</span></span>
<span id="cb409-2"><a href="#cb409-2" aria-hidden="true" tabindex="-1"></a>sample_sizes <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">10</span>, <span class="dv">150</span>, <span class="at">by =</span> <span class="dv">5</span>)</span>
<span id="cb409-3"><a href="#cb409-3" aria-hidden="true" tabindex="-1"></a>effect_sizes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.5</span>, <span class="fl">0.8</span>)</span>
<span id="cb409-4"><a href="#cb409-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb409-5"><a href="#cb409-5" aria-hidden="true" tabindex="-1"></a>power_curves <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(</span>
<span id="cb409-6"><a href="#cb409-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> sample_sizes,</span>
<span id="cb409-7"><a href="#cb409-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">d =</span> effect_sizes</span>
<span id="cb409-8"><a href="#cb409-8" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb409-9"><a href="#cb409-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb409-10"><a href="#cb409-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">power =</span> <span class="fu">map2_dbl</span>(d, n, <span class="sc">~</span><span class="fu">pwr.t.test</span>(</span>
<span id="cb409-11"><a href="#cb409-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">d =</span> .x, <span class="at">n =</span> .y, <span class="at">sig.level =</span> alpha,</span>
<span id="cb409-12"><a href="#cb409-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">type =</span> <span class="st">"two.sample"</span>, <span class="at">alternative =</span> <span class="st">"two.sided"</span></span>
<span id="cb409-13"><a href="#cb409-13" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">$</span>power)</span>
<span id="cb409-14"><a href="#cb409-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb409-15"><a href="#cb409-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb409-16"><a href="#cb409-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot power curves</span></span>
<span id="cb409-17"><a href="#cb409-17" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(power_curves, <span class="fu">aes</span>(<span class="at">x =</span> n, <span class="at">y =</span> power, <span class="at">color =</span> <span class="fu">factor</span>(d))) <span class="sc">+</span></span>
<span id="cb409-18"><a href="#cb409-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb409-19"><a href="#cb409-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.80</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb409-20"><a href="#cb409-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> n_per_group, <span class="at">linetype =</span> <span class="st">"dotted"</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb409-21"><a href="#cb409-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb409-22"><a href="#cb409-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"green"</span>, <span class="st">"blue"</span>, <span class="st">"purple"</span>),</span>
<span id="cb409-23"><a href="#cb409-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"d=0.2 (small)"</span>, <span class="st">"d=0.5 (medium)"</span>, <span class="st">"d=0.8 (large)"</span>)</span>
<span id="cb409-24"><a href="#cb409-24" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb409-25"><a href="#cb409-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb409-26"><a href="#cb409-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Power Curves for Two-Sample t-Test"</span>,</span>
<span id="cb409-27"><a href="#cb409-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">sprintf</span>(<span class="st">"α=%.2f, two-tailed"</span>, alpha),</span>
<span id="cb409-28"><a href="#cb409-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Sample Size (per group)"</span>,</span>
<span id="cb409-29"><a href="#cb409-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Statistical Power (1-β)"</span>,</span>
<span id="cb409-30"><a href="#cb409-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Effect Size"</span></span>
<span id="cb409-31"><a href="#cb409-31" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb409-32"><a href="#cb409-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb409-33"><a href="#cb409-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="part-g-lab-practicals_files/figure-html/lab8-power-curves-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Checkpoint:</strong> Power increases with larger n and larger effect sizes. Red line shows 80% power threshold.</p>
<hr>
</section>
<section id="step-4-explore-effect-of-alpha-on-power" class="level3">
<h3 class="anchored" data-anchor-id="step-4-explore-effect-of-alpha-on-power">Step 4: Explore Effect of Alpha on Power</h3>
<p>Compare power with different significance levels:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb410"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb410-1"><a href="#cb410-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Power for different alpha levels</span></span>
<span id="cb410-2"><a href="#cb410-2" aria-hidden="true" tabindex="-1"></a>alphas <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="fl">0.10</span>)</span>
<span id="cb410-3"><a href="#cb410-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb410-4"><a href="#cb410-4" aria-hidden="true" tabindex="-1"></a>alpha_comparison <span class="ot">&lt;-</span> <span class="fu">map_df</span>(alphas, <span class="cf">function</span>(a) {</span>
<span id="cb410-5"><a href="#cb410-5" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">pwr.t.test</span>(</span>
<span id="cb410-6"><a href="#cb410-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">d =</span> effect_size,</span>
<span id="cb410-7"><a href="#cb410-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">sig.level =</span> a,</span>
<span id="cb410-8"><a href="#cb410-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">power =</span> power_target,</span>
<span id="cb410-9"><a href="#cb410-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">"two.sample"</span></span>
<span id="cb410-10"><a href="#cb410-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb410-11"><a href="#cb410-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb410-12"><a href="#cb410-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> a,</span>
<span id="cb410-13"><a href="#cb410-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">required_n =</span> <span class="fu">ceiling</span>(result<span class="sc">$</span>n),</span>
<span id="cb410-14"><a href="#cb410-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_n =</span> <span class="fu">ceiling</span>(result<span class="sc">$</span>n) <span class="sc">*</span> <span class="dv">2</span></span>
<span id="cb410-15"><a href="#cb410-15" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb410-16"><a href="#cb410-16" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb410-17"><a href="#cb410-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb410-18"><a href="#cb410-18" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(alpha_comparison)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  alpha required_n total_n
  &lt;dbl&gt;      &lt;dbl&gt;   &lt;dbl&gt;
1  0.01         96     192
2  0.05         64     128
3  0.1          51     102</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb412"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb412-1"><a href="#cb412-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization</span></span>
<span id="cb412-2"><a href="#cb412-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(alpha_comparison, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(alpha), <span class="at">y =</span> required_n)) <span class="sc">+</span></span>
<span id="cb412-3"><a href="#cb412-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb412-4"><a href="#cb412-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> required_n), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb412-5"><a href="#cb412-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb412-6"><a href="#cb412-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Required Sample Size vs Significance Level"</span>,</span>
<span id="cb412-7"><a href="#cb412-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">sprintf</span>(<span class="st">"For d=%.1f and power=%.0f%%"</span>, </span>
<span id="cb412-8"><a href="#cb412-8" aria-hidden="true" tabindex="-1"></a>                      effect_size, power_target<span class="sc">*</span><span class="dv">100</span>),</span>
<span id="cb412-9"><a href="#cb412-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Significance Level (α)"</span>,</span>
<span id="cb412-10"><a href="#cb412-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Required n per Group"</span></span>
<span id="cb412-11"><a href="#cb412-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb412-12"><a href="#cb412-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="part-g-lab-practicals_files/figure-html/lab8-alpha-power-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Checkpoint:</strong> More stringent α (e.g., 0.01) requires larger samples to maintain 80% power.</p>
<hr>
</section>
<section id="step-5-anova-power-analysis" class="level3">
<h3 class="anchored" data-anchor-id="step-5-anova-power-analysis">Step 5: ANOVA Power Analysis</h3>
<p>Calculate power for one-way ANOVA with multiple groups:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb413"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb413-1"><a href="#cb413-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Scenario: Compare 3 groups (Control, Treatment A, Treatment B)</span></span>
<span id="cb413-2"><a href="#cb413-2" aria-hidden="true" tabindex="-1"></a>k_groups <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb413-3"><a href="#cb413-3" aria-hidden="true" tabindex="-1"></a>effect_size_anova <span class="ot">&lt;-</span> <span class="fl">0.25</span>  <span class="co"># Cohen's f = 0.25 (medium effect for ANOVA)</span></span>
<span id="cb413-4"><a href="#cb413-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb413-5"><a href="#cb413-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Power analysis for ANOVA</span></span>
<span id="cb413-6"><a href="#cb413-6" aria-hidden="true" tabindex="-1"></a>anova_result <span class="ot">&lt;-</span> <span class="fu">pwr.anova.test</span>(</span>
<span id="cb413-7"><a href="#cb413-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">k =</span> k_groups,</span>
<span id="cb413-8"><a href="#cb413-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">f =</span> effect_size_anova,</span>
<span id="cb413-9"><a href="#cb413-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">sig.level =</span> alpha,</span>
<span id="cb413-10"><a href="#cb413-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">power =</span> power_target</span>
<span id="cb413-11"><a href="#cb413-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb413-12"><a href="#cb413-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb413-13"><a href="#cb413-13" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(anova_result)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Balanced one-way analysis of variance power calculation 

              k = 3
              n = 52.4
              f = 0.25
      sig.level = 0.05
          power = 0.8

NOTE: n is number in each group</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb415"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb415-1"><a href="#cb415-1" aria-hidden="true" tabindex="-1"></a>n_per_group_anova <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(anova_result<span class="sc">$</span>n)</span>
<span id="cb415-2"><a href="#cb415-2" aria-hidden="true" tabindex="-1"></a>total_n_anova <span class="ot">&lt;-</span> n_per_group_anova <span class="sc">*</span> k_groups</span>
<span id="cb415-3"><a href="#cb415-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb415-4"><a href="#cb415-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">ANOVA Sample Size:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
ANOVA Sample Size:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb417"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb417-1"><a href="#cb417-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Groups:"</span>, k_groups, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>- Groups: 3 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb419"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb419-1"><a href="#cb419-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Per group:"</span>, n_per_group_anova, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>- Per group: 53 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb421"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb421-1"><a href="#cb421-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Total:"</span>, total_n_anova, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>- Total: 159 </code></pre>
</div>
</div>
<p><strong>Checkpoint:</strong> For f=0.25 and 3 groups, you should need approximately n=52 per group (156 total).</p>
<hr>
</section>
<section id="step-6-post-hoc-power-analysis-observed-effect" class="level3">
<h3 class="anchored" data-anchor-id="step-6-post-hoc-power-analysis-observed-effect">Step 6: Post-Hoc Power Analysis (Observed Effect)</h3>
<p>Suppose you conducted a pilot study (n=20 per group) and observed d=0.45. What was achieved power?</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb423"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb423-1"><a href="#cb423-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pilot study parameters</span></span>
<span id="cb423-2"><a href="#cb423-2" aria-hidden="true" tabindex="-1"></a>pilot_n <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb423-3"><a href="#cb423-3" aria-hidden="true" tabindex="-1"></a>observed_d <span class="ot">&lt;-</span> <span class="fl">0.45</span></span>
<span id="cb423-4"><a href="#cb423-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb423-5"><a href="#cb423-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate achieved power</span></span>
<span id="cb423-6"><a href="#cb423-6" aria-hidden="true" tabindex="-1"></a>achieved_power <span class="ot">&lt;-</span> <span class="fu">pwr.t.test</span>(</span>
<span id="cb423-7"><a href="#cb423-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">d =</span> observed_d,</span>
<span id="cb423-8"><a href="#cb423-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> pilot_n,</span>
<span id="cb423-9"><a href="#cb423-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">sig.level =</span> alpha,</span>
<span id="cb423-10"><a href="#cb423-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"two.sample"</span>,</span>
<span id="cb423-11"><a href="#cb423-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">alternative =</span> <span class="st">"two.sided"</span></span>
<span id="cb423-12"><a href="#cb423-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb423-13"><a href="#cb423-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb423-14"><a href="#cb423-14" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(achieved_power)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Two-sample t test power calculation 

              n = 20
              d = 0.45
      sig.level = 0.05
          power = 0.2838
    alternative = two.sided

NOTE: n is number in *each* group</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb425"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb425-1"><a href="#cb425-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Pilot Study Power:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Pilot Study Power:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb427"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb427-1"><a href="#cb427-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Sample size:"</span>, pilot_n, <span class="st">"per group</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>- Sample size: 20 per group</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb429"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb429-1"><a href="#cb429-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Observed effect:"</span>, observed_d, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>- Observed effect: 0.45 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb431"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb431-1"><a href="#cb431-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Achieved power:"</span>, <span class="fu">round</span>(achieved_power<span class="sc">$</span>power, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>- Achieved power: 0.284 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb433"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb433-1"><a href="#cb433-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Interpretation:"</span>, </span>
<span id="cb433-2"><a href="#cb433-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ifelse</span>(achieved_power<span class="sc">$</span>power <span class="sc">&lt;</span> <span class="fl">0.80</span>, </span>
<span id="cb433-3"><a href="#cb433-3" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Underpowered - consider larger sample for main study"</span>,</span>
<span id="cb433-4"><a href="#cb433-4" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Adequately powered"</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>- Interpretation: Underpowered - consider larger sample for main study </code></pre>
</div>
</div>
<p><strong>Checkpoint:</strong> With n=20 and d=0.45, power is only ~0.35 (35%), indicating the pilot was underpowered.</p>
<hr>
</section>
<section id="step-7-sensitivity-analysis" class="level3">
<h3 class="anchored" data-anchor-id="step-7-sensitivity-analysis">Step 7: Sensitivity Analysis</h3>
<p>For a fixed sample size, what is the minimum detectable effect (MDE)?</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb435"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb435-1"><a href="#cb435-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Available sample: n=40 per group</span></span>
<span id="cb435-2"><a href="#cb435-2" aria-hidden="true" tabindex="-1"></a>available_n <span class="ot">&lt;-</span> <span class="dv">40</span></span>
<span id="cb435-3"><a href="#cb435-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb435-4"><a href="#cb435-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Minimum detectable effect with 80% power</span></span>
<span id="cb435-5"><a href="#cb435-5" aria-hidden="true" tabindex="-1"></a>mde_result <span class="ot">&lt;-</span> <span class="fu">pwr.t.test</span>(</span>
<span id="cb435-6"><a href="#cb435-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> available_n,</span>
<span id="cb435-7"><a href="#cb435-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">sig.level =</span> alpha,</span>
<span id="cb435-8"><a href="#cb435-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">power =</span> power_target,</span>
<span id="cb435-9"><a href="#cb435-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"two.sample"</span>,</span>
<span id="cb435-10"><a href="#cb435-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">alternative =</span> <span class="st">"two.sided"</span></span>
<span id="cb435-11"><a href="#cb435-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb435-12"><a href="#cb435-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb435-13"><a href="#cb435-13" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(mde_result)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Two-sample t test power calculation 

              n = 40
              d = 0.6343
      sig.level = 0.05
          power = 0.8
    alternative = two.sided

NOTE: n is number in *each* group</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb437"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb437-1"><a href="#cb437-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Sensitivity Analysis:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Sensitivity Analysis:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb439"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb439-1"><a href="#cb439-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Available sample:"</span>, available_n, <span class="st">"per group</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>- Available sample: 40 per group</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb441"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb441-1"><a href="#cb441-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Minimum detectable effect (80% power):"</span>, <span class="fu">round</span>(mde_result<span class="sc">$</span>d, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>- Minimum detectable effect (80% power): 0.63 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb443"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb443-1"><a href="#cb443-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Interpretation: Can detect effects of d ≥"</span>, </span>
<span id="cb443-2"><a href="#cb443-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(mde_result<span class="sc">$</span>d, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>- Interpretation: Can detect effects of d ≥ 0.63 </code></pre>
</div>
</div>
<p><strong>Checkpoint:</strong> With n=40 per group, you can detect effects of d≥0.64 with 80% power (between medium and large).</p>
<hr>
</section>
<section id="step-8-create-sample-size-justification" class="level3">
<h3 class="anchored" data-anchor-id="step-8-create-sample-size-justification">Step 8: Create Sample Size Justification</h3>
<p>Write a formal justification for grant/ethics applications:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb445"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb445-1"><a href="#cb445-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Final recommended sample size</span></span>
<span id="cb445-2"><a href="#cb445-2" aria-hidden="true" tabindex="-1"></a>recommended_n <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(power_result<span class="sc">$</span>n) <span class="sc">*</span> <span class="fl">1.15</span>  <span class="co"># Add 15% for attrition</span></span>
<span id="cb445-3"><a href="#cb445-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb445-4"><a href="#cb445-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"SAMPLE SIZE JUSTIFICATION</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>SAMPLE SIZE JUSTIFICATION</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb447"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb447-1"><a href="#cb447-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"===========================</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>===========================</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb449"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb449-1"><a href="#cb449-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Research Question: Does the new therapy reduce depression scores</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Research Question: Does the new therapy reduce depression scores</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb451"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb451-1"><a href="#cb451-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"compared to standard care?</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>compared to standard care?</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb453"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb453-1"><a href="#cb453-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Statistical Test: Independent samples t-test (two-tailed)</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Statistical Test: Independent samples t-test (two-tailed)</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb455"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb455-1"><a href="#cb455-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Effect Size Estimation:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Effect Size Estimation:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb457"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb457-1"><a href="#cb457-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Based on meta-analysis (Smith et al., 2023), similar therapies</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>- Based on meta-analysis (Smith et al., 2023), similar therapies</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb459"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb459-1"><a href="#cb459-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  produce medium effects (d=0.50, range: 0.35-0.65)</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  produce medium effects (d=0.50, range: 0.35-0.65)</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb461"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb461-1"><a href="#cb461-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- We conservatively assume d=0.50</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>- We conservatively assume d=0.50</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb463"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb463-1"><a href="#cb463-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Power Analysis:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Power Analysis:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb465"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb465-1"><a href="#cb465-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"- Significance level: α=%.2f</span><span class="sc">\n</span><span class="st">"</span>, alpha))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>- Significance level: α=0.05</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb467"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb467-1"><a href="#cb467-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"- Desired power: %.0f%%</span><span class="sc">\n</span><span class="st">"</span>, power_target<span class="sc">*</span><span class="dv">100</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>- Desired power: 80%</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb469"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb469-1"><a href="#cb469-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"- Effect size: d=%.2f</span><span class="sc">\n</span><span class="st">"</span>, effect_size))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>- Effect size: d=0.50</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb471"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb471-1"><a href="#cb471-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"- Required sample: n=%d per group (%d total)</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb471-2"><a href="#cb471-2" aria-hidden="true" tabindex="-1"></a>            n_per_group, total_n))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>- Required sample: n=64 per group (128 total)</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb473"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb473-1"><a href="#cb473-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"- With 15%% attrition: n=%d per group (%d total)</span><span class="sc">\n\n</span><span class="st">"</span>,</span>
<span id="cb473-2"><a href="#cb473-2" aria-hidden="true" tabindex="-1"></a>            <span class="fu">ceiling</span>(recommended_n), <span class="fu">ceiling</span>(recommended_n)<span class="sc">*</span><span class="dv">2</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>- With 15% attrition: n=74 per group (148 total)</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb475"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb475-1"><a href="#cb475-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Justification:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Justification:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb477"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb477-1"><a href="#cb477-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"This sample size provides 80% power to detect a medium effect (d=0.50)</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>This sample size provides 80% power to detect a medium effect (d=0.50)</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb479"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb479-1"><a href="#cb479-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"at the conventional α=0.05 significance level. We will recruit</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>at the conventional α=0.05 significance level. We will recruit</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb481"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb481-1"><a href="#cb481-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"n=%d per group (accounting for expected 15%% dropout) to ensure</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb481-2"><a href="#cb481-2" aria-hidden="true" tabindex="-1"></a>            <span class="fu">ceiling</span>(recommended_n)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>n=74 per group (accounting for expected 15% dropout) to ensure</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb483"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb483-1"><a href="#cb483-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"adequate power for the primary analysis.</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>adequate power for the primary analysis.</code></pre>
</div>
</div>
<p><strong>Checkpoint:</strong> Professional justification suitable for research proposals.</p>
<hr>
</section>
<section id="discussion-questions-7" class="level3">
<h3 class="anchored" data-anchor-id="discussion-questions-7">Discussion Questions</h3>
<ol type="1">
<li><p><strong>A Priori vs Post-Hoc:</strong> Why is a priori power analysis preferred over post-hoc power analysis?</p>
<p><em>Answer: A priori analysis plans sample size before data collection, maximizing power while minimizing resources. Post-hoc analysis is circular (uses observed effect), uninformative (you already know if the result is significant), and can mislead (low power with significant result suggests lucky sample).</em></p></li>
<li><p><strong>Effect Size Estimation:</strong> How should you choose an effect size for planning?</p>
<p><em>Answer: Base on (1) prior literature/meta-analyses, (2) pilot data, (3) smallest effect of practical interest (SESOI), (4) expert judgment. Be conservative – overestimating effect size leads to underpowered studies.</em></p></li>
<li><p><strong>Trade-offs:</strong> If you can only recruit n=30 per group (not the required 64), what should you do?</p>
<p><em>Answer: Options: (1) acknowledge lower power (report achieved power), (2) increase effect size claims (detect only larger effects), (3) use more powerful design (repeated measures), (4) collaborate to increase n, (5) delay until sufficient resources available.</em></p></li>
<li><p><strong>Multiple Comparisons:</strong> How does power change with multiple outcome tests?</p>
<p><em>Answer: Multiple comparisons require adjusted alpha (e.g., Bonferroni), which decreases power for each test. Need larger samples to maintain power when testing multiple hypotheses.</em></p></li>
<li><p><strong>Reporting:</strong> What power information should you include in a paper?</p>
<p><em>Answer: For planning: a priori power analysis with effect size justification. For results: achieved sample size, observed effect size with CI. Do NOT report post-hoc power for non-significant results (it’s always low).</em></p></li>
</ol>
<hr>
</section>
<section id="key-takeaways-7" class="level3">
<h3 class="anchored" data-anchor-id="key-takeaways-7">Key Takeaways</h3>
<p>✓ <strong>A priori power analysis guides sample size planning</strong> before data collection<br>
✓ <strong>Power depends on</strong>: effect size, sample size, significance level, and test type<br>
✓ <strong>80% power is conventional minimum</strong>; 90% preferred when feasible<br>
✓ <strong>Effect size estimation is critical</strong> – base on literature, not wishful thinking<br>
✓ <strong>Power curves visualize trade-offs</strong> between n, effect size, and power<br>
✓ <strong>Account for attrition</strong> by recruiting 10-20% more than calculated n<br>
✓ <strong>Underpowered studies are unethical</strong> – they waste resources and participant time</p>
<hr>
</section>
<section id="homework-exercise-7" class="level3">
<h3 class="anchored" data-anchor-id="homework-exercise-7">Homework Exercise</h3>
<p><strong>Scenario:</strong> You’re planning a within-subjects study where n=25 participants complete a task before and after an intervention. You expect a medium effect (d=0.50) and want to know if this sample provides adequate power.</p>
<p><strong>Your Tasks:</strong></p>
<ol type="1">
<li>Calculate power for a paired t-test with n=25, d=0.50, α=0.05</li>
<li>Determine the required sample size for 80% power</li>
<li>Create a power curve showing power vs n (n=10 to 50) for d=0.3, 0.5, 0.8</li>
<li>Calculate the minimum detectable effect with n=25 and 80% power</li>
<li>Perform a sensitivity analysis: What power do you have to detect d=0.40 with n=25?</li>
<li>Compare power for paired vs independent t-tests (use n=25 per group for independent)</li>
<li>Create a table comparing required n for 70%, 80%, and 90% power (d=0.50)</li>
<li>Write a 3-4 sentence sample size justification for a grant proposal</li>
</ol>
<p><strong>Expected Results:</strong></p>
<ul>
<li>With n=25 paired, d=0.50: power ≈ 0.85 (adequately powered)</li>
<li>Required n for 80% power: approximately 27-34 (paired t-test)</li>
<li>Minimum detectable effect: d ≈ 0.57-0.58</li>
<li>Paired design is more powerful than independent (requires ~60% fewer participants)</li>
</ul>
<p><strong>Hints:</strong> - Use <code>pwr.t.test()</code> with <code>type = "paired"</code> for within-subjects - Use <code>map_df()</code> or loops to create power curves over multiple n values - For sensitivity, solve for d given n and power</p>
<p><strong>Bonus:</strong> Suppose you can only recruit n=20 (not 27). Should you proceed? Calculate the achieved power and interpret what this means for your ability to detect the expected effect. What alternatives might you consider?</p>
<hr>
</section>
</section>
<section id="lab-mice" class="level2">
<h2 class="anchored" data-anchor-id="lab-mice">Lab 9: Multiple Imputation with MICE</h2>
<p><strong>Learning Objectives:</strong></p>
<ul>
<li>Identify missing data patterns and mechanisms (MCAR, MAR, MNAR)</li>
<li>Perform multiple imputation using the MICE algorithm</li>
<li>Assess convergence through trace plots and diagnostics</li>
<li>Pool results across imputed datasets</li>
<li>Compare complete-case vs multiple imputation analyses</li>
<li>Report imputation procedures appropriately</li>
</ul>
<p><strong>Scenario:</strong> You have survey data from n=50 employees measuring job satisfaction, stress, and performance. However, 20% of values are missing due to survey non-response. You’ll use multiple imputation to handle missing data appropriately.</p>
<section id="step-1-set-up-and-create-data-with-missing-values" class="level3">
<h3 class="anchored" data-anchor-id="step-1-set-up-and-create-data-with-missing-values">Step 1: Set Up and Create Data with Missing Values</h3>
<p>Create realistic dataset with missing data:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb485"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb485-1"><a href="#cb485-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb485-2"><a href="#cb485-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mice)</span>
<span id="cb485-3"><a href="#cb485-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(naniar)  <span class="co"># For missing data visualization</span></span>
<span id="cb485-4"><a href="#cb485-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(VIM)     <span class="co"># For missing data patterns</span></span>
<span id="cb485-5"><a href="#cb485-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb485-6"><a href="#cb485-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Set seed for reproducibility</span></span>
<span id="cb485-7"><a href="#cb485-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb485-8"><a href="#cb485-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb485-9"><a href="#cb485-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Complete data (for comparison later)</span></span>
<span id="cb485-10"><a href="#cb485-10" aria-hidden="true" tabindex="-1"></a>complete_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb485-11"><a href="#cb485-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">employee_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>,</span>
<span id="cb485-12"><a href="#cb485-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">age =</span> <span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="dv">35</span>, <span class="dv">8</span>)),</span>
<span id="cb485-13"><a href="#cb485-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">tenure_years =</span> <span class="fu">round</span>(<span class="fu">runif</span>(<span class="dv">50</span>, <span class="dv">1</span>, <span class="dv">15</span>), <span class="dv">1</span>),</span>
<span id="cb485-14"><a href="#cb485-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">job_satisfaction =</span> <span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="dv">70</span>, <span class="dv">12</span>)),</span>
<span id="cb485-15"><a href="#cb485-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">stress_level =</span> <span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="dv">55</span>, <span class="dv">15</span>)),</span>
<span id="cb485-16"><a href="#cb485-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">performance_score =</span> <span class="fu">round</span>(<span class="dv">60</span> <span class="sc">+</span> <span class="fl">0.3</span> <span class="sc">*</span> job_satisfaction <span class="sc">-</span> <span class="fl">0.2</span> <span class="sc">*</span> stress_level <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="dv">0</span>, <span class="dv">8</span>))</span>
<span id="cb485-17"><a href="#cb485-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb485-18"><a href="#cb485-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb485-19"><a href="#cb485-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Introduce missing data (MAR mechanism)</span></span>
<span id="cb485-20"><a href="#cb485-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Higher stress predicts missingness in job_satisfaction</span></span>
<span id="cb485-21"><a href="#cb485-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Lower performance predicts missingness in stress_level</span></span>
<span id="cb485-22"><a href="#cb485-22" aria-hidden="true" tabindex="-1"></a>survey_data <span class="ot">&lt;-</span> complete_data <span class="sc">%&gt;%</span></span>
<span id="cb485-23"><a href="#cb485-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb485-24"><a href="#cb485-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">job_satisfaction =</span> <span class="fu">if_else</span>(</span>
<span id="cb485-25"><a href="#cb485-25" aria-hidden="true" tabindex="-1"></a>      stress_level <span class="sc">&gt;</span> <span class="dv">60</span> <span class="sc">&amp;</span> <span class="fu">runif</span>(<span class="dv">50</span>) <span class="sc">&lt;</span> <span class="fl">0.3</span>, </span>
<span id="cb485-26"><a href="#cb485-26" aria-hidden="true" tabindex="-1"></a>      <span class="cn">NA_real_</span>, </span>
<span id="cb485-27"><a href="#cb485-27" aria-hidden="true" tabindex="-1"></a>      job_satisfaction</span>
<span id="cb485-28"><a href="#cb485-28" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb485-29"><a href="#cb485-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">stress_level =</span> <span class="fu">if_else</span>(</span>
<span id="cb485-30"><a href="#cb485-30" aria-hidden="true" tabindex="-1"></a>      performance_score <span class="sc">&lt;</span> <span class="dv">65</span> <span class="sc">&amp;</span> <span class="fu">runif</span>(<span class="dv">50</span>) <span class="sc">&lt;</span> <span class="fl">0.25</span>,</span>
<span id="cb485-31"><a href="#cb485-31" aria-hidden="true" tabindex="-1"></a>      <span class="cn">NA_real_</span>,</span>
<span id="cb485-32"><a href="#cb485-32" aria-hidden="true" tabindex="-1"></a>      stress_level</span>
<span id="cb485-33"><a href="#cb485-33" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb485-34"><a href="#cb485-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">performance_score =</span> <span class="fu">if_else</span>(</span>
<span id="cb485-35"><a href="#cb485-35" aria-hidden="true" tabindex="-1"></a>      <span class="fu">runif</span>(<span class="dv">50</span>) <span class="sc">&lt;</span> <span class="fl">0.15</span>,</span>
<span id="cb485-36"><a href="#cb485-36" aria-hidden="true" tabindex="-1"></a>      <span class="cn">NA_real_</span>,</span>
<span id="cb485-37"><a href="#cb485-37" aria-hidden="true" tabindex="-1"></a>      performance_score</span>
<span id="cb485-38"><a href="#cb485-38" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb485-39"><a href="#cb485-39" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb485-40"><a href="#cb485-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb485-41"><a href="#cb485-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Missing data summary</span></span>
<span id="cb485-42"><a href="#cb485-42" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Missing Data Summary:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Missing Data Summary:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb487"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb487-1"><a href="#cb487-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(survey_data)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  employee_id        age        tenure_years   job_satisfaction  stress_level 
 Min.   : 1.0   Min.   :21.0   Min.   : 1.10   Min.   :47.0     Min.   :26.0  
 1st Qu.:13.2   1st Qu.:32.0   1st Qu.: 4.58   1st Qu.:57.2     1st Qu.:44.0  
 Median :25.5   Median :35.5   Median :10.00   Median :66.5     Median :54.0  
 Mean   :25.5   Mean   :36.2   Mean   : 8.58   Mean   :67.7     Mean   :54.8  
 3rd Qu.:37.8   3rd Qu.:41.0   3rd Qu.:11.30   3rd Qu.:76.8     3rd Qu.:68.0  
 Max.   :50.0   Max.   :58.0   Max.   :14.50   Max.   :88.0     Max.   :89.0  
                                               NA's   :8        NA's   :5     
 performance_score
 Min.   :47.0     
 1st Qu.:63.2     
 Median :71.0     
 Mean   :70.3     
 3rd Qu.:77.0     
 Max.   :89.0     
 NA's   :8        </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb489"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb489-1"><a href="#cb489-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Proportion missing per variable</span></span>
<span id="cb489-2"><a href="#cb489-2" aria-hidden="true" tabindex="-1"></a><span class="fu">miss_var_summary</span>(survey_data)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  variable          n_miss pct_miss
  &lt;chr&gt;              &lt;int&gt;    &lt;num&gt;
1 job_satisfaction       8       16
2 performance_score      8       16
3 stress_level           5       10
4 employee_id            0        0
5 age                    0        0
6 tenure_years           0        0</code></pre>
</div>
</div>
<p><strong>Checkpoint:</strong> You should have ~20% missing data across job_satisfaction, stress_level, and performance_score.</p>
<hr>
</section>
<section id="step-2-visualize-missing-data-patterns" class="level3">
<h3 class="anchored" data-anchor-id="step-2-visualize-missing-data-patterns">Step 2: Visualize Missing Data Patterns</h3>
<p>Examine patterns and mechanisms:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb491"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb491-1"><a href="#cb491-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Missing data pattern visualization</span></span>
<span id="cb491-2"><a href="#cb491-2" aria-hidden="true" tabindex="-1"></a><span class="fu">gg_miss_var</span>(survey_data) <span class="sc">+</span></span>
<span id="cb491-3"><a href="#cb491-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Missing Data by Variable"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="part-g-lab-practicals_files/figure-html/lab9-patterns-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb492"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb492-1"><a href="#cb492-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Missing data pattern combinations</span></span>
<span id="cb492-2"><a href="#cb492-2" aria-hidden="true" tabindex="-1"></a>md_pattern <span class="ot">&lt;-</span> <span class="fu">md.pattern</span>(survey_data, <span class="at">rotate.names =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="part-g-lab-practicals_files/figure-html/lab9-patterns-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb493"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb493-1"><a href="#cb493-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Upset plot showing missing combinations</span></span>
<span id="cb493-2"><a href="#cb493-2" aria-hidden="true" tabindex="-1"></a><span class="fu">gg_miss_upset</span>(survey_data)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="part-g-lab-practicals_files/figure-html/lab9-patterns-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb494"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb494-1"><a href="#cb494-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check relationships between missingness and observed values</span></span>
<span id="cb494-2"><a href="#cb494-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Is missingness related to other variables? (MAR test)</span></span>
<span id="cb494-3"><a href="#cb494-3" aria-hidden="true" tabindex="-1"></a>survey_data <span class="sc">%&gt;%</span></span>
<span id="cb494-4"><a href="#cb494-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb494-5"><a href="#cb494-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">satisfaction_missing =</span> <span class="fu">is.na</span>(job_satisfaction),</span>
<span id="cb494-6"><a href="#cb494-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">stress_missing =</span> <span class="fu">is.na</span>(stress_level)</span>
<span id="cb494-7"><a href="#cb494-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb494-8"><a href="#cb494-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(satisfaction_missing) <span class="sc">%&gt;%</span></span>
<span id="cb494-9"><a href="#cb494-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb494-10"><a href="#cb494-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb494-11"><a href="#cb494-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_stress_observed =</span> <span class="fu">mean</span>(stress_level, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb494-12"><a href="#cb494-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_age =</span> <span class="fu">mean</span>(age, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb494-13"><a href="#cb494-13" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  satisfaction_missing     n mean_stress_observed mean_age
  &lt;lgl&gt;                &lt;int&gt;                &lt;dbl&gt;    &lt;dbl&gt;
1 FALSE                   42                 51.8     35.6
2 TRUE                     8                 70.9     39.2</code></pre>
</div>
</div>
<p><strong>Checkpoint:</strong> You should see that missingness is not completely random (MAR mechanism confirmed).</p>
<p><strong>Discussion:</strong> What’s the difference between MCAR (Missing Completely at Random), MAR (Missing at Random), and MNAR (Missing Not at Random)?</p>
<hr>
</section>
<section id="step-3-perform-multiple-imputation" class="level3">
<h3 class="anchored" data-anchor-id="step-3-perform-multiple-imputation">Step 3: Perform Multiple Imputation</h3>
<p>Run MICE algorithm with m=20 imputations:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb496"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb496-1"><a href="#cb496-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up imputation</span></span>
<span id="cb496-2"><a href="#cb496-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Exclude employee_id from imputation model</span></span>
<span id="cb496-3"><a href="#cb496-3" aria-hidden="true" tabindex="-1"></a>impute_vars <span class="ot">&lt;-</span> survey_data <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>employee_id)</span>
<span id="cb496-4"><a href="#cb496-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb496-5"><a href="#cb496-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Run MICE</span></span>
<span id="cb496-6"><a href="#cb496-6" aria-hidden="true" tabindex="-1"></a><span class="co"># m = 20 imputed datasets</span></span>
<span id="cb496-7"><a href="#cb496-7" aria-hidden="true" tabindex="-1"></a><span class="co"># maxit = 20 iterations</span></span>
<span id="cb496-8"><a href="#cb496-8" aria-hidden="true" tabindex="-1"></a><span class="co"># method = "pmm" (predictive mean matching) for continuous variables</span></span>
<span id="cb496-9"><a href="#cb496-9" aria-hidden="true" tabindex="-1"></a>mice_result <span class="ot">&lt;-</span> <span class="fu">mice</span>(</span>
<span id="cb496-10"><a href="#cb496-10" aria-hidden="true" tabindex="-1"></a>  impute_vars,</span>
<span id="cb496-11"><a href="#cb496-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">m =</span> <span class="dv">20</span>,</span>
<span id="cb496-12"><a href="#cb496-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">maxit =</span> <span class="dv">20</span>,</span>
<span id="cb496-13"><a href="#cb496-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"pmm"</span>,</span>
<span id="cb496-14"><a href="#cb496-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">2025</span>,</span>
<span id="cb496-15"><a href="#cb496-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">print =</span> <span class="cn">FALSE</span></span>
<span id="cb496-16"><a href="#cb496-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb496-17"><a href="#cb496-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb496-18"><a href="#cb496-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary of imputation</span></span>
<span id="cb496-19"><a href="#cb496-19" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(mice_result)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Class: mids
Number of multiple imputations:  20 
Imputation methods:
              age      tenure_years  job_satisfaction      stress_level 
               ""                ""             "pmm"             "pmm" 
performance_score 
            "pmm" 
PredictorMatrix:
                  age tenure_years job_satisfaction stress_level
age                 0            1                1            1
tenure_years        1            0                1            1
job_satisfaction    1            1                0            1
stress_level        1            1                1            0
performance_score   1            1                1            1
                  performance_score
age                               1
tenure_years                      1
job_satisfaction                  1
stress_level                      1
performance_score                 0</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb498"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb498-1"><a href="#cb498-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check imputation methods used</span></span>
<span id="cb498-2"><a href="#cb498-2" aria-hidden="true" tabindex="-1"></a>mice_result<span class="sc">$</span>method</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>              age      tenure_years  job_satisfaction      stress_level 
               ""                ""             "pmm"             "pmm" 
performance_score 
            "pmm" </code></pre>
</div>
</div>
<p><strong>Checkpoint:</strong> MICE should complete 20 imputations with 20 iterations each. Method “pmm” used for continuous variables.</p>
<hr>
</section>
<section id="step-4-check-convergence-diagnostics" class="level3">
<h3 class="anchored" data-anchor-id="step-4-check-convergence-diagnostics">Step 4: Check Convergence Diagnostics</h3>
<p>Assess whether MICE algorithm converged:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb500"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb500-1"><a href="#cb500-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Trace plots (should show mixing without trends)</span></span>
<span id="cb500-2"><a href="#cb500-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mice_result, <span class="fu">c</span>(<span class="st">"job_satisfaction"</span>, <span class="st">"stress_level"</span>, <span class="st">"performance_score"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="part-g-lab-practicals_files/figure-html/lab9-convergence-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb501"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb501-1"><a href="#cb501-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternative: ggplot version for publication</span></span>
<span id="cb501-2"><a href="#cb501-2" aria-hidden="true" tabindex="-1"></a>convergence_data <span class="ot">&lt;-</span> mice_result<span class="sc">$</span>chainMean <span class="sc">%&gt;%</span></span>
<span id="cb501-3"><a href="#cb501-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb501-4"><a href="#cb501-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">iteration =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb501-5"><a href="#cb501-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>iteration, <span class="at">names_to =</span> <span class="st">"variable"</span>, <span class="at">values_to =</span> <span class="st">"mean"</span>)</span>
<span id="cb501-6"><a href="#cb501-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb501-7"><a href="#cb501-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(convergence_data, <span class="fu">aes</span>(<span class="at">x =</span> iteration, <span class="at">y =</span> mean, <span class="at">color =</span> variable)) <span class="sc">+</span></span>
<span id="cb501-8"><a href="#cb501-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb501-9"><a href="#cb501-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>variable, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb501-10"><a href="#cb501-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb501-11"><a href="#cb501-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"MICE Convergence: Trace Plots of Imputed Means"</span>,</span>
<span id="cb501-12"><a href="#cb501-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Lines should stabilize and mix (no trends)"</span>,</span>
<span id="cb501-13"><a href="#cb501-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Iteration"</span>, <span class="at">y =</span> <span class="st">"Mean of Imputed Values"</span></span>
<span id="cb501-14"><a href="#cb501-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb501-15"><a href="#cb501-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb501-16"><a href="#cb501-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="part-g-lab-practicals_files/figure-html/lab9-convergence-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Checkpoint:</strong> Trace plots should show stable streams without upward/downward trends (convergence achieved).</p>
<p><strong>Discussion:</strong> What would non-convergence look like? What should you do if chains don’t converge?</p>
<hr>
</section>
<section id="step-5-inspect-imputed-values" class="level3">
<h3 class="anchored" data-anchor-id="step-5-inspect-imputed-values">Step 5: Inspect Imputed Values</h3>
<p>Check plausibility of imputed data:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb502"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb502-1"><a href="#cb502-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare distributions: observed vs imputed</span></span>
<span id="cb502-2"><a href="#cb502-2" aria-hidden="true" tabindex="-1"></a><span class="fu">densityplot</span>(mice_result, <span class="sc">~</span>job_satisfaction <span class="sc">+</span> stress_level <span class="sc">+</span> performance_score)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="part-g-lab-practicals_files/figure-html/lab9-inspect-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb503"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb503-1"><a href="#cb503-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatterplot: observed (blue) vs imputed (red)</span></span>
<span id="cb503-2"><a href="#cb503-2" aria-hidden="true" tabindex="-1"></a><span class="fu">xyplot</span>(mice_result, </span>
<span id="cb503-3"><a href="#cb503-3" aria-hidden="true" tabindex="-1"></a>       job_satisfaction <span class="sc">~</span> stress_level <span class="sc">+</span> performance_score,</span>
<span id="cb503-4"><a href="#cb503-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">20</span>), </span>
<span id="cb503-5"><a href="#cb503-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">cex =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">1.5</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="part-g-lab-practicals_files/figure-html/lab9-inspect-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb504"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb504-1"><a href="#cb504-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Numerical comparison</span></span>
<span id="cb504-2"><a href="#cb504-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract first imputed dataset</span></span>
<span id="cb504-3"><a href="#cb504-3" aria-hidden="true" tabindex="-1"></a>imputed_data_1 <span class="ot">&lt;-</span> <span class="fu">complete</span>(mice_result, <span class="dv">1</span>)</span>
<span id="cb504-4"><a href="#cb504-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb504-5"><a href="#cb504-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare observed vs imputed distributions</span></span>
<span id="cb504-6"><a href="#cb504-6" aria-hidden="true" tabindex="-1"></a>comparison_summary <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb504-7"><a href="#cb504-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Variable =</span> <span class="fu">c</span>(<span class="st">"job_satisfaction"</span>, <span class="st">"stress_level"</span>, <span class="st">"performance_score"</span>),</span>
<span id="cb504-8"><a href="#cb504-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">Observed_Mean =</span> <span class="fu">c</span>(</span>
<span id="cb504-9"><a href="#cb504-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mean</span>(survey_data<span class="sc">$</span>job_satisfaction, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb504-10"><a href="#cb504-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mean</span>(survey_data<span class="sc">$</span>stress_level, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb504-11"><a href="#cb504-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mean</span>(survey_data<span class="sc">$</span>performance_score, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb504-12"><a href="#cb504-12" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb504-13"><a href="#cb504-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">Imputed_Mean =</span> <span class="fu">c</span>(</span>
<span id="cb504-14"><a href="#cb504-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mean</span>(imputed_data_1<span class="sc">$</span>job_satisfaction),</span>
<span id="cb504-15"><a href="#cb504-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mean</span>(imputed_data_1<span class="sc">$</span>stress_level),</span>
<span id="cb504-16"><a href="#cb504-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mean</span>(imputed_data_1<span class="sc">$</span>performance_score)</span>
<span id="cb504-17"><a href="#cb504-17" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb504-18"><a href="#cb504-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">Observed_SD =</span> <span class="fu">c</span>(</span>
<span id="cb504-19"><a href="#cb504-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sd</span>(survey_data<span class="sc">$</span>job_satisfaction, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb504-20"><a href="#cb504-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sd</span>(survey_data<span class="sc">$</span>stress_level, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb504-21"><a href="#cb504-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sd</span>(survey_data<span class="sc">$</span>performance_score, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb504-22"><a href="#cb504-22" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb504-23"><a href="#cb504-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">Imputed_SD =</span> <span class="fu">c</span>(</span>
<span id="cb504-24"><a href="#cb504-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sd</span>(imputed_data_1<span class="sc">$</span>job_satisfaction),</span>
<span id="cb504-25"><a href="#cb504-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sd</span>(imputed_data_1<span class="sc">$</span>stress_level),</span>
<span id="cb504-26"><a href="#cb504-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sd</span>(imputed_data_1<span class="sc">$</span>performance_score)</span>
<span id="cb504-27"><a href="#cb504-27" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb504-28"><a href="#cb504-28" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb504-29"><a href="#cb504-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb504-30"><a href="#cb504-30" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(comparison_summary)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
  Variable          Observed_Mean Imputed_Mean Observed_SD Imputed_SD
  &lt;chr&gt;                     &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;      &lt;dbl&gt;
1 job_satisfaction           67.7         69.1       11.7        11.8
2 stress_level               54.8         54.9       15.6        15.3
3 performance_score          70.3         69.4        9.56       10.1</code></pre>
</div>
</div>
<p><strong>Checkpoint:</strong> Imputed values should be plausible (within observed range) and distributions should be similar to observed data.</p>
<hr>
</section>
<section id="step-6-analyze-imputed-data-and-pool-results" class="level3">
<h3 class="anchored" data-anchor-id="step-6-analyze-imputed-data-and-pool-results">Step 6: Analyze Imputed Data and Pool Results</h3>
<p>Fit regression model across all imputed datasets:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb506"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb506-1"><a href="#cb506-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Research question: Does job satisfaction predict performance,</span></span>
<span id="cb506-2"><a href="#cb506-2" aria-hidden="true" tabindex="-1"></a><span class="co"># controlling for stress and age?</span></span>
<span id="cb506-3"><a href="#cb506-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb506-4"><a href="#cb506-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit model to each imputed dataset</span></span>
<span id="cb506-5"><a href="#cb506-5" aria-hidden="true" tabindex="-1"></a>fitted_models <span class="ot">&lt;-</span> <span class="fu">with</span>(mice_result, </span>
<span id="cb506-6"><a href="#cb506-6" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">lm</span>(performance_score <span class="sc">~</span> job_satisfaction <span class="sc">+</span> stress_level <span class="sc">+</span> age))</span>
<span id="cb506-7"><a href="#cb506-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb506-8"><a href="#cb506-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Pool results using Rubin's rules</span></span>
<span id="cb506-9"><a href="#cb506-9" aria-hidden="true" tabindex="-1"></a>pooled_results <span class="ot">&lt;-</span> <span class="fu">pool</span>(fitted_models)</span>
<span id="cb506-10"><a href="#cb506-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb506-11"><a href="#cb506-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary of pooled estimates</span></span>
<span id="cb506-12"><a href="#cb506-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pooled_results, <span class="at">conf.int =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>              term estimate std.error statistic    df    p.value   2.5 %
1      (Intercept)  62.3151  11.20395    5.5619 31.75 0.00000397 39.4865
2 job_satisfaction   0.4007   0.11897    3.3682 25.67 0.00239443  0.1560
3     stress_level  -0.2742   0.08975   -3.0546 22.27 0.00575630 -0.4602
4              age  -0.1111   0.17250   -0.6441 24.93 0.52537872 -0.4664
    97.5 % conf.low conf.high
1 85.14378  39.4865  85.14378
2  0.64542   0.1560   0.64542
3 -0.08815  -0.4602  -0.08815
4  0.24421  -0.4664   0.24421</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb508"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb508-1"><a href="#cb508-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract key statistics</span></span>
<span id="cb508-2"><a href="#cb508-2" aria-hidden="true" tabindex="-1"></a>pooled_summary <span class="ot">&lt;-</span> <span class="fu">summary</span>(pooled_results, <span class="at">conf.int =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb508-3"><a href="#cb508-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb508-4"><a href="#cb508-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb508-5"><a href="#cb508-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">term =</span> term,</span>
<span id="cb508-6"><a href="#cb508-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">estimate =</span> <span class="fu">round</span>(estimate, <span class="dv">3</span>),</span>
<span id="cb508-7"><a href="#cb508-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">std.error =</span> <span class="fu">round</span>(std.error, <span class="dv">3</span>),</span>
<span id="cb508-8"><a href="#cb508-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">statistic =</span> <span class="fu">round</span>(statistic, <span class="dv">2</span>),</span>
<span id="cb508-9"><a href="#cb508-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">p.value =</span> <span class="fu">round</span>(p.value, <span class="dv">4</span>),</span>
<span id="cb508-10"><a href="#cb508-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">95% CI</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sprintf</span>(<span class="st">"[%.2f, %.2f]"</span>, <span class="st">`</span><span class="at">2.5 %</span><span class="st">`</span>, <span class="st">`</span><span class="at">97.5 %</span><span class="st">`</span>)</span>
<span id="cb508-11"><a href="#cb508-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb508-12"><a href="#cb508-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(term, estimate, std.error, statistic, p.value, <span class="st">`</span><span class="at">95% CI</span><span class="st">`</span>)</span>
<span id="cb508-13"><a href="#cb508-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb508-14"><a href="#cb508-14" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pooled_summary)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 6
  term             estimate std.error statistic p.value `95% CI`      
  &lt;fct&gt;               &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;         
1 (Intercept)        62.3      11.2        5.56  0      [39.49, 85.14]
2 job_satisfaction    0.401     0.119      3.37  0.0024 [0.16, 0.65]  
3 stress_level       -0.274     0.09      -3.05  0.0058 [-0.46, -0.09]
4 age                -0.111     0.172     -0.64  0.525  [-0.47, 0.24] </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb510"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb510-1"><a href="#cb510-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fraction of missing information (FMI)</span></span>
<span id="cb510-2"><a href="#cb510-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Higher FMI = more uncertainty due to missing data</span></span>
<span id="cb510-3"><a href="#cb510-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pool.r.squared</span>(fitted_models)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>      est  lo 95  hi 95   fmi
R^2 0.416 0.1384 0.6647 0.432</code></pre>
</div>
</div>
<p><strong>Checkpoint:</strong> Pooled regression results should show relationship between job satisfaction and performance, with appropriate standard errors accounting for imputation uncertainty.</p>
<hr>
</section>
<section id="step-7-compare-with-complete-case-analysis" class="level3">
<h3 class="anchored" data-anchor-id="step-7-compare-with-complete-case-analysis">Step 7: Compare with Complete-Case Analysis</h3>
<p>Contrast MI results with naive complete-case deletion:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb512"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb512-1"><a href="#cb512-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Complete-case analysis (list-wise deletion)</span></span>
<span id="cb512-2"><a href="#cb512-2" aria-hidden="true" tabindex="-1"></a>complete_case_data <span class="ot">&lt;-</span> survey_data <span class="sc">%&gt;%</span> </span>
<span id="cb512-3"><a href="#cb512-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>employee_id) <span class="sc">%&gt;%</span></span>
<span id="cb512-4"><a href="#cb512-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>()</span>
<span id="cb512-5"><a href="#cb512-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb512-6"><a href="#cb512-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Sample sizes:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Sample sizes:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb514"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb514-1"><a href="#cb514-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Complete-case analysis:"</span>, <span class="fu">nrow</span>(complete_case_data), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>- Complete-case analysis: 32 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb516"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb516-1"><a href="#cb516-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Multiple imputation:"</span>, <span class="fu">nrow</span>(survey_data), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>- Multiple imputation: 50 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb518"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb518-1"><a href="#cb518-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Cases lost:"</span>, <span class="fu">nrow</span>(survey_data) <span class="sc">-</span> <span class="fu">nrow</span>(complete_case_data), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>- Cases lost: 18 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb520"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb520-1"><a href="#cb520-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit complete-case model</span></span>
<span id="cb520-2"><a href="#cb520-2" aria-hidden="true" tabindex="-1"></a>cc_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(performance_score <span class="sc">~</span> job_satisfaction <span class="sc">+</span> stress_level <span class="sc">+</span> age,</span>
<span id="cb520-3"><a href="#cb520-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> complete_case_data)</span>
<span id="cb520-4"><a href="#cb520-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb520-5"><a href="#cb520-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare estimates</span></span>
<span id="cb520-6"><a href="#cb520-6" aria-hidden="true" tabindex="-1"></a>comparison_table <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb520-7"><a href="#cb520-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Predictor =</span> <span class="fu">c</span>(<span class="st">"Intercept"</span>, <span class="st">"Job Satisfaction"</span>, <span class="st">"Stress Level"</span>, <span class="st">"Age"</span>),</span>
<span id="cb520-8"><a href="#cb520-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">CC_Estimate =</span> <span class="fu">round</span>(<span class="fu">coef</span>(cc_model), <span class="dv">3</span>),</span>
<span id="cb520-9"><a href="#cb520-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">CC_SE =</span> <span class="fu">round</span>(<span class="fu">summary</span>(cc_model)<span class="sc">$</span>coef[, <span class="dv">2</span>], <span class="dv">3</span>),</span>
<span id="cb520-10"><a href="#cb520-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">MI_Estimate =</span> <span class="fu">round</span>(<span class="fu">summary</span>(pooled_results)<span class="sc">$</span>estimate, <span class="dv">3</span>),</span>
<span id="cb520-11"><a href="#cb520-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">MI_SE =</span> <span class="fu">round</span>(<span class="fu">summary</span>(pooled_results)<span class="sc">$</span>std.error, <span class="dv">3</span>),</span>
<span id="cb520-12"><a href="#cb520-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">Difference =</span> <span class="fu">round</span>(<span class="fu">abs</span>(<span class="fu">coef</span>(cc_model) <span class="sc">-</span> <span class="fu">summary</span>(pooled_results)<span class="sc">$</span>estimate), <span class="dv">3</span>)</span>
<span id="cb520-13"><a href="#cb520-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb520-14"><a href="#cb520-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb520-15"><a href="#cb520-15" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(comparison_table)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 6
  Predictor        CC_Estimate  CC_SE MI_Estimate  MI_SE Difference
  &lt;chr&gt;                  &lt;dbl&gt;  &lt;dbl&gt;       &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt;
1 Intercept             69.2   11.1        62.3   11.2        6.91 
2 Job Satisfaction       0.424  0.113       0.401  0.119      0.023
3 Stress Level          -0.32   0.09       -0.274  0.09       0.046
4 Age                   -0.256  0.168      -0.111  0.172      0.145</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb522"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb522-1"><a href="#cb522-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization</span></span>
<span id="cb522-2"><a href="#cb522-2" aria-hidden="true" tabindex="-1"></a>comparison_long <span class="ot">&lt;-</span> comparison_table <span class="sc">%&gt;%</span></span>
<span id="cb522-3"><a href="#cb522-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Predictor, CC_Estimate, MI_Estimate) <span class="sc">%&gt;%</span></span>
<span id="cb522-4"><a href="#cb522-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Predictor <span class="sc">!=</span> <span class="st">"Intercept"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb522-5"><a href="#cb522-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>Predictor, <span class="at">names_to =</span> <span class="st">"Method"</span>, <span class="at">values_to =</span> <span class="st">"Estimate"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb522-6"><a href="#cb522-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Method =</span> <span class="fu">recode</span>(Method, </span>
<span id="cb522-7"><a href="#cb522-7" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"CC_Estimate"</span> <span class="ot">=</span> <span class="st">"Complete Case"</span>,</span>
<span id="cb522-8"><a href="#cb522-8" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"MI_Estimate"</span> <span class="ot">=</span> <span class="st">"Multiple Imputation"</span>))</span>
<span id="cb522-9"><a href="#cb522-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb522-10"><a href="#cb522-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(comparison_long, <span class="fu">aes</span>(<span class="at">x =</span> Predictor, <span class="at">y =</span> Estimate, <span class="at">fill =</span> Method)) <span class="sc">+</span></span>
<span id="cb522-11"><a href="#cb522-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb522-12"><a href="#cb522-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb522-13"><a href="#cb522-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Complete-Case vs Multiple Imputation"</span>,</span>
<span id="cb522-14"><a href="#cb522-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Regression Coefficient Estimates"</span>,</span>
<span id="cb522-15"><a href="#cb522-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Coefficient Estimate"</span></span>
<span id="cb522-16"><a href="#cb522-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb522-17"><a href="#cb522-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb522-18"><a href="#cb522-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="part-g-lab-practicals_files/figure-html/lab9-comparison-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Checkpoint:</strong> Complete-case analysis loses power (smaller n) and may produce biased estimates if data are MAR. MI preserves full sample and accounts for uncertainty.</p>
<hr>
</section>
<section id="step-8-report-imputation-procedures" class="level3">
<h3 class="anchored" data-anchor-id="step-8-report-imputation-procedures">Step 8: Report Imputation Procedures</h3>
<p>Create publication-ready summary:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb523"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb523-1"><a href="#cb523-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb523-2"><a href="#cb523-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb523-3"><a href="#cb523-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Publication table</span></span>
<span id="cb523-4"><a href="#cb523-4" aria-hidden="true" tabindex="-1"></a>pooled_summary <span class="sc">%&gt;%</span></span>
<span id="cb523-5"><a href="#cb523-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb523-6"><a href="#cb523-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb523-7"><a href="#cb523-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Multiple Imputation Regression Results"</span>,</span>
<span id="cb523-8"><a href="#cb523-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Predicting Employee Performance (N=50, m=20 imputations)"</span></span>
<span id="cb523-9"><a href="#cb523-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb523-10"><a href="#cb523-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(</span>
<span id="cb523-11"><a href="#cb523-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">term =</span> <span class="st">"Predictor"</span>,</span>
<span id="cb523-12"><a href="#cb523-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">estimate =</span> <span class="st">"B"</span>,</span>
<span id="cb523-13"><a href="#cb523-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">std.error =</span> <span class="st">"SE"</span>,</span>
<span id="cb523-14"><a href="#cb523-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">statistic =</span> <span class="st">"t"</span>,</span>
<span id="cb523-15"><a href="#cb523-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">p.value =</span> <span class="st">"p"</span></span>
<span id="cb523-16"><a href="#cb523-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb523-17"><a href="#cb523-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_footnote</span>(</span>
<span id="cb523-18"><a href="#cb523-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">footnote =</span> <span class="st">"Multiple imputation performed using MICE (predictive mean matching)"</span>,</span>
<span id="cb523-19"><a href="#cb523-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_column_labels</span>(<span class="at">columns =</span> <span class="st">"estimate"</span>)</span>
<span id="cb523-20"><a href="#cb523-20" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb523-21"><a href="#cb523-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_footnote</span>(</span>
<span id="cb523-22"><a href="#cb523-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">footnote =</span> <span class="fu">sprintf</span>(<span class="st">"Missing data: job_satisfaction (%.0f%%), stress_level (%.0f%%), performance_score (%.0f%%)"</span>,</span>
<span id="cb523-23"><a href="#cb523-23" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">mean</span>(<span class="fu">is.na</span>(survey_data<span class="sc">$</span>job_satisfaction))<span class="sc">*</span><span class="dv">100</span>,</span>
<span id="cb523-24"><a href="#cb523-24" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">mean</span>(<span class="fu">is.na</span>(survey_data<span class="sc">$</span>stress_level))<span class="sc">*</span><span class="dv">100</span>,</span>
<span id="cb523-25"><a href="#cb523-25" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">mean</span>(<span class="fu">is.na</span>(survey_data<span class="sc">$</span>performance_score))<span class="sc">*</span><span class="dv">100</span>),</span>
<span id="cb523-26"><a href="#cb523-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_title</span>()</span>
<span id="cb523-27"><a href="#cb523-27" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="tdaqckqnwb" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#tdaqckqnwb table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#tdaqckqnwb thead, #tdaqckqnwb tbody, #tdaqckqnwb tfoot, #tdaqckqnwb tr, #tdaqckqnwb td, #tdaqckqnwb th {
  border-style: none;
}

#tdaqckqnwb p {
  margin: 0;
  padding: 0;
}

#tdaqckqnwb .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#tdaqckqnwb .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#tdaqckqnwb .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#tdaqckqnwb .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#tdaqckqnwb .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#tdaqckqnwb .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tdaqckqnwb .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#tdaqckqnwb .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#tdaqckqnwb .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#tdaqckqnwb .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#tdaqckqnwb .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#tdaqckqnwb .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#tdaqckqnwb .gt_spanner_row {
  border-bottom-style: hidden;
}

#tdaqckqnwb .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#tdaqckqnwb .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#tdaqckqnwb .gt_from_md > :first-child {
  margin-top: 0;
}

#tdaqckqnwb .gt_from_md > :last-child {
  margin-bottom: 0;
}

#tdaqckqnwb .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#tdaqckqnwb .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#tdaqckqnwb .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#tdaqckqnwb .gt_row_group_first td {
  border-top-width: 2px;
}

#tdaqckqnwb .gt_row_group_first th {
  border-top-width: 2px;
}

#tdaqckqnwb .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#tdaqckqnwb .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#tdaqckqnwb .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#tdaqckqnwb .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tdaqckqnwb .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#tdaqckqnwb .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#tdaqckqnwb .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#tdaqckqnwb .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#tdaqckqnwb .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tdaqckqnwb .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#tdaqckqnwb .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#tdaqckqnwb .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#tdaqckqnwb .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#tdaqckqnwb .gt_left {
  text-align: left;
}

#tdaqckqnwb .gt_center {
  text-align: center;
}

#tdaqckqnwb .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#tdaqckqnwb .gt_font_normal {
  font-weight: normal;
}

#tdaqckqnwb .gt_font_bold {
  font-weight: bold;
}

#tdaqckqnwb .gt_font_italic {
  font-style: italic;
}

#tdaqckqnwb .gt_super {
  font-size: 65%;
}

#tdaqckqnwb .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#tdaqckqnwb .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#tdaqckqnwb .gt_indent_1 {
  text-indent: 5px;
}

#tdaqckqnwb .gt_indent_2 {
  text-indent: 10px;
}

#tdaqckqnwb .gt_indent_3 {
  text-indent: 15px;
}

#tdaqckqnwb .gt_indent_4 {
  text-indent: 20px;
}

#tdaqckqnwb .gt_indent_5 {
  text-indent: 25px;
}

#tdaqckqnwb .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#tdaqckqnwb div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading header">
<td colspan="6" class="gt_heading gt_title gt_font_normal">Multiple Imputation Regression Results<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></td>
</tr>
<tr class="gt_heading even">
<td colspan="6" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border">Predicting Employee Performance (N=50, m=20 imputations)<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></td>
</tr>
<tr class="gt_col_headings header">
<th id="term" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Predictor</th>
<th id="estimate" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">B<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>2</sup></span></th>
<th id="std.error" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">SE</th>
<th id="statistic" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">t</th>
<th id="p.value" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">p</th>
<th id="a95%-CI" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">95% CI</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_center" headers="term">(Intercept)</td>
<td class="gt_row gt_right" headers="estimate">62.315</td>
<td class="gt_row gt_right" headers="std.error">11.204</td>
<td class="gt_row gt_right" headers="statistic">5.56</td>
<td class="gt_row gt_right" headers="p.value">0.0000</td>
<td class="gt_row gt_left" headers="95% CI">[39.49, 85.14]</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="term">job_satisfaction</td>
<td class="gt_row gt_right" headers="estimate">0.401</td>
<td class="gt_row gt_right" headers="std.error">0.119</td>
<td class="gt_row gt_right" headers="statistic">3.37</td>
<td class="gt_row gt_right" headers="p.value">0.0024</td>
<td class="gt_row gt_left" headers="95% CI">[0.16, 0.65]</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="term">stress_level</td>
<td class="gt_row gt_right" headers="estimate">-0.274</td>
<td class="gt_row gt_right" headers="std.error">0.090</td>
<td class="gt_row gt_right" headers="statistic">-3.05</td>
<td class="gt_row gt_right" headers="p.value">0.0058</td>
<td class="gt_row gt_left" headers="95% CI">[-0.46, -0.09]</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="term">age</td>
<td class="gt_row gt_right" headers="estimate">-0.111</td>
<td class="gt_row gt_right" headers="std.error">0.172</td>
<td class="gt_row gt_right" headers="statistic">-0.64</td>
<td class="gt_row gt_right" headers="p.value">0.5254</td>
<td class="gt_row gt_left" headers="95% CI">[-0.47, 0.24]</td>
</tr>
</tbody><tfoot class="gt_footnotes">
<tr class="odd">
<td colspan="6" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> Missing data: job_satisfaction (16%), stress_level (10%), performance_score (16%)</td>
</tr>
<tr class="even">
<td colspan="6" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>2</sup></span> Multiple imputation performed using MICE (predictive mean matching)</td>
</tr>
</tfoot>

</table>

</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb524"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb524-1"><a href="#cb524-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample methods statement</span></span>
<span id="cb524-2"><a href="#cb524-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Sample Methods Statement:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Sample Methods Statement:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb526"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb526-1"><a href="#cb526-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Missing data were handled using multiple imputation (MI) with the</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Missing data were handled using multiple imputation (MI) with the</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb528"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb528-1"><a href="#cb528-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"MICE algorithm (van Buuren &amp; Groothuis-Oudshoorn, 2011). Variables</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>MICE algorithm (van Buuren &amp; Groothuis-Oudshoorn, 2011). Variables</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb530"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb530-1"><a href="#cb530-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"ranged from"</span>, <span class="fu">round</span>(<span class="fu">min</span>(<span class="fu">miss_var_summary</span>(survey_data)<span class="sc">$</span>pct_miss), <span class="dv">1</span>), </span>
<span id="cb530-2"><a href="#cb530-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"% to"</span>, <span class="fu">round</span>(<span class="fu">max</span>(<span class="fu">miss_var_summary</span>(survey_data)<span class="sc">$</span>pct_miss), <span class="dv">1</span>), </span>
<span id="cb530-3"><a href="#cb530-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"% missing.</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>ranged from 0 % to 16 % missing.</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb532"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb532-1"><a href="#cb532-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"We generated m=20 imputed datasets using predictive mean matching</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>We generated m=20 imputed datasets using predictive mean matching</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb534"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb534-1"><a href="#cb534-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"(PMM) with 20 iterations. Convergence diagnostics (trace plots)</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>(PMM) with 20 iterations. Convergence diagnostics (trace plots)</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb536"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb536-1"><a href="#cb536-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"indicated adequate convergence. Regression analyses were performed</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>indicated adequate convergence. Regression analyses were performed</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb538"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb538-1"><a href="#cb538-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"on each imputed dataset, and results were pooled using Rubin's rules.</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>on each imputed dataset, and results were pooled using Rubin's rules.</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb540"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb540-1"><a href="#cb540-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Complete-case analysis (n="</span>, <span class="fu">nrow</span>(complete_case_data), </span>
<span id="cb540-2"><a href="#cb540-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">") yielded similar results,</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Complete-case analysis (n= 32 ) yielded similar results,</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb542"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb542-1"><a href="#cb542-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"but MI retained the full sample (N=50) and appropriately quantified</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>but MI retained the full sample (N=50) and appropriately quantified</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb544"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb544-1"><a href="#cb544-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"uncertainty due to missing data.</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>uncertainty due to missing data.</code></pre>
</div>
</div>
<p><strong>Checkpoint:</strong> Professional reporting following MI best practices.</p>
<hr>
</section>
<section id="discussion-questions-8" class="level3">
<h3 class="anchored" data-anchor-id="discussion-questions-8">Discussion Questions</h3>
<ol type="1">
<li><p><strong>Missing Data Mechanisms:</strong> How can you determine if data are MCAR, MAR, or MNAR?</p>
<p><em>Answer: Use Little’s MCAR test (null hypothesis: data are MCAR), examine correlations between missingness indicators and observed variables (MAR if related), and consider theory (MNAR if missingness depends on unobserved values). MNAR cannot be tested statistically and requires assumptions.</em></p></li>
<li><p><strong>Number of Imputations:</strong> Why use m=20 imputations instead of the traditional m=5?</p>
<p><em>Answer: Modern recommendations suggest m ≥ 20 (or equal to percentage missing) for more stable estimates and better power. More imputations improve precision and reproducibility, especially with high missingness or small samples.</em></p></li>
<li><p><strong>PMM vs Other Methods:</strong> Why use predictive mean matching (pmm) instead of regression imputation?</p>
<p><em>Answer: PMM imputes actual observed values (not predictions), preserving data distribution and avoiding impossible values (e.g., negative scores). Regression imputation can produce out-of-range values and underestimate variability.</em></p></li>
<li><p><strong>When Not to Use MI:</strong> Are there situations where you shouldn’t use multiple imputation?</p>
<p><em>Answer: (1) MNAR data (requires specialized models), (2) &gt;40-50% missing (insufficient information), (3) key variables completely missing for subgroups, (4) missing data on outcome only (can bias estimates), (5) when missingness IS the research question.</em></p></li>
<li><p><strong>Complete-Case Bias:</strong> Why might complete-case analysis produce biased results even if data are MAR?</p>
<p><em>Answer: Complete-case deletion excludes systematically different cases (e.g., those with high stress), reducing generalizability and potentially biasing estimates. MI uses all available information and maintains proper statistical relationships.</em></p></li>
</ol>
<hr>
</section>
<section id="key-takeaways-8" class="level3">
<h3 class="anchored" data-anchor-id="key-takeaways-8">Key Takeaways</h3>
<p>✓ <strong>Missing data are common in small samples</strong> – handle appropriately, don’t ignore<br>
✓ <strong>Multiple imputation preserves sample size</strong> and accounts for uncertainty<br>
✓ <strong>MICE is flexible</strong>: handles different variable types and missing patterns<br>
✓ <strong>Check convergence</strong>: Trace plots must show stable streams without trends<br>
✓ <strong>Imputed values should be plausible</strong> – visually inspect distributions<br>
✓ <strong>Pool results using Rubin’s rules</strong> – don’t analyze single imputed dataset<br>
✓ <strong>Always report imputation procedures</strong>: m, iterations, methods, convergence</p>
<hr>
</section>
<section id="homework-exercise-8" class="level3">
<h3 class="anchored" data-anchor-id="homework-exercise-8">Homework Exercise</h3>
<p><strong>Dataset:</strong> A quality improvement study (n=35) measuring patient satisfaction, wait time, and treatment effectiveness. Data have ~25% missingness.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb546"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb546-1"><a href="#cb546-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">789</span>)</span>
<span id="cb546-2"><a href="#cb546-2" aria-hidden="true" tabindex="-1"></a>patient_data_complete <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb546-3"><a href="#cb546-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">patient_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">35</span>,</span>
<span id="cb546-4"><a href="#cb546-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">age =</span> <span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="dv">35</span>, <span class="dv">55</span>, <span class="dv">12</span>)),</span>
<span id="cb546-5"><a href="#cb546-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">wait_time_mins =</span> <span class="fu">round</span>(<span class="fu">runif</span>(<span class="dv">35</span>, <span class="dv">10</span>, <span class="dv">90</span>)),</span>
<span id="cb546-6"><a href="#cb546-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">satisfaction_score =</span> <span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="dv">35</span>, <span class="dv">75</span>, <span class="dv">15</span>)),</span>
<span id="cb546-7"><a href="#cb546-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">effectiveness_score =</span> <span class="fu">round</span>(<span class="dv">70</span> <span class="sc">+</span> <span class="fl">0.2</span> <span class="sc">*</span> satisfaction_score <span class="sc">-</span> <span class="fl">0.1</span> <span class="sc">*</span> wait_time_mins <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">35</span>, <span class="dv">0</span>, <span class="dv">10</span>))</span>
<span id="cb546-8"><a href="#cb546-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb546-9"><a href="#cb546-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb546-10"><a href="#cb546-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Introduce MAR missingness</span></span>
<span id="cb546-11"><a href="#cb546-11" aria-hidden="true" tabindex="-1"></a>patient_data <span class="ot">&lt;-</span> patient_data_complete <span class="sc">%&gt;%</span></span>
<span id="cb546-12"><a href="#cb546-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb546-13"><a href="#cb546-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">satisfaction_score =</span> <span class="fu">if_else</span>(wait_time_mins <span class="sc">&gt;</span> <span class="dv">60</span> <span class="sc">&amp;</span> <span class="fu">runif</span>(<span class="dv">35</span>) <span class="sc">&lt;</span> <span class="fl">0.35</span>, <span class="cn">NA_real_</span>, satisfaction_score),</span>
<span id="cb546-14"><a href="#cb546-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">effectiveness_score =</span> <span class="fu">if_else</span>(satisfaction_score <span class="sc">&lt;</span> <span class="dv">65</span> <span class="sc">&amp;</span> <span class="fu">runif</span>(<span class="dv">35</span>) <span class="sc">&lt;</span> <span class="fl">0.30</span>, <span class="cn">NA_real_</span>, effectiveness_score),</span>
<span id="cb546-15"><a href="#cb546-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">wait_time_mins =</span> <span class="fu">if_else</span>(<span class="fu">runif</span>(<span class="dv">35</span>) <span class="sc">&lt;</span> <span class="fl">0.20</span>, <span class="cn">NA_real_</span>, wait_time_mins)</span>
<span id="cb546-16"><a href="#cb546-16" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p><strong>Your Tasks:</strong></p>
<ol type="1">
<li>Calculate the proportion of missing data for each variable</li>
<li>Visualize missing data patterns using <code>gg_miss_upset()</code> and <code>md.pattern()</code></li>
<li>Perform multiple imputation with m=25 imputations, 25 iterations</li>
<li>Create trace plots and assess convergence</li>
<li>Inspect imputed values using <code>densityplot()</code> – are they plausible?</li>
<li>Fit a regression model predicting effectiveness from satisfaction and wait time</li>
<li>Pool results across imputed datasets</li>
<li>Compare MI results with complete-case analysis (report both n’s and estimates)</li>
<li>Create a publication-ready table of pooled regression results</li>
<li>Write a methods paragraph describing the imputation procedure</li>
</ol>
<p><strong>Expected Results:</strong></p>
<ul>
<li>~25-30% missing across variables</li>
<li>Good convergence (stable trace plots)</li>
<li>Satisfaction positively predicts effectiveness (β ≈ 0.15-0.25)</li>
<li>Wait time negatively predicts effectiveness (β ≈ -0.08 to -0.15)</li>
<li>Complete-case n ≈ 20-25 (vs N=35 for MI)</li>
<li>MI standard errors slightly larger than complete-case (accounting for imputation uncertainty)</li>
</ul>
<p><strong>Hints:</strong> - Use <code>miss_var_summary(data)</code> for missing percentages - Check <code>mice_result$loggedEvents</code> for any imputation warnings - Extract pooled R² with <code>pool.r.squared(fitted_models)</code> - Compare FMI (fraction of missing information) across predictors</p>
<p><strong>Bonus:</strong> Perform a sensitivity analysis by re-running MICE with different methods (e.g., “norm” for Bayesian linear regression instead of “pmm”). Do results substantively change? What does this reveal about robustness of findings?</p>
<hr>
</section>
</section>
<section id="lab-screening" class="level2">
<h2 class="anchored" data-anchor-id="lab-screening">Lab 10: Data Screening and Outlier Detection</h2>
<p><strong>Learning Objectives:</strong></p>
<ul>
<li>Screen small-sample data for outliers using multiple methods</li>
<li>Apply univariate detection (z-scores, boxplots, Tukey fences)</li>
<li>Use multivariate detection (Mahalanobis distance, Cook’s D)</li>
<li>Assess normality assumptions with Q-Q plots and tests</li>
<li>Make principled decisions about outlier treatment</li>
<li>Document data screening procedures for transparency</li>
</ul>
<p><strong>Scenario:</strong> You have collected cognitive performance data (n=30) from a pilot intervention study. Before analysis, you need to screen for outliers, assess normality, and check for influential cases that might distort results.</p>
<section id="step-1-set-up-and-load-data-3" class="level3">
<h3 class="anchored" data-anchor-id="step-1-set-up-and-load-data-3">Step 1: Set Up and Load Data</h3>
<p>Create dataset with some outliers:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb547"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb547-1"><a href="#cb547-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb547-2"><a href="#cb547-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)        <span class="co"># For outlier tests</span></span>
<span id="cb547-3"><a href="#cb547-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performance) <span class="co"># For check_outliers()</span></span>
<span id="cb547-4"><a href="#cb547-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MVN)        <span class="co"># For multivariate normality</span></span>
<span id="cb547-5"><a href="#cb547-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb547-6"><a href="#cb547-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Set seed for reproducibility</span></span>
<span id="cb547-7"><a href="#cb547-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb547-8"><a href="#cb547-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb547-9"><a href="#cb547-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data with outliers</span></span>
<span id="cb547-10"><a href="#cb547-10" aria-hidden="true" tabindex="-1"></a>cognitive_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb547-11"><a href="#cb547-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">participant_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>,</span>
<span id="cb547-12"><a href="#cb547-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">age =</span> <span class="fu">c</span>(<span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="dv">28</span>, <span class="dv">25</span>, <span class="dv">4</span>)), <span class="dv">45</span>, <span class="dv">50</span>),  <span class="co"># 2 age outliers</span></span>
<span id="cb547-13"><a href="#cb547-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">baseline_score =</span> <span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="dv">30</span>, <span class="dv">50</span>, <span class="dv">8</span>)),</span>
<span id="cb547-14"><a href="#cb547-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">post_score =</span> <span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="dv">30</span>, <span class="dv">55</span>, <span class="dv">9</span>)),</span>
<span id="cb547-15"><a href="#cb547-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">improvement =</span> post_score <span class="sc">-</span> baseline_score</span>
<span id="cb547-16"><a href="#cb547-16" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb547-17"><a href="#cb547-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb547-18"><a href="#cb547-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add one multivariate outlier (high age, low scores)</span></span>
<span id="cb547-19"><a href="#cb547-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">baseline_score =</span> <span class="fu">if_else</span>(participant_id <span class="sc">==</span> <span class="dv">29</span>, <span class="dv">25</span>, baseline_score),</span>
<span id="cb547-20"><a href="#cb547-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">post_score =</span> <span class="fu">if_else</span>(participant_id <span class="sc">==</span> <span class="dv">29</span>, <span class="dv">28</span>, post_score),</span>
<span id="cb547-21"><a href="#cb547-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">improvement =</span> post_score <span class="sc">-</span> baseline_score</span>
<span id="cb547-22"><a href="#cb547-22" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb547-23"><a href="#cb547-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb547-24"><a href="#cb547-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Descriptive statistics</span></span>
<span id="cb547-25"><a href="#cb547-25" aria-hidden="true" tabindex="-1"></a>cognitive_data <span class="sc">%&gt;%</span></span>
<span id="cb547-26"><a href="#cb547-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>participant_id) <span class="sc">%&gt;%</span></span>
<span id="cb547-27"><a href="#cb547-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>      age       baseline_score   post_score    improvement    
 Min.   :18.0   Min.   :25.0   Min.   :28.0   Min.   :-14.00  
 1st Qu.:24.0   1st Qu.:43.5   1st Qu.:47.2   1st Qu.: -5.75  
 Median :25.5   Median :51.5   Median :50.5   Median :  2.00  
 Mean   :27.3   Mean   :49.8   Mean   :52.0   Mean   :  2.20  
 3rd Qu.:28.0   3rd Qu.:57.0   3rd Qu.:58.5   3rd Qu.: 11.00  
 Max.   :50.0   Max.   :65.0   Max.   :70.0   Max.   : 28.00  </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb549"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb549-1"><a href="#cb549-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize raw data</span></span>
<span id="cb549-2"><a href="#cb549-2" aria-hidden="true" tabindex="-1"></a>cognitive_data <span class="sc">%&gt;%</span></span>
<span id="cb549-3"><a href="#cb549-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(age, baseline_score, post_score, improvement) <span class="sc">%&gt;%</span></span>
<span id="cb549-4"><a href="#cb549-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">"variable"</span>, <span class="at">values_to =</span> <span class="st">"value"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb549-5"><a href="#cb549-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> variable, <span class="at">y =</span> value)) <span class="sc">+</span></span>
<span id="cb549-6"><a href="#cb549-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">"lightblue"</span>) <span class="sc">+</span></span>
<span id="cb549-7"><a href="#cb549-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb549-8"><a href="#cb549-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Variables (Boxplots)"</span>,</span>
<span id="cb549-9"><a href="#cb549-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Variable"</span>, <span class="at">y =</span> <span class="st">"Value"</span>) <span class="sc">+</span></span>
<span id="cb549-10"><a href="#cb549-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb549-11"><a href="#cb549-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="part-g-lab-practicals_files/figure-html/lab10-data-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Checkpoint:</strong> You should see n=30 participants with visible outliers in age and possibly in scores.</p>
<hr>
</section>
<section id="step-2-univariate-outlier-detection-with-z-scores" class="level3">
<h3 class="anchored" data-anchor-id="step-2-univariate-outlier-detection-with-z-scores">Step 2: Univariate Outlier Detection with Z-Scores</h3>
<p>Identify outliers using standardized scores:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb550"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb550-1"><a href="#cb550-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate z-scores for all numeric variables</span></span>
<span id="cb550-2"><a href="#cb550-2" aria-hidden="true" tabindex="-1"></a>cognitive_zscores <span class="ot">&lt;-</span> cognitive_data <span class="sc">%&gt;%</span></span>
<span id="cb550-3"><a href="#cb550-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb550-4"><a href="#cb550-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">z_age =</span> <span class="fu">scale</span>(age)[,<span class="dv">1</span>],</span>
<span id="cb550-5"><a href="#cb550-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">z_baseline =</span> <span class="fu">scale</span>(baseline_score)[,<span class="dv">1</span>],</span>
<span id="cb550-6"><a href="#cb550-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">z_post =</span> <span class="fu">scale</span>(post_score)[,<span class="dv">1</span>],</span>
<span id="cb550-7"><a href="#cb550-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">z_improvement =</span> <span class="fu">scale</span>(improvement)[,<span class="dv">1</span>]</span>
<span id="cb550-8"><a href="#cb550-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb550-9"><a href="#cb550-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb550-10"><a href="#cb550-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Flag outliers (|z| &gt; 3.0 for small samples, or &gt; 2.5)</span></span>
<span id="cb550-11"><a href="#cb550-11" aria-hidden="true" tabindex="-1"></a>threshold <span class="ot">&lt;-</span> <span class="fl">2.5</span></span>
<span id="cb550-12"><a href="#cb550-12" aria-hidden="true" tabindex="-1"></a>outliers_zscore <span class="ot">&lt;-</span> cognitive_zscores <span class="sc">%&gt;%</span></span>
<span id="cb550-13"><a href="#cb550-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb550-14"><a href="#cb550-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">outlier_age =</span> <span class="fu">abs</span>(z_age) <span class="sc">&gt;</span> threshold,</span>
<span id="cb550-15"><a href="#cb550-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">outlier_baseline =</span> <span class="fu">abs</span>(z_baseline) <span class="sc">&gt;</span> threshold,</span>
<span id="cb550-16"><a href="#cb550-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">outlier_post =</span> <span class="fu">abs</span>(z_post) <span class="sc">&gt;</span> threshold,</span>
<span id="cb550-17"><a href="#cb550-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">outlier_improvement =</span> <span class="fu">abs</span>(z_improvement) <span class="sc">&gt;</span> threshold,</span>
<span id="cb550-18"><a href="#cb550-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">any_outlier =</span> outlier_age <span class="sc">|</span> outlier_baseline <span class="sc">|</span> outlier_post <span class="sc">|</span> outlier_improvement</span>
<span id="cb550-19"><a href="#cb550-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb550-20"><a href="#cb550-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb550-21"><a href="#cb550-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary of outliers</span></span>
<span id="cb550-22"><a href="#cb550-22" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Z-Score Outliers (|z| &gt;"</span>, threshold, <span class="st">"):</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Z-Score Outliers (|z| &gt; 2.5 ):</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb552"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb552-1"><a href="#cb552-1" aria-hidden="true" tabindex="-1"></a>outliers_zscore <span class="sc">%&gt;%</span></span>
<span id="cb552-2"><a href="#cb552-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(any_outlier) <span class="sc">%&gt;%</span></span>
<span id="cb552-3"><a href="#cb552-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(participant_id, age, z_age, baseline_score, z_baseline, </span>
<span id="cb552-4"><a href="#cb552-4" aria-hidden="true" tabindex="-1"></a>         post_score, z_post, improvement, z_improvement)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 9
  participant_id   age z_age baseline_score z_baseline post_score z_post
           &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;          &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;  &lt;dbl&gt;
1             29    45  2.63             25     -2.74          28 -2.35 
2             30    50  3.37             43     -0.754         46 -0.590
# ℹ 2 more variables: improvement &lt;dbl&gt;, z_improvement &lt;dbl&gt;</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb554"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb554-1"><a href="#cb554-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Count outliers per variable</span></span>
<span id="cb554-2"><a href="#cb554-2" aria-hidden="true" tabindex="-1"></a>outliers_zscore <span class="sc">%&gt;%</span></span>
<span id="cb554-3"><a href="#cb554-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb554-4"><a href="#cb554-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">age_outliers =</span> <span class="fu">sum</span>(outlier_age),</span>
<span id="cb554-5"><a href="#cb554-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">baseline_outliers =</span> <span class="fu">sum</span>(outlier_baseline),</span>
<span id="cb554-6"><a href="#cb554-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">post_outliers =</span> <span class="fu">sum</span>(outlier_post),</span>
<span id="cb554-7"><a href="#cb554-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">improvement_outliers =</span> <span class="fu">sum</span>(outlier_improvement),</span>
<span id="cb554-8"><a href="#cb554-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_flagged =</span> <span class="fu">sum</span>(any_outlier)</span>
<span id="cb554-9"><a href="#cb554-9" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 5
  age_outliers baseline_outliers post_outliers improvement_outliers
         &lt;int&gt;             &lt;int&gt;         &lt;int&gt;                &lt;int&gt;
1            2                 1             0                    0
# ℹ 1 more variable: total_flagged &lt;int&gt;</code></pre>
</div>
</div>
<p><strong>Checkpoint:</strong> Participants 29 and 30 should be flagged as outliers on age; participant 29 also on baseline/post scores.</p>
<hr>
</section>
<section id="step-3-tukey-fences-boxplot-method" class="level3">
<h3 class="anchored" data-anchor-id="step-3-tukey-fences-boxplot-method">Step 3: Tukey Fences (Boxplot Method)</h3>
<p>Apply IQR-based outlier detection:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb556"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb556-1"><a href="#cb556-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to calculate Tukey fences</span></span>
<span id="cb556-2"><a href="#cb556-2" aria-hidden="true" tabindex="-1"></a>tukey_outliers <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb556-3"><a href="#cb556-3" aria-hidden="true" tabindex="-1"></a>  Q1 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(x, <span class="fl">0.25</span>)</span>
<span id="cb556-4"><a href="#cb556-4" aria-hidden="true" tabindex="-1"></a>  Q3 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(x, <span class="fl">0.75</span>)</span>
<span id="cb556-5"><a href="#cb556-5" aria-hidden="true" tabindex="-1"></a>  IQR <span class="ot">&lt;-</span> Q3 <span class="sc">-</span> Q1</span>
<span id="cb556-6"><a href="#cb556-6" aria-hidden="true" tabindex="-1"></a>  lower_fence <span class="ot">&lt;-</span> Q1 <span class="sc">-</span> <span class="fl">1.5</span> <span class="sc">*</span> IQR</span>
<span id="cb556-7"><a href="#cb556-7" aria-hidden="true" tabindex="-1"></a>  upper_fence <span class="ot">&lt;-</span> Q3 <span class="sc">+</span> <span class="fl">1.5</span> <span class="sc">*</span> IQR</span>
<span id="cb556-8"><a href="#cb556-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x <span class="sc">&lt;</span> lower_fence <span class="sc">|</span> x <span class="sc">&gt;</span> upper_fence)</span>
<span id="cb556-9"><a href="#cb556-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb556-10"><a href="#cb556-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb556-11"><a href="#cb556-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify Tukey outliers</span></span>
<span id="cb556-12"><a href="#cb556-12" aria-hidden="true" tabindex="-1"></a>cognitive_tukey <span class="ot">&lt;-</span> cognitive_data <span class="sc">%&gt;%</span></span>
<span id="cb556-13"><a href="#cb556-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb556-14"><a href="#cb556-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">tukey_age =</span> <span class="fu">tukey_outliers</span>(age),</span>
<span id="cb556-15"><a href="#cb556-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">tukey_baseline =</span> <span class="fu">tukey_outliers</span>(baseline_score),</span>
<span id="cb556-16"><a href="#cb556-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">tukey_post =</span> <span class="fu">tukey_outliers</span>(post_score),</span>
<span id="cb556-17"><a href="#cb556-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">tukey_improvement =</span> <span class="fu">tukey_outliers</span>(improvement),</span>
<span id="cb556-18"><a href="#cb556-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">any_tukey_outlier =</span> tukey_age <span class="sc">|</span> tukey_baseline <span class="sc">|</span> tukey_post <span class="sc">|</span> tukey_improvement</span>
<span id="cb556-19"><a href="#cb556-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb556-20"><a href="#cb556-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb556-21"><a href="#cb556-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary</span></span>
<span id="cb556-22"><a href="#cb556-22" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Tukey Fence Outliers:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Tukey Fence Outliers:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb558"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb558-1"><a href="#cb558-1" aria-hidden="true" tabindex="-1"></a>cognitive_tukey <span class="sc">%&gt;%</span></span>
<span id="cb558-2"><a href="#cb558-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(any_tukey_outlier) <span class="sc">%&gt;%</span></span>
<span id="cb558-3"><a href="#cb558-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(participant_id, age, tukey_age, baseline_score, tukey_baseline,</span>
<span id="cb558-4"><a href="#cb558-4" aria-hidden="true" tabindex="-1"></a>         post_score, tukey_post)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 7
  participant_id   age tukey_age baseline_score tukey_baseline post_score
           &lt;int&gt; &lt;dbl&gt; &lt;lgl&gt;              &lt;dbl&gt; &lt;lgl&gt;               &lt;dbl&gt;
1             20    35 TRUE                  51 FALSE                  69
2             23    36 TRUE                  53 FALSE                  45
3             29    45 TRUE                  25 FALSE                  28
4             30    50 TRUE                  43 FALSE                  46
# ℹ 1 more variable: tukey_post &lt;lgl&gt;</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb560"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb560-1"><a href="#cb560-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize with outliers highlighted</span></span>
<span id="cb560-2"><a href="#cb560-2" aria-hidden="true" tabindex="-1"></a>cognitive_tukey <span class="sc">%&gt;%</span></span>
<span id="cb560-3"><a href="#cb560-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> improvement, <span class="at">color =</span> any_tukey_outlier)) <span class="sc">+</span></span>
<span id="cb560-4"><a href="#cb560-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb560-5"><a href="#cb560-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">if_else</span>(any_tukey_outlier, </span>
<span id="cb560-6"><a href="#cb560-6" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">as.character</span>(participant_id), <span class="st">""</span>)),</span>
<span id="cb560-7"><a href="#cb560-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.8</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb560-8"><a href="#cb560-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"red"</span>), </span>
<span id="cb560-9"><a href="#cb560-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Normal"</span>, <span class="st">"Outlier"</span>)) <span class="sc">+</span></span>
<span id="cb560-10"><a href="#cb560-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Age vs Improvement: Tukey Outliers Highlighted"</span>,</span>
<span id="cb560-11"><a href="#cb560-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Age"</span>, <span class="at">y =</span> <span class="st">"Improvement Score"</span>, <span class="at">color =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb560-12"><a href="#cb560-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="part-g-lab-practicals_files/figure-html/lab10-tukey-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Checkpoint:</strong> Tukey method should identify similar outliers as z-scores, particularly on age variable.</p>
<hr>
</section>
<section id="step-4-multivariate-outlier-detection-mahalanobis-distance" class="level3">
<h3 class="anchored" data-anchor-id="step-4-multivariate-outlier-detection-mahalanobis-distance">Step 4: Multivariate Outlier Detection (Mahalanobis Distance)</h3>
<p>Detect cases that are outlying in multivariate space:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb561"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb561-1"><a href="#cb561-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate Mahalanobis distance</span></span>
<span id="cb561-2"><a href="#cb561-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Include age, baseline, post scores</span></span>
<span id="cb561-3"><a href="#cb561-3" aria-hidden="true" tabindex="-1"></a>outlier_vars <span class="ot">&lt;-</span> cognitive_data <span class="sc">%&gt;%</span></span>
<span id="cb561-4"><a href="#cb561-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(age, baseline_score, post_score) <span class="sc">%&gt;%</span></span>
<span id="cb561-5"><a href="#cb561-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>()</span>
<span id="cb561-6"><a href="#cb561-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb561-7"><a href="#cb561-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Center and covariance</span></span>
<span id="cb561-8"><a href="#cb561-8" aria-hidden="true" tabindex="-1"></a>center <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(outlier_vars)</span>
<span id="cb561-9"><a href="#cb561-9" aria-hidden="true" tabindex="-1"></a>cov_matrix <span class="ot">&lt;-</span> <span class="fu">cov</span>(outlier_vars)</span>
<span id="cb561-10"><a href="#cb561-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb561-11"><a href="#cb561-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Mahalanobis distances</span></span>
<span id="cb561-12"><a href="#cb561-12" aria-hidden="true" tabindex="-1"></a>mahal_dist <span class="ot">&lt;-</span> <span class="fu">mahalanobis</span>(outlier_vars, center, cov_matrix)</span>
<span id="cb561-13"><a href="#cb561-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb561-14"><a href="#cb561-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Chi-square critical value (df = number of variables)</span></span>
<span id="cb561-15"><a href="#cb561-15" aria-hidden="true" tabindex="-1"></a><span class="co"># For 3 variables, chi-sq(3, 0.001) ≈ 13.8</span></span>
<span id="cb561-16"><a href="#cb561-16" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">ncol</span>(outlier_vars)</span>
<span id="cb561-17"><a href="#cb561-17" aria-hidden="true" tabindex="-1"></a>critical_value <span class="ot">&lt;-</span> <span class="fu">qchisq</span>(<span class="fl">0.999</span>, df)  <span class="co"># p &lt; 0.001</span></span>
<span id="cb561-18"><a href="#cb561-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb561-19"><a href="#cb561-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Flag multivariate outliers</span></span>
<span id="cb561-20"><a href="#cb561-20" aria-hidden="true" tabindex="-1"></a>cognitive_mahal <span class="ot">&lt;-</span> cognitive_data <span class="sc">%&gt;%</span></span>
<span id="cb561-21"><a href="#cb561-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb561-22"><a href="#cb561-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">mahal_distance =</span> mahal_dist,</span>
<span id="cb561-23"><a href="#cb561-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">mahal_outlier =</span> mahal_dist <span class="sc">&gt;</span> critical_value,</span>
<span id="cb561-24"><a href="#cb561-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">mahal_p =</span> <span class="fu">pchisq</span>(mahal_dist, df, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb561-25"><a href="#cb561-25" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb561-26"><a href="#cb561-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb561-27"><a href="#cb561-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary</span></span>
<span id="cb561-28"><a href="#cb561-28" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Mahalanobis Distance Outliers (χ² p &lt; 0.001):</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mahalanobis Distance Outliers (χ² p &lt; 0.001):</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb563"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb563-1"><a href="#cb563-1" aria-hidden="true" tabindex="-1"></a>cognitive_mahal <span class="sc">%&gt;%</span></span>
<span id="cb563-2"><a href="#cb563-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(mahal_outlier) <span class="sc">%&gt;%</span></span>
<span id="cb563-3"><a href="#cb563-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(participant_id, age, baseline_score, post_score, </span>
<span id="cb563-4"><a href="#cb563-4" aria-hidden="true" tabindex="-1"></a>         mahal_distance, mahal_p) <span class="sc">%&gt;%</span></span>
<span id="cb563-5"><a href="#cb563-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(mahal_distance))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 0 × 6
# ℹ 6 variables: participant_id &lt;int&gt;, age &lt;dbl&gt;, baseline_score &lt;dbl&gt;,
#   post_score &lt;dbl&gt;, mahal_distance &lt;dbl&gt;, mahal_p &lt;dbl&gt;</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb565"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb565-1"><a href="#cb565-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize</span></span>
<span id="cb565-2"><a href="#cb565-2" aria-hidden="true" tabindex="-1"></a>cognitive_mahal <span class="sc">%&gt;%</span></span>
<span id="cb565-3"><a href="#cb565-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> participant_id, <span class="at">y =</span> mahal_distance, </span>
<span id="cb565-4"><a href="#cb565-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> mahal_outlier)) <span class="sc">+</span></span>
<span id="cb565-5"><a href="#cb565-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb565-6"><a href="#cb565-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> critical_value, <span class="at">linetype =</span> <span class="st">"dashed"</span>, </span>
<span id="cb565-7"><a href="#cb565-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb565-8"><a href="#cb565-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">if_else</span>(mahal_outlier, </span>
<span id="cb565-9"><a href="#cb565-9" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">as.character</span>(participant_id), <span class="st">""</span>)),</span>
<span id="cb565-10"><a href="#cb565-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.8</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb565-11"><a href="#cb565-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"red"</span>)) <span class="sc">+</span></span>
<span id="cb565-12"><a href="#cb565-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Mahalanobis Distance: Multivariate Outliers"</span>,</span>
<span id="cb565-13"><a href="#cb565-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">sprintf</span>(<span class="st">"Red line = critical value (χ²(%.0f) = %.2f)"</span>, </span>
<span id="cb565-14"><a href="#cb565-14" aria-hidden="true" tabindex="-1"></a>                         df, critical_value),</span>
<span id="cb565-15"><a href="#cb565-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Participant ID"</span>, <span class="at">y =</span> <span class="st">"Mahalanobis Distance"</span>) <span class="sc">+</span></span>
<span id="cb565-16"><a href="#cb565-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb565-17"><a href="#cb565-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="part-g-lab-practicals_files/figure-html/lab10-mahalanobis-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Checkpoint:</strong> Participant 29 should be flagged as multivariate outlier (unusual combination of high age + low scores).</p>
<hr>
</section>
<section id="step-5-influential-cases-cooks-distance" class="level3">
<h3 class="anchored" data-anchor-id="step-5-influential-cases-cooks-distance">Step 5: Influential Cases (Cook’s Distance)</h3>
<p>Identify cases with high influence on regression results:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb566"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb566-1"><a href="#cb566-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit regression model (predicting improvement from age and baseline)</span></span>
<span id="cb566-2"><a href="#cb566-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(improvement <span class="sc">~</span> age <span class="sc">+</span> baseline_score, <span class="at">data =</span> cognitive_data)</span>
<span id="cb566-3"><a href="#cb566-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb566-4"><a href="#cb566-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate Cook's distance</span></span>
<span id="cb566-5"><a href="#cb566-5" aria-hidden="true" tabindex="-1"></a>cooks_d <span class="ot">&lt;-</span> <span class="fu">cooks.distance</span>(model)</span>
<span id="cb566-6"><a href="#cb566-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb566-7"><a href="#cb566-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Flag influential cases (Cook's D &gt; 4/n threshold)</span></span>
<span id="cb566-8"><a href="#cb566-8" aria-hidden="true" tabindex="-1"></a>threshold_cooks <span class="ot">&lt;-</span> <span class="dv">4</span> <span class="sc">/</span> <span class="fu">nrow</span>(cognitive_data)</span>
<span id="cb566-9"><a href="#cb566-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb566-10"><a href="#cb566-10" aria-hidden="true" tabindex="-1"></a>cognitive_cooks <span class="ot">&lt;-</span> cognitive_data <span class="sc">%&gt;%</span></span>
<span id="cb566-11"><a href="#cb566-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb566-12"><a href="#cb566-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">cooks_d =</span> cooks_d,</span>
<span id="cb566-13"><a href="#cb566-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">influential =</span> cooks_d <span class="sc">&gt;</span> threshold_cooks</span>
<span id="cb566-14"><a href="#cb566-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb566-15"><a href="#cb566-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb566-16"><a href="#cb566-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary</span></span>
<span id="cb566-17"><a href="#cb566-17" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Influential Cases (Cook's D &gt; 4/n ="</span>, <span class="fu">round</span>(threshold_cooks, <span class="dv">3</span>), <span class="st">"):</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Influential Cases (Cook's D &gt; 4/n = 0.133 ):</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb568"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb568-1"><a href="#cb568-1" aria-hidden="true" tabindex="-1"></a>cognitive_cooks <span class="sc">%&gt;%</span></span>
<span id="cb568-2"><a href="#cb568-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(influential) <span class="sc">%&gt;%</span></span>
<span id="cb568-3"><a href="#cb568-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(participant_id, age, baseline_score, improvement, cooks_d) <span class="sc">%&gt;%</span></span>
<span id="cb568-4"><a href="#cb568-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(cooks_d))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 5
  participant_id   age baseline_score improvement cooks_d
           &lt;int&gt; &lt;dbl&gt;          &lt;dbl&gt;       &lt;dbl&gt;   &lt;dbl&gt;
1             29    45             25           3   0.522</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb570"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb570-1"><a href="#cb570-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization with Cook's distance plot</span></span>
<span id="cb570-2"><a href="#cb570-2" aria-hidden="true" tabindex="-1"></a>cognitive_cooks <span class="sc">%&gt;%</span></span>
<span id="cb570-3"><a href="#cb570-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> participant_id, <span class="at">y =</span> cooks_d, <span class="at">fill =</span> influential)) <span class="sc">+</span></span>
<span id="cb570-4"><a href="#cb570-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb570-5"><a href="#cb570-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> threshold_cooks, <span class="at">linetype =</span> <span class="st">"dashed"</span>, </span>
<span id="cb570-6"><a href="#cb570-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb570-7"><a href="#cb570-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"gray70"</span>, <span class="st">"coral"</span>)) <span class="sc">+</span></span>
<span id="cb570-8"><a href="#cb570-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Cook's Distance: Influential Cases"</span>,</span>
<span id="cb570-9"><a href="#cb570-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">sprintf</span>(<span class="st">"Threshold = 4/n = %.3f"</span>, threshold_cooks),</span>
<span id="cb570-10"><a href="#cb570-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Participant ID"</span>, <span class="at">y =</span> <span class="st">"Cook's Distance"</span>) <span class="sc">+</span></span>
<span id="cb570-11"><a href="#cb570-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb570-12"><a href="#cb570-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="part-g-lab-practicals_files/figure-html/lab10-cooks-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb571"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb571-1"><a href="#cb571-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Influence plot</span></span>
<span id="cb571-2"><a href="#cb571-2" aria-hidden="true" tabindex="-1"></a><span class="fu">influencePlot</span>(model, <span class="at">main =</span> <span class="st">"Influence Plot"</span>, </span>
<span id="cb571-3"><a href="#cb571-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">id =</span> <span class="fu">list</span>(<span class="at">n =</span> <span class="dv">3</span>, <span class="at">labels =</span> cognitive_data<span class="sc">$</span>participant_id))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="part-g-lab-practicals_files/figure-html/lab10-cooks-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   StudRes     Hat    CookD
4    0.348 0.18230 0.009302
16  -1.900 0.05275 0.061117
20   1.958 0.09471 0.121031
24   2.303 0.07912 0.130972
29  -1.639 0.38247 0.522164
30  -0.128 0.44496 0.004542</code></pre>
</div>
</div>
<p><strong>Checkpoint:</strong> Some outliers (especially participant 29) should show high Cook’s D, indicating strong influence on regression coefficients.</p>
<hr>
</section>
<section id="step-6-assess-normality-assumptions" class="level3">
<h3 class="anchored" data-anchor-id="step-6-assess-normality-assumptions">Step 6: Assess Normality Assumptions</h3>
<p>Check if data meet normality assumptions:</p>
<p><strong>Checkpoint:</strong> Age likely violates normality (due to outliers). Other variables may be approximately normal.</p>
<p><strong>Discussion:</strong> When do normality violations matter? When can you proceed despite non-normality?</p>
<hr>
</section>
<section id="step-7-compare-analyses-withwithout-outliers" class="level3">
<h3 class="anchored" data-anchor-id="step-7-compare-analyses-withwithout-outliers">Step 7: Compare Analyses With/Without Outliers</h3>
<p>Assess impact of outliers on results:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb573"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb573-1"><a href="#cb573-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Original model (with outliers)</span></span>
<span id="cb573-2"><a href="#cb573-2" aria-hidden="true" tabindex="-1"></a>model_full <span class="ot">&lt;-</span> <span class="fu">lm</span>(improvement <span class="sc">~</span> age <span class="sc">+</span> baseline_score, <span class="at">data =</span> cognitive_data)</span>
<span id="cb573-3"><a href="#cb573-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb573-4"><a href="#cb573-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Model without identified outliers</span></span>
<span id="cb573-5"><a href="#cb573-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove participants flagged by multiple methods</span></span>
<span id="cb573-6"><a href="#cb573-6" aria-hidden="true" tabindex="-1"></a>outliers_to_remove <span class="ot">&lt;-</span> cognitive_mahal <span class="sc">%&gt;%</span></span>
<span id="cb573-7"><a href="#cb573-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(mahal_outlier) <span class="sc">%&gt;%</span></span>
<span id="cb573-8"><a href="#cb573-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(participant_id)</span>
<span id="cb573-9"><a href="#cb573-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb573-10"><a href="#cb573-10" aria-hidden="true" tabindex="-1"></a>cognitive_clean <span class="ot">&lt;-</span> cognitive_data <span class="sc">%&gt;%</span></span>
<span id="cb573-11"><a href="#cb573-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>participant_id <span class="sc">%in%</span> outliers_to_remove)</span>
<span id="cb573-12"><a href="#cb573-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb573-13"><a href="#cb573-13" aria-hidden="true" tabindex="-1"></a>model_clean <span class="ot">&lt;-</span> <span class="fu">lm</span>(improvement <span class="sc">~</span> age <span class="sc">+</span> baseline_score, <span class="at">data =</span> cognitive_clean)</span>
<span id="cb573-14"><a href="#cb573-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb573-15"><a href="#cb573-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Comparison table</span></span>
<span id="cb573-16"><a href="#cb573-16" aria-hidden="true" tabindex="-1"></a>comparison <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb573-17"><a href="#cb573-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">Model =</span> <span class="fu">c</span>(<span class="st">"With Outliers"</span>, <span class="st">"Without Outliers"</span>),</span>
<span id="cb573-18"><a href="#cb573-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">N =</span> <span class="fu">c</span>(<span class="fu">nrow</span>(cognitive_data), <span class="fu">nrow</span>(cognitive_clean)),</span>
<span id="cb573-19"><a href="#cb573-19" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Intercept</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">coef</span>(model_full)[<span class="dv">1</span>], <span class="fu">coef</span>(model_clean)[<span class="dv">1</span>]),</span>
<span id="cb573-20"><a href="#cb573-20" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">β (Age)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">coef</span>(model_full)[<span class="dv">2</span>], <span class="fu">coef</span>(model_clean)[<span class="dv">2</span>]),</span>
<span id="cb573-21"><a href="#cb573-21" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">β (Baseline)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">coef</span>(model_full)[<span class="dv">3</span>], <span class="fu">coef</span>(model_clean)[<span class="dv">3</span>]),</span>
<span id="cb573-22"><a href="#cb573-22" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">R²</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">summary</span>(model_full)<span class="sc">$</span>r.squared, <span class="fu">summary</span>(model_clean)<span class="sc">$</span>r.squared),</span>
<span id="cb573-23"><a href="#cb573-23" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">RMSE</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">sigma</span>(model_full), <span class="fu">sigma</span>(model_clean))</span>
<span id="cb573-24"><a href="#cb573-24" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb573-25"><a href="#cb573-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb573-26"><a href="#cb573-26" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(comparison)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 7
  Model                N Intercept `β (Age)` `β (Baseline)`  `R²`  RMSE
  &lt;chr&gt;            &lt;int&gt;     &lt;dbl&gt;     &lt;dbl&gt;          &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 With Outliers       30      34.7    -0.102         -0.596 0.230  9.75
2 Without Outliers    30      34.7    -0.102         -0.596 0.230  9.75</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb575"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb575-1"><a href="#cb575-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization</span></span>
<span id="cb575-2"><a href="#cb575-2" aria-hidden="true" tabindex="-1"></a>comparison <span class="sc">%&gt;%</span></span>
<span id="cb575-3"><a href="#cb575-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Model, <span class="st">`</span><span class="at">β (Age)</span><span class="st">`</span>, <span class="st">`</span><span class="at">β (Baseline)</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb575-4"><a href="#cb575-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>Model, <span class="at">names_to =</span> <span class="st">"Coefficient"</span>, <span class="at">values_to =</span> <span class="st">"Estimate"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb575-5"><a href="#cb575-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Coefficient, <span class="at">y =</span> Estimate, <span class="at">fill =</span> Model)) <span class="sc">+</span></span>
<span id="cb575-6"><a href="#cb575-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb575-7"><a href="#cb575-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Regression Coefficients: With vs Without Outliers"</span>,</span>
<span id="cb575-8"><a href="#cb575-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Coefficient Estimate"</span>) <span class="sc">+</span></span>
<span id="cb575-9"><a href="#cb575-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="part-g-lab-practicals_files/figure-html/lab10-impact-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb576"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb576-1"><a href="#cb576-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Interpretation:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Interpretation:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb578"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb578-1"><a href="#cb578-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Removing outliers changed coefficients by:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing outliers changed coefficients by:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb580"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb580-1"><a href="#cb580-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Age:"</span>, <span class="fu">round</span>(<span class="fu">abs</span>(<span class="fu">coef</span>(model_full)[<span class="dv">2</span>] <span class="sc">-</span> <span class="fu">coef</span>(model_clean)[<span class="dv">2</span>]), <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>- Age: 0 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb582"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb582-1"><a href="#cb582-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Baseline:"</span>, <span class="fu">round</span>(<span class="fu">abs</span>(<span class="fu">coef</span>(model_full)[<span class="dv">3</span>] <span class="sc">-</span> <span class="fu">coef</span>(model_clean)[<span class="dv">3</span>]), <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>- Baseline: 0 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb584"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb584-1"><a href="#cb584-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- R² increased by:"</span>, </span>
<span id="cb584-2"><a href="#cb584-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>((<span class="fu">summary</span>(model_clean)<span class="sc">$</span>r.squared <span class="sc">-</span> <span class="fu">summary</span>(model_full)<span class="sc">$</span>r.squared), <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>- R² increased by: 0 </code></pre>
</div>
</div>
<p><strong>Checkpoint:</strong> Removing outliers should improve model fit (higher R²) and potentially change coefficient estimates.</p>
<hr>
</section>
<section id="step-8-document-screening-decisions" class="level3">
<h3 class="anchored" data-anchor-id="step-8-document-screening-decisions">Step 8: Document Screening Decisions</h3>
<p>Create transparent reporting:</p>
<p><strong>Checkpoint:</strong> Professional documentation suitable for methods section or supplementary materials.</p>
<hr>
</section>
<section id="discussion-questions-9" class="level3">
<h3 class="anchored" data-anchor-id="discussion-questions-9">Discussion Questions</h3>
<ol type="1">
<li><p><strong>Multiple Methods:</strong> Why use multiple outlier detection methods instead of just one?</p>
<p><em>Answer: Different methods detect different types of outliers (univariate vs multivariate, influential vs extreme). Convergent evidence from multiple methods increases confidence. Cases flagged by only one method may be borderline and warrant closer inspection.</em></p></li>
<li><p><strong>To Remove or Not:</strong> When should you remove outliers vs retain them?</p>
<p><em>Answer: Remove if: (1) data entry error (verify first), (2) procedural error (e.g., equipment malfunction), (3) not from target population. Retain if: (1) legitimate extreme values from population, (2) no clear reason for exclusion, (3) reflects real variability. Always report analyses both ways.</em></p></li>
<li><p><strong>Small Sample Impact:</strong> Why are outliers particularly problematic in small samples?</p>
<p><em>Answer: With small n, a single outlier can have disproportionate influence on means, correlations, and regression coefficients. One case can change statistical significance. Effect is diluted in large samples.</em></p></li>
<li><p><strong>Normality Violations:</strong> The Shapiro-Wilk test rejected normality, but should you still use parametric tests?</p>
<p><em>Answer: Depends on: (1) severity of violation, (2) sample size (CLT helps with larger n), (3) robustness of test (t-tests are robust to moderate non-normality), (4) availability of alternatives (nonparametric tests, transformations, robust methods).</em></p></li>
<li><p><strong>Transparency:</strong> What should you report about outlier treatment?</p>
<p><em>Answer: Report: (1) detection methods used, (2) number and identification of outliers, (3) decisions made (kept/removed), (4) justification for decisions, (5) sensitivity analyses showing results with/without outliers. Pre-register outlier criteria when possible.</em></p></li>
</ol>
<hr>
</section>
<section id="key-takeaways-9" class="level3">
<h3 class="anchored" data-anchor-id="key-takeaways-9">Key Takeaways</h3>
<p>✓ <strong>Screen data systematically</strong> using multiple detection methods<br>
✓ <strong>Univariate outliers</strong> (z-scores, Tukey) detect extreme values on single variables<br>
✓ <strong>Multivariate outliers</strong> (Mahalanobis) detect unusual combinations of values<br>
✓ <strong>Influential cases</strong> (Cook’s D) have high leverage on regression results<br>
✓ <strong>Always compare results</strong> with and without outliers (sensitivity analysis)<br>
✓ <strong>Document decisions transparently</strong> – report criteria, cases removed, justification<br>
✓ <strong>In small samples</strong>, outliers have disproportionate impact on results</p>
<hr>
</section>
<section id="homework-exercise-9" class="level3">
<h3 class="anchored" data-anchor-id="homework-exercise-9">Homework Exercise</h3>
<p><strong>Dataset:</strong> A pilot training study (n=28) measuring reaction time, accuracy, and learning rate.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb586"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb586-1"><a href="#cb586-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">321</span>)</span>
<span id="cb586-2"><a href="#cb586-2" aria-hidden="true" tabindex="-1"></a>training_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb586-3"><a href="#cb586-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">participant_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">28</span>,</span>
<span id="cb586-4"><a href="#cb586-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">reaction_time_ms =</span> <span class="fu">c</span>(<span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="dv">26</span>, <span class="dv">300</span>, <span class="dv">40</span>)), <span class="dv">150</span>, <span class="dv">520</span>),  <span class="co"># 2 outliers</span></span>
<span id="cb586-5"><a href="#cb586-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">accuracy_pct =</span> <span class="fu">c</span>(<span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="dv">26</span>, <span class="dv">85</span>, <span class="dv">8</span>)), <span class="dv">55</span>, <span class="dv">98</span>),</span>
<span id="cb586-6"><a href="#cb586-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">learning_rate =</span> <span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="dv">28</span>, <span class="dv">12</span>, <span class="dv">4</span>), <span class="dv">1</span>)</span>
<span id="cb586-7"><a href="#cb586-7" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb586-8"><a href="#cb586-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb586-9"><a href="#cb586-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add multivariate outlier</span></span>
<span id="cb586-10"><a href="#cb586-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">accuracy_pct =</span> <span class="fu">if_else</span>(participant_id <span class="sc">==</span> <span class="dv">27</span>, <span class="dv">55</span>, accuracy_pct),</span>
<span id="cb586-11"><a href="#cb586-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">learning_rate =</span> <span class="fu">if_else</span>(participant_id <span class="sc">==</span> <span class="dv">27</span>, <span class="dv">3</span>, learning_rate)</span>
<span id="cb586-12"><a href="#cb586-12" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p><strong>Your Tasks:</strong></p>
<ol type="1">
<li>Create boxplots for all three variables</li>
<li>Calculate z-scores and flag outliers (|z| &gt; 2.5)</li>
<li>Apply Tukey fences to identify IQR-based outliers</li>
<li>Calculate Mahalanobis distances and flag multivariate outliers (p &lt; .001)</li>
<li>Fit a regression model (reaction_time ~ accuracy + learning_rate) and calculate Cook’s D</li>
<li>Identify influential cases (Cook’s D &gt; 4/n)</li>
<li>Create Q-Q plots and run Shapiro-Wilk tests for normality</li>
<li>Compare regression results with vs without identified outliers</li>
<li>Create a data screening summary table</li>
<li>Write a methods paragraph documenting your screening process</li>
</ol>
<p><strong>Expected Results:</strong></p>
<ul>
<li>Participants 27 and 28 flagged by multiple methods</li>
<li>Participant 27: multivariate outlier (low accuracy + low learning rate)</li>
<li>Participant 28: univariate outlier (high reaction time)</li>
<li>Shapiro-Wilk may reject normality for reaction_time</li>
<li>Removing outliers should improve regression R² and reduce RMSE</li>
<li>At least 2-3 cases exceed Cook’s D threshold</li>
</ul>
<p><strong>Hints:</strong> - Use <code>scale()</code> for z-scores - For Mahalanobis: <code>mahalanobis(data, center, cov)</code> with <code>qchisq(0.999, df)</code> - Check <code>influencePlot(model)</code> for visual diagnostic - Compare <code>summary(model_full)</code> vs <code>summary(model_clean)</code></p>
<p><strong>Bonus:</strong> Perform a Winsorization alternative: instead of removing outliers, replace them with the value at the 5th/95th percentile. Compare results from (1) original data, (2) outliers removed, and (3) outliers Winsorized. Which approach is most conservative? Most liberal?</p>
<hr>
</section>
</section>
<section id="lab-effect-sizes" class="level2">
<h2 class="anchored" data-anchor-id="lab-effect-sizes">Lab 11: Effect Sizes and Confidence Intervals</h2>
<p><strong>Learning Objectives:</strong></p>
<ul>
<li>Calculate standardized effect sizes (Cohen’s d, r, odds ratios)</li>
<li>Compute confidence intervals for effect sizes</li>
<li>Interpret effect size magnitudes using Cohen’s benchmarks</li>
<li>Distinguish between statistical and practical significance</li>
<li>Report effect sizes following APA guidelines</li>
<li>Visualize effect sizes with forest plots</li>
</ul>
<p><strong>Scenario:</strong> You conducted a small pilot study (n=24, 12 per group) comparing two teaching methods on test scores. The results are statistically significant, but you need to quantify and interpret the effect size to assess practical importance.</p>
<section id="step-1-set-up-and-load-data-4" class="level3">
<h3 class="anchored" data-anchor-id="step-1-set-up-and-load-data-4">Step 1: Set Up and Load Data</h3>
<p>Create two-group comparison data:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb587"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb587-1"><a href="#cb587-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb587-2"><a href="#cb587-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(effsize)    <span class="co"># For effect size calculations</span></span>
<span id="cb587-3"><a href="#cb587-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MBESS)      <span class="co"># For CIs on effect sizes</span></span>
<span id="cb587-4"><a href="#cb587-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb587-5"><a href="#cb587-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb587-6"><a href="#cb587-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Set seed for reproducibility</span></span>
<span id="cb587-7"><a href="#cb587-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb587-8"><a href="#cb587-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb587-9"><a href="#cb587-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Two-group study: Method A vs Method B</span></span>
<span id="cb587-10"><a href="#cb587-10" aria-hidden="true" tabindex="-1"></a>teaching_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb587-11"><a href="#cb587-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">student_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">24</span>,</span>
<span id="cb587-12"><a href="#cb587-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Method A"</span>, <span class="st">"Method B"</span>), <span class="at">each =</span> <span class="dv">12</span>),</span>
<span id="cb587-13"><a href="#cb587-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">test_score =</span> <span class="fu">c</span>(</span>
<span id="cb587-14"><a href="#cb587-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="dv">12</span>, <span class="dv">75</span>, <span class="dv">10</span>)),  <span class="co"># Method A: M=75, SD=10</span></span>
<span id="cb587-15"><a href="#cb587-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="dv">12</span>, <span class="dv">85</span>, <span class="dv">12</span>))   <span class="co"># Method B: M=85, SD=12</span></span>
<span id="cb587-16"><a href="#cb587-16" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb587-17"><a href="#cb587-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb587-18"><a href="#cb587-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb587-19"><a href="#cb587-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Descriptive statistics</span></span>
<span id="cb587-20"><a href="#cb587-20" aria-hidden="true" tabindex="-1"></a>teaching_summary <span class="ot">&lt;-</span> teaching_data <span class="sc">%&gt;%</span></span>
<span id="cb587-21"><a href="#cb587-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(method) <span class="sc">%&gt;%</span></span>
<span id="cb587-22"><a href="#cb587-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb587-23"><a href="#cb587-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb587-24"><a href="#cb587-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">M =</span> <span class="fu">mean</span>(test_score),</span>
<span id="cb587-25"><a href="#cb587-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">SD =</span> <span class="fu">sd</span>(test_score),</span>
<span id="cb587-26"><a href="#cb587-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">SE =</span> SD <span class="sc">/</span> <span class="fu">sqrt</span>(n),</span>
<span id="cb587-27"><a href="#cb587-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb587-28"><a href="#cb587-28" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb587-29"><a href="#cb587-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb587-30"><a href="#cb587-30" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(teaching_summary)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 5
  method       n     M    SD    SE
  &lt;chr&gt;    &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 Method A    12  76.2  7.91  2.28
2 Method B    12  91.7 14.1   4.06</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb589"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb589-1"><a href="#cb589-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize raw data</span></span>
<span id="cb589-2"><a href="#cb589-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(teaching_data, <span class="fu">aes</span>(<span class="at">x =</span> method, <span class="at">y =</span> test_score, <span class="at">fill =</span> method)) <span class="sc">+</span></span>
<span id="cb589-3"><a href="#cb589-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb589-4"><a href="#cb589-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb589-5"><a href="#cb589-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"point"</span>, <span class="at">shape =</span> <span class="dv">23</span>, </span>
<span id="cb589-6"><a href="#cb589-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">4</span>, <span class="at">fill =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb589-7"><a href="#cb589-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Test Scores by Teaching Method"</span>,</span>
<span id="cb589-8"><a href="#cb589-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Teaching Method"</span>, <span class="at">y =</span> <span class="st">"Test Score"</span>) <span class="sc">+</span></span>
<span id="cb589-9"><a href="#cb589-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb589-10"><a href="#cb589-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="part-g-lab-practicals_files/figure-html/lab11-data-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Checkpoint:</strong> You should see n=12 per group with Method B showing higher mean scores.</p>
<hr>
</section>
<section id="step-2-calculate-cohens-d" class="level3">
<h3 class="anchored" data-anchor-id="step-2-calculate-cohens-d">Step 2: Calculate Cohen’s d</h3>
<p>Compute standardized mean difference:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb590"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb590-1"><a href="#cb590-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract groups</span></span>
<span id="cb590-2"><a href="#cb590-2" aria-hidden="true" tabindex="-1"></a>method_a <span class="ot">&lt;-</span> teaching_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(method <span class="sc">==</span> <span class="st">"Method A"</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(test_score)</span>
<span id="cb590-3"><a href="#cb590-3" aria-hidden="true" tabindex="-1"></a>method_b <span class="ot">&lt;-</span> teaching_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(method <span class="sc">==</span> <span class="st">"Method B"</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(test_score)</span>
<span id="cb590-4"><a href="#cb590-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb590-5"><a href="#cb590-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Cohen's d with pooled SD</span></span>
<span id="cb590-6"><a href="#cb590-6" aria-hidden="true" tabindex="-1"></a>cohen_d_result <span class="ot">&lt;-</span> <span class="fu">cohen.d</span>(method_b, method_a)</span>
<span id="cb590-7"><a href="#cb590-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cohen_d_result)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Cohen's d

d estimate: 1.358 (large)
95 percent confidence interval:
 lower  upper 
0.4188 2.2971 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb592"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb592-1"><a href="#cb592-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Manual calculation for verification</span></span>
<span id="cb592-2"><a href="#cb592-2" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(method_a)</span>
<span id="cb592-3"><a href="#cb592-3" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">mean</span>(method_b)</span>
<span id="cb592-4"><a href="#cb592-4" aria-hidden="true" tabindex="-1"></a>sd1 <span class="ot">&lt;-</span> <span class="fu">sd</span>(method_a)</span>
<span id="cb592-5"><a href="#cb592-5" aria-hidden="true" tabindex="-1"></a>sd2 <span class="ot">&lt;-</span> <span class="fu">sd</span>(method_b)</span>
<span id="cb592-6"><a href="#cb592-6" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="fu">length</span>(method_a)</span>
<span id="cb592-7"><a href="#cb592-7" aria-hidden="true" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> <span class="fu">length</span>(method_b)</span>
<span id="cb592-8"><a href="#cb592-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb592-9"><a href="#cb592-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Pooled SD</span></span>
<span id="cb592-10"><a href="#cb592-10" aria-hidden="true" tabindex="-1"></a>pooled_sd <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(((n1 <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> sd1<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (n2 <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> sd2<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> (n1 <span class="sc">+</span> n2 <span class="sc">-</span> <span class="dv">2</span>))</span>
<span id="cb592-11"><a href="#cb592-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb592-12"><a href="#cb592-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Cohen's d</span></span>
<span id="cb592-13"><a href="#cb592-13" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> (m2 <span class="sc">-</span> m1) <span class="sc">/</span> pooled_sd</span>
<span id="cb592-14"><a href="#cb592-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb592-15"><a href="#cb592-15" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Manual Calculation:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Manual Calculation:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb594"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb594-1"><a href="#cb594-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Mean difference:"</span>, <span class="fu">round</span>(m2 <span class="sc">-</span> m1, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mean difference: 15.5 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb596"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb596-1"><a href="#cb596-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Pooled SD:"</span>, <span class="fu">round</span>(pooled_sd, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Pooled SD: 11.41 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb598"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb598-1"><a href="#cb598-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Cohen's d:"</span>, <span class="fu">round</span>(d, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Cohen's d: 1.358 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb600"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb600-1"><a href="#cb600-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Interpretation using Cohen's benchmarks</span></span>
<span id="cb600-2"><a href="#cb600-2" aria-hidden="true" tabindex="-1"></a>interpretation <span class="ot">&lt;-</span> <span class="fu">case_when</span>(</span>
<span id="cb600-3"><a href="#cb600-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abs</span>(d) <span class="sc">&lt;</span> <span class="fl">0.2</span> <span class="sc">~</span> <span class="st">"Negligible"</span>,</span>
<span id="cb600-4"><a href="#cb600-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abs</span>(d) <span class="sc">&lt;</span> <span class="fl">0.5</span> <span class="sc">~</span> <span class="st">"Small"</span>,</span>
<span id="cb600-5"><a href="#cb600-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abs</span>(d) <span class="sc">&lt;</span> <span class="fl">0.8</span> <span class="sc">~</span> <span class="st">"Medium"</span>,</span>
<span id="cb600-6"><a href="#cb600-6" aria-hidden="true" tabindex="-1"></a>  <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Large"</span></span>
<span id="cb600-7"><a href="#cb600-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb600-8"><a href="#cb600-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Interpretation:"</span>, interpretation, <span class="st">"effect</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Interpretation: Large effect</code></pre>
</div>
</div>
<p><strong>Checkpoint:</strong> Cohen’s d should be approximately 0.6-0.9 (medium to large effect).</p>
<hr>
</section>
<section id="step-3-compute-confidence-interval-for-d" class="level3">
<h3 class="anchored" data-anchor-id="step-3-compute-confidence-interval-for-d">Step 3: Compute Confidence Interval for d</h3>
<p>Calculate 95% CI around the effect size:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb602"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb602-1"><a href="#cb602-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Confidence interval for Cohen's d using MBESS</span></span>
<span id="cb602-2"><a href="#cb602-2" aria-hidden="true" tabindex="-1"></a>ci_d <span class="ot">&lt;-</span> <span class="fu">ci.smd</span>(</span>
<span id="cb602-3"><a href="#cb602-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">smd =</span> d,</span>
<span id="cb602-4"><a href="#cb602-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">n.1 =</span> n1,</span>
<span id="cb602-5"><a href="#cb602-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">n.2 =</span> n2,</span>
<span id="cb602-6"><a href="#cb602-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">conf.level =</span> <span class="fl">0.95</span></span>
<span id="cb602-7"><a href="#cb602-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb602-8"><a href="#cb602-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb602-9"><a href="#cb602-9" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"95% Confidence Interval for Cohen's d:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>95% Confidence Interval for Cohen's d:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb604"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb604-1"><a href="#cb604-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"["</span>, <span class="fu">round</span>(ci_d<span class="sc">$</span>Lower.Conf.Limit.smd, <span class="dv">3</span>), <span class="st">", "</span>,</span>
<span id="cb604-2"><a href="#cb604-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(ci_d<span class="sc">$</span>Upper.Conf.Limit.smd, <span class="dv">3</span>), <span class="st">"]</span><span class="sc">\n</span><span class="st">"</span>, <span class="at">sep =</span> <span class="st">""</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[0.452, 2.24]</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb606"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb606-1"><a href="#cb606-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternative: bootstrap CI</span></span>
<span id="cb606-2"><a href="#cb606-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb606-3"><a href="#cb606-3" aria-hidden="true" tabindex="-1"></a>cohens_d_boot <span class="ot">&lt;-</span> <span class="cf">function</span>(data, indices) {</span>
<span id="cb606-4"><a href="#cb606-4" aria-hidden="true" tabindex="-1"></a>  d <span class="ot">&lt;-</span> data[indices, ]</span>
<span id="cb606-5"><a href="#cb606-5" aria-hidden="true" tabindex="-1"></a>  a <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> <span class="fu">filter</span>(method <span class="sc">==</span> <span class="st">"Method A"</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(test_score)</span>
<span id="cb606-6"><a href="#cb606-6" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> <span class="fu">filter</span>(method <span class="sc">==</span> <span class="st">"Method B"</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(test_score)</span>
<span id="cb606-7"><a href="#cb606-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb606-8"><a href="#cb606-8" aria-hidden="true" tabindex="-1"></a>  m_a <span class="ot">&lt;-</span> <span class="fu">mean</span>(a)</span>
<span id="cb606-9"><a href="#cb606-9" aria-hidden="true" tabindex="-1"></a>  m_b <span class="ot">&lt;-</span> <span class="fu">mean</span>(b)</span>
<span id="cb606-10"><a href="#cb606-10" aria-hidden="true" tabindex="-1"></a>  sd_pooled <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(((<span class="fu">length</span>(a) <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">sd</span>(a)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> </span>
<span id="cb606-11"><a href="#cb606-11" aria-hidden="true" tabindex="-1"></a>                      (<span class="fu">length</span>(b) <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">sd</span>(b)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> </span>
<span id="cb606-12"><a href="#cb606-12" aria-hidden="true" tabindex="-1"></a>                     (<span class="fu">length</span>(a) <span class="sc">+</span> <span class="fu">length</span>(b) <span class="sc">-</span> <span class="dv">2</span>))</span>
<span id="cb606-13"><a href="#cb606-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb606-14"><a href="#cb606-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>((m_b <span class="sc">-</span> m_a) <span class="sc">/</span> sd_pooled)</span>
<span id="cb606-15"><a href="#cb606-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb606-16"><a href="#cb606-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb606-17"><a href="#cb606-17" aria-hidden="true" tabindex="-1"></a>boot_result <span class="ot">&lt;-</span> <span class="fu">boot</span>(teaching_data, cohens_d_boot, <span class="at">R =</span> <span class="dv">2000</span>)</span>
<span id="cb606-18"><a href="#cb606-18" aria-hidden="true" tabindex="-1"></a>boot_ci <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(boot_result, <span class="at">type =</span> <span class="st">"bca"</span>)</span>
<span id="cb606-19"><a href="#cb606-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb606-20"><a href="#cb606-20" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Bootstrap 95% CI (BCa method):</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Bootstrap 95% CI (BCa method):</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb608"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb608-1"><a href="#cb608-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"["</span>, <span class="fu">round</span>(boot_ci<span class="sc">$</span>bca[<span class="dv">4</span>], <span class="dv">3</span>), <span class="st">", "</span>, </span>
<span id="cb608-2"><a href="#cb608-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(boot_ci<span class="sc">$</span>bca[<span class="dv">5</span>], <span class="dv">3</span>), <span class="st">"]</span><span class="sc">\n</span><span class="st">"</span>, <span class="at">sep =</span> <span class="st">""</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[0.421, 2.092]</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb610"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb610-1"><a href="#cb610-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize effect size with CI</span></span>
<span id="cb610-2"><a href="#cb610-2" aria-hidden="true" tabindex="-1"></a>effect_plot_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb610-3"><a href="#cb610-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Effect =</span> <span class="st">"Cohen's d"</span>,</span>
<span id="cb610-4"><a href="#cb610-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Estimate =</span> d,</span>
<span id="cb610-5"><a href="#cb610-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Lower =</span> ci_d<span class="sc">$</span>Lower.Conf.Limit.smd,</span>
<span id="cb610-6"><a href="#cb610-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Upper =</span> ci_d<span class="sc">$</span>Upper.Conf.Limit.smd</span>
<span id="cb610-7"><a href="#cb610-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb610-8"><a href="#cb610-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb610-9"><a href="#cb610-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(effect_plot_data, <span class="fu">aes</span>(<span class="at">x =</span> Effect, <span class="at">y =</span> Estimate)) <span class="sc">+</span></span>
<span id="cb610-10"><a href="#cb610-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb610-11"><a href="#cb610-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> Lower, <span class="at">ymax =</span> Upper), <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb610-12"><a href="#cb610-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"gray50"</span>) <span class="sc">+</span></span>
<span id="cb610-13"><a href="#cb610-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.5</span>, <span class="fl">0.8</span>), </span>
<span id="cb610-14"><a href="#cb610-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dotted"</span>, <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb610-15"><a href="#cb610-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">1.3</span>, <span class="at">y =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.5</span>, <span class="fl">0.8</span>), </span>
<span id="cb610-16"><a href="#cb610-16" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"Small"</span>, <span class="st">"Medium"</span>, <span class="st">"Large"</span>), </span>
<span id="cb610-17"><a href="#cb610-17" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb610-18"><a href="#cb610-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Effect Size with 95% Confidence Interval"</span>,</span>
<span id="cb610-19"><a href="#cb610-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Method B vs Method A"</span>,</span>
<span id="cb610-20"><a href="#cb610-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Cohen's d"</span>) <span class="sc">+</span></span>
<span id="cb610-21"><a href="#cb610-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="part-g-lab-practicals_files/figure-html/lab11-ci-d-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Checkpoint:</strong> 95% CI should exclude zero, confirming significant difference. Width reflects small sample uncertainty.</p>
<hr>
</section>
<section id="step-4-calculate-alternative-effect-sizes" class="level3">
<h3 class="anchored" data-anchor-id="step-4-calculate-alternative-effect-sizes">Step 4: Calculate Alternative Effect Sizes</h3>
<p>Compute correlation-based effect size:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb611"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb611-1"><a href="#cb611-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Point-biserial correlation (r)</span></span>
<span id="cb611-2"><a href="#cb611-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Create binary group variable (0 = Method A, 1 = Method B)</span></span>
<span id="cb611-3"><a href="#cb611-3" aria-hidden="true" tabindex="-1"></a>teaching_data_binary <span class="ot">&lt;-</span> teaching_data <span class="sc">%&gt;%</span></span>
<span id="cb611-4"><a href="#cb611-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group_code =</span> <span class="fu">if_else</span>(method <span class="sc">==</span> <span class="st">"Method A"</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb611-5"><a href="#cb611-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb611-6"><a href="#cb611-6" aria-hidden="true" tabindex="-1"></a>r_pb <span class="ot">&lt;-</span> <span class="fu">cor</span>(teaching_data_binary<span class="sc">$</span>group_code, teaching_data_binary<span class="sc">$</span>test_score)</span>
<span id="cb611-7"><a href="#cb611-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb611-8"><a href="#cb611-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Point-Biserial Correlation: r ="</span>, <span class="fu">round</span>(r_pb, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Point-Biserial Correlation: r = 0.578 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb613"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb613-1"><a href="#cb613-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert between d and r</span></span>
<span id="cb613-2"><a href="#cb613-2" aria-hidden="true" tabindex="-1"></a>r_from_d <span class="ot">&lt;-</span> d <span class="sc">/</span> <span class="fu">sqrt</span>(d<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="dv">4</span>)</span>
<span id="cb613-3"><a href="#cb613-3" aria-hidden="true" tabindex="-1"></a>d_from_r <span class="ot">&lt;-</span> (<span class="dv">2</span> <span class="sc">*</span> r_pb) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">1</span> <span class="sc">-</span> r_pb<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb613-4"><a href="#cb613-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb613-5"><a href="#cb613-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Conversion: d ="</span>, <span class="fu">round</span>(d, <span class="dv">3</span>), <span class="st">"→ r ="</span>, <span class="fu">round</span>(r_from_d, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Conversion: d = 1.358 → r = 0.562 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb615"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb615-1"><a href="#cb615-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Conversion: r ="</span>, <span class="fu">round</span>(r_pb, <span class="dv">3</span>), <span class="st">"→ d ="</span>, <span class="fu">round</span>(d_from_r, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Conversion: r = 0.578 → d = 1.418 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb617"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb617-1"><a href="#cb617-1" aria-hidden="true" tabindex="-1"></a><span class="co"># R-squared (proportion of variance explained)</span></span>
<span id="cb617-2"><a href="#cb617-2" aria-hidden="true" tabindex="-1"></a>r_squared <span class="ot">&lt;-</span> r_pb<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb617-3"><a href="#cb617-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">R² (variance explained):"</span>, <span class="fu">round</span>(r_squared, <span class="dv">3</span>), </span>
<span id="cb617-4"><a href="#cb617-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"("</span>, <span class="fu">round</span>(r_squared <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>), <span class="st">"%)</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
R² (variance explained): 0.335 ( 33.5 %)</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb619"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb619-1"><a href="#cb619-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Number Needed to Treat (NNT) approximation</span></span>
<span id="cb619-2"><a href="#cb619-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Assumes binary outcome; here illustrative only</span></span>
<span id="cb619-3"><a href="#cb619-3" aria-hidden="true" tabindex="-1"></a><span class="co"># For continuous outcome, use BESD or CLES</span></span>
<span id="cb619-4"><a href="#cb619-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb619-5"><a href="#cb619-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Common Language Effect Size (CLES)</span></span>
<span id="cb619-6"><a href="#cb619-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Probability that random Method B score &gt; Method A score</span></span>
<span id="cb619-7"><a href="#cb619-7" aria-hidden="true" tabindex="-1"></a>cles <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(d <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">2</span>))</span>
<span id="cb619-8"><a href="#cb619-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Common Language Effect Size:"</span>, <span class="fu">round</span>(cles, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Common Language Effect Size: 0.832 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb621"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb621-1"><a href="#cb621-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Interpretation:"</span>, <span class="fu">round</span>(cles <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>), </span>
<span id="cb621-2"><a href="#cb621-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"% chance Method B student scores higher</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Interpretation: 83.2 % chance Method B student scores higher</code></pre>
</div>
</div>
<p><strong>Checkpoint:</strong> Point-biserial r should be around 0.4-0.5. CLES ~70-75% (Method B advantage).</p>
<hr>
</section>
<section id="step-5-statistical-vs-practical-significance" class="level3">
<h3 class="anchored" data-anchor-id="step-5-statistical-vs-practical-significance">Step 5: Statistical vs Practical Significance</h3>
<p>Compare p-value and effect size interpretations:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb623"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb623-1"><a href="#cb623-1" aria-hidden="true" tabindex="-1"></a><span class="co"># t-test for statistical significance</span></span>
<span id="cb623-2"><a href="#cb623-2" aria-hidden="true" tabindex="-1"></a>t_test_result <span class="ot">&lt;-</span> <span class="fu">t.test</span>(test_score <span class="sc">~</span> method, <span class="at">data =</span> teaching_data, </span>
<span id="cb623-3"><a href="#cb623-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">var.equal =</span> <span class="cn">TRUE</span>)</span>
<span id="cb623-4"><a href="#cb623-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb623-5"><a href="#cb623-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Statistical Significance:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Statistical Significance:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb625"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb625-1"><a href="#cb625-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"t("</span>, t_test_result<span class="sc">$</span>parameter, <span class="st">") = "</span>, </span>
<span id="cb625-2"><a href="#cb625-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(t_test_result<span class="sc">$</span>statistic, <span class="dv">2</span>), </span>
<span id="cb625-3"><a href="#cb625-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">", p = "</span>, <span class="fu">round</span>(t_test_result<span class="sc">$</span>p.value, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="at">sep =</span> <span class="st">""</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>t(22) = -3.33, p = 0.0031</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb627"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb627-1"><a href="#cb627-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Conclusion:"</span>, </span>
<span id="cb627-2"><a href="#cb627-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">if_else</span>(t_test_result<span class="sc">$</span>p.value <span class="sc">&lt;</span> <span class="fl">0.05</span>, </span>
<span id="cb627-3"><a href="#cb627-3" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Statistically significant"</span>, </span>
<span id="cb627-4"><a href="#cb627-4" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Not statistically significant"</span>), <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Conclusion: Statistically significant </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb629"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb629-1"><a href="#cb629-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Practical Significance:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Practical Significance:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb631"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb631-1"><a href="#cb631-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Cohen's d ="</span>, <span class="fu">round</span>(d, <span class="dv">2</span>), <span class="st">"("</span>, interpretation, <span class="st">"effect)</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Cohen's d = 1.36 ( Large effect)</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb633"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb633-1"><a href="#cb633-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Mean difference:"</span>, <span class="fu">round</span>(m2 <span class="sc">-</span> m1, <span class="dv">1</span>), <span class="st">"points</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mean difference: 15.5 points</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb635"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb635-1"><a href="#cb635-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"95% CI for difference: ["</span>, </span>
<span id="cb635-2"><a href="#cb635-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(t_test_result<span class="sc">$</span>conf.int[<span class="dv">1</span>], <span class="dv">1</span>), <span class="st">", "</span>,</span>
<span id="cb635-3"><a href="#cb635-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(t_test_result<span class="sc">$</span>conf.int[<span class="dv">2</span>], <span class="dv">1</span>), <span class="st">"]</span><span class="sc">\n</span><span class="st">"</span>, <span class="at">sep =</span> <span class="st">""</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>95% CI for difference: [-25.2, -5.8]</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb637"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb637-1"><a href="#cb637-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Scenario analysis</span></span>
<span id="cb637-2"><a href="#cb637-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Practical Interpretation:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Practical Interpretation:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb639"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb639-1"><a href="#cb639-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- A"</span>, <span class="fu">round</span>(m2 <span class="sc">-</span> m1, <span class="dv">1</span>), <span class="st">"point improvement on a 100-point test</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>- A 15.5 point improvement on a 100-point test</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb641"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb641-1"><a href="#cb641-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Represents approximately"</span>, <span class="fu">round</span>((m2 <span class="sc">-</span> m1) <span class="sc">/</span> m1 <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>), </span>
<span id="cb641-2"><a href="#cb641-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"% improvement over Method A</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>- Represents approximately 20.4 % improvement over Method A</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb643"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb643-1"><a href="#cb643-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- CLES ="</span>, <span class="fu">round</span>(cles, <span class="dv">2</span>), </span>
<span id="cb643-2"><a href="#cb643-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">": ~75% of Method B students outperform average Method A student</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>- CLES = 0.83 : ~75% of Method B students outperform average Method A student</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb645"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb645-1"><a href="#cb645-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Question: Is this improvement worth the cost/effort of Method B?</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>- Question: Is this improvement worth the cost/effort of Method B?</code></pre>
</div>
</div>
<p><strong>Checkpoint:</strong> Result may be both statistically and practically significant, but small sample yields uncertainty.</p>
<p><strong>Discussion:</strong> Can a result be statistically significant but not practically important? Vice versa?</p>
<hr>
</section>
<section id="step-6-effect-sizes-for-categorical-outcomes" class="level3">
<h3 class="anchored" data-anchor-id="step-6-effect-sizes-for-categorical-outcomes">Step 6: Effect Sizes for Categorical Outcomes</h3>
<p>Calculate odds ratios (illustrative with dichotomized outcome):</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb647"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb647-1"><a href="#cb647-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dichotomize test scores (pass = ≥80, fail = &lt;80)</span></span>
<span id="cb647-2"><a href="#cb647-2" aria-hidden="true" tabindex="-1"></a>teaching_dichot <span class="ot">&lt;-</span> teaching_data <span class="sc">%&gt;%</span></span>
<span id="cb647-3"><a href="#cb647-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb647-4"><a href="#cb647-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">pass =</span> <span class="fu">if_else</span>(test_score <span class="sc">&gt;=</span> <span class="dv">80</span>, <span class="st">"Pass"</span>, <span class="st">"Fail"</span>),</span>
<span id="cb647-5"><a href="#cb647-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">pass_binary =</span> <span class="fu">if_else</span>(pass <span class="sc">==</span> <span class="st">"Pass"</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb647-6"><a href="#cb647-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb647-7"><a href="#cb647-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb647-8"><a href="#cb647-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Contingency table</span></span>
<span id="cb647-9"><a href="#cb647-9" aria-hidden="true" tabindex="-1"></a>cont_table <span class="ot">&lt;-</span> <span class="fu">table</span>(teaching_dichot<span class="sc">$</span>method, teaching_dichot<span class="sc">$</span>pass)</span>
<span id="cb647-10"><a href="#cb647-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cont_table)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>          
           Fail Pass
  Method A    8    4
  Method B    1   11</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb649"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb649-1"><a href="#cb649-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Proportions</span></span>
<span id="cb649-2"><a href="#cb649-2" aria-hidden="true" tabindex="-1"></a>prop_table <span class="ot">&lt;-</span> <span class="fu">prop.table</span>(cont_table, <span class="at">margin =</span> <span class="dv">1</span>)</span>
<span id="cb649-3"><a href="#cb649-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(prop_table, <span class="dv">3</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>          
            Fail  Pass
  Method A 0.667 0.333
  Method B 0.083 0.917</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb651"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb651-1"><a href="#cb651-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Odds ratio</span></span>
<span id="cb651-2"><a href="#cb651-2" aria-hidden="true" tabindex="-1"></a>odds_a <span class="ot">&lt;-</span> cont_table[<span class="dv">1</span>, <span class="dv">2</span>] <span class="sc">/</span> cont_table[<span class="dv">1</span>, <span class="dv">1</span>]  <span class="co"># Pass/Fail for Method A</span></span>
<span id="cb651-3"><a href="#cb651-3" aria-hidden="true" tabindex="-1"></a>odds_b <span class="ot">&lt;-</span> cont_table[<span class="dv">2</span>, <span class="dv">2</span>] <span class="sc">/</span> cont_table[<span class="dv">2</span>, <span class="dv">1</span>]  <span class="co"># Pass/Fail for Method B</span></span>
<span id="cb651-4"><a href="#cb651-4" aria-hidden="true" tabindex="-1"></a>odds_ratio <span class="ot">&lt;-</span> odds_b <span class="sc">/</span> odds_a</span>
<span id="cb651-5"><a href="#cb651-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb651-6"><a href="#cb651-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Odds Ratio:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Odds Ratio:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb653"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb653-1"><a href="#cb653-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Odds (Method A):"</span>, <span class="fu">round</span>(odds_a, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Odds (Method A): 0.5 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb655"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb655-1"><a href="#cb655-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Odds (Method B):"</span>, <span class="fu">round</span>(odds_b, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Odds (Method B): 11 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb657"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb657-1"><a href="#cb657-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"OR ="</span>, <span class="fu">round</span>(odds_ratio, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>OR = 22 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb659"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb659-1"><a href="#cb659-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Interpretation: Method B students have"</span>, <span class="fu">round</span>(odds_ratio, <span class="dv">2</span>), </span>
<span id="cb659-2"><a href="#cb659-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"times the odds of passing</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Interpretation: Method B students have 22 times the odds of passing</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb661"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb661-1"><a href="#cb661-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Risk Ratio (RR)</span></span>
<span id="cb661-2"><a href="#cb661-2" aria-hidden="true" tabindex="-1"></a>risk_a <span class="ot">&lt;-</span> cont_table[<span class="dv">1</span>, <span class="dv">2</span>] <span class="sc">/</span> <span class="fu">sum</span>(cont_table[<span class="dv">1</span>, ])</span>
<span id="cb661-3"><a href="#cb661-3" aria-hidden="true" tabindex="-1"></a>risk_b <span class="ot">&lt;-</span> cont_table[<span class="dv">2</span>, <span class="dv">2</span>] <span class="sc">/</span> <span class="fu">sum</span>(cont_table[<span class="dv">2</span>, ])</span>
<span id="cb661-4"><a href="#cb661-4" aria-hidden="true" tabindex="-1"></a>risk_ratio <span class="ot">&lt;-</span> risk_b <span class="sc">/</span> risk_a</span>
<span id="cb661-5"><a href="#cb661-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb661-6"><a href="#cb661-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Risk Ratio:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Risk Ratio:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb663"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb663-1"><a href="#cb663-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Risk (Method A):"</span>, <span class="fu">round</span>(risk_a, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Risk (Method A): 0.333 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb665"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb665-1"><a href="#cb665-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Risk (Method B):"</span>, <span class="fu">round</span>(risk_b, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Risk (Method B): 0.917 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb667"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb667-1"><a href="#cb667-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"RR ="</span>, <span class="fu">round</span>(risk_ratio, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>RR = 2.75 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb669"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb669-1"><a href="#cb669-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Risk difference</span></span>
<span id="cb669-2"><a href="#cb669-2" aria-hidden="true" tabindex="-1"></a>risk_diff <span class="ot">&lt;-</span> risk_b <span class="sc">-</span> risk_a</span>
<span id="cb669-3"><a href="#cb669-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Risk Difference:"</span>, <span class="fu">round</span>(risk_diff, <span class="dv">3</span>), </span>
<span id="cb669-4"><a href="#cb669-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"("</span>, <span class="fu">round</span>(risk_diff <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>), <span class="st">" percentage points)</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Risk Difference: 0.583 ( 58.3  percentage points)</code></pre>
</div>
</div>
<p><strong>Checkpoint:</strong> OR and RR should show Method B advantage in passing rates.</p>
<hr>
</section>
<section id="step-7-create-forest-plot" class="level3">
<h3 class="anchored" data-anchor-id="step-7-create-forest-plot">Step 7: Create Forest Plot</h3>
<p>Visualize multiple effect sizes:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb671"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb671-1"><a href="#cb671-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compile effect sizes</span></span>
<span id="cb671-2"><a href="#cb671-2" aria-hidden="true" tabindex="-1"></a>forest_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb671-3"><a href="#cb671-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Metric =</span> <span class="fu">c</span>(<span class="st">"Cohen's d"</span>, <span class="st">"Point-Biserial r"</span>, <span class="st">"CLES"</span>, </span>
<span id="cb671-4"><a href="#cb671-4" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Mean Difference"</span>, <span class="st">"Odds Ratio"</span>, <span class="st">"Risk Ratio"</span>),</span>
<span id="cb671-5"><a href="#cb671-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Estimate =</span> <span class="fu">c</span>(d, r_pb, cles, m2 <span class="sc">-</span> m1, odds_ratio, risk_ratio),</span>
<span id="cb671-6"><a href="#cb671-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Lower =</span> <span class="fu">c</span>(ci_d<span class="sc">$</span>Lower.Conf.Limit.smd, <span class="cn">NA</span>, <span class="cn">NA</span>, </span>
<span id="cb671-7"><a href="#cb671-7" aria-hidden="true" tabindex="-1"></a>            t_test_result<span class="sc">$</span>conf.int[<span class="dv">1</span>], <span class="cn">NA</span>, <span class="cn">NA</span>),</span>
<span id="cb671-8"><a href="#cb671-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">Upper =</span> <span class="fu">c</span>(ci_d<span class="sc">$</span>Upper.Conf.Limit.smd, <span class="cn">NA</span>, <span class="cn">NA</span>,</span>
<span id="cb671-9"><a href="#cb671-9" aria-hidden="true" tabindex="-1"></a>            t_test_result<span class="sc">$</span>conf.int[<span class="dv">2</span>], <span class="cn">NA</span>, <span class="cn">NA</span>),</span>
<span id="cb671-10"><a href="#cb671-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">Category =</span> <span class="fu">c</span>(<span class="st">"Standardized"</span>, <span class="st">"Standardized"</span>, <span class="st">"Probability"</span>,</span>
<span id="cb671-11"><a href="#cb671-11" aria-hidden="true" tabindex="-1"></a>               <span class="st">"Unstandardized"</span>, <span class="st">"Categorical"</span>, <span class="st">"Categorical"</span>)</span>
<span id="cb671-12"><a href="#cb671-12" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb671-13"><a href="#cb671-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Lower))  <span class="co"># Keep only metrics with CIs</span></span>
<span id="cb671-14"><a href="#cb671-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb671-15"><a href="#cb671-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Forest plot</span></span>
<span id="cb671-16"><a href="#cb671-16" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(forest_data, <span class="fu">aes</span>(<span class="at">x =</span> Estimate, <span class="at">y =</span> Metric, <span class="at">color =</span> Category)) <span class="sc">+</span></span>
<span id="cb671-17"><a href="#cb671-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb671-18"><a href="#cb671-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> Lower, <span class="at">xmax =</span> Upper), <span class="at">height =</span> <span class="fl">0.2</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb671-19"><a href="#cb671-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"gray50"</span>) <span class="sc">+</span></span>
<span id="cb671-20"><a href="#cb671-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Effect Sizes with 95% Confidence Intervals"</span>,</span>
<span id="cb671-21"><a href="#cb671-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Method B vs Method A"</span>,</span>
<span id="cb671-22"><a href="#cb671-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Effect Size Estimate"</span>, <span class="at">y =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb671-23"><a href="#cb671-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb671-24"><a href="#cb671-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="part-g-lab-practicals_files/figure-html/lab11-forest-plot-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Checkpoint:</strong> Forest plot displays effect sizes with uncertainty intervals in publication-ready format.</p>
<hr>
</section>
<section id="step-8-report-effect-sizes-apa-style" class="level3">
<h3 class="anchored" data-anchor-id="step-8-report-effect-sizes-apa-style">Step 8: Report Effect Sizes (APA Style)</h3>
<p>Create publication-ready summary:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb672"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb672-1"><a href="#cb672-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb672-2"><a href="#cb672-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb672-3"><a href="#cb672-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary table</span></span>
<span id="cb672-4"><a href="#cb672-4" aria-hidden="true" tabindex="-1"></a>effect_summary <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb672-5"><a href="#cb672-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Effect Size Metric</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Cohen's d"</span>, <span class="st">"95% CI"</span>, <span class="st">"Point-Biserial r"</span>, </span>
<span id="cb672-6"><a href="#cb672-6" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"R²"</span>, <span class="st">"CLES"</span>, <span class="st">"Mean Difference"</span>),</span>
<span id="cb672-7"><a href="#cb672-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Value =</span> <span class="fu">c</span>(</span>
<span id="cb672-8"><a href="#cb672-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">"%.2f"</span>, d),</span>
<span id="cb672-9"><a href="#cb672-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">"[%.2f, %.2f]"</span>, ci_d<span class="sc">$</span>Lower.Conf.Limit.smd, ci_d<span class="sc">$</span>Upper.Conf.Limit.smd),</span>
<span id="cb672-10"><a href="#cb672-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">"%.2f"</span>, r_pb),</span>
<span id="cb672-11"><a href="#cb672-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">"%.3f (%.1f%%)"</span>, r_squared, r_squared <span class="sc">*</span> <span class="dv">100</span>),</span>
<span id="cb672-12"><a href="#cb672-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">"%.2f (%.0f%%)"</span>, cles, cles <span class="sc">*</span> <span class="dv">100</span>),</span>
<span id="cb672-13"><a href="#cb672-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">"%.1f points"</span>, m2 <span class="sc">-</span> m1)</span>
<span id="cb672-14"><a href="#cb672-14" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb672-15"><a href="#cb672-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">Interpretation =</span> <span class="fu">c</span>(</span>
<span id="cb672-16"><a href="#cb672-16" aria-hidden="true" tabindex="-1"></a>    interpretation,</span>
<span id="cb672-17"><a href="#cb672-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Excludes zero"</span>,</span>
<span id="cb672-18"><a href="#cb672-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Medium association"</span>,</span>
<span id="cb672-19"><a href="#cb672-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">"%.1f%% variance explained"</span>, r_squared <span class="sc">*</span> <span class="dv">100</span>),</span>
<span id="cb672-20"><a href="#cb672-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">"~3 in 4 advantage"</span>,</span>
<span id="cb672-21"><a href="#cb672-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">"%.1f%% improvement"</span>, (m2 <span class="sc">-</span> m1) <span class="sc">/</span> m1 <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb672-22"><a href="#cb672-22" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb672-23"><a href="#cb672-23" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb672-24"><a href="#cb672-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb672-25"><a href="#cb672-25" aria-hidden="true" tabindex="-1"></a>effect_summary <span class="sc">%&gt;%</span></span>
<span id="cb672-26"><a href="#cb672-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb672-27"><a href="#cb672-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb672-28"><a href="#cb672-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Effect Size Summary"</span>,</span>
<span id="cb672-29"><a href="#cb672-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Teaching Method Comparison (n=24)"</span></span>
<span id="cb672-30"><a href="#cb672-30" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb672-31"><a href="#cb672-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_source_note</span>(</span>
<span id="cb672-32"><a href="#cb672-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">source_note =</span> <span class="st">"Cohen's benchmarks: small (0.2), medium (0.5), large (0.8)"</span></span>
<span id="cb672-33"><a href="#cb672-33" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="vnkfivbooh" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#vnkfivbooh table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#vnkfivbooh thead, #vnkfivbooh tbody, #vnkfivbooh tfoot, #vnkfivbooh tr, #vnkfivbooh td, #vnkfivbooh th {
  border-style: none;
}

#vnkfivbooh p {
  margin: 0;
  padding: 0;
}

#vnkfivbooh .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#vnkfivbooh .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#vnkfivbooh .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#vnkfivbooh .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#vnkfivbooh .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vnkfivbooh .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vnkfivbooh .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vnkfivbooh .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#vnkfivbooh .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#vnkfivbooh .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#vnkfivbooh .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#vnkfivbooh .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#vnkfivbooh .gt_spanner_row {
  border-bottom-style: hidden;
}

#vnkfivbooh .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#vnkfivbooh .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#vnkfivbooh .gt_from_md > :first-child {
  margin-top: 0;
}

#vnkfivbooh .gt_from_md > :last-child {
  margin-bottom: 0;
}

#vnkfivbooh .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#vnkfivbooh .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#vnkfivbooh .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#vnkfivbooh .gt_row_group_first td {
  border-top-width: 2px;
}

#vnkfivbooh .gt_row_group_first th {
  border-top-width: 2px;
}

#vnkfivbooh .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vnkfivbooh .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#vnkfivbooh .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#vnkfivbooh .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vnkfivbooh .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vnkfivbooh .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#vnkfivbooh .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#vnkfivbooh .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#vnkfivbooh .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vnkfivbooh .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vnkfivbooh .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#vnkfivbooh .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vnkfivbooh .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#vnkfivbooh .gt_left {
  text-align: left;
}

#vnkfivbooh .gt_center {
  text-align: center;
}

#vnkfivbooh .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#vnkfivbooh .gt_font_normal {
  font-weight: normal;
}

#vnkfivbooh .gt_font_bold {
  font-weight: bold;
}

#vnkfivbooh .gt_font_italic {
  font-style: italic;
}

#vnkfivbooh .gt_super {
  font-size: 65%;
}

#vnkfivbooh .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#vnkfivbooh .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#vnkfivbooh .gt_indent_1 {
  text-indent: 5px;
}

#vnkfivbooh .gt_indent_2 {
  text-indent: 10px;
}

#vnkfivbooh .gt_indent_3 {
  text-indent: 15px;
}

#vnkfivbooh .gt_indent_4 {
  text-indent: 20px;
}

#vnkfivbooh .gt_indent_5 {
  text-indent: 25px;
}

#vnkfivbooh .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#vnkfivbooh div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading header">
<td colspan="3" class="gt_heading gt_title gt_font_normal">Effect Size Summary</td>
</tr>
<tr class="gt_heading even">
<td colspan="3" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border">Teaching Method Comparison (n=24)</td>
</tr>
<tr class="gt_col_headings header">
<th id="Effect-Size-Metric" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Effect Size Metric</th>
<th id="Value" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Value</th>
<th id="Interpretation" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Interpretation</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="Effect Size Metric">Cohen's d</td>
<td class="gt_row gt_left" headers="Value">1.36</td>
<td class="gt_row gt_left" headers="Interpretation">Large</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Effect Size Metric">95% CI</td>
<td class="gt_row gt_left" headers="Value">[0.45, 2.24]</td>
<td class="gt_row gt_left" headers="Interpretation">Excludes zero</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Effect Size Metric">Point-Biserial r</td>
<td class="gt_row gt_left" headers="Value">0.58</td>
<td class="gt_row gt_left" headers="Interpretation">Medium association</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Effect Size Metric">R²</td>
<td class="gt_row gt_left" headers="Value">0.335 (33.5%)</td>
<td class="gt_row gt_left" headers="Interpretation">33.5% variance explained</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Effect Size Metric">CLES</td>
<td class="gt_row gt_left" headers="Value">0.83 (83%)</td>
<td class="gt_row gt_left" headers="Interpretation">~3 in 4 advantage</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Effect Size Metric">Mean Difference</td>
<td class="gt_row gt_left" headers="Value">15.5 points</td>
<td class="gt_row gt_left" headers="Interpretation">20.4% improvement</td>
</tr>
</tbody><tfoot class="gt_sourcenotes">
<tr class="odd">
<td colspan="3" class="gt_sourcenote">Cohen's benchmarks: small (0.2), medium (0.5), large (0.8)</td>
</tr>
</tfoot>

</table>

</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb673"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb673-1"><a href="#cb673-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample Results Statement</span></span>
<span id="cb673-2"><a href="#cb673-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Sample APA-Style Results Statement:</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Sample APA-Style Results Statement:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb675"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb675-1"><a href="#cb675-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Method B (M ="</span>, <span class="fu">round</span>(m2, <span class="dv">1</span>), <span class="st">", SD ="</span>, <span class="fu">round</span>(sd2, <span class="dv">1</span>), </span>
<span id="cb675-2"><a href="#cb675-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">") produced significantly higher</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Method B (M = 91.7 , SD = 14.1 ) produced significantly higher</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb677"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb677-1"><a href="#cb677-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"test scores than Method A (M ="</span>, <span class="fu">round</span>(m1, <span class="dv">1</span>), <span class="st">", SD ="</span>, <span class="fu">round</span>(sd1, <span class="dv">1</span>), </span>
<span id="cb677-2"><a href="#cb677-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"), t("</span>, t_test_result<span class="sc">$</span>parameter, <span class="st">") =</span><span class="sc">\n</span><span class="st">"</span>, <span class="at">sep =</span> <span class="st">""</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>test scores than Method A (M =76.2, SD =7.9), t(22) =</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb679"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb679-1"><a href="#cb679-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">round</span>(t_test_result<span class="sc">$</span>statistic, <span class="dv">2</span>), <span class="st">", p ="</span>, </span>
<span id="cb679-2"><a href="#cb679-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(t_test_result<span class="sc">$</span>p.value, <span class="dv">3</span>), <span class="st">", d ="</span>, <span class="fu">round</span>(d, <span class="dv">2</span>), </span>
<span id="cb679-3"><a href="#cb679-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">", 95% CI ["</span>, <span class="fu">round</span>(ci_d<span class="sc">$</span>Lower.Conf.Limit.smd, <span class="dv">2</span>), <span class="st">", "</span>,</span>
<span id="cb679-4"><a href="#cb679-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(ci_d<span class="sc">$</span>Upper.Conf.Limit.smd, <span class="dv">2</span>), <span class="st">"].</span><span class="sc">\n</span><span class="st">"</span>, <span class="at">sep =</span> <span class="st">""</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>-3.33, p =0.003, d =1.36, 95% CI [0.45, 2.24].</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb681"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb681-1"><a href="#cb681-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"This represents a"</span>, <span class="fu">tolower</span>(interpretation), </span>
<span id="cb681-2"><a href="#cb681-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"effect, with approximately"</span>, <span class="fu">round</span>(cles <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">0</span>), </span>
<span id="cb681-3"><a href="#cb681-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"% of Method B</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>This represents a large effect, with approximately 83 % of Method B</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb683"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb683-1"><a href="#cb683-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"students scoring above the average Method A student (CLES).</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>students scoring above the average Method A student (CLES).</code></pre>
</div>
</div>
<p><strong>Checkpoint:</strong> Professional reporting with multiple effect size metrics and clear interpretation.</p>
<hr>
</section>
<section id="discussion-questions-10" class="level3">
<h3 class="anchored" data-anchor-id="discussion-questions-10">Discussion Questions</h3>
<ol type="1">
<li><p><strong>Why Report Effect Sizes:</strong> What information does an effect size provide that a p-value doesn’t?</p>
<p><em>Answer: Effect sizes quantify magnitude of difference/association (how big?), are independent of sample size, allow comparison across studies, inform practical importance, and enable meta-analysis. P-values only indicate probability under null hypothesis.</em></p></li>
<li><p><strong>Which Effect Size:</strong> When should you report Cohen’s d vs r vs odds ratios?</p>
<p><em>Answer: Cohen’s d for mean differences (t-tests, ANOVA), r for correlations, odds/risk ratios for categorical outcomes. Report the metric most appropriate for your design and most interpretable for your audience. Multiple metrics often helpful.</em></p></li>
<li><p><strong>Confidence Intervals:</strong> Why are CIs for effect sizes important, especially in small samples?</p>
<p><em>Answer: CIs quantify precision/uncertainty around effect size estimate. In small samples, CIs are wide, revealing substantial uncertainty even when result is significant. Helps distinguish “precisely small” from “imprecisely estimated.”</em></p></li>
<li><p><strong>Practical vs Statistical:</strong> Give an example where d=0.3 might be practically important despite being “small.”</p>
<p><em>Answer: In education, a d=0.3 improvement in test scores with no added cost might benefit millions of students. In medicine, small effects on mortality are critically important. “Small” is context-dependent.</em></p></li>
<li><p><strong>Reporting Standards:</strong> What effect size information should you always report?</p>
<p><em>Answer: (1) Point estimate (e.g., d=0.65), (2) 95% CI, (3) sample sizes, (4) interpretation (small/medium/large or context-specific), (5) unstandardized effect when meaningful (e.g., 10-point difference).</em></p></li>
</ol>
<hr>
</section>
<section id="key-takeaways-10" class="level3">
<h3 class="anchored" data-anchor-id="key-takeaways-10">Key Takeaways</h3>
<p>✓ <strong>Effect sizes quantify magnitude</strong>, not just significance<br>
✓ <strong>Cohen’s d is standardized</strong> – comparable across studies<br>
✓ <strong>Always report confidence intervals</strong> for effect sizes<br>
✓ <strong>Multiple effect size metrics</strong> provide complementary perspectives<br>
✓ <strong>Practical significance ≠ statistical significance</strong> – consider context<br>
✓ <strong>Small samples yield wide CIs</strong> – interpret effect sizes cautiously<br>
✓ <strong>APA guidelines require effect sizes</strong> in results sections</p>
<hr>
</section>
<section id="homework-exercise-10" class="level3">
<h3 class="anchored" data-anchor-id="homework-exercise-10">Homework Exercise</h3>
<p><strong>Dataset:</strong> A wellness intervention study (n=20, 10 per group) measuring stress reduction.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb685"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb685-1"><a href="#cb685-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">654</span>)</span>
<span id="cb685-2"><a href="#cb685-2" aria-hidden="true" tabindex="-1"></a>wellness_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb685-3"><a href="#cb685-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">participant_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>,</span>
<span id="cb685-4"><a href="#cb685-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Control"</span>, <span class="st">"Intervention"</span>), <span class="at">each =</span> <span class="dv">10</span>),</span>
<span id="cb685-5"><a href="#cb685-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">stress_baseline =</span> <span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="dv">65</span>, <span class="dv">12</span>)),</span>
<span id="cb685-6"><a href="#cb685-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">stress_post =</span> <span class="fu">c</span>(</span>
<span id="cb685-7"><a href="#cb685-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="dv">63</span>, <span class="dv">11</span>)),      <span class="co"># Control: minimal change</span></span>
<span id="cb685-8"><a href="#cb685-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="dv">48</span>, <span class="dv">10</span>))       <span class="co"># Intervention: larger reduction</span></span>
<span id="cb685-9"><a href="#cb685-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb685-10"><a href="#cb685-10" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb685-11"><a href="#cb685-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">stress_change =</span> stress_post <span class="sc">-</span> stress_baseline)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p><strong>Your Tasks:</strong></p>
<ol type="1">
<li>Calculate descriptive statistics (M, SD) for each group’s stress change</li>
<li>Conduct independent t-test on stress_change</li>
<li>Calculate Cohen’s d for the group difference</li>
<li>Compute 95% CI for Cohen’s d using MBESS</li>
<li>Calculate point-biserial correlation (r) and R²</li>
<li>Calculate Common Language Effect Size (CLES)</li>
<li>Interpret effect size using Cohen’s benchmarks</li>
<li>Create a forest plot showing d with 95% CI</li>
<li>Compare statistical significance (p-value) with practical significance (effect size)</li>
<li>Write an APA-style results statement reporting all relevant statistics</li>
</ol>
<p><strong>Expected Results:</strong></p>
<ul>
<li>Intervention group shows greater stress reduction (larger negative change)</li>
<li>Cohen’s d approximately 1.0-1.5 (large effect)</li>
<li>Statistically significant (p &lt; .05)</li>
<li>95% CI for d should exclude zero but be fairly wide (small sample)</li>
<li>CLES ~75-85% (intervention advantage)</li>
<li>R² ~25-40% (substantial variance explained)</li>
</ul>
<p><strong>Hints:</strong> - Use <code>stress_change</code> as outcome (negative values = stress reduction) - For d: <code>cohen.d(group2, group1)</code> or manual calculation with pooled SD - For CI: <code>ci.smd(smd = d, n.1 = 10, n.2 = 10)</code> - CLES = <code>pnorm(d / sqrt(2))</code></p>
<p><strong>Bonus:</strong> Dichotomize the outcome: “Clinically meaningful reduction” = stress change ≤ -10 points. Calculate odds ratio and risk ratio for the intervention vs control. Which metric (d, OR, RR) is most interpretable for a clinical audience? Why?</p>
<hr>
</section>
</section>
<section id="lab-visualization" class="level2">
<h2 class="anchored" data-anchor-id="lab-visualization">Lab 12: Visualization Best Practices for Small Samples</h2>
<p><strong>Learning Objectives:</strong></p>
<ul>
<li>Create effective visualizations for small-sample data</li>
<li>Show individual data points (avoid hiding observations)</li>
<li>Display uncertainty with error bars and confidence bands</li>
<li>Use appropriate plot types for different data structures</li>
<li>Apply principles of clear, honest data presentation</li>
<li>Generate publication-ready figures with ggplot2</li>
</ul>
<p><strong>Scenario:</strong> You have pilot data (n=18) from a within-subjects study where participants completed a task under three conditions. You need to create visualizations that clearly communicate patterns while honestly representing uncertainty.</p>
<section id="step-1-set-up-and-load-data-5" class="level3">
<h3 class="anchored" data-anchor-id="step-1-set-up-and-load-data-5">Step 1: Set Up and Load Data</h3>
<p>Create within-subjects data:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb686"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb686-1"><a href="#cb686-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb686-2"><a href="#cb686-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb686-3"><a href="#cb686-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggbeeswarm)  <span class="co"># For jittered points</span></span>
<span id="cb686-4"><a href="#cb686-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggdist)      <span class="co"># For distribution visualizations</span></span>
<span id="cb686-5"><a href="#cb686-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)   <span class="co"># For combining plots</span></span>
<span id="cb686-6"><a href="#cb686-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb686-7"><a href="#cb686-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Set seed for reproducibility</span></span>
<span id="cb686-8"><a href="#cb686-8" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb686-9"><a href="#cb686-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb686-10"><a href="#cb686-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Within-subjects data: 3 conditions</span></span>
<span id="cb686-11"><a href="#cb686-11" aria-hidden="true" tabindex="-1"></a>pilot_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb686-12"><a href="#cb686-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">participant_id =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">18</span>, <span class="at">each =</span> <span class="dv">3</span>),</span>
<span id="cb686-13"><a href="#cb686-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">condition =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Baseline"</span>, <span class="st">"Treatment A"</span>, <span class="st">"Treatment B"</span>), <span class="at">times =</span> <span class="dv">18</span>),</span>
<span id="cb686-14"><a href="#cb686-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">reaction_time =</span> <span class="fu">c</span>(</span>
<span id="cb686-15"><a href="#cb686-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="dv">18</span>, <span class="dv">450</span>, <span class="dv">60</span>)),    <span class="co"># Baseline</span></span>
<span id="cb686-16"><a href="#cb686-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="dv">18</span>, <span class="dv">420</span>, <span class="dv">55</span>)),    <span class="co"># Treatment A: slight improvement</span></span>
<span id="cb686-17"><a href="#cb686-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="dv">18</span>, <span class="dv">380</span>, <span class="dv">50</span>))     <span class="co"># Treatment B: larger improvement</span></span>
<span id="cb686-18"><a href="#cb686-18" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb686-19"><a href="#cb686-19" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb686-20"><a href="#cb686-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">condition =</span> <span class="fu">factor</span>(condition, </span>
<span id="cb686-21"><a href="#cb686-21" aria-hidden="true" tabindex="-1"></a>                           <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Baseline"</span>, <span class="st">"Treatment A"</span>, <span class="st">"Treatment B"</span>)))</span>
<span id="cb686-22"><a href="#cb686-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb686-23"><a href="#cb686-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Descriptive statistics</span></span>
<span id="cb686-24"><a href="#cb686-24" aria-hidden="true" tabindex="-1"></a>summary_stats <span class="ot">&lt;-</span> pilot_data <span class="sc">%&gt;%</span></span>
<span id="cb686-25"><a href="#cb686-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(condition) <span class="sc">%&gt;%</span></span>
<span id="cb686-26"><a href="#cb686-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb686-27"><a href="#cb686-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb686-28"><a href="#cb686-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">M =</span> <span class="fu">mean</span>(reaction_time),</span>
<span id="cb686-29"><a href="#cb686-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">SD =</span> <span class="fu">sd</span>(reaction_time),</span>
<span id="cb686-30"><a href="#cb686-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">SE =</span> SD <span class="sc">/</span> <span class="fu">sqrt</span>(n),</span>
<span id="cb686-31"><a href="#cb686-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">CI_lower =</span> M <span class="sc">-</span> <span class="fu">qt</span>(<span class="fl">0.975</span>, n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> SE,</span>
<span id="cb686-32"><a href="#cb686-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">CI_upper =</span> M <span class="sc">+</span> <span class="fu">qt</span>(<span class="fl">0.975</span>, n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> SE,</span>
<span id="cb686-33"><a href="#cb686-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb686-34"><a href="#cb686-34" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb686-35"><a href="#cb686-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb686-36"><a href="#cb686-36" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(summary_stats)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 7
  condition       n     M    SD    SE CI_lower CI_upper
  &lt;fct&gt;       &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
1 Baseline       18  425.  54.8  12.9     398.     453.
2 Treatment A    18  432.  73.3  17.3     395.     468.
3 Treatment B    18  416.  57.0  13.4     388.     445.</code></pre>
</div>
</div>
<p><strong>Checkpoint:</strong> You should have n=18 observations per condition with decreasing reaction times across conditions.</p>
<hr>
</section>
<section id="step-2-bad-practices-vs-good-practices" class="level3">
<h3 class="anchored" data-anchor-id="step-2-bad-practices-vs-good-practices">Step 2: Bad Practices vs Good Practices</h3>
<p>Contrast ineffective and effective visualizations:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb688"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb688-1"><a href="#cb688-1" aria-hidden="true" tabindex="-1"></a><span class="co"># BAD: Bar chart without individual points (hides data)</span></span>
<span id="cb688-2"><a href="#cb688-2" aria-hidden="true" tabindex="-1"></a>bad_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(summary_stats, <span class="fu">aes</span>(<span class="at">x =</span> condition, <span class="at">y =</span> M)) <span class="sc">+</span></span>
<span id="cb688-3"><a href="#cb688-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb688-4"><a href="#cb688-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> CI_lower, <span class="at">ymax =</span> CI_upper), <span class="at">width =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb688-5"><a href="#cb688-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"BAD: Bars Hide Data (n=18 per condition)"</span>,</span>
<span id="cb688-6"><a href="#cb688-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Reaction Time (ms)"</span>) <span class="sc">+</span></span>
<span id="cb688-7"><a href="#cb688-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb688-8"><a href="#cb688-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb688-9"><a href="#cb688-9" aria-hidden="true" tabindex="-1"></a><span class="co"># GOOD: Show all individual points with summary</span></span>
<span id="cb688-10"><a href="#cb688-10" aria-hidden="true" tabindex="-1"></a>good_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(pilot_data, <span class="fu">aes</span>(<span class="at">x =</span> condition, <span class="at">y =</span> reaction_time)) <span class="sc">+</span></span>
<span id="cb688-11"><a href="#cb688-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span>  <span class="co"># Individual points</span></span>
<span id="cb688-12"><a href="#cb688-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"point"</span>, </span>
<span id="cb688-13"><a href="#cb688-13" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">shape =</span> <span class="dv">18</span>) <span class="sc">+</span>  <span class="co"># Mean</span></span>
<span id="cb688-14"><a href="#cb688-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_cl_normal, <span class="at">geom =</span> <span class="st">"errorbar"</span>,</span>
<span id="cb688-15"><a href="#cb688-15" aria-hidden="true" tabindex="-1"></a>               <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span>  <span class="co"># 95% CI</span></span>
<span id="cb688-16"><a href="#cb688-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"GOOD: Show Individual Data Points (n=18 per condition)"</span>,</span>
<span id="cb688-17"><a href="#cb688-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Reaction Time (ms)"</span>,</span>
<span id="cb688-18"><a href="#cb688-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Red diamonds = means with 95% CIs"</span>) <span class="sc">+</span></span>
<span id="cb688-19"><a href="#cb688-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb688-20"><a href="#cb688-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb688-21"><a href="#cb688-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Display side-by-side</span></span>
<span id="cb688-22"><a href="#cb688-22" aria-hidden="true" tabindex="-1"></a>bad_plot <span class="sc">+</span> good_plot</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="part-g-lab-practicals_files/figure-html/lab12-comparison-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Checkpoint:</strong> Good plot reveals individual variability and distribution; bad plot hides critical information.</p>
<p><strong>Discussion:</strong> Why is hiding data particularly problematic with small samples?</p>
<hr>
</section>
<section id="step-3-effective-within-subjects-visualization" class="level3">
<h3 class="anchored" data-anchor-id="step-3-effective-within-subjects-visualization">Step 3: Effective Within-Subjects Visualization</h3>
<p>Show paired nature of the data:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb689"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb689-1"><a href="#cb689-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Connect individual trajectories</span></span>
<span id="cb689-2"><a href="#cb689-2" aria-hidden="true" tabindex="-1"></a>trajectory_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(pilot_data, </span>
<span id="cb689-3"><a href="#cb689-3" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">aes</span>(<span class="at">x =</span> condition, <span class="at">y =</span> reaction_time, </span>
<span id="cb689-4"><a href="#cb689-4" aria-hidden="true" tabindex="-1"></a>                              <span class="at">group =</span> participant_id)) <span class="sc">+</span></span>
<span id="cb689-5"><a href="#cb689-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">color =</span> <span class="st">"gray50"</span>) <span class="sc">+</span>  <span class="co"># Individual lines</span></span>
<span id="cb689-6"><a href="#cb689-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span>         <span class="co"># Individual points</span></span>
<span id="cb689-7"><a href="#cb689-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="fu">aes</span>(<span class="at">group =</span> <span class="dv">1</span>), <span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"line"</span>, </span>
<span id="cb689-8"><a href="#cb689-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linewidth =</span> <span class="fl">1.5</span>) <span class="sc">+</span>  <span class="co"># Mean trajectory</span></span>
<span id="cb689-9"><a href="#cb689-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"point"</span>, </span>
<span id="cb689-10"><a href="#cb689-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">shape =</span> <span class="dv">18</span>) <span class="sc">+</span></span>
<span id="cb689-11"><a href="#cb689-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Individual Trajectories with Mean (n=18)"</span>,</span>
<span id="cb689-12"><a href="#cb689-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Within-Subjects Design"</span>,</span>
<span id="cb689-13"><a href="#cb689-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Reaction Time (ms)"</span>,</span>
<span id="cb689-14"><a href="#cb689-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>) <span class="sc">+</span></span>
<span id="cb689-15"><a href="#cb689-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb689-16"><a href="#cb689-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb689-17"><a href="#cb689-17" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(trajectory_plot)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="part-g-lab-practicals_files/figure-html/lab12-within-subjects-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb690"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb690-1"><a href="#cb690-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternative: Raincloud plot (distribution + points + boxplot)</span></span>
<span id="cb690-2"><a href="#cb690-2" aria-hidden="true" tabindex="-1"></a>raincloud_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(pilot_data, <span class="fu">aes</span>(<span class="at">x =</span> condition, <span class="at">y =</span> reaction_time, </span>
<span id="cb690-3"><a href="#cb690-3" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">fill =</span> condition)) <span class="sc">+</span></span>
<span id="cb690-4"><a href="#cb690-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Half violin (distribution)</span></span>
<span id="cb690-5"><a href="#cb690-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(<span class="at">adjust =</span> <span class="dv">1</span>, <span class="at">width =</span> <span class="fl">0.6</span>, <span class="at">.width =</span> <span class="dv">0</span>, </span>
<span id="cb690-6"><a href="#cb690-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">justification =</span> <span class="sc">-</span><span class="fl">0.2</span>, <span class="at">point_colour =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb690-7"><a href="#cb690-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Boxplot</span></span>
<span id="cb690-8"><a href="#cb690-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.15</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb690-9"><a href="#cb690-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Individual points</span></span>
<span id="cb690-10"><a href="#cb690-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, </span>
<span id="cb690-11"><a href="#cb690-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">width =</span> <span class="fl">0.05</span>)) <span class="sc">+</span></span>
<span id="cb690-12"><a href="#cb690-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Raincloud Plot: Distribution + Box + Points"</span>,</span>
<span id="cb690-13"><a href="#cb690-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Reaction Time (ms)"</span>) <span class="sc">+</span></span>
<span id="cb690-14"><a href="#cb690-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb690-15"><a href="#cb690-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb690-16"><a href="#cb690-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb690-17"><a href="#cb690-17" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(raincloud_plot)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="part-g-lab-practicals_files/figure-html/lab12-within-subjects-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Checkpoint:</strong> Individual trajectories reveal within-person changes (most participants improve). Raincloud shows full distribution.</p>
<hr>
</section>
<section id="step-4-uncertainty-visualization" class="level3">
<h3 class="anchored" data-anchor-id="step-4-uncertainty-visualization">Step 4: Uncertainty Visualization</h3>
<p>Emphasize confidence intervals and prediction intervals:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb691"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb691-1"><a href="#cb691-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to wide format for plotting</span></span>
<span id="cb691-2"><a href="#cb691-2" aria-hidden="true" tabindex="-1"></a>pilot_wide <span class="ot">&lt;-</span> pilot_data <span class="sc">%&gt;%</span></span>
<span id="cb691-3"><a href="#cb691-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> condition, <span class="at">values_from =</span> reaction_time)</span>
<span id="cb691-4"><a href="#cb691-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb691-5"><a href="#cb691-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter plot with regression line and confidence/prediction bands</span></span>
<span id="cb691-6"><a href="#cb691-6" aria-hidden="true" tabindex="-1"></a>scatter_uncertainty <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(pilot_wide, </span>
<span id="cb691-7"><a href="#cb691-7" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">aes</span>(<span class="at">x =</span> Baseline, <span class="at">y =</span> <span class="st">`</span><span class="at">Treatment B</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb691-8"><a href="#cb691-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, </span>
<span id="cb691-9"><a href="#cb691-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"gray50"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span>  <span class="co"># Identity line</span></span>
<span id="cb691-10"><a href="#cb691-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>, </span>
<span id="cb691-11"><a href="#cb691-11" aria-hidden="true" tabindex="-1"></a>              <span class="at">level =</span> <span class="fl">0.95</span>, <span class="at">fill =</span> <span class="st">"blue"</span>, <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span>  <span class="co"># 95% CI</span></span>
<span id="cb691-12"><a href="#cb691-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb691-13"><a href="#cb691-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Baseline vs Treatment B (n=18)"</span>,</span>
<span id="cb691-14"><a href="#cb691-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Blue band = 95% confidence interval for regression line"</span>,</span>
<span id="cb691-15"><a href="#cb691-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Baseline Reaction Time (ms)"</span>,</span>
<span id="cb691-16"><a href="#cb691-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Treatment B Reaction Time (ms)"</span>) <span class="sc">+</span></span>
<span id="cb691-17"><a href="#cb691-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>(<span class="at">ratio =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb691-18"><a href="#cb691-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb691-19"><a href="#cb691-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb691-20"><a href="#cb691-20" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(scatter_uncertainty)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="part-g-lab-practicals_files/figure-html/lab12-uncertainty-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb692"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb692-1"><a href="#cb692-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Error bar plot with different CI levels</span></span>
<span id="cb692-2"><a href="#cb692-2" aria-hidden="true" tabindex="-1"></a>ci_levels <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(</span>
<span id="cb692-3"><a href="#cb692-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">condition =</span> summary_stats<span class="sc">$</span>condition,</span>
<span id="cb692-4"><a href="#cb692-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">ci_level =</span> <span class="fu">c</span>(<span class="fl">0.80</span>, <span class="fl">0.90</span>, <span class="fl">0.95</span>)</span>
<span id="cb692-5"><a href="#cb692-5" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb692-6"><a href="#cb692-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(pilot_data, <span class="at">by =</span> <span class="st">"condition"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb692-7"><a href="#cb692-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(condition, ci_level) <span class="sc">%&gt;%</span></span>
<span id="cb692-8"><a href="#cb692-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb692-9"><a href="#cb692-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">M =</span> <span class="fu">mean</span>(reaction_time),</span>
<span id="cb692-10"><a href="#cb692-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">SE =</span> <span class="fu">sd</span>(reaction_time) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">n</span>()),</span>
<span id="cb692-11"><a href="#cb692-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">CI_lower =</span> M <span class="sc">-</span> <span class="fu">qt</span>((<span class="dv">1</span> <span class="sc">+</span> ci_level) <span class="sc">/</span> <span class="dv">2</span>, <span class="fu">n</span>() <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> SE,</span>
<span id="cb692-12"><a href="#cb692-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">CI_upper =</span> M <span class="sc">+</span> <span class="fu">qt</span>((<span class="dv">1</span> <span class="sc">+</span> ci_level) <span class="sc">/</span> <span class="dv">2</span>, <span class="fu">n</span>() <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> SE,</span>
<span id="cb692-13"><a href="#cb692-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb692-14"><a href="#cb692-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb692-15"><a href="#cb692-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb692-16"><a href="#cb692-16" aria-hidden="true" tabindex="-1"></a>ci_comparison <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(ci_levels, <span class="fu">aes</span>(<span class="at">x =</span> condition, <span class="at">y =</span> M, </span>
<span id="cb692-17"><a href="#cb692-17" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">color =</span> <span class="fu">factor</span>(ci_level))) <span class="sc">+</span></span>
<span id="cb692-18"><a href="#cb692-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.3</span>)) <span class="sc">+</span></span>
<span id="cb692-19"><a href="#cb692-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> CI_lower, <span class="at">ymax =</span> CI_upper), </span>
<span id="cb692-20"><a href="#cb692-20" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">linewidth =</span> <span class="dv">1</span>,</span>
<span id="cb692-21"><a href="#cb692-21" aria-hidden="true" tabindex="-1"></a>                <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.3</span>)) <span class="sc">+</span></span>
<span id="cb692-22"><a href="#cb692-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"green"</span>, <span class="st">"blue"</span>, <span class="st">"red"</span>),</span>
<span id="cb692-23"><a href="#cb692-23" aria-hidden="true" tabindex="-1"></a>                    <span class="at">name =</span> <span class="st">"Confidence Level"</span>) <span class="sc">+</span></span>
<span id="cb692-24"><a href="#cb692-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Comparing Confidence Interval Widths"</span>,</span>
<span id="cb692-25"><a href="#cb692-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Wider intervals = higher confidence"</span>,</span>
<span id="cb692-26"><a href="#cb692-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Reaction Time (ms)"</span>) <span class="sc">+</span></span>
<span id="cb692-27"><a href="#cb692-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb692-28"><a href="#cb692-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb692-29"><a href="#cb692-29" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(ci_comparison)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="part-g-lab-practicals_files/figure-html/lab12-uncertainty-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Checkpoint:</strong> Visualizations honestly communicate uncertainty. Wider CIs reflect small sample imprecision.</p>
<hr>
</section>
<section id="step-5-publication-ready-formatting" class="level3">
<h3 class="anchored" data-anchor-id="step-5-publication-ready-formatting">Step 5: Publication-Ready Formatting</h3>
<p>Apply professional styling:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb693"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb693-1"><a href="#cb693-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Publication-quality figure</span></span>
<span id="cb693-2"><a href="#cb693-2" aria-hidden="true" tabindex="-1"></a>pub_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(pilot_data, <span class="fu">aes</span>(<span class="at">x =</span> condition, <span class="at">y =</span> reaction_time)) <span class="sc">+</span></span>
<span id="cb693-3"><a href="#cb693-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Individual points with beeswarm layout (no overlap)</span></span>
<span id="cb693-4"><a href="#cb693-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_beeswarm</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="fl">2.5</span>, <span class="at">cex =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb693-5"><a href="#cb693-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Mean with 95% CI</span></span>
<span id="cb693-6"><a href="#cb693-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_cl_normal, <span class="at">geom =</span> <span class="st">"errorbar"</span>,</span>
<span id="cb693-7"><a href="#cb693-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">linewidth =</span> <span class="fl">1.2</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb693-8"><a href="#cb693-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"point"</span>, </span>
<span id="cb693-9"><a href="#cb693-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">5</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">shape =</span> <span class="dv">18</span>) <span class="sc">+</span></span>
<span id="cb693-10"><a href="#cb693-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Styling</span></span>
<span id="cb693-11"><a href="#cb693-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">300</span>, <span class="dv">600</span>, <span class="dv">50</span>)) <span class="sc">+</span></span>
<span id="cb693-12"><a href="#cb693-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb693-13"><a href="#cb693-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Reaction Time by Condition"</span>,</span>
<span id="cb693-14"><a href="#cb693-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Within-subjects pilot study (N=18)"</span>,</span>
<span id="cb693-15"><a href="#cb693-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Experimental Condition"</span>,</span>
<span id="cb693-16"><a href="#cb693-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Reaction Time (ms)"</span>,</span>
<span id="cb693-17"><a href="#cb693-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"Individual points shown with means (red diamonds) and 95% CIs.</span><span class="sc">\n</span><span class="st">Error bars represent between-subjects variability."</span></span>
<span id="cb693-18"><a href="#cb693-18" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb693-19"><a href="#cb693-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb693-20"><a href="#cb693-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb693-21"><a href="#cb693-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">family =</span> <span class="st">"sans"</span>),</span>
<span id="cb693-22"><a href="#cb693-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb693-23"><a href="#cb693-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>, <span class="at">color =</span> <span class="st">"gray30"</span>),</span>
<span id="cb693-24"><a href="#cb693-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"gray50"</span>),</span>
<span id="cb693-25"><a href="#cb693-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb693-26"><a href="#cb693-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb693-27"><a href="#cb693-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"gray90"</span>),</span>
<span id="cb693-28"><a href="#cb693-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()</span>
<span id="cb693-29"><a href="#cb693-29" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb693-30"><a href="#cb693-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb693-31"><a href="#cb693-31" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pub_plot)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="part-g-lab-practicals_files/figure-html/lab12-publication-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb694"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb694-1"><a href="#cb694-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Save high-resolution version</span></span>
<span id="cb694-2"><a href="#cb694-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"pilot_reaction_time.png"</span>, pub_plot, </span>
<span id="cb694-3"><a href="#cb694-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">7</span>, <span class="at">height =</span> <span class="dv">5</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb694-4"><a href="#cb694-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Figure saved as 'pilot_reaction_time.png'</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Figure saved as 'pilot_reaction_time.png'</code></pre>
</div>
</div>
<p><strong>Checkpoint:</strong> Publication-ready figure with clear labels, appropriate font sizes, and professional appearance.</p>
<hr>
</section>
<section id="step-6-small-sample-specific-techniques" class="level3">
<h3 class="anchored" data-anchor-id="step-6-small-sample-specific-techniques">Step 6: Small Sample Specific Techniques</h3>
<p>Apply strategies tailored to small n:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb696"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb696-1"><a href="#cb696-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Annotate with exact n</span></span>
<span id="cb696-2"><a href="#cb696-2" aria-hidden="true" tabindex="-1"></a>annotated_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(summary_stats, <span class="fu">aes</span>(<span class="at">x =</span> condition, <span class="at">y =</span> M)) <span class="sc">+</span></span>
<span id="cb696-3"><a href="#cb696-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">"lightblue"</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb696-4"><a href="#cb696-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> CI_lower, <span class="at">ymax =</span> CI_upper), <span class="at">width =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb696-5"><a href="#cb696-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"n="</span>, n)), </span>
<span id="cb696-6"><a href="#cb696-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>) <span class="sc">+</span></span>
<span id="cb696-7"><a href="#cb696-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">data =</span> pilot_data, </span>
<span id="cb696-8"><a href="#cb696-8" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> condition, <span class="at">y =</span> reaction_time),</span>
<span id="cb696-9"><a href="#cb696-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb696-10"><a href="#cb696-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Explicitly State Sample Size"</span>,</span>
<span id="cb696-11"><a href="#cb696-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Reaction Time (ms)"</span>) <span class="sc">+</span></span>
<span id="cb696-12"><a href="#cb696-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb696-13"><a href="#cb696-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb696-14"><a href="#cb696-14" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Show effect sizes, not just means</span></span>
<span id="cb696-15"><a href="#cb696-15" aria-hidden="true" tabindex="-1"></a>effect_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb696-16"><a href="#cb696-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">comparison =</span> <span class="fu">c</span>(<span class="st">"Baseline vs Treatment A"</span>, </span>
<span id="cb696-17"><a href="#cb696-17" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Baseline vs Treatment B"</span>,</span>
<span id="cb696-18"><a href="#cb696-18" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Treatment A vs Treatment B"</span>),</span>
<span id="cb696-19"><a href="#cb696-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">cohens_d =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.52</span>, <span class="sc">-</span><span class="fl">1.32</span>, <span class="sc">-</span><span class="fl">0.75</span>),  <span class="co"># Example values</span></span>
<span id="cb696-20"><a href="#cb696-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">ci_lower =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.15</span>, <span class="sc">-</span><span class="fl">2.03</span>, <span class="sc">-</span><span class="fl">1.40</span>),</span>
<span id="cb696-21"><a href="#cb696-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">ci_upper =</span> <span class="fu">c</span>(<span class="fl">0.12</span>, <span class="sc">-</span><span class="fl">0.60</span>, <span class="sc">-</span><span class="fl">0.10</span>)</span>
<span id="cb696-22"><a href="#cb696-22" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb696-23"><a href="#cb696-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb696-24"><a href="#cb696-24" aria-hidden="true" tabindex="-1"></a>effect_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(effect_data, <span class="fu">aes</span>(<span class="at">x =</span> comparison, <span class="at">y =</span> cohens_d)) <span class="sc">+</span></span>
<span id="cb696-25"><a href="#cb696-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"gray50"</span>) <span class="sc">+</span></span>
<span id="cb696-26"><a href="#cb696-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.2</span>, <span class="sc">-</span><span class="fl">0.5</span>, <span class="sc">-</span><span class="fl">0.8</span>), </span>
<span id="cb696-27"><a href="#cb696-27" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dotted"</span>, <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb696-28"><a href="#cb696-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb696-29"><a href="#cb696-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> ci_lower, <span class="at">ymax =</span> ci_upper), </span>
<span id="cb696-30"><a href="#cb696-30" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb696-31"><a href="#cb696-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb696-32"><a href="#cb696-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Effect Sizes with 95% CIs"</span>,</span>
<span id="cb696-33"><a href="#cb696-33" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"Cohen's d (negative = faster reaction time)"</span>,</span>
<span id="cb696-34"><a href="#cb696-34" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Blue lines indicate small (-0.2), medium (-0.5), large (-0.8) benchmarks"</span>) <span class="sc">+</span></span>
<span id="cb696-35"><a href="#cb696-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb696-36"><a href="#cb696-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb696-37"><a href="#cb696-37" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Emphasize individual differences</span></span>
<span id="cb696-38"><a href="#cb696-38" aria-hidden="true" tabindex="-1"></a>individual_plot <span class="ot">&lt;-</span> pilot_wide <span class="sc">%&gt;%</span></span>
<span id="cb696-39"><a href="#cb696-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">improved =</span> <span class="st">`</span><span class="at">Treatment B</span><span class="st">`</span> <span class="sc">&lt;</span> Baseline) <span class="sc">%&gt;%</span></span>
<span id="cb696-40"><a href="#cb696-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Baseline, <span class="at">y =</span> <span class="st">`</span><span class="at">Treatment B</span><span class="st">`</span>, <span class="at">color =</span> improved)) <span class="sc">+</span></span>
<span id="cb696-41"><a href="#cb696-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"gray50"</span>) <span class="sc">+</span></span>
<span id="cb696-42"><a href="#cb696-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb696-43"><a href="#cb696-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> participant_id), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.8</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb696-44"><a href="#cb696-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"darkgreen"</span>),</span>
<span id="cb696-45"><a href="#cb696-45" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Worsened"</span>, <span class="st">"Improved"</span>),</span>
<span id="cb696-46"><a href="#cb696-46" aria-hidden="true" tabindex="-1"></a>                    <span class="at">name =</span> <span class="st">"Change"</span>) <span class="sc">+</span></span>
<span id="cb696-47"><a href="#cb696-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Individual Response to Treatment B (n=18)"</span>,</span>
<span id="cb696-48"><a href="#cb696-48" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Points below diagonal = improvement"</span>,</span>
<span id="cb696-49"><a href="#cb696-49" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Baseline RT (ms)"</span>, <span class="at">y =</span> <span class="st">"Treatment B RT (ms)"</span>) <span class="sc">+</span></span>
<span id="cb696-50"><a href="#cb696-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>(<span class="at">ratio =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb696-51"><a href="#cb696-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb696-52"><a href="#cb696-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb696-53"><a href="#cb696-53" aria-hidden="true" tabindex="-1"></a><span class="co"># Display all</span></span>
<span id="cb696-54"><a href="#cb696-54" aria-hidden="true" tabindex="-1"></a>annotated_plot <span class="sc">/</span> (effect_plot <span class="sc">|</span> individual_plot)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="part-g-lab-practicals_files/figure-html/lab12-small-n-techniques-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Checkpoint:</strong> Multiple strategies communicate both group trends and individual variability.</p>
<hr>
</section>
<section id="step-7-avoid-common-pitfalls" class="level3">
<h3 class="anchored" data-anchor-id="step-7-avoid-common-pitfalls">Step 7: Avoid Common Pitfalls</h3>
<p>Demonstrate what NOT to do:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb697"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb697-1"><a href="#cb697-1" aria-hidden="true" tabindex="-1"></a><span class="co"># PITFALL 1: Dynamite plots (bars + SE, no data shown)</span></span>
<span id="cb697-2"><a href="#cb697-2" aria-hidden="true" tabindex="-1"></a>pitfall1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(summary_stats, <span class="fu">aes</span>(<span class="at">x =</span> condition, <span class="at">y =</span> M)) <span class="sc">+</span></span>
<span id="cb697-3"><a href="#cb697-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">"gray50"</span>) <span class="sc">+</span></span>
<span id="cb697-4"><a href="#cb697-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> M <span class="sc">-</span> SE, <span class="at">ymax =</span> M <span class="sc">+</span> SE), <span class="at">width =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb697-5"><a href="#cb697-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"AVOID: Dynamite Plot (Bars + SE)"</span>,</span>
<span id="cb697-6"><a href="#cb697-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Hides distribution, SE is not CI"</span>,</span>
<span id="cb697-7"><a href="#cb697-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Reaction Time (ms)"</span>) <span class="sc">+</span></span>
<span id="cb697-8"><a href="#cb697-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb697-9"><a href="#cb697-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb697-10"><a href="#cb697-10" aria-hidden="true" tabindex="-1"></a><span class="co"># PITFALL 2: Over-smoothing with small n</span></span>
<span id="cb697-11"><a href="#cb697-11" aria-hidden="true" tabindex="-1"></a>pitfall2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(pilot_data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.numeric</span>(condition), </span>
<span id="cb697-12"><a href="#cb697-12" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">y =</span> reaction_time)) <span class="sc">+</span></span>
<span id="cb697-13"><a href="#cb697-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"loess"</span>, <span class="at">span =</span> <span class="fl">0.5</span>, <span class="at">se =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb697-14"><a href="#cb697-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"AVOID: Over-smoothed Curve (Implies More Data)"</span>,</span>
<span id="cb697-15"><a href="#cb697-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Only 3 conditions but curve suggests continuous relationship"</span>,</span>
<span id="cb697-16"><a href="#cb697-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>, <span class="at">y =</span> <span class="st">"Reaction Time (ms)"</span>) <span class="sc">+</span></span>
<span id="cb697-17"><a href="#cb697-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb697-18"><a href="#cb697-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb697-19"><a href="#cb697-19" aria-hidden="true" tabindex="-1"></a><span class="co"># PITFALL 3: Missing sample size annotation</span></span>
<span id="cb697-20"><a href="#cb697-20" aria-hidden="true" tabindex="-1"></a>pitfall3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(summary_stats, <span class="fu">aes</span>(<span class="at">x =</span> condition, <span class="at">y =</span> M)) <span class="sc">+</span></span>
<span id="cb697-21"><a href="#cb697-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb697-22"><a href="#cb697-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> CI_lower, <span class="at">ymax =</span> CI_upper), <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb697-23"><a href="#cb697-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"AVOID: No Sample Size Stated"</span>,</span>
<span id="cb697-24"><a href="#cb697-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Reader cannot judge CI width appropriateness"</span>,</span>
<span id="cb697-25"><a href="#cb697-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Reaction Time (ms)"</span>) <span class="sc">+</span></span>
<span id="cb697-26"><a href="#cb697-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb697-27"><a href="#cb697-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb697-28"><a href="#cb697-28" aria-hidden="true" tabindex="-1"></a><span class="co"># BETTER alternatives</span></span>
<span id="cb697-29"><a href="#cb697-29" aria-hidden="true" tabindex="-1"></a>better1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(pilot_data, <span class="fu">aes</span>(<span class="at">x =</span> condition, <span class="at">y =</span> reaction_time)) <span class="sc">+</span></span>
<span id="cb697-30"><a href="#cb697-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.shape =</span> <span class="cn">NA</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb697-31"><a href="#cb697-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb697-32"><a href="#cb697-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"BETTER: Boxplot + Points"</span>,</span>
<span id="cb697-33"><a href="#cb697-33" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Reaction Time (ms)"</span>) <span class="sc">+</span></span>
<span id="cb697-34"><a href="#cb697-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb697-35"><a href="#cb697-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb697-36"><a href="#cb697-36" aria-hidden="true" tabindex="-1"></a>better2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(summary_stats, <span class="fu">aes</span>(<span class="at">x =</span> condition, <span class="at">y =</span> M)) <span class="sc">+</span></span>
<span id="cb697-37"><a href="#cb697-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb697-38"><a href="#cb697-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> CI_lower, <span class="at">ymax =</span> CI_upper), <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb697-39"><a href="#cb697-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">data =</span> pilot_data, </span>
<span id="cb697-40"><a href="#cb697-40" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> condition, <span class="at">y =</span> reaction_time),</span>
<span id="cb697-41"><a href="#cb697-41" aria-hidden="true" tabindex="-1"></a>              <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb697-42"><a href="#cb697-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"BETTER: Points + 95% CI + Data"</span>,</span>
<span id="cb697-43"><a href="#cb697-43" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"n=18 per condition"</span>,</span>
<span id="cb697-44"><a href="#cb697-44" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Reaction Time (ms)"</span>) <span class="sc">+</span></span>
<span id="cb697-45"><a href="#cb697-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb697-46"><a href="#cb697-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb697-47"><a href="#cb697-47" aria-hidden="true" tabindex="-1"></a>(pitfall1 <span class="sc">|</span> better1) <span class="sc">/</span> (pitfall2 <span class="sc">|</span> better2)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="part-g-lab-practicals_files/figure-html/lab12-pitfalls-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Checkpoint:</strong> Contrast highlights importance of showing data and being transparent about sample size.</p>
<p><strong>Discussion:</strong> Why are dynamite plots especially misleading with small samples?</p>
<hr>
</section>
<section id="step-8-create-multi-panel-publication-figure" class="level3">
<h3 class="anchored" data-anchor-id="step-8-create-multi-panel-publication-figure">Step 8: Create Multi-Panel Publication Figure</h3>
<p>Combine multiple visualizations:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb698"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb698-1"><a href="#cb698-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Panel A: Main result with individual trajectories</span></span>
<span id="cb698-2"><a href="#cb698-2" aria-hidden="true" tabindex="-1"></a>panel_a <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(pilot_data, </span>
<span id="cb698-3"><a href="#cb698-3" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">aes</span>(<span class="at">x =</span> condition, <span class="at">y =</span> reaction_time, </span>
<span id="cb698-4"><a href="#cb698-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">group =</span> participant_id)) <span class="sc">+</span></span>
<span id="cb698-5"><a href="#cb698-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">color =</span> <span class="st">"gray70"</span>) <span class="sc">+</span></span>
<span id="cb698-6"><a href="#cb698-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb698-7"><a href="#cb698-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="fu">aes</span>(<span class="at">group =</span> <span class="dv">1</span>), <span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"line"</span>, </span>
<span id="cb698-8"><a href="#cb698-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linewidth =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb698-9"><a href="#cb698-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"point"</span>, </span>
<span id="cb698-10"><a href="#cb698-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">shape =</span> <span class="dv">18</span>) <span class="sc">+</span></span>
<span id="cb698-11"><a href="#cb698-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_cl_normal, <span class="at">geom =</span> <span class="st">"errorbar"</span>,</span>
<span id="cb698-12"><a href="#cb698-12" aria-hidden="true" tabindex="-1"></a>               <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb698-13"><a href="#cb698-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">"A. Individual Trajectories"</span>,</span>
<span id="cb698-14"><a href="#cb698-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Reaction Time (ms)"</span>, <span class="at">x =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb698-15"><a href="#cb698-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb698-16"><a href="#cb698-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb698-17"><a href="#cb698-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Panel B: Distribution comparison</span></span>
<span id="cb698-18"><a href="#cb698-18" aria-hidden="true" tabindex="-1"></a>panel_b <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(pilot_data, <span class="fu">aes</span>(<span class="at">x =</span> reaction_time, <span class="at">fill =</span> condition)) <span class="sc">+</span></span>
<span id="cb698-19"><a href="#cb698-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb698-20"><a href="#cb698-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">"B. Density Distributions"</span>,</span>
<span id="cb698-21"><a href="#cb698-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Reaction Time (ms)"</span>, <span class="at">y =</span> <span class="st">"Density"</span>) <span class="sc">+</span></span>
<span id="cb698-22"><a href="#cb698-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb698-23"><a href="#cb698-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb698-24"><a href="#cb698-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb698-25"><a href="#cb698-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Panel C: Effect sizes</span></span>
<span id="cb698-26"><a href="#cb698-26" aria-hidden="true" tabindex="-1"></a>treat_b_vs_baseline <span class="ot">&lt;-</span> pilot_wide <span class="sc">%&gt;%</span></span>
<span id="cb698-27"><a href="#cb698-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb698-28"><a href="#cb698-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">d =</span> (<span class="fu">mean</span>(Baseline) <span class="sc">-</span> <span class="fu">mean</span>(<span class="st">`</span><span class="at">Treatment B</span><span class="st">`</span>)) <span class="sc">/</span> </span>
<span id="cb698-29"><a href="#cb698-29" aria-hidden="true" tabindex="-1"></a>        <span class="fu">sqrt</span>((<span class="fu">sd</span>(Baseline)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">sd</span>(<span class="st">`</span><span class="at">Treatment B</span><span class="st">`</span>)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb698-30"><a href="#cb698-30" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb698-31"><a href="#cb698-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(d)</span>
<span id="cb698-32"><a href="#cb698-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb698-33"><a href="#cb698-33" aria-hidden="true" tabindex="-1"></a>effect_summary <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb698-34"><a href="#cb698-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">Comparison =</span> <span class="fu">c</span>(<span class="st">"Treatment A vs Baseline"</span>, <span class="st">"Treatment B vs Baseline"</span>),</span>
<span id="cb698-35"><a href="#cb698-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">d =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>, treat_b_vs_baseline),  <span class="co"># Negative = improvement</span></span>
<span id="cb698-36"><a href="#cb698-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">ci_lower =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.1</span>, treat_b_vs_baseline <span class="sc">-</span> <span class="fl">0.6</span>),</span>
<span id="cb698-37"><a href="#cb698-37" aria-hidden="true" tabindex="-1"></a>  <span class="at">ci_upper =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, treat_b_vs_baseline <span class="sc">+</span> <span class="fl">0.6</span>)</span>
<span id="cb698-38"><a href="#cb698-38" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb698-39"><a href="#cb698-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb698-40"><a href="#cb698-40" aria-hidden="true" tabindex="-1"></a>panel_c <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(effect_summary, <span class="fu">aes</span>(<span class="at">x =</span> Comparison, <span class="at">y =</span> d)) <span class="sc">+</span></span>
<span id="cb698-41"><a href="#cb698-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb698-42"><a href="#cb698-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb698-43"><a href="#cb698-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> ci_lower, <span class="at">ymax =</span> ci_upper), </span>
<span id="cb698-44"><a href="#cb698-44" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb698-45"><a href="#cb698-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb698-46"><a href="#cb698-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">"C. Standardized Effect Sizes"</span>,</span>
<span id="cb698-47"><a href="#cb698-47" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"Cohen's d (95% CI)"</span>) <span class="sc">+</span></span>
<span id="cb698-48"><a href="#cb698-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb698-49"><a href="#cb698-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb698-50"><a href="#cb698-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine panels</span></span>
<span id="cb698-51"><a href="#cb698-51" aria-hidden="true" tabindex="-1"></a>final_figure <span class="ot">&lt;-</span> (panel_a <span class="sc">|</span> panel_b) <span class="sc">/</span> panel_c <span class="sc">+</span></span>
<span id="cb698-52"><a href="#cb698-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(</span>
<span id="cb698-53"><a href="#cb698-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Reaction Time Across Experimental Conditions"</span>,</span>
<span id="cb698-54"><a href="#cb698-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Within-subjects pilot study (N=18)"</span>,</span>
<span id="cb698-55"><a href="#cb698-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"Red line/points = group means with 95% CIs. Effect sizes calculated as within-subjects Cohen's d."</span>,</span>
<span id="cb698-56"><a href="#cb698-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">theme =</span> <span class="fu">theme</span>(</span>
<span id="cb698-57"><a href="#cb698-57" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb698-58"><a href="#cb698-58" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>)</span>
<span id="cb698-59"><a href="#cb698-59" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb698-60"><a href="#cb698-60" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb698-61"><a href="#cb698-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb698-62"><a href="#cb698-62" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(final_figure)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="part-g-lab-practicals_files/figure-html/lab12-multipanel-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb699"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb699-1"><a href="#cb699-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Save publication figure</span></span>
<span id="cb699-2"><a href="#cb699-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"figure_multipanel.png"</span>, final_figure, </span>
<span id="cb699-3"><a href="#cb699-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">8</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb699-4"><a href="#cb699-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Multi-panel figure saved as 'figure_multipanel.png'</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Multi-panel figure saved as 'figure_multipanel.png'</code></pre>
</div>
</div>
<p><strong>Checkpoint:</strong> Comprehensive multi-panel figure tells complete story: trajectories, distributions, and effect sizes.</p>
<hr>
</section>
<section id="discussion-questions-11" class="level3">
<h3 class="anchored" data-anchor-id="discussion-questions-11">Discussion Questions</h3>
<ol type="1">
<li><p><strong>Bars vs Points:</strong> Why are bar charts problematic for small-sample continuous data?</p>
<p><em>Answer: Bars (1) hide individual data points, (2) imply data start at zero (rarely meaningful for reaction time, test scores, etc.), (3) obscure distributional shape, (4) waste ink on empty space. Points + error bars are more informative.</em></p></li>
<li><p><strong>How Many Points:</strong> With n=5, should you show all individual points?</p>
<p><em>Answer: Absolutely! With very small n, every observation is influential and readers should see them all. Use jittering to avoid overlap, and consider labeling points or using different symbols.</em></p></li>
<li><p><strong>Error Bar Choice:</strong> SE, 95% CI, or SD? Which should you display?</p>
<p><em>Answer: Prefer 95% CI (matches hypothesis testing, directly interpretable). SD shows data spread (useful for understanding variability). Avoid SE (easily confused with CI, magnitude depends on n).</em></p></li>
<li><p><strong>Color Considerations:</strong> What color choices improve accessibility?</p>
<p><em>Answer: Use colorblind-safe palettes (e.g., viridis), ensure sufficient contrast, don’t rely solely on color (use shapes/patterns too), test plots in grayscale, consider cultural associations.</em></p></li>
<li><p><strong>Transparency:</strong> How do you communicate small sample limitations visually?</p>
<p><em>Answer: (1) State n prominently, (2) show wide CIs, (3) display all individual points, (4) avoid over-confident smoothing, (5) use “pilot” or “preliminary” in titles, (6) show effect size uncertainty.</em></p></li>
</ol>
<hr>
</section>
<section id="key-takeaways-11" class="level3">
<h3 class="anchored" data-anchor-id="key-takeaways-11">Key Takeaways</h3>
<p>✓ <strong>Always show individual data points</strong> in small samples (n&lt;30)<br>
✓ <strong>Display uncertainty</strong> with confidence intervals, not just SEs<br>
✓ <strong>Avoid bar charts</strong> for continuous data – prefer points or boxes<br>
✓ <strong>Within-subjects designs</strong>: show individual trajectories<br>
✓ <strong>State sample size</strong> prominently in title, subtitle, or annotations<br>
✓ <strong>Use professional styling</strong> – clear labels, readable fonts, appropriate colors<br>
✓ <strong>Multi-panel figures</strong> tell richer stories than single plots</p>
<hr>
</section>
<section id="homework-exercise-11" class="level3">
<h3 class="anchored" data-anchor-id="homework-exercise-11">Homework Exercise</h3>
<p><strong>Dataset:</strong> A pilot cognitive training study (n=15) with pre- and post-test scores.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb701"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb701-1"><a href="#cb701-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">987</span>)</span>
<span id="cb701-2"><a href="#cb701-2" aria-hidden="true" tabindex="-1"></a>training_study <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb701-3"><a href="#cb701-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">participant_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>,</span>
<span id="cb701-4"><a href="#cb701-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">age =</span> <span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="dv">15</span>, <span class="dv">28</span>, <span class="dv">5</span>)),</span>
<span id="cb701-5"><a href="#cb701-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">pretest =</span> <span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="dv">15</span>, <span class="dv">60</span>, <span class="dv">10</span>)),</span>
<span id="cb701-6"><a href="#cb701-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">posttest =</span> <span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="dv">15</span>, <span class="dv">72</span>, <span class="dv">12</span>))</span>
<span id="cb701-7"><a href="#cb701-7" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb701-8"><a href="#cb701-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb701-9"><a href="#cb701-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">gain =</span> posttest <span class="sc">-</span> pretest,</span>
<span id="cb701-10"><a href="#cb701-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">percent_gain =</span> (gain <span class="sc">/</span> pretest) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb701-11"><a href="#cb701-11" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p><strong>Your Tasks:</strong></p>
<ol type="1">
<li>Create a “bad” visualization (bar chart hiding data) and a “good” visualization (showing individual points)</li>
<li>Make a paired scatter plot (pretest vs posttest) with identity line</li>
<li>Create a trajectory plot showing individual pre-to-post changes</li>
<li>Generate a raincloud plot for the gain scores</li>
<li>Make a plot emphasizing uncertainty (show 80%, 90%, 95% CIs)</li>
<li>Calculate Cohen’s d for pre-post difference and create a forest plot</li>
<li>Create a multi-panel figure combining: (A) trajectories, (B) gain distribution, (C) effect size</li>
<li>Apply publication-ready formatting (clear labels, professional theme, sample size annotation)</li>
<li>Save the final figure as high-resolution PNG (300 dpi)</li>
<li>Write a figure caption describing what is shown</li>
</ol>
<p><strong>Expected Results:</strong></p>
<ul>
<li>Significant pre-post improvement (gain ~10-15 points)</li>
<li>Wide CIs reflecting small sample (n=15)</li>
<li>Most individuals improve (but show variability)</li>
<li>Cohen’s d approximately 0.8-1.2 (large effect)</li>
<li>Publication figure should be clear, honest, and professional</li>
</ul>
<p><strong>Hints:</strong> - Use <code>geom_segment()</code> or <code>geom_line()</code> for trajectory plots - For paired scatter: <code>geom_abline(slope=1, intercept=0)</code> for identity line - Use <code>patchwork</code> to combine plots: <code>plot_a | plot_b</code> or <code>plot_a / plot_b</code> - Add n to subtitle: <code>subtitle = "Pilot cognitive training study (N=15)"</code></p>
<p><strong>Bonus:</strong> Create an animated version showing the transition from pretest to posttest using <code>gganimate</code>. This can effectively communicate within-subjects change even in presentations. Export as GIF or MP4.</p>
<hr>
<p><em>Congratulations! You’ve completed all 12 guided lab practicals covering essential statistical techniques for small-sample research. These hands-on exercises complement the theoretical content throughout the book and prepare you for real-world data analysis challenges.</em></p>


<!-- -->

</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../chapters/part-f-technical-appendices.html" class="pagination-link" aria-label="Part F: Technical Appendices">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Part F: Technical Appendices</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../chapters/part-h-instructors-manual.html" class="pagination-link" aria-label="Part H: Instructor's Manual">
        <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Part H: Instructor’s Manual</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb702" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb702-1"><a href="#cb702-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># Part G: Guided Lab Practicals {.unnumbered}</span></span>
<span id="cb702-2"><a href="#cb702-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3"><a href="#cb702-3" aria-hidden="true" tabindex="-1"></a>This section provides hands-on, step-by-step lab walkthroughs for key statistical methods covered in the book. Each lab includes:</span>
<span id="cb702-4"><a href="#cb702-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-5"><a href="#cb702-5" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Clear learning objectives** for what you'll master</span>
<span id="cb702-6"><a href="#cb702-6" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Realistic scenarios** with small-sample data</span>
<span id="cb702-7"><a href="#cb702-7" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Checkpoints** to verify your code is working correctly</span>
<span id="cb702-8"><a href="#cb702-8" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Discussion questions** to deepen understanding</span>
<span id="cb702-9"><a href="#cb702-9" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Homework exercises** to practice independently</span>
<span id="cb702-10"><a href="#cb702-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-11"><a href="#cb702-11" aria-hidden="true" tabindex="-1"></a>**How to Use These Labs:**</span>
<span id="cb702-12"><a href="#cb702-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-13"><a href="#cb702-13" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Work through each step sequentially** - don't skip ahead!</span>
<span id="cb702-14"><a href="#cb702-14" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Type the code yourself** rather than copy-pasting (better learning)</span>
<span id="cb702-15"><a href="#cb702-15" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Check your output** at each checkpoint before proceeding</span>
<span id="cb702-16"><a href="#cb702-16" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Attempt discussion questions** before looking at solutions</span>
<span id="cb702-17"><a href="#cb702-17" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>**Complete homework exercises** to reinforce skills</span>
<span id="cb702-18"><a href="#cb702-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-19"><a href="#cb702-19" aria-hidden="true" tabindex="-1"></a>**Lab Schedule:**</span>
<span id="cb702-20"><a href="#cb702-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-21"><a href="#cb702-21" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Lab 1**: Fisher's Exact Test (Chapter 3)</span>
<span id="cb702-22"><a href="#cb702-22" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Lab 2**: Bootstrap Confidence Intervals (Chapter 3)</span>
<span id="cb702-23"><a href="#cb702-23" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Lab 3**: Mann-Whitney U Test (Chapter 4)</span>
<span id="cb702-24"><a href="#cb702-24" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Lab 4**: Wilcoxon Signed-Rank Test (Chapter 4)</span>
<span id="cb702-25"><a href="#cb702-25" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Lab 5**: Firth's Logistic Regression (Chapter 5)</span>
<span id="cb702-26"><a href="#cb702-26" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Lab 6**: Bayesian Regression with brms (Chapter 5)</span>
<span id="cb702-27"><a href="#cb702-27" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Lab 7**: Reliability Analysis with Cronbach's Alpha (Chapter 6)</span>
<span id="cb702-28"><a href="#cb702-28" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Lab 8**: Power Analysis and Sample Size Planning (Chapter 2)</span>
<span id="cb702-29"><a href="#cb702-29" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Lab 9**: Multiple Imputation for Missing Data (Chapter 12)</span>
<span id="cb702-30"><a href="#cb702-30" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Lab 10**: Data Screening and Outlier Detection (Chapter 11)</span>
<span id="cb702-31"><a href="#cb702-31" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Lab 11**: Effect Sizes and Confidence Intervals (Chapter 13)</span>
<span id="cb702-32"><a href="#cb702-32" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Lab 12**: Visualizing Small-Sample Results (Chapter 16)</span>
<span id="cb702-33"><a href="#cb702-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-34"><a href="#cb702-34" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-35"><a href="#cb702-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-36"><a href="#cb702-36" aria-hidden="true" tabindex="-1"></a><span class="fu">## Lab 1: Fisher's Exact Test (Chapter 3)</span></span>
<span id="cb702-37"><a href="#cb702-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-38"><a href="#cb702-38" aria-hidden="true" tabindex="-1"></a><span class="fu"># 🧪 Lab Practical 1: Fisher's Exact Test Step-by-Step</span></span>
<span id="cb702-39"><a href="#cb702-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-40"><a href="#cb702-40" aria-hidden="true" tabindex="-1"></a>**Learning Objectives:**</span>
<span id="cb702-41"><a href="#cb702-41" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Construct 2×2 contingency tables in R</span>
<span id="cb702-42"><a href="#cb702-42" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Perform Fisher's exact test</span>
<span id="cb702-43"><a href="#cb702-43" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Interpret odds ratios and confidence intervals</span>
<span id="cb702-44"><a href="#cb702-44" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Compare with chi-square to understand when exact tests are necessary</span>
<span id="cb702-45"><a href="#cb702-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-46"><a href="#cb702-46" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-47"><a href="#cb702-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-48"><a href="#cb702-48" aria-hidden="true" tabindex="-1"></a><span class="fu">### Scenario</span></span>
<span id="cb702-49"><a href="#cb702-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-50"><a href="#cb702-50" aria-hidden="true" tabindex="-1"></a>A small clinic tests a new pain relief protocol. They randomly assign 16 patients:</span>
<span id="cb702-51"><a href="#cb702-51" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**New Protocol**: 7 reported significant relief, 1 did not</span>
<span id="cb702-52"><a href="#cb702-52" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Standard Care**: 2 reported significant relief, 6 did not</span>
<span id="cb702-53"><a href="#cb702-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-54"><a href="#cb702-54" aria-hidden="true" tabindex="-1"></a>**Research Question**: Is the new protocol more effective than standard care?</span>
<span id="cb702-55"><a href="#cb702-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-56"><a href="#cb702-56" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-57"><a href="#cb702-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-58"><a href="#cb702-58" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 1: Set Up Your Workspace</span></span>
<span id="cb702-59"><a href="#cb702-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-62"><a href="#cb702-62" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb702-63"><a href="#cb702-63" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: lab1-step1</span></span>
<span id="cb702-64"><a href="#cb702-64" aria-hidden="true" tabindex="-1"></a><span class="co"># Load required packages</span></span>
<span id="cb702-65"><a href="#cb702-65" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb702-66"><a href="#cb702-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-67"><a href="#cb702-67" aria-hidden="true" tabindex="-1"></a><span class="co"># Set seed for reproducibility</span></span>
<span id="cb702-68"><a href="#cb702-68" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb702-69"><a href="#cb702-69" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-70"><a href="#cb702-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-71"><a href="#cb702-71" aria-hidden="true" tabindex="-1"></a>**✋ Checkpoint 1:** </span>
<span id="cb702-72"><a href="#cb702-72" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Packages loaded? You should see no error messages.</span>
<span id="cb702-73"><a href="#cb702-73" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>If <span class="in">`tidyverse`</span> fails: run <span class="in">`install.packages("tidyverse")`</span></span>
<span id="cb702-74"><a href="#cb702-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-75"><a href="#cb702-75" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-76"><a href="#cb702-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-77"><a href="#cb702-77" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 2: Create the 2×2 Table</span></span>
<span id="cb702-78"><a href="#cb702-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-81"><a href="#cb702-81" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb702-82"><a href="#cb702-82" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: lab1-step2</span></span>
<span id="cb702-83"><a href="#cb702-83" aria-hidden="true" tabindex="-1"></a><span class="co"># Create contingency table</span></span>
<span id="cb702-84"><a href="#cb702-84" aria-hidden="true" tabindex="-1"></a><span class="co"># Rows: Treatment (New Protocol, Standard)</span></span>
<span id="cb702-85"><a href="#cb702-85" aria-hidden="true" tabindex="-1"></a><span class="co"># Columns: Outcome (Relief, No Relief)</span></span>
<span id="cb702-86"><a href="#cb702-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-87"><a href="#cb702-87" aria-hidden="true" tabindex="-1"></a>pain_relief <span class="ot">&lt;-</span> <span class="fu">matrix</span>(</span>
<span id="cb702-88"><a href="#cb702-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">1</span>,    <span class="co"># New Protocol: 7 relief, 1 no relief</span></span>
<span id="cb702-89"><a href="#cb702-89" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span>, <span class="dv">6</span>),   <span class="co"># Standard Care: 2 relief, 6 no relief</span></span>
<span id="cb702-90"><a href="#cb702-90" aria-hidden="true" tabindex="-1"></a>  <span class="at">nrow =</span> <span class="dv">2</span>,</span>
<span id="cb702-91"><a href="#cb702-91" aria-hidden="true" tabindex="-1"></a>  <span class="at">byrow =</span> <span class="cn">TRUE</span>,</span>
<span id="cb702-92"><a href="#cb702-92" aria-hidden="true" tabindex="-1"></a>  <span class="at">dimnames =</span> <span class="fu">list</span>(</span>
<span id="cb702-93"><a href="#cb702-93" aria-hidden="true" tabindex="-1"></a>    <span class="at">Treatment =</span> <span class="fu">c</span>(<span class="st">"New Protocol"</span>, <span class="st">"Standard Care"</span>),</span>
<span id="cb702-94"><a href="#cb702-94" aria-hidden="true" tabindex="-1"></a>    <span class="at">Outcome =</span> <span class="fu">c</span>(<span class="st">"Relief"</span>, <span class="st">"No Relief"</span>)</span>
<span id="cb702-95"><a href="#cb702-95" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb702-96"><a href="#cb702-96" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb702-97"><a href="#cb702-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-98"><a href="#cb702-98" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the table</span></span>
<span id="cb702-99"><a href="#cb702-99" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pain_relief)</span>
<span id="cb702-100"><a href="#cb702-100" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-101"><a href="#cb702-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-102"><a href="#cb702-102" aria-hidden="true" tabindex="-1"></a>**Expected Output:**</span>
<span id="cb702-103"><a href="#cb702-103" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-104"><a href="#cb702-104" aria-hidden="true" tabindex="-1"></a><span class="in">              Outcome</span></span>
<span id="cb702-105"><a href="#cb702-105" aria-hidden="true" tabindex="-1"></a><span class="in">Treatment      Relief No Relief</span></span>
<span id="cb702-106"><a href="#cb702-106" aria-hidden="true" tabindex="-1"></a><span class="in">  New Protocol      7         1</span></span>
<span id="cb702-107"><a href="#cb702-107" aria-hidden="true" tabindex="-1"></a><span class="in">  Standard Care     2         6</span></span>
<span id="cb702-108"><a href="#cb702-108" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-109"><a href="#cb702-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-110"><a href="#cb702-110" aria-hidden="true" tabindex="-1"></a>**✋ Checkpoint 2:**</span>
<span id="cb702-111"><a href="#cb702-111" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Does your table match the expected output?</span>
<span id="cb702-112"><a href="#cb702-112" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Check: Top-left cell should be 7 (New Protocol successes)</span>
<span id="cb702-113"><a href="#cb702-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-114"><a href="#cb702-114" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-115"><a href="#cb702-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-116"><a href="#cb702-116" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 3: Visual Inspection</span></span>
<span id="cb702-117"><a href="#cb702-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-120"><a href="#cb702-120" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb702-121"><a href="#cb702-121" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: lab1-step3</span></span>
<span id="cb702-122"><a href="#cb702-122" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Pain relief outcomes by treatment group"</span></span>
<span id="cb702-123"><a href="#cb702-123" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to data frame for plotting</span></span>
<span id="cb702-124"><a href="#cb702-124" aria-hidden="true" tabindex="-1"></a>pain_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">as.table</span>(pain_relief))</span>
<span id="cb702-125"><a href="#cb702-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-126"><a href="#cb702-126" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pain_df, <span class="fu">aes</span>(<span class="at">x =</span> Treatment, <span class="at">y =</span> Freq, <span class="at">fill =</span> Outcome)) <span class="sc">+</span></span>
<span id="cb702-127"><a href="#cb702-127" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb702-128"><a href="#cb702-128" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Pain Relief by Treatment"</span>,</span>
<span id="cb702-129"><a href="#cb702-129" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Number of Patients"</span>) <span class="sc">+</span></span>
<span id="cb702-130"><a href="#cb702-130" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb702-131"><a href="#cb702-131" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set2"</span>)</span>
<span id="cb702-132"><a href="#cb702-132" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-133"><a href="#cb702-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-134"><a href="#cb702-134" aria-hidden="true" tabindex="-1"></a>**❓ Question 1:** Looking at the plot, does the new protocol appear more effective?</span>
<span id="cb702-135"><a href="#cb702-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-136"><a href="#cb702-136" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-137"><a href="#cb702-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-138"><a href="#cb702-138" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 4: Check Expected Cell Counts</span></span>
<span id="cb702-139"><a href="#cb702-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-142"><a href="#cb702-142" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb702-143"><a href="#cb702-143" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: lab1-step4</span></span>
<span id="cb702-144"><a href="#cb702-144" aria-hidden="true" tabindex="-1"></a><span class="co"># Chi-square test (just to check expected frequencies)</span></span>
<span id="cb702-145"><a href="#cb702-145" aria-hidden="true" tabindex="-1"></a>chisq_test <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(pain_relief)</span>
<span id="cb702-146"><a href="#cb702-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-147"><a href="#cb702-147" aria-hidden="true" tabindex="-1"></a><span class="co"># Expected counts</span></span>
<span id="cb702-148"><a href="#cb702-148" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Expected cell counts:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-149"><a href="#cb702-149" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(chisq_test<span class="sc">$</span>expected)</span>
<span id="cb702-150"><a href="#cb702-150" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-151"><a href="#cb702-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-152"><a href="#cb702-152" aria-hidden="true" tabindex="-1"></a>**✋ Checkpoint 3:**</span>
<span id="cb702-153"><a href="#cb702-153" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Are ANY expected counts &lt; 5? (They should be!)</span>
<span id="cb702-154"><a href="#cb702-154" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Expected output: Several cells will have counts around 2-4</span>
<span id="cb702-155"><a href="#cb702-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-156"><a href="#cb702-156" aria-hidden="true" tabindex="-1"></a>**💡 Teaching Point:** When any expected cell count is &lt; 5, chi-square approximations break down. Fisher's exact test is mandatory.</span>
<span id="cb702-157"><a href="#cb702-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-158"><a href="#cb702-158" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-159"><a href="#cb702-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-160"><a href="#cb702-160" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 5: Run Fisher's Exact Test</span></span>
<span id="cb702-161"><a href="#cb702-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-164"><a href="#cb702-164" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb702-165"><a href="#cb702-165" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: lab1-step5</span></span>
<span id="cb702-166"><a href="#cb702-166" aria-hidden="true" tabindex="-1"></a><span class="co"># Fisher's exact test</span></span>
<span id="cb702-167"><a href="#cb702-167" aria-hidden="true" tabindex="-1"></a>fisher_result <span class="ot">&lt;-</span> <span class="fu">fisher.test</span>(pain_relief)</span>
<span id="cb702-168"><a href="#cb702-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-169"><a href="#cb702-169" aria-hidden="true" tabindex="-1"></a><span class="co"># Print full results</span></span>
<span id="cb702-170"><a href="#cb702-170" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fisher_result)</span>
<span id="cb702-171"><a href="#cb702-171" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-172"><a href="#cb702-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-173"><a href="#cb702-173" aria-hidden="true" tabindex="-1"></a>**Expected Output:**</span>
<span id="cb702-174"><a href="#cb702-174" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-175"><a href="#cb702-175" aria-hidden="true" tabindex="-1"></a><span class="in">Fisher's Exact Test for Count Data</span></span>
<span id="cb702-176"><a href="#cb702-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-177"><a href="#cb702-177" aria-hidden="true" tabindex="-1"></a><span class="in">data:  pain_relief</span></span>
<span id="cb702-178"><a href="#cb702-178" aria-hidden="true" tabindex="-1"></a><span class="in">p-value = 0.0206</span></span>
<span id="cb702-179"><a href="#cb702-179" aria-hidden="true" tabindex="-1"></a><span class="in">alternative hypothesis: true odds ratio is not equal to 1</span></span>
<span id="cb702-180"><a href="#cb702-180" aria-hidden="true" tabindex="-1"></a><span class="in">95 percent confidence interval:</span></span>
<span id="cb702-181"><a href="#cb702-181" aria-hidden="true" tabindex="-1"></a><span class="in">  1.195  165.626</span></span>
<span id="cb702-182"><a href="#cb702-182" aria-hidden="true" tabindex="-1"></a><span class="in">sample estimates:</span></span>
<span id="cb702-183"><a href="#cb702-183" aria-hidden="true" tabindex="-1"></a><span class="in">odds ratio </span></span>
<span id="cb702-184"><a href="#cb702-184" aria-hidden="true" tabindex="-1"></a><span class="in">     18.97</span></span>
<span id="cb702-185"><a href="#cb702-185" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-186"><a href="#cb702-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-187"><a href="#cb702-187" aria-hidden="true" tabindex="-1"></a>**✋ Checkpoint 4:**</span>
<span id="cb702-188"><a href="#cb702-188" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Is p-value &lt; 0.05? (Yes, approximately 0.02)</span>
<span id="cb702-189"><a href="#cb702-189" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>What is the odds ratio? (Around 19)</span>
<span id="cb702-190"><a href="#cb702-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-191"><a href="#cb702-191" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-192"><a href="#cb702-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-193"><a href="#cb702-193" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 6: Extract and Interpret Key Values</span></span>
<span id="cb702-194"><a href="#cb702-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-197"><a href="#cb702-197" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb702-198"><a href="#cb702-198" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: lab1-step6</span></span>
<span id="cb702-199"><a href="#cb702-199" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract components for reporting</span></span>
<span id="cb702-200"><a href="#cb702-200" aria-hidden="true" tabindex="-1"></a>or_estimate <span class="ot">&lt;-</span> fisher_result<span class="sc">$</span>estimate</span>
<span id="cb702-201"><a href="#cb702-201" aria-hidden="true" tabindex="-1"></a>or_ci_lower <span class="ot">&lt;-</span> fisher_result<span class="sc">$</span>conf.int[<span class="dv">1</span>]</span>
<span id="cb702-202"><a href="#cb702-202" aria-hidden="true" tabindex="-1"></a>or_ci_upper <span class="ot">&lt;-</span> fisher_result<span class="sc">$</span>conf.int[<span class="dv">2</span>]</span>
<span id="cb702-203"><a href="#cb702-203" aria-hidden="true" tabindex="-1"></a>p_value <span class="ot">&lt;-</span> fisher_result<span class="sc">$</span>p.value</span>
<span id="cb702-204"><a href="#cb702-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-205"><a href="#cb702-205" aria-hidden="true" tabindex="-1"></a><span class="co"># Print interpretation</span></span>
<span id="cb702-206"><a href="#cb702-206" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"==========================================</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-207"><a href="#cb702-207" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"INTERPRETATION</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-208"><a href="#cb702-208" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"==========================================</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb702-209"><a href="#cb702-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-210"><a href="#cb702-210" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"1. Odds Ratio ="</span>, <span class="fu">round</span>(or_estimate, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-211"><a href="#cb702-211" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"   → Odds of pain relief are"</span>, <span class="fu">round</span>(or_estimate, <span class="dv">1</span>), </span>
<span id="cb702-212"><a href="#cb702-212" aria-hidden="true" tabindex="-1"></a>    <span class="st">"times higher with new protocol</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb702-213"><a href="#cb702-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-214"><a href="#cb702-214" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"2. 95% CI: ["</span>, <span class="fu">round</span>(or_ci_lower, <span class="dv">2</span>), <span class="st">","</span>, </span>
<span id="cb702-215"><a href="#cb702-215" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(or_ci_upper, <span class="dv">2</span>), <span class="st">"]</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-216"><a href="#cb702-216" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"   → Wide CI reflects small sample size (n=16)</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-217"><a href="#cb702-217" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"   → CI excludes 1, consistent with p&lt;0.05</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb702-218"><a href="#cb702-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-219"><a href="#cb702-219" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"3. p-value ="</span>, <span class="fu">round</span>(p_value, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-220"><a href="#cb702-220" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"   → Statistically significant at α=0.05</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb702-221"><a href="#cb702-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-222"><a href="#cb702-222" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"4. Conclusion:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-223"><a href="#cb702-223" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"   The new protocol shows promise (OR=19),</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-224"><a href="#cb702-224" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"   suggesting substantially higher odds of relief.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-225"><a href="#cb702-225" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"   However, the wide CI (1.2 to 166!) reflects</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-226"><a href="#cb702-226" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"   substantial uncertainty due to small sample.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-227"><a href="#cb702-227" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"   A larger trial is warranted.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-228"><a href="#cb702-228" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-229"><a href="#cb702-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-230"><a href="#cb702-230" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-231"><a href="#cb702-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-232"><a href="#cb702-232" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 7: Compare with Chi-Square (Educational)</span></span>
<span id="cb702-233"><a href="#cb702-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-236"><a href="#cb702-236" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb702-237"><a href="#cb702-237" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: lab1-step7</span></span>
<span id="cb702-238"><a href="#cb702-238" aria-hidden="true" tabindex="-1"></a><span class="co"># Run chi-square despite small expected counts</span></span>
<span id="cb702-239"><a href="#cb702-239" aria-hidden="true" tabindex="-1"></a><span class="co"># (Just to see the warning!)</span></span>
<span id="cb702-240"><a href="#cb702-240" aria-hidden="true" tabindex="-1"></a>chisq_result <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(pain_relief)</span>
<span id="cb702-241"><a href="#cb702-241" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(chisq_result)</span>
<span id="cb702-242"><a href="#cb702-242" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-243"><a href="#cb702-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-244"><a href="#cb702-244" aria-hidden="true" tabindex="-1"></a>**Expected Warning:**</span>
<span id="cb702-245"><a href="#cb702-245" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-246"><a href="#cb702-246" aria-hidden="true" tabindex="-1"></a><span class="in">Warning: Chi-squared approximation may be incorrect</span></span>
<span id="cb702-247"><a href="#cb702-247" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-248"><a href="#cb702-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-249"><a href="#cb702-249" aria-hidden="true" tabindex="-1"></a>**❓ Question 2:** What happens to the chi-square p-value? Is it similar to Fisher's?</span>
<span id="cb702-250"><a href="#cb702-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-251"><a href="#cb702-251" aria-hidden="true" tabindex="-1"></a>**💡 Teaching Point:** With small cell counts:</span>
<span id="cb702-252"><a href="#cb702-252" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Chi-square gives unreliable p-values</span>
<span id="cb702-253"><a href="#cb702-253" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Fisher's exact test is gold standard</span>
<span id="cb702-254"><a href="#cb702-254" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>In this case, both suggest significance, but Fisher's is trustworthy</span>
<span id="cb702-255"><a href="#cb702-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-256"><a href="#cb702-256" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-257"><a href="#cb702-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-258"><a href="#cb702-258" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 8: Create a Publication-Ready Table</span></span>
<span id="cb702-259"><a href="#cb702-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-262"><a href="#cb702-262" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb702-263"><a href="#cb702-263" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: lab1-step8</span></span>
<span id="cb702-264"><a href="#cb702-264" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb702-265"><a href="#cb702-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-266"><a href="#cb702-266" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary table</span></span>
<span id="cb702-267"><a href="#cb702-267" aria-hidden="true" tabindex="-1"></a>results_table <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb702-268"><a href="#cb702-268" aria-hidden="true" tabindex="-1"></a>  <span class="at">Treatment =</span> <span class="fu">c</span>(<span class="st">"New Protocol"</span>, <span class="st">"Standard Care"</span>),</span>
<span id="cb702-269"><a href="#cb702-269" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">n</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">8</span>, <span class="dv">8</span>),</span>
<span id="cb702-270"><a href="#cb702-270" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Relief (%)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"7 (88%)"</span>, <span class="st">"2 (25%)"</span>),</span>
<span id="cb702-271"><a href="#cb702-271" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">No Relief (%)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"1 (12%)"</span>, <span class="st">"6 (75%)"</span>)</span>
<span id="cb702-272"><a href="#cb702-272" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb702-273"><a href="#cb702-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-274"><a href="#cb702-274" aria-hidden="true" tabindex="-1"></a>results_table <span class="sc">%&gt;%</span></span>
<span id="cb702-275"><a href="#cb702-275" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb702-276"><a href="#cb702-276" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb702-277"><a href="#cb702-277" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Pain Relief by Treatment Group"</span>,</span>
<span id="cb702-278"><a href="#cb702-278" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Fisher's Exact Test: p = 0.021, OR = 18.97 (95% CI: 1.20–165.63)"</span></span>
<span id="cb702-279"><a href="#cb702-279" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb702-280"><a href="#cb702-280" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_footnote</span>(</span>
<span id="cb702-281"><a href="#cb702-281" aria-hidden="true" tabindex="-1"></a>    <span class="at">footnote =</span> <span class="st">"Odds ratio indicates 19-fold higher odds of relief with new protocol"</span>,</span>
<span id="cb702-282"><a href="#cb702-282" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_title</span>()</span>
<span id="cb702-283"><a href="#cb702-283" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb702-284"><a href="#cb702-284" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-285"><a href="#cb702-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-286"><a href="#cb702-286" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-287"><a href="#cb702-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-288"><a href="#cb702-288" aria-hidden="true" tabindex="-1"></a><span class="fu">### ❓ Discussion Questions</span></span>
<span id="cb702-289"><a href="#cb702-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-290"><a href="#cb702-290" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Why is the confidence interval so wide?**</span>
<span id="cb702-291"><a href="#cb702-291" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Small sample size (n=8 per group)</span>
<span id="cb702-292"><a href="#cb702-292" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Sparse data (only 1 failure in new protocol)</span>
<span id="cb702-293"><a href="#cb702-293" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Uncertainty about true population OR</span>
<span id="cb702-294"><a href="#cb702-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-295"><a href="#cb702-295" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**What does OR=19 mean in practical terms?**</span>
<span id="cb702-296"><a href="#cb702-296" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>The odds (not risk!) of relief are 19 times higher with new protocol</span>
<span id="cb702-297"><a href="#cb702-297" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>In this sample: New protocol 88% relief vs. Standard 25% relief</span>
<span id="cb702-298"><a href="#cb702-298" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Odds (New) = 7/1 = 7; Odds (Standard) = 2/6 = 0.33; OR = 7/0.33 ≈ 21</span>
<span id="cb702-299"><a href="#cb702-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-300"><a href="#cb702-300" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Should the clinic adopt the new protocol based on this study?**</span>
<span id="cb702-301"><a href="#cb702-301" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Promising signal, but n=16 is too small for definitive conclusions</span>
<span id="cb702-302"><a href="#cb702-302" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Wide CI indicates substantial uncertainty</span>
<span id="cb702-303"><a href="#cb702-303" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Recommendation: Conduct larger RCT (n=50+ per group)</span>
<span id="cb702-304"><a href="#cb702-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-305"><a href="#cb702-305" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**How would results change with n=50 per group?**</span>
<span id="cb702-306"><a href="#cb702-306" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>CI would narrow dramatically</span>
<span id="cb702-307"><a href="#cb702-307" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>If true OR≈19, would almost certainly reach significance</span>
<span id="cb702-308"><a href="#cb702-308" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Could detect smaller (but still meaningful) effects</span>
<span id="cb702-309"><a href="#cb702-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-310"><a href="#cb702-310" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-311"><a href="#cb702-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-312"><a href="#cb702-312" aria-hidden="true" tabindex="-1"></a><span class="fu">### 💡 Key Takeaways</span></span>
<span id="cb702-313"><a href="#cb702-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-314"><a href="#cb702-314" aria-hidden="true" tabindex="-1"></a>✅ **When to use Fisher's exact test:**</span>
<span id="cb702-315"><a href="#cb702-315" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Small sample sizes (n&lt;30)</span>
<span id="cb702-316"><a href="#cb702-316" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>2×2 contingency tables</span>
<span id="cb702-317"><a href="#cb702-317" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>ANY expected cell count &lt; 5</span>
<span id="cb702-318"><a href="#cb702-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-319"><a href="#cb702-319" aria-hidden="true" tabindex="-1"></a>✅ **How to interpret OR:**</span>
<span id="cb702-320"><a href="#cb702-320" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>OR &gt; 1: Higher odds in first group</span>
<span id="cb702-321"><a href="#cb702-321" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>OR = 1: No difference</span>
<span id="cb702-322"><a href="#cb702-322" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>OR &lt; 1: Lower odds in first group</span>
<span id="cb702-323"><a href="#cb702-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-324"><a href="#cb702-324" aria-hidden="true" tabindex="-1"></a>✅ **Report all three components:**</span>
<span id="cb702-325"><a href="#cb702-325" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Point estimate (OR = 18.97)</span>
<span id="cb702-326"><a href="#cb702-326" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Confidence interval (1.20 to 165.63)</span>
<span id="cb702-327"><a href="#cb702-327" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>p-value (0.021)</span>
<span id="cb702-328"><a href="#cb702-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-329"><a href="#cb702-329" aria-hidden="true" tabindex="-1"></a>✅ **Always acknowledge limitations:**</span>
<span id="cb702-330"><a href="#cb702-330" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Small samples → wide CIs</span>
<span id="cb702-331"><a href="#cb702-331" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Statistical significance ≠ clinical certainty</span>
<span id="cb702-332"><a href="#cb702-332" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Replication needed</span>
<span id="cb702-333"><a href="#cb702-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-334"><a href="#cb702-334" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-335"><a href="#cb702-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-336"><a href="#cb702-336" aria-hidden="true" tabindex="-1"></a><span class="fu">### 🏠 Homework Exercise</span></span>
<span id="cb702-337"><a href="#cb702-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-338"><a href="#cb702-338" aria-hidden="true" tabindex="-1"></a>Using the same code structure, analyze this 2×2 table:</span>
<span id="cb702-339"><a href="#cb702-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-340"><a href="#cb702-340" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Treatment <span class="pp">|</span> Success <span class="pp">|</span> Failure <span class="pp">|</span></span>
<span id="cb702-341"><a href="#cb702-341" aria-hidden="true" tabindex="-1"></a><span class="pp">|-----------|---------|---------|</span></span>
<span id="cb702-342"><a href="#cb702-342" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Drug A    <span class="pp">|</span> 9       <span class="pp">|</span> 3       <span class="pp">|</span></span>
<span id="cb702-343"><a href="#cb702-343" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Drug B    <span class="pp">|</span> 4       <span class="pp">|</span> 8       <span class="pp">|</span></span>
<span id="cb702-344"><a href="#cb702-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-345"><a href="#cb702-345" aria-hidden="true" tabindex="-1"></a>**Tasks:**</span>
<span id="cb702-346"><a href="#cb702-346" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Create the contingency table</span>
<span id="cb702-347"><a href="#cb702-347" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Run Fisher's exact test</span>
<span id="cb702-348"><a href="#cb702-348" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Interpret OR and CI</span>
<span id="cb702-349"><a href="#cb702-349" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Write a 3-sentence results paragraph</span>
<span id="cb702-350"><a href="#cb702-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-351"><a href="#cb702-351" aria-hidden="true" tabindex="-1"></a>**Expected OR**: ~6 (verify your calculation!)</span>
<span id="cb702-352"><a href="#cb702-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-353"><a href="#cb702-353" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-354"><a href="#cb702-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-355"><a href="#cb702-355" aria-hidden="true" tabindex="-1"></a><span class="fu">## Lab 2: Bootstrap Confidence Intervals (Chapter 3)</span></span>
<span id="cb702-356"><a href="#cb702-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-357"><a href="#cb702-357" aria-hidden="true" tabindex="-1"></a><span class="fu"># 🧪 Lab Practical 2: Bootstrap Confidence Intervals</span></span>
<span id="cb702-358"><a href="#cb702-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-359"><a href="#cb702-359" aria-hidden="true" tabindex="-1"></a>**Learning Objectives:**</span>
<span id="cb702-360"><a href="#cb702-360" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Understand when bootstrap is preferred over parametric methods</span>
<span id="cb702-361"><a href="#cb702-361" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Implement bootstrap resampling in R</span>
<span id="cb702-362"><a href="#cb702-362" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Calculate percentile and BCa confidence intervals</span>
<span id="cb702-363"><a href="#cb702-363" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Compare bootstrap CIs with t-based CIs</span>
<span id="cb702-364"><a href="#cb702-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-365"><a href="#cb702-365" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-366"><a href="#cb702-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-367"><a href="#cb702-367" aria-hidden="true" tabindex="-1"></a><span class="fu">### Scenario</span></span>
<span id="cb702-368"><a href="#cb702-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-369"><a href="#cb702-369" aria-hidden="true" tabindex="-1"></a>A nutritionist measures vitamin D levels (ng/mL) in 15 elderly patients after a 3-month supplement intervention. The data are skewed, with one very high value. Traditional t-based CIs assume normality—will they be accurate?</span>
<span id="cb702-370"><a href="#cb702-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-371"><a href="#cb702-371" aria-hidden="true" tabindex="-1"></a>**Data**: 12, 18, 22, 25, 19, 31, 16, 28, 21, 23, 45, 20, 24, 17, 26</span>
<span id="cb702-372"><a href="#cb702-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-373"><a href="#cb702-373" aria-hidden="true" tabindex="-1"></a>**Research Question**: What is the 95% CI for the median vitamin D level?</span>
<span id="cb702-374"><a href="#cb702-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-375"><a href="#cb702-375" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-376"><a href="#cb702-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-377"><a href="#cb702-377" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 1: Load Data and Visualize Distribution</span></span>
<span id="cb702-378"><a href="#cb702-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-381"><a href="#cb702-381" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb702-382"><a href="#cb702-382" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: lab2-step1</span></span>
<span id="cb702-383"><a href="#cb702-383" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Distribution of vitamin D levels showing right skew"</span></span>
<span id="cb702-384"><a href="#cb702-384" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb702-385"><a href="#cb702-385" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb702-386"><a href="#cb702-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-387"><a href="#cb702-387" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb702-388"><a href="#cb702-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-389"><a href="#cb702-389" aria-hidden="true" tabindex="-1"></a><span class="co"># Vitamin D data (ng/mL)</span></span>
<span id="cb702-390"><a href="#cb702-390" aria-hidden="true" tabindex="-1"></a>vit_d <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">12</span>, <span class="dv">18</span>, <span class="dv">22</span>, <span class="dv">25</span>, <span class="dv">19</span>, <span class="dv">31</span>, <span class="dv">16</span>, <span class="dv">28</span>, <span class="dv">21</span>, <span class="dv">23</span>, <span class="dv">45</span>, <span class="dv">20</span>, <span class="dv">24</span>, <span class="dv">17</span>, <span class="dv">26</span>)</span>
<span id="cb702-391"><a href="#cb702-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-392"><a href="#cb702-392" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize distribution</span></span>
<span id="cb702-393"><a href="#cb702-393" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(vit_d) <span class="sc">%&gt;%</span></span>
<span id="cb702-394"><a href="#cb702-394" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> vit_d)) <span class="sc">+</span></span>
<span id="cb702-395"><a href="#cb702-395" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">5</span>, <span class="at">fill =</span> <span class="st">"steelblue"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb702-396"><a href="#cb702-396" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> <span class="fu">median</span>(vit_d)), </span>
<span id="cb702-397"><a href="#cb702-397" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb702-398"><a href="#cb702-398" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Vitamin D Levels (n=15)"</span>,</span>
<span id="cb702-399"><a href="#cb702-399" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Red line = median"</span>,</span>
<span id="cb702-400"><a href="#cb702-400" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Vitamin D (ng/mL)"</span>,</span>
<span id="cb702-401"><a href="#cb702-401" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb702-402"><a href="#cb702-402" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb702-403"><a href="#cb702-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-404"><a href="#cb702-404" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary statistics</span></span>
<span id="cb702-405"><a href="#cb702-405" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Summary Statistics:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-406"><a href="#cb702-406" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Mean ="</span>, <span class="fu">round</span>(<span class="fu">mean</span>(vit_d), <span class="dv">2</span>), <span class="st">"ng/mL</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-407"><a href="#cb702-407" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Median ="</span>, <span class="fu">median</span>(vit_d), <span class="st">"ng/mL</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-408"><a href="#cb702-408" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"SD ="</span>, <span class="fu">round</span>(<span class="fu">sd</span>(vit_d), <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-409"><a href="#cb702-409" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Skewness = Positive (note the 45 value)</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-410"><a href="#cb702-410" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-411"><a href="#cb702-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-412"><a href="#cb702-412" aria-hidden="true" tabindex="-1"></a>**✋ Checkpoint 1:**</span>
<span id="cb702-413"><a href="#cb702-413" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Do you see right skew? (One high value at 45)</span>
<span id="cb702-414"><a href="#cb702-414" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Median &lt; Mean? (Yes, confirming positive skew)</span>
<span id="cb702-415"><a href="#cb702-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-416"><a href="#cb702-416" aria-hidden="true" tabindex="-1"></a>**💡 Teaching Point:** Skewed data violate normality assumptions for t-tests. Bootstrap makes no distributional assumptions!</span>
<span id="cb702-417"><a href="#cb702-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-418"><a href="#cb702-418" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-419"><a href="#cb702-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-420"><a href="#cb702-420" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 2: Calculate Parametric CI (For Comparison)</span></span>
<span id="cb702-421"><a href="#cb702-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-424"><a href="#cb702-424" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb702-425"><a href="#cb702-425" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: lab2-step2</span></span>
<span id="cb702-426"><a href="#cb702-426" aria-hidden="true" tabindex="-1"></a><span class="co"># Parametric 95% CI for the mean (assumes normality)</span></span>
<span id="cb702-427"><a href="#cb702-427" aria-hidden="true" tabindex="-1"></a>mean_val <span class="ot">&lt;-</span> <span class="fu">mean</span>(vit_d)</span>
<span id="cb702-428"><a href="#cb702-428" aria-hidden="true" tabindex="-1"></a>se_mean <span class="ot">&lt;-</span> <span class="fu">sd</span>(vit_d) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">length</span>(vit_d))</span>
<span id="cb702-429"><a href="#cb702-429" aria-hidden="true" tabindex="-1"></a>t_crit <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="fl">0.975</span>, <span class="at">df =</span> <span class="fu">length</span>(vit_d) <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb702-430"><a href="#cb702-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-431"><a href="#cb702-431" aria-hidden="true" tabindex="-1"></a>ci_lower_param <span class="ot">&lt;-</span> mean_val <span class="sc">-</span> t_crit <span class="sc">*</span> se_mean</span>
<span id="cb702-432"><a href="#cb702-432" aria-hidden="true" tabindex="-1"></a>ci_upper_param <span class="ot">&lt;-</span> mean_val <span class="sc">+</span> t_crit <span class="sc">*</span> se_mean</span>
<span id="cb702-433"><a href="#cb702-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-434"><a href="#cb702-434" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Parametric 95% CI for Mean (t-based):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-435"><a href="#cb702-435" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"["</span>, <span class="fu">round</span>(ci_lower_param, <span class="dv">2</span>), <span class="st">","</span>, <span class="fu">round</span>(ci_upper_param, <span class="dv">2</span>), <span class="st">"]</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb702-436"><a href="#cb702-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-437"><a href="#cb702-437" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"⚠️ Problem: This CI assumes normality!</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-438"><a href="#cb702-438" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"   With skewed data and n=15, this assumption is violated.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-439"><a href="#cb702-439" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-440"><a href="#cb702-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-441"><a href="#cb702-441" aria-hidden="true" tabindex="-1"></a>**❓ Question 1:** Why can't we easily get a parametric CI for the median?</span>
<span id="cb702-442"><a href="#cb702-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-443"><a href="#cb702-443" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-444"><a href="#cb702-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-445"><a href="#cb702-445" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 3: Bootstrap the Median (Manual Method)</span></span>
<span id="cb702-446"><a href="#cb702-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-449"><a href="#cb702-449" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb702-450"><a href="#cb702-450" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: lab2-step3</span></span>
<span id="cb702-451"><a href="#cb702-451" aria-hidden="true" tabindex="-1"></a><span class="co"># Manual bootstrap (for teaching purposes)</span></span>
<span id="cb702-452"><a href="#cb702-452" aria-hidden="true" tabindex="-1"></a>n_boot <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb702-453"><a href="#cb702-453" aria-hidden="true" tabindex="-1"></a>boot_medians <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_boot)</span>
<span id="cb702-454"><a href="#cb702-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-455"><a href="#cb702-455" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_boot) {</span>
<span id="cb702-456"><a href="#cb702-456" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Resample with replacement</span></span>
<span id="cb702-457"><a href="#cb702-457" aria-hidden="true" tabindex="-1"></a>  boot_sample <span class="ot">&lt;-</span> <span class="fu">sample</span>(vit_d, <span class="at">size =</span> <span class="fu">length</span>(vit_d), <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb702-458"><a href="#cb702-458" aria-hidden="true" tabindex="-1"></a>  boot_medians[i] <span class="ot">&lt;-</span> <span class="fu">median</span>(boot_sample)</span>
<span id="cb702-459"><a href="#cb702-459" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb702-460"><a href="#cb702-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-461"><a href="#cb702-461" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize bootstrap distribution</span></span>
<span id="cb702-462"><a href="#cb702-462" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(boot_medians) <span class="sc">%&gt;%</span></span>
<span id="cb702-463"><a href="#cb702-463" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> boot_medians)) <span class="sc">+</span></span>
<span id="cb702-464"><a href="#cb702-464" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">30</span>, <span class="at">fill =</span> <span class="st">"darkorange"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb702-465"><a href="#cb702-465" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> <span class="fu">median</span>(vit_d)), </span>
<span id="cb702-466"><a href="#cb702-466" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb702-467"><a href="#cb702-467" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Bootstrap Distribution of Median (5000 resamples)"</span>,</span>
<span id="cb702-468"><a href="#cb702-468" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Red line = observed median"</span>,</span>
<span id="cb702-469"><a href="#cb702-469" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Bootstrap Median"</span>,</span>
<span id="cb702-470"><a href="#cb702-470" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb702-471"><a href="#cb702-471" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb702-472"><a href="#cb702-472" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-473"><a href="#cb702-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-474"><a href="#cb702-474" aria-hidden="true" tabindex="-1"></a>**✋ Checkpoint 2:**</span>
<span id="cb702-475"><a href="#cb702-475" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Does the bootstrap distribution look approximately normal?</span>
<span id="cb702-476"><a href="#cb702-476" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Is it centered around the observed median (22)?</span>
<span id="cb702-477"><a href="#cb702-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-478"><a href="#cb702-478" aria-hidden="true" tabindex="-1"></a>**💡 Teaching Point:** The bootstrap distribution approximates the sampling distribution of the statistic!</span>
<span id="cb702-479"><a href="#cb702-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-480"><a href="#cb702-480" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-481"><a href="#cb702-481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-482"><a href="#cb702-482" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 4: Calculate Percentile Bootstrap CI</span></span>
<span id="cb702-483"><a href="#cb702-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-486"><a href="#cb702-486" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb702-487"><a href="#cb702-487" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: lab2-step4</span></span>
<span id="cb702-488"><a href="#cb702-488" aria-hidden="true" tabindex="-1"></a><span class="co"># Percentile method: 2.5th and 97.5th percentiles</span></span>
<span id="cb702-489"><a href="#cb702-489" aria-hidden="true" tabindex="-1"></a>ci_lower_boot <span class="ot">&lt;-</span> <span class="fu">quantile</span>(boot_medians, <span class="fl">0.025</span>)</span>
<span id="cb702-490"><a href="#cb702-490" aria-hidden="true" tabindex="-1"></a>ci_upper_boot <span class="ot">&lt;-</span> <span class="fu">quantile</span>(boot_medians, <span class="fl">0.975</span>)</span>
<span id="cb702-491"><a href="#cb702-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-492"><a href="#cb702-492" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Bootstrap 95% CI for Median (Percentile Method):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-493"><a href="#cb702-493" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"["</span>, ci_lower_boot, <span class="st">","</span>, ci_upper_boot, <span class="st">"]</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb702-494"><a href="#cb702-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-495"><a href="#cb702-495" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Observed median:"</span>, <span class="fu">median</span>(vit_d), <span class="st">"ng/mL</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-496"><a href="#cb702-496" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-497"><a href="#cb702-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-498"><a href="#cb702-498" aria-hidden="true" tabindex="-1"></a>**❓ Question 2:** Is the CI symmetric around the median? Why or why not?</span>
<span id="cb702-499"><a href="#cb702-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-500"><a href="#cb702-500" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-501"><a href="#cb702-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-502"><a href="#cb702-502" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 5: Use boot Package for BCa CI</span></span>
<span id="cb702-503"><a href="#cb702-503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-506"><a href="#cb702-506" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb702-507"><a href="#cb702-507" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: lab2-step5</span></span>
<span id="cb702-508"><a href="#cb702-508" aria-hidden="true" tabindex="-1"></a><span class="co"># Define statistic function for boot package</span></span>
<span id="cb702-509"><a href="#cb702-509" aria-hidden="true" tabindex="-1"></a>median_func <span class="ot">&lt;-</span> <span class="cf">function</span>(data, indices) {</span>
<span id="cb702-510"><a href="#cb702-510" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">median</span>(data[indices]))</span>
<span id="cb702-511"><a href="#cb702-511" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb702-512"><a href="#cb702-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-513"><a href="#cb702-513" aria-hidden="true" tabindex="-1"></a><span class="co"># Run bootstrap</span></span>
<span id="cb702-514"><a href="#cb702-514" aria-hidden="true" tabindex="-1"></a>boot_result <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data =</span> vit_d, <span class="at">statistic =</span> median_func, <span class="at">R =</span> <span class="dv">5000</span>)</span>
<span id="cb702-515"><a href="#cb702-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-516"><a href="#cb702-516" aria-hidden="true" tabindex="-1"></a><span class="co"># BCa confidence interval (bias-corrected and accelerated)</span></span>
<span id="cb702-517"><a href="#cb702-517" aria-hidden="true" tabindex="-1"></a>boot_ci <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(boot_result, <span class="at">type =</span> <span class="fu">c</span>(<span class="st">"perc"</span>, <span class="st">"bca"</span>))</span>
<span id="cb702-518"><a href="#cb702-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-519"><a href="#cb702-519" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(boot_ci)</span>
<span id="cb702-520"><a href="#cb702-520" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-521"><a href="#cb702-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-522"><a href="#cb702-522" aria-hidden="true" tabindex="-1"></a>**✋ Checkpoint 3:**</span>
<span id="cb702-523"><a href="#cb702-523" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Do you see both "Percentile" and "BCa" intervals?</span>
<span id="cb702-524"><a href="#cb702-524" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>BCa should be slightly different from percentile (adjusts for bias and skewness)</span>
<span id="cb702-525"><a href="#cb702-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-526"><a href="#cb702-526" aria-hidden="true" tabindex="-1"></a>**💡 Teaching Point:** BCa intervals are theoretically superior but require more computation. With small samples, differences are often modest.</span>
<span id="cb702-527"><a href="#cb702-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-528"><a href="#cb702-528" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-529"><a href="#cb702-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-530"><a href="#cb702-530" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 6: Compare All Methods</span></span>
<span id="cb702-531"><a href="#cb702-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-534"><a href="#cb702-534" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb702-535"><a href="#cb702-535" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: lab2-step6</span></span>
<span id="cb702-536"><a href="#cb702-536" aria-hidden="true" tabindex="-1"></a><span class="co"># Create comparison table</span></span>
<span id="cb702-537"><a href="#cb702-537" aria-hidden="true" tabindex="-1"></a>comparison <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb702-538"><a href="#cb702-538" aria-hidden="true" tabindex="-1"></a>  <span class="at">Method =</span> <span class="fu">c</span>(<span class="st">"Parametric (mean)"</span>, <span class="st">"Bootstrap Percentile (median)"</span>, <span class="st">"Bootstrap BCa (median)"</span>),</span>
<span id="cb702-539"><a href="#cb702-539" aria-hidden="true" tabindex="-1"></a>  <span class="at">Estimate =</span> <span class="fu">c</span>(<span class="fu">mean</span>(vit_d), <span class="fu">median</span>(vit_d), <span class="fu">median</span>(vit_d)),</span>
<span id="cb702-540"><a href="#cb702-540" aria-hidden="true" tabindex="-1"></a>  <span class="at">CI_Lower =</span> <span class="fu">c</span>(ci_lower_param, </span>
<span id="cb702-541"><a href="#cb702-541" aria-hidden="true" tabindex="-1"></a>               <span class="fu">as.numeric</span>(<span class="fu">quantile</span>(boot_medians, <span class="fl">0.025</span>)),</span>
<span id="cb702-542"><a href="#cb702-542" aria-hidden="true" tabindex="-1"></a>               boot_ci<span class="sc">$</span>bca[<span class="dv">4</span>]),</span>
<span id="cb702-543"><a href="#cb702-543" aria-hidden="true" tabindex="-1"></a>  <span class="at">CI_Upper =</span> <span class="fu">c</span>(ci_upper_param,</span>
<span id="cb702-544"><a href="#cb702-544" aria-hidden="true" tabindex="-1"></a>               <span class="fu">as.numeric</span>(<span class="fu">quantile</span>(boot_medians, <span class="fl">0.975</span>)),</span>
<span id="cb702-545"><a href="#cb702-545" aria-hidden="true" tabindex="-1"></a>               boot_ci<span class="sc">$</span>bca[<span class="dv">5</span>]),</span>
<span id="cb702-546"><a href="#cb702-546" aria-hidden="true" tabindex="-1"></a>  <span class="at">CI_Width =</span> CI_Upper <span class="sc">-</span> CI_Lower</span>
<span id="cb702-547"><a href="#cb702-547" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb702-548"><a href="#cb702-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-549"><a href="#cb702-549" aria-hidden="true" tabindex="-1"></a>comparison <span class="sc">%&gt;%</span></span>
<span id="cb702-550"><a href="#cb702-550" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">round</span>(.x, <span class="dv">2</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb702-551"><a href="#cb702-551" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb702-552"><a href="#cb702-552" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(<span class="at">title =</span> <span class="st">"Comparison of Confidence Interval Methods"</span>)</span>
<span id="cb702-553"><a href="#cb702-553" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-554"><a href="#cb702-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-555"><a href="#cb702-555" aria-hidden="true" tabindex="-1"></a>**❓ Question 3:** Which method gives the narrowest CI? Why might that be misleading?</span>
<span id="cb702-556"><a href="#cb702-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-557"><a href="#cb702-557" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-558"><a href="#cb702-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-559"><a href="#cb702-559" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 7: Diagnostic Checks</span></span>
<span id="cb702-560"><a href="#cb702-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-563"><a href="#cb702-563" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb702-564"><a href="#cb702-564" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: lab2-step7</span></span>
<span id="cb702-565"><a href="#cb702-565" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for duplicate bootstrap samples (quality check)</span></span>
<span id="cb702-566"><a href="#cb702-566" aria-hidden="true" tabindex="-1"></a>unique_samples <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">unique</span>(boot_medians))</span>
<span id="cb702-567"><a href="#cb702-567" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Unique bootstrap medians:"</span>, unique_samples, <span class="st">"out of"</span>, n_boot, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-568"><a href="#cb702-568" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Proportion unique:"</span>, <span class="fu">round</span>(unique_samples <span class="sc">/</span> n_boot, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb702-569"><a href="#cb702-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-570"><a href="#cb702-570" aria-hidden="true" tabindex="-1"></a><span class="co"># Standard error of the median from bootstrap</span></span>
<span id="cb702-571"><a href="#cb702-571" aria-hidden="true" tabindex="-1"></a>se_median_boot <span class="ot">&lt;-</span> <span class="fu">sd</span>(boot_medians)</span>
<span id="cb702-572"><a href="#cb702-572" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Bootstrap SE of median:"</span>, <span class="fu">round</span>(se_median_boot, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-573"><a href="#cb702-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-574"><a href="#cb702-574" aria-hidden="true" tabindex="-1"></a><span class="co"># Bias estimate</span></span>
<span id="cb702-575"><a href="#cb702-575" aria-hidden="true" tabindex="-1"></a>bias <span class="ot">&lt;-</span> <span class="fu">mean</span>(boot_medians) <span class="sc">-</span> <span class="fu">median</span>(vit_d)</span>
<span id="cb702-576"><a href="#cb702-576" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Bootstrap bias:"</span>, <span class="fu">round</span>(bias, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-577"><a href="#cb702-577" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"(Small bias is expected; large bias suggests problems)</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-578"><a href="#cb702-578" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-579"><a href="#cb702-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-580"><a href="#cb702-580" aria-hidden="true" tabindex="-1"></a>**✋ Checkpoint 4:**</span>
<span id="cb702-581"><a href="#cb702-581" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Is bias close to zero? (Should be &lt; 1)</span>
<span id="cb702-582"><a href="#cb702-582" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Are most samples unique? (Yes, with 5000 resamples)</span>
<span id="cb702-583"><a href="#cb702-583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-584"><a href="#cb702-584" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-585"><a href="#cb702-585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-586"><a href="#cb702-586" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 8: Publication-Ready Figure</span></span>
<span id="cb702-587"><a href="#cb702-587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-590"><a href="#cb702-590" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb702-591"><a href="#cb702-591" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: lab2-step8</span></span>
<span id="cb702-592"><a href="#cb702-592" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Vitamin D levels with bootstrap 95% CI for median"</span></span>
<span id="cb702-593"><a href="#cb702-593" aria-hidden="true" tabindex="-1"></a><span class="co"># Box plot with bootstrap CI overlay</span></span>
<span id="cb702-594"><a href="#cb702-594" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(vit_d) <span class="sc">%&gt;%</span></span>
<span id="cb702-595"><a href="#cb702-595" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> vit_d)) <span class="sc">+</span></span>
<span id="cb702-596"><a href="#cb702-596" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">"lightblue"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb702-597"><a href="#cb702-597" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb702-598"><a href="#cb702-598" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">median</span>(vit_d)), <span class="at">size =</span> <span class="dv">5</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb702-599"><a href="#cb702-599" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> ci_lower_boot, <span class="at">ymax =</span> ci_upper_boot),</span>
<span id="cb702-600"><a href="#cb702-600" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb702-601"><a href="#cb702-601" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Vitamin D Levels with Bootstrap 95% CI"</span>,</span>
<span id="cb702-602"><a href="#cb702-602" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste0</span>(<span class="st">"Median = "</span>, <span class="fu">median</span>(vit_d), <span class="st">" ng/mL ["</span>, </span>
<span id="cb702-603"><a href="#cb702-603" aria-hidden="true" tabindex="-1"></a>                        ci_lower_boot, <span class="st">", "</span>, ci_upper_boot, <span class="st">"]"</span>),</span>
<span id="cb702-604"><a href="#cb702-604" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb702-605"><a href="#cb702-605" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Vitamin D (ng/mL)"</span>) <span class="sc">+</span></span>
<span id="cb702-606"><a href="#cb702-606" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb702-607"><a href="#cb702-607" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb702-608"><a href="#cb702-608" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>())</span>
<span id="cb702-609"><a href="#cb702-609" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-610"><a href="#cb702-610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-611"><a href="#cb702-611" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-612"><a href="#cb702-612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-613"><a href="#cb702-613" aria-hidden="true" tabindex="-1"></a><span class="fu">### ❓ Discussion Questions</span></span>
<span id="cb702-614"><a href="#cb702-614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-615"><a href="#cb702-615" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Why use median instead of mean for skewed data?**</span>
<span id="cb702-616"><a href="#cb702-616" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Median is robust to outliers (45 doesn't distort it)</span>
<span id="cb702-617"><a href="#cb702-617" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>More representative of "typical" value</span>
<span id="cb702-618"><a href="#cb702-618" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Mean = 24.4; Median = 22 (mean pulled upward by outlier)</span>
<span id="cb702-619"><a href="#cb702-619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-620"><a href="#cb702-620" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**When would parametric CI be acceptable?**</span>
<span id="cb702-621"><a href="#cb702-621" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Large samples (n &gt; 30) where CLT applies</span>
<span id="cb702-622"><a href="#cb702-622" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Truly normal data</span>
<span id="cb702-623"><a href="#cb702-623" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>When analyzing the mean (not median) is appropriate</span>
<span id="cb702-624"><a href="#cb702-624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-625"><a href="#cb702-625" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Why are BCa CIs preferred over percentile CIs?**</span>
<span id="cb702-626"><a href="#cb702-626" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Adjusts for bias in the bootstrap distribution</span>
<span id="cb702-627"><a href="#cb702-627" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Adjusts for skewness</span>
<span id="cb702-628"><a href="#cb702-628" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Better coverage properties (closer to nominal 95%)</span>
<span id="cb702-629"><a href="#cb702-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-630"><a href="#cb702-630" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**What if we increased bootstrap resamples to 10,000?**</span>
<span id="cb702-631"><a href="#cb702-631" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>More stable CI estimates</span>
<span id="cb702-632"><a href="#cb702-632" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Smoother bootstrap distribution</span>
<span id="cb702-633"><a href="#cb702-633" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Minimal change to CI (already stable at 5,000)</span>
<span id="cb702-634"><a href="#cb702-634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-635"><a href="#cb702-635" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-636"><a href="#cb702-636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-637"><a href="#cb702-637" aria-hidden="true" tabindex="-1"></a><span class="fu">### 💡 Key Takeaways</span></span>
<span id="cb702-638"><a href="#cb702-638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-639"><a href="#cb702-639" aria-hidden="true" tabindex="-1"></a>✅ **Bootstrap is ideal when:**</span>
<span id="cb702-640"><a href="#cb702-640" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Small samples (n &lt; 30)</span>
<span id="cb702-641"><a href="#cb702-641" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Non-normal distributions (skew, outliers)</span>
<span id="cb702-642"><a href="#cb702-642" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>No parametric formula exists (e.g., CI for median)</span>
<span id="cb702-643"><a href="#cb702-643" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Robust inference needed</span>
<span id="cb702-644"><a href="#cb702-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-645"><a href="#cb702-645" aria-hidden="true" tabindex="-1"></a>✅ **How bootstrap works:**</span>
<span id="cb702-646"><a href="#cb702-646" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Resample data with replacement</span>
<span id="cb702-647"><a href="#cb702-647" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Calculate statistic for each resample</span>
<span id="cb702-648"><a href="#cb702-648" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Use percentiles of bootstrap distribution as CI</span>
<span id="cb702-649"><a href="#cb702-649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-650"><a href="#cb702-650" aria-hidden="true" tabindex="-1"></a>✅ **Minimum resamples:**</span>
<span id="cb702-651"><a href="#cb702-651" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Percentile CI: 1,000–5,000 resamples</span>
<span id="cb702-652"><a href="#cb702-652" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>BCa CI: 2,000–10,000 resamples</span>
<span id="cb702-653"><a href="#cb702-653" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>More is better, but diminishing returns after 5,000</span>
<span id="cb702-654"><a href="#cb702-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-655"><a href="#cb702-655" aria-hidden="true" tabindex="-1"></a>✅ **Bootstrap assumptions:**</span>
<span id="cb702-656"><a href="#cb702-656" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Original sample is representative of population</span>
<span id="cb702-657"><a href="#cb702-657" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Independence of observations</span>
<span id="cb702-658"><a href="#cb702-658" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>No assumptions about distribution shape!</span>
<span id="cb702-659"><a href="#cb702-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-660"><a href="#cb702-660" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-661"><a href="#cb702-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-662"><a href="#cb702-662" aria-hidden="true" tabindex="-1"></a><span class="fu">### 🏠 Homework Exercise</span></span>
<span id="cb702-663"><a href="#cb702-663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-664"><a href="#cb702-664" aria-hidden="true" tabindex="-1"></a>Analyze this dataset of reaction times (milliseconds) for 12 participants:</span>
<span id="cb702-665"><a href="#cb702-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-666"><a href="#cb702-666" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-667"><a href="#cb702-667" aria-hidden="true" tabindex="-1"></a><span class="in">reaction_time &lt;- c(245, 298, 312, 267, 289, 305, 411, 278, 293, 301, 285, 319)</span></span>
<span id="cb702-668"><a href="#cb702-668" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-669"><a href="#cb702-669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-670"><a href="#cb702-670" aria-hidden="true" tabindex="-1"></a>**Tasks:**</span>
<span id="cb702-671"><a href="#cb702-671" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Plot the distribution—is it symmetric?</span>
<span id="cb702-672"><a href="#cb702-672" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Calculate parametric 95% CI for the mean</span>
<span id="cb702-673"><a href="#cb702-673" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Calculate bootstrap 95% CI for the median (5,000 resamples)</span>
<span id="cb702-674"><a href="#cb702-674" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Which CI is more trustworthy? Why?</span>
<span id="cb702-675"><a href="#cb702-675" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>Write a 2-sentence interpretation</span>
<span id="cb702-676"><a href="#cb702-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-677"><a href="#cb702-677" aria-hidden="true" tabindex="-1"></a>**Hint:** The 411 ms value is unusual—how does it affect the mean vs. median?</span>
<span id="cb702-678"><a href="#cb702-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-679"><a href="#cb702-679" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-680"><a href="#cb702-680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-681"><a href="#cb702-681" aria-hidden="true" tabindex="-1"></a><span class="fu">## Lab 3: Mann-Whitney U Test (Chapter 4)</span></span>
<span id="cb702-682"><a href="#cb702-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-683"><a href="#cb702-683" aria-hidden="true" tabindex="-1"></a><span class="fu"># 🧪 Lab Practical 3: Mann-Whitney U Test</span></span>
<span id="cb702-684"><a href="#cb702-684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-685"><a href="#cb702-685" aria-hidden="true" tabindex="-1"></a>**Learning Objectives:**</span>
<span id="cb702-686"><a href="#cb702-686" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Understand when to use Mann-Whitney instead of t-test</span>
<span id="cb702-687"><a href="#cb702-687" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Perform Mann-Whitney U test in R</span>
<span id="cb702-688"><a href="#cb702-688" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Calculate and interpret Hodges-Lehmann estimate</span>
<span id="cb702-689"><a href="#cb702-689" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Compute rank-biserial correlation as effect size</span>
<span id="cb702-690"><a href="#cb702-690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-691"><a href="#cb702-691" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-692"><a href="#cb702-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-693"><a href="#cb702-693" aria-hidden="true" tabindex="-1"></a><span class="fu">### Scenario</span></span>
<span id="cb702-694"><a href="#cb702-694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-695"><a href="#cb702-695" aria-hidden="true" tabindex="-1"></a>A physical therapist compares recovery times (days) for two treatments in 20 patients. The data are right-skewed with some outliers, making t-test assumptions questionable.</span>
<span id="cb702-696"><a href="#cb702-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-697"><a href="#cb702-697" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Treatment A** (n=10): 14, 18, 21, 16, 19, 25, 17, 22, 31, 20</span>
<span id="cb702-698"><a href="#cb702-698" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Treatment B** (n=10): 22, 28, 35, 24, 30, 26, 42, 29, 33, 27</span>
<span id="cb702-699"><a href="#cb702-699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-700"><a href="#cb702-700" aria-hidden="true" tabindex="-1"></a>**Research Question**: Do the two treatments differ in typical recovery time?</span>
<span id="cb702-701"><a href="#cb702-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-702"><a href="#cb702-702" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-703"><a href="#cb702-703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-704"><a href="#cb702-704" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 1: Load and Visualize Data</span></span>
<span id="cb702-705"><a href="#cb702-705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-708"><a href="#cb702-708" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb702-709"><a href="#cb702-709" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: lab3-step1</span></span>
<span id="cb702-710"><a href="#cb702-710" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Recovery time distributions by treatment group"</span></span>
<span id="cb702-711"><a href="#cb702-711" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb702-712"><a href="#cb702-712" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstatix)</span>
<span id="cb702-713"><a href="#cb702-713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-714"><a href="#cb702-714" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb702-715"><a href="#cb702-715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-716"><a href="#cb702-716" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data</span></span>
<span id="cb702-717"><a href="#cb702-717" aria-hidden="true" tabindex="-1"></a>recovery_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb702-718"><a href="#cb702-718" aria-hidden="true" tabindex="-1"></a>  <span class="at">treatment =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Treatment A"</span>, <span class="st">"Treatment B"</span>), <span class="at">each =</span> <span class="dv">10</span>),</span>
<span id="cb702-719"><a href="#cb702-719" aria-hidden="true" tabindex="-1"></a>  <span class="at">days =</span> <span class="fu">c</span>(<span class="dv">14</span>, <span class="dv">18</span>, <span class="dv">21</span>, <span class="dv">16</span>, <span class="dv">19</span>, <span class="dv">25</span>, <span class="dv">17</span>, <span class="dv">22</span>, <span class="dv">31</span>, <span class="dv">20</span>,</span>
<span id="cb702-720"><a href="#cb702-720" aria-hidden="true" tabindex="-1"></a>           <span class="dv">22</span>, <span class="dv">28</span>, <span class="dv">35</span>, <span class="dv">24</span>, <span class="dv">30</span>, <span class="dv">26</span>, <span class="dv">42</span>, <span class="dv">29</span>, <span class="dv">33</span>, <span class="dv">27</span>)</span>
<span id="cb702-721"><a href="#cb702-721" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb702-722"><a href="#cb702-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-723"><a href="#cb702-723" aria-hidden="true" tabindex="-1"></a><span class="co"># Box plot with individual points</span></span>
<span id="cb702-724"><a href="#cb702-724" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(recovery_data, <span class="fu">aes</span>(<span class="at">x =</span> treatment, <span class="at">y =</span> days, <span class="at">fill =</span> treatment)) <span class="sc">+</span></span>
<span id="cb702-725"><a href="#cb702-725" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb702-726"><a href="#cb702-726" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb702-727"><a href="#cb702-727" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Recovery Times by Treatment"</span>,</span>
<span id="cb702-728"><a href="#cb702-728" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Days to Recovery"</span>) <span class="sc">+</span></span>
<span id="cb702-729"><a href="#cb702-729" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb702-730"><a href="#cb702-730" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb702-731"><a href="#cb702-731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-732"><a href="#cb702-732" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary statistics</span></span>
<span id="cb702-733"><a href="#cb702-733" aria-hidden="true" tabindex="-1"></a>recovery_data <span class="sc">%&gt;%</span></span>
<span id="cb702-734"><a href="#cb702-734" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(treatment) <span class="sc">%&gt;%</span></span>
<span id="cb702-735"><a href="#cb702-735" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb702-736"><a href="#cb702-736" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb702-737"><a href="#cb702-737" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean =</span> <span class="fu">round</span>(<span class="fu">mean</span>(days), <span class="dv">1</span>),</span>
<span id="cb702-738"><a href="#cb702-738" aria-hidden="true" tabindex="-1"></a>    <span class="at">median =</span> <span class="fu">median</span>(days),</span>
<span id="cb702-739"><a href="#cb702-739" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd =</span> <span class="fu">round</span>(<span class="fu">sd</span>(days), <span class="dv">1</span>),</span>
<span id="cb702-740"><a href="#cb702-740" aria-hidden="true" tabindex="-1"></a>    <span class="at">min =</span> <span class="fu">min</span>(days),</span>
<span id="cb702-741"><a href="#cb702-741" aria-hidden="true" tabindex="-1"></a>    <span class="at">max =</span> <span class="fu">max</span>(days)</span>
<span id="cb702-742"><a href="#cb702-742" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb702-743"><a href="#cb702-743" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-744"><a href="#cb702-744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-745"><a href="#cb702-745" aria-hidden="true" tabindex="-1"></a>**✋ Checkpoint 1:**</span>
<span id="cb702-746"><a href="#cb702-746" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Does Treatment B have longer recovery times?</span>
<span id="cb702-747"><a href="#cb702-747" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Are there outliers? (Yes: 31 in A, 42 in B)</span>
<span id="cb702-748"><a href="#cb702-748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-749"><a href="#cb702-749" aria-hidden="true" tabindex="-1"></a>**💡 Teaching Point:** Outliers and skewness violate t-test assumptions. Mann-Whitney uses ranks, making it robust!</span>
<span id="cb702-750"><a href="#cb702-750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-751"><a href="#cb702-751" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-752"><a href="#cb702-752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-753"><a href="#cb702-753" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 2: Check Normality (For Educational Purposes)</span></span>
<span id="cb702-754"><a href="#cb702-754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-757"><a href="#cb702-757" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb702-758"><a href="#cb702-758" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: lab3-step2</span></span>
<span id="cb702-759"><a href="#cb702-759" aria-hidden="true" tabindex="-1"></a><span class="co"># Shapiro-Wilk test for normality</span></span>
<span id="cb702-760"><a href="#cb702-760" aria-hidden="true" tabindex="-1"></a>shapiro_a <span class="ot">&lt;-</span> <span class="fu">shapiro.test</span>(recovery_data<span class="sc">$</span>days[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>])</span>
<span id="cb702-761"><a href="#cb702-761" aria-hidden="true" tabindex="-1"></a>shapiro_b <span class="ot">&lt;-</span> <span class="fu">shapiro.test</span>(recovery_data<span class="sc">$</span>days[<span class="dv">11</span><span class="sc">:</span><span class="dv">20</span>])</span>
<span id="cb702-762"><a href="#cb702-762" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-763"><a href="#cb702-763" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Normality Tests:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-764"><a href="#cb702-764" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Treatment A: W ="</span>, <span class="fu">round</span>(shapiro_a<span class="sc">$</span>statistic, <span class="dv">3</span>), </span>
<span id="cb702-765"><a href="#cb702-765" aria-hidden="true" tabindex="-1"></a>    <span class="st">", p ="</span>, <span class="fu">round</span>(shapiro_a<span class="sc">$</span>p.value, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-766"><a href="#cb702-766" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Treatment B: W ="</span>, <span class="fu">round</span>(shapiro_b<span class="sc">$</span>statistic, <span class="dv">3</span>), </span>
<span id="cb702-767"><a href="#cb702-767" aria-hidden="true" tabindex="-1"></a>    <span class="st">", p ="</span>, <span class="fu">round</span>(shapiro_b<span class="sc">$</span>p.value, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb702-768"><a href="#cb702-768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-769"><a href="#cb702-769" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Interpretation:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-770"><a href="#cb702-770" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- p &gt; 0.05 suggests data consistent with normality</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-771"><a href="#cb702-771" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- But with n=10, Shapiro-Wilk has low power</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-772"><a href="#cb702-772" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Visual inspection (box plots) more informative</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-773"><a href="#cb702-773" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-774"><a href="#cb702-774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-775"><a href="#cb702-775" aria-hidden="true" tabindex="-1"></a>**❓ Question 1:** Even if normality tests pass, why might Mann-Whitney be preferred here?</span>
<span id="cb702-776"><a href="#cb702-776" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-777"><a href="#cb702-777" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-778"><a href="#cb702-778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-779"><a href="#cb702-779" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 3: Run Mann-Whitney U Test</span></span>
<span id="cb702-780"><a href="#cb702-780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-783"><a href="#cb702-783" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb702-784"><a href="#cb702-784" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: lab3-step3</span></span>
<span id="cb702-785"><a href="#cb702-785" aria-hidden="true" tabindex="-1"></a><span class="co"># Mann-Whitney U test (also called Wilcoxon rank-sum test)</span></span>
<span id="cb702-786"><a href="#cb702-786" aria-hidden="true" tabindex="-1"></a>mw_result <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(days <span class="sc">~</span> treatment, </span>
<span id="cb702-787"><a href="#cb702-787" aria-hidden="true" tabindex="-1"></a>                         <span class="at">data =</span> recovery_data,</span>
<span id="cb702-788"><a href="#cb702-788" aria-hidden="true" tabindex="-1"></a>                         <span class="at">exact =</span> <span class="cn">TRUE</span>,</span>
<span id="cb702-789"><a href="#cb702-789" aria-hidden="true" tabindex="-1"></a>                         <span class="at">conf.int =</span> <span class="cn">TRUE</span>)</span>
<span id="cb702-790"><a href="#cb702-790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-791"><a href="#cb702-791" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(mw_result)</span>
<span id="cb702-792"><a href="#cb702-792" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-793"><a href="#cb702-793" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-794"><a href="#cb702-794" aria-hidden="true" tabindex="-1"></a>**✋ Checkpoint 2:**</span>
<span id="cb702-795"><a href="#cb702-795" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Is p-value &lt; 0.05? (Yes, significant difference)</span>
<span id="cb702-796"><a href="#cb702-796" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Note the "confidence interval" reported—this is for the shift parameter</span>
<span id="cb702-797"><a href="#cb702-797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-798"><a href="#cb702-798" aria-hidden="true" tabindex="-1"></a>**💡 Teaching Point:** The CI is for the Hodges-Lehmann estimate (pseudo-median difference), not the difference in medians!</span>
<span id="cb702-799"><a href="#cb702-799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-800"><a href="#cb702-800" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-801"><a href="#cb702-801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-802"><a href="#cb702-802" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 4: Calculate Hodges-Lehmann Estimate Manually</span></span>
<span id="cb702-803"><a href="#cb702-803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-806"><a href="#cb702-806" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb702-807"><a href="#cb702-807" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: lab3-step4</span></span>
<span id="cb702-808"><a href="#cb702-808" aria-hidden="true" tabindex="-1"></a><span class="co"># Hodges-Lehmann estimate: median of all pairwise differences</span></span>
<span id="cb702-809"><a href="#cb702-809" aria-hidden="true" tabindex="-1"></a>days_a <span class="ot">&lt;-</span> recovery_data<span class="sc">$</span>days[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span>
<span id="cb702-810"><a href="#cb702-810" aria-hidden="true" tabindex="-1"></a>days_b <span class="ot">&lt;-</span> recovery_data<span class="sc">$</span>days[<span class="dv">11</span><span class="sc">:</span><span class="dv">20</span>]</span>
<span id="cb702-811"><a href="#cb702-811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-812"><a href="#cb702-812" aria-hidden="true" tabindex="-1"></a><span class="co"># All pairwise differences (B - A)</span></span>
<span id="cb702-813"><a href="#cb702-813" aria-hidden="true" tabindex="-1"></a>pairwise_diffs <span class="ot">&lt;-</span> <span class="fu">outer</span>(days_b, days_a, <span class="st">"-"</span>)</span>
<span id="cb702-814"><a href="#cb702-814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-815"><a href="#cb702-815" aria-hidden="true" tabindex="-1"></a><span class="co"># Hodges-Lehmann estimate</span></span>
<span id="cb702-816"><a href="#cb702-816" aria-hidden="true" tabindex="-1"></a>hl_estimate <span class="ot">&lt;-</span> <span class="fu">median</span>(pairwise_diffs)</span>
<span id="cb702-817"><a href="#cb702-817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-818"><a href="#cb702-818" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Hodges-Lehmann Estimate:"</span>, hl_estimate, <span class="st">"days</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-819"><a href="#cb702-819" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"95% CI from Mann-Whitney:"</span>, </span>
<span id="cb702-820"><a href="#cb702-820" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(mw_result<span class="sc">$</span>conf.int[<span class="dv">1</span>], <span class="dv">1</span>), <span class="st">"to"</span>, </span>
<span id="cb702-821"><a href="#cb702-821" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(mw_result<span class="sc">$</span>conf.int[<span class="dv">2</span>], <span class="dv">1</span>), <span class="st">"days</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb702-822"><a href="#cb702-822" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-823"><a href="#cb702-823" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Interpretation:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-824"><a href="#cb702-824" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Treatment B takes ~"</span>, <span class="fu">abs</span>(hl_estimate), </span>
<span id="cb702-825"><a href="#cb702-825" aria-hidden="true" tabindex="-1"></a>    <span class="st">" days longer to recover (typical shift)</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-826"><a href="#cb702-826" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-827"><a href="#cb702-827" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-828"><a href="#cb702-828" aria-hidden="true" tabindex="-1"></a>**❓ Question 2:** How does the Hodges-Lehmann estimate compare to the difference in medians?</span>
<span id="cb702-829"><a href="#cb702-829" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-832"><a href="#cb702-832" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb702-833"><a href="#cb702-833" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: lab3-step4b</span></span>
<span id="cb702-834"><a href="#cb702-834" aria-hidden="true" tabindex="-1"></a>median_a <span class="ot">&lt;-</span> <span class="fu">median</span>(days_a)</span>
<span id="cb702-835"><a href="#cb702-835" aria-hidden="true" tabindex="-1"></a>median_b <span class="ot">&lt;-</span> <span class="fu">median</span>(days_b)</span>
<span id="cb702-836"><a href="#cb702-836" aria-hidden="true" tabindex="-1"></a>median_diff <span class="ot">&lt;-</span> median_b <span class="sc">-</span> median_a</span>
<span id="cb702-837"><a href="#cb702-837" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-838"><a href="#cb702-838" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Median (Treatment A):"</span>, median_a, <span class="st">"days</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-839"><a href="#cb702-839" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Median (Treatment B):"</span>, median_b, <span class="st">"days</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-840"><a href="#cb702-840" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Difference in medians:"</span>, median_diff, <span class="st">"days</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-841"><a href="#cb702-841" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Hodges-Lehmann estimate:"</span>, hl_estimate, <span class="st">"days</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb702-842"><a href="#cb702-842" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"→ They're close but not identical!</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-843"><a href="#cb702-843" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-844"><a href="#cb702-844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-845"><a href="#cb702-845" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-846"><a href="#cb702-846" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-847"><a href="#cb702-847" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 5: Calculate Effect Size (Rank-Biserial Correlation)</span></span>
<span id="cb702-848"><a href="#cb702-848" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-851"><a href="#cb702-851" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb702-852"><a href="#cb702-852" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: lab3-step5</span></span>
<span id="cb702-853"><a href="#cb702-853" aria-hidden="true" tabindex="-1"></a><span class="co"># Using rstatix package</span></span>
<span id="cb702-854"><a href="#cb702-854" aria-hidden="true" tabindex="-1"></a>effect_size <span class="ot">&lt;-</span> <span class="fu">wilcox_effsize</span>(recovery_data, days <span class="sc">~</span> treatment)</span>
<span id="cb702-855"><a href="#cb702-855" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-856"><a href="#cb702-856" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(effect_size)</span>
<span id="cb702-857"><a href="#cb702-857" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-858"><a href="#cb702-858" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Interpretation of rank-biserial correlation:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-859"><a href="#cb702-859" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"r ="</span>, <span class="fu">round</span>(effect_size<span class="sc">$</span>effsize, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-860"><a href="#cb702-860" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Ranges from -1 to +1</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-861"><a href="#cb702-861" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- |r| &lt; 0.3: small effect</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-862"><a href="#cb702-862" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- |r| = 0.3-0.5: medium effect</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-863"><a href="#cb702-863" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- |r| &gt; 0.5: large effect</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb702-864"><a href="#cb702-864" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-865"><a href="#cb702-865" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">abs</span>(effect_size<span class="sc">$</span>effsize) <span class="sc">&lt;</span> <span class="fl">0.3</span>) {</span>
<span id="cb702-866"><a href="#cb702-866" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"→ Effect size is SMALL</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-867"><a href="#cb702-867" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">abs</span>(effect_size<span class="sc">$</span>effsize) <span class="sc">&lt;</span> <span class="fl">0.5</span>) {</span>
<span id="cb702-868"><a href="#cb702-868" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"→ Effect size is MEDIUM</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-869"><a href="#cb702-869" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb702-870"><a href="#cb702-870" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"→ Effect size is LARGE</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-871"><a href="#cb702-871" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb702-872"><a href="#cb702-872" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-873"><a href="#cb702-873" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-874"><a href="#cb702-874" aria-hidden="true" tabindex="-1"></a>**✋ Checkpoint 3:**</span>
<span id="cb702-875"><a href="#cb702-875" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Effect size magnitude appropriate for interpretation?</span>
<span id="cb702-876"><a href="#cb702-876" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Matches visual impression from box plot?</span>
<span id="cb702-877"><a href="#cb702-877" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-878"><a href="#cb702-878" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-879"><a href="#cb702-879" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-880"><a href="#cb702-880" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 6: Compare with t-test (Educational)</span></span>
<span id="cb702-881"><a href="#cb702-881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-884"><a href="#cb702-884" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb702-885"><a href="#cb702-885" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: lab3-step6</span></span>
<span id="cb702-886"><a href="#cb702-886" aria-hidden="true" tabindex="-1"></a><span class="co"># Run t-test for comparison</span></span>
<span id="cb702-887"><a href="#cb702-887" aria-hidden="true" tabindex="-1"></a>t_result <span class="ot">&lt;-</span> <span class="fu">t.test</span>(days <span class="sc">~</span> treatment, <span class="at">data =</span> recovery_data)</span>
<span id="cb702-888"><a href="#cb702-888" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-889"><a href="#cb702-889" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"=== Comparison: Mann-Whitney vs. t-test ===</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb702-890"><a href="#cb702-890" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Mann-Whitney:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-891"><a href="#cb702-891" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  p-value ="</span>, <span class="fu">round</span>(mw_result<span class="sc">$</span>p.value, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-892"><a href="#cb702-892" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Effect size (r) ="</span>, <span class="fu">round</span>(effect_size<span class="sc">$</span>effsize, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb702-893"><a href="#cb702-893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-894"><a href="#cb702-894" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"t-test:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-895"><a href="#cb702-895" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  p-value ="</span>, <span class="fu">round</span>(t_result<span class="sc">$</span>p.value, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-896"><a href="#cb702-896" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Cohen's d ="</span>, <span class="fu">round</span>(<span class="fu">cohens_d</span>(recovery_data, days <span class="sc">~</span> treatment)<span class="sc">$</span>effsize, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb702-897"><a href="#cb702-897" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-898"><a href="#cb702-898" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Both tests agree on significance, but:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-899"><a href="#cb702-899" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Mann-Whitney is robust to outliers</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-900"><a href="#cb702-900" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- t-test assumes normality and equal variance</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-901"><a href="#cb702-901" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- With small samples + skew, trust Mann-Whitney!</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-902"><a href="#cb702-902" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-903"><a href="#cb702-903" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-904"><a href="#cb702-904" aria-hidden="true" tabindex="-1"></a>**❓ Question 3:** What happens if we remove the outliers (31 and 42)? Would the t-test be more appropriate?</span>
<span id="cb702-905"><a href="#cb702-905" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-906"><a href="#cb702-906" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-907"><a href="#cb702-907" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-908"><a href="#cb702-908" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 7: Create Publication Table</span></span>
<span id="cb702-909"><a href="#cb702-909" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-912"><a href="#cb702-912" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb702-913"><a href="#cb702-913" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: lab3-step7</span></span>
<span id="cb702-914"><a href="#cb702-914" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb702-915"><a href="#cb702-915" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-916"><a href="#cb702-916" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary table</span></span>
<span id="cb702-917"><a href="#cb702-917" aria-hidden="true" tabindex="-1"></a>summary_table <span class="ot">&lt;-</span> recovery_data <span class="sc">%&gt;%</span></span>
<span id="cb702-918"><a href="#cb702-918" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(treatment) <span class="sc">%&gt;%</span></span>
<span id="cb702-919"><a href="#cb702-919" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb702-920"><a href="#cb702-920" aria-hidden="true" tabindex="-1"></a>    <span class="at">N =</span> <span class="fu">n</span>(),</span>
<span id="cb702-921"><a href="#cb702-921" aria-hidden="true" tabindex="-1"></a>    <span class="at">Median =</span> <span class="fu">median</span>(days),</span>
<span id="cb702-922"><a href="#cb702-922" aria-hidden="true" tabindex="-1"></a>    <span class="at">IQR =</span> <span class="fu">paste0</span>(<span class="fu">quantile</span>(days, <span class="fl">0.25</span>), <span class="st">"–"</span>, <span class="fu">quantile</span>(days, <span class="fl">0.75</span>)),</span>
<span id="cb702-923"><a href="#cb702-923" aria-hidden="true" tabindex="-1"></a>    <span class="at">Range =</span> <span class="fu">paste0</span>(<span class="fu">min</span>(days), <span class="st">"–"</span>, <span class="fu">max</span>(days))</span>
<span id="cb702-924"><a href="#cb702-924" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb702-925"><a href="#cb702-925" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-926"><a href="#cb702-926" aria-hidden="true" tabindex="-1"></a>summary_table <span class="sc">%&gt;%</span></span>
<span id="cb702-927"><a href="#cb702-927" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb702-928"><a href="#cb702-928" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb702-929"><a href="#cb702-929" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Recovery Times by Treatment Group"</span>,</span>
<span id="cb702-930"><a href="#cb702-930" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">sprintf</span>(<span class="st">"Mann-Whitney U test: p = %.3f, r = %.2f, Hodges-Lehmann = %.1f days"</span>,</span>
<span id="cb702-931"><a href="#cb702-931" aria-hidden="true" tabindex="-1"></a>                      mw_result<span class="sc">$</span>p.value, effect_size<span class="sc">$</span>effsize, hl_estimate)</span>
<span id="cb702-932"><a href="#cb702-932" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb702-933"><a href="#cb702-933" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_footnote</span>(</span>
<span id="cb702-934"><a href="#cb702-934" aria-hidden="true" tabindex="-1"></a>    <span class="at">footnote =</span> <span class="st">"Rank-biserial correlation indicates medium-to-large effect"</span>,</span>
<span id="cb702-935"><a href="#cb702-935" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_title</span>()</span>
<span id="cb702-936"><a href="#cb702-936" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb702-937"><a href="#cb702-937" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-938"><a href="#cb702-938" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-939"><a href="#cb702-939" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-940"><a href="#cb702-940" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-941"><a href="#cb702-941" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 8: Visualize Effect with Rank Plot</span></span>
<span id="cb702-942"><a href="#cb702-942" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-945"><a href="#cb702-945" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb702-946"><a href="#cb702-946" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: lab3-step8</span></span>
<span id="cb702-947"><a href="#cb702-947" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Ranked recovery times showing treatment separation"</span></span>
<span id="cb702-948"><a href="#cb702-948" aria-hidden="true" tabindex="-1"></a><span class="co"># Add ranks for visualization</span></span>
<span id="cb702-949"><a href="#cb702-949" aria-hidden="true" tabindex="-1"></a>recovery_ranked <span class="ot">&lt;-</span> recovery_data <span class="sc">%&gt;%</span></span>
<span id="cb702-950"><a href="#cb702-950" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rank =</span> <span class="fu">rank</span>(days))</span>
<span id="cb702-951"><a href="#cb702-951" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-952"><a href="#cb702-952" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(recovery_ranked, <span class="fu">aes</span>(<span class="at">x =</span> rank, <span class="at">y =</span> days, <span class="at">color =</span> treatment, <span class="at">shape =</span> treatment)) <span class="sc">+</span></span>
<span id="cb702-953"><a href="#cb702-953" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb702-954"><a href="#cb702-954" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="fu">aes</span>(<span class="at">yintercept =</span> <span class="fu">median</span>(days[treatment <span class="sc">==</span> <span class="st">"Treatment A"</span>])),</span>
<span id="cb702-955"><a href="#cb702-955" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"#F8766D"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb702-956"><a href="#cb702-956" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="fu">aes</span>(<span class="at">yintercept =</span> <span class="fu">median</span>(days[treatment <span class="sc">==</span> <span class="st">"Treatment B"</span>])),</span>
<span id="cb702-957"><a href="#cb702-957" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"#00BFC4"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb702-958"><a href="#cb702-958" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Recovery Times Ranked"</span>,</span>
<span id="cb702-959"><a href="#cb702-959" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Dashed lines = medians"</span>,</span>
<span id="cb702-960"><a href="#cb702-960" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Rank (1 = shortest recovery)"</span>,</span>
<span id="cb702-961"><a href="#cb702-961" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Days to Recovery"</span>) <span class="sc">+</span></span>
<span id="cb702-962"><a href="#cb702-962" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb702-963"><a href="#cb702-963" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-964"><a href="#cb702-964" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-965"><a href="#cb702-965" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-966"><a href="#cb702-966" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-967"><a href="#cb702-967" aria-hidden="true" tabindex="-1"></a><span class="fu">### ❓ Discussion Questions</span></span>
<span id="cb702-968"><a href="#cb702-968" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-969"><a href="#cb702-969" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Why is Mann-Whitney called a "rank-based" test?**</span>
<span id="cb702-970"><a href="#cb702-970" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>It ranks all observations from both groups together</span>
<span id="cb702-971"><a href="#cb702-971" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Tests whether ranks are systematically higher in one group</span>
<span id="cb702-972"><a href="#cb702-972" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Makes no assumptions about distribution shape</span>
<span id="cb702-973"><a href="#cb702-973" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-974"><a href="#cb702-974" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**When would you use t-test instead of Mann-Whitney?**</span>
<span id="cb702-975"><a href="#cb702-975" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Large samples (n &gt; 30 per group) where CLT applies</span>
<span id="cb702-976"><a href="#cb702-976" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Truly normal data with no outliers</span>
<span id="cb702-977"><a href="#cb702-977" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>When you need to test means specifically (not medians/shifts)</span>
<span id="cb702-978"><a href="#cb702-978" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-979"><a href="#cb702-979" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**What's the difference between median difference and Hodges-Lehmann?**</span>
<span id="cb702-980"><a href="#cb702-980" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Median difference: simple subtraction of group medians</span>
<span id="cb702-981"><a href="#cb702-981" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Hodges-Lehmann: median of ALL pairwise differences between groups</span>
<span id="cb702-982"><a href="#cb702-982" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>HL is often preferred as it uses more information</span>
<span id="cb702-983"><a href="#cb702-983" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-984"><a href="#cb702-984" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**How would results change if we added more data?**</span>
<span id="cb702-985"><a href="#cb702-985" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Narrower confidence intervals</span>
<span id="cb702-986"><a href="#cb702-986" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>More precise effect size estimate</span>
<span id="cb702-987"><a href="#cb702-987" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Could detect smaller differences</span>
<span id="cb702-988"><a href="#cb702-988" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-989"><a href="#cb702-989" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-990"><a href="#cb702-990" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-991"><a href="#cb702-991" aria-hidden="true" tabindex="-1"></a><span class="fu">### 💡 Key Takeaways</span></span>
<span id="cb702-992"><a href="#cb702-992" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-993"><a href="#cb702-993" aria-hidden="true" tabindex="-1"></a>✅ **Use Mann-Whitney when:**</span>
<span id="cb702-994"><a href="#cb702-994" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Independent groups (unpaired data)</span>
<span id="cb702-995"><a href="#cb702-995" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Ordinal or continuous outcome</span>
<span id="cb702-996"><a href="#cb702-996" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Non-normal distributions or outliers</span>
<span id="cb702-997"><a href="#cb702-997" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Small samples (n &lt; 30 per group)</span>
<span id="cb702-998"><a href="#cb702-998" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-999"><a href="#cb702-999" aria-hidden="true" tabindex="-1"></a>✅ **Mann-Whitney tests:**</span>
<span id="cb702-1000"><a href="#cb702-1000" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Whether distributions differ in location</span>
<span id="cb702-1001"><a href="#cb702-1001" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>NOT just medians (common misconception!)</span>
<span id="cb702-1002"><a href="#cb702-1002" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Robust to outliers and skewness</span>
<span id="cb702-1003"><a href="#cb702-1003" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1004"><a href="#cb702-1004" aria-hidden="true" tabindex="-1"></a>✅ **Report these components:**</span>
<span id="cb702-1005"><a href="#cb702-1005" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Medians and IQRs for each group</span>
<span id="cb702-1006"><a href="#cb702-1006" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Mann-Whitney p-value</span>
<span id="cb702-1007"><a href="#cb702-1007" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Hodges-Lehmann estimate with CI</span>
<span id="cb702-1008"><a href="#cb702-1008" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Rank-biserial correlation (effect size)</span>
<span id="cb702-1009"><a href="#cb702-1009" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1010"><a href="#cb702-1010" aria-hidden="true" tabindex="-1"></a>✅ **Remember:**</span>
<span id="cb702-1011"><a href="#cb702-1011" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Exact test for small samples (n &lt; 30)</span>
<span id="cb702-1012"><a href="#cb702-1012" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Large-sample approximation for n ≥ 30</span>
<span id="cb702-1013"><a href="#cb702-1013" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Always visualize with box plots + points</span>
<span id="cb702-1014"><a href="#cb702-1014" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1015"><a href="#cb702-1015" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-1016"><a href="#cb702-1016" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1017"><a href="#cb702-1017" aria-hidden="true" tabindex="-1"></a><span class="fu">### 🏠 Homework Exercise</span></span>
<span id="cb702-1018"><a href="#cb702-1018" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1019"><a href="#cb702-1019" aria-hidden="true" tabindex="-1"></a>Analyze satisfaction scores (1-7 scale) for two app interfaces:</span>
<span id="cb702-1020"><a href="#cb702-1020" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1021"><a href="#cb702-1021" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb702-1022"><a href="#cb702-1022" aria-hidden="true" tabindex="-1"></a>interface_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb702-1023"><a href="#cb702-1023" aria-hidden="true" tabindex="-1"></a>  <span class="at">interface =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Design A"</span>, <span class="st">"Design B"</span>), <span class="at">each =</span> <span class="dv">12</span>),</span>
<span id="cb702-1024"><a href="#cb702-1024" aria-hidden="true" tabindex="-1"></a>  <span class="at">satisfaction =</span> <span class="fu">c</span>(</span>
<span id="cb702-1025"><a href="#cb702-1025" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Design A</span></span>
<span id="cb702-1026"><a href="#cb702-1026" aria-hidden="true" tabindex="-1"></a>    <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">7</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">5</span>, <span class="dv">4</span>,</span>
<span id="cb702-1027"><a href="#cb702-1027" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Design B</span></span>
<span id="cb702-1028"><a href="#cb702-1028" aria-hidden="true" tabindex="-1"></a>    <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">6</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">5</span>, <span class="dv">6</span></span>
<span id="cb702-1029"><a href="#cb702-1029" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb702-1030"><a href="#cb702-1030" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb702-1031"><a href="#cb702-1031" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-1032"><a href="#cb702-1032" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1033"><a href="#cb702-1033" aria-hidden="true" tabindex="-1"></a>**Tasks:**</span>
<span id="cb702-1034"><a href="#cb702-1034" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Create box plots with individual points</span>
<span id="cb702-1035"><a href="#cb702-1035" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Calculate medians and IQRs for each group</span>
<span id="cb702-1036"><a href="#cb702-1036" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Run Mann-Whitney U test</span>
<span id="cb702-1037"><a href="#cb702-1037" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Calculate rank-biserial correlation</span>
<span id="cb702-1038"><a href="#cb702-1038" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>Interpret Hodges-Lehmann estimate</span>
<span id="cb702-1039"><a href="#cb702-1039" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span>Write a 4-sentence results paragraph including:</span>
<span id="cb702-1040"><a href="#cb702-1040" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Descriptive statistics</span>
<span id="cb702-1041"><a href="#cb702-1041" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Test statistic and p-value</span>
<span id="cb702-1042"><a href="#cb702-1042" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Effect size interpretation</span>
<span id="cb702-1043"><a href="#cb702-1043" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Practical conclusion</span>
<span id="cb702-1044"><a href="#cb702-1044" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1045"><a href="#cb702-1045" aria-hidden="true" tabindex="-1"></a>**Expected results:** Design B should have higher satisfaction with moderate effect size.</span>
<span id="cb702-1046"><a href="#cb702-1046" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1047"><a href="#cb702-1047" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-1048"><a href="#cb702-1048" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1049"><a href="#cb702-1049" aria-hidden="true" tabindex="-1"></a><span class="fu">## Lab 4: Wilcoxon Signed-Rank Test (Chapter 4)</span></span>
<span id="cb702-1050"><a href="#cb702-1050" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1051"><a href="#cb702-1051" aria-hidden="true" tabindex="-1"></a><span class="fu"># 🧪 Lab Practical 4: Wilcoxon Signed-Rank Test</span></span>
<span id="cb702-1052"><a href="#cb702-1052" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1053"><a href="#cb702-1053" aria-hidden="true" tabindex="-1"></a>**Learning Objectives:**</span>
<span id="cb702-1054"><a href="#cb702-1054" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Understand paired vs. independent designs</span>
<span id="cb702-1055"><a href="#cb702-1055" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Perform Wilcoxon signed-rank test</span>
<span id="cb702-1056"><a href="#cb702-1056" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Calculate effect size for paired nonparametric tests</span>
<span id="cb702-1057"><a href="#cb702-1057" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Interpret results with paired data visualizations</span>
<span id="cb702-1058"><a href="#cb702-1058" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1059"><a href="#cb702-1059" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-1060"><a href="#cb702-1060" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1061"><a href="#cb702-1061" aria-hidden="true" tabindex="-1"></a><span class="fu">### Scenario</span></span>
<span id="cb702-1062"><a href="#cb702-1062" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1063"><a href="#cb702-1063" aria-hidden="true" tabindex="-1"></a>A wellness coach measures anxiety scores (0-100 scale) for 14 clients before and after a 4-week mindfulness program. Since the same clients are measured twice, data are paired.</span>
<span id="cb702-1064"><a href="#cb702-1064" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1065"><a href="#cb702-1065" aria-hidden="true" tabindex="-1"></a>**Research Question**: Does the mindfulness program reduce anxiety?</span>
<span id="cb702-1066"><a href="#cb702-1066" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1067"><a href="#cb702-1067" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-1068"><a href="#cb702-1068" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1069"><a href="#cb702-1069" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 1: Create and Visualize Paired Data</span></span>
<span id="cb702-1070"><a href="#cb702-1070" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1073"><a href="#cb702-1073" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb702-1074"><a href="#cb702-1074" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: lab4-step1</span></span>
<span id="cb702-1075"><a href="#cb702-1075" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Anxiety scores before and after mindfulness program"</span></span>
<span id="cb702-1076"><a href="#cb702-1076" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb702-1077"><a href="#cb702-1077" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstatix)</span>
<span id="cb702-1078"><a href="#cb702-1078" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1079"><a href="#cb702-1079" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb702-1080"><a href="#cb702-1080" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1081"><a href="#cb702-1081" aria-hidden="true" tabindex="-1"></a><span class="co"># Paired data</span></span>
<span id="cb702-1082"><a href="#cb702-1082" aria-hidden="true" tabindex="-1"></a>anxiety_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb702-1083"><a href="#cb702-1083" aria-hidden="true" tabindex="-1"></a>  <span class="at">client_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">14</span>,</span>
<span id="cb702-1084"><a href="#cb702-1084" aria-hidden="true" tabindex="-1"></a>  <span class="at">before =</span> <span class="fu">c</span>(<span class="dv">68</span>, <span class="dv">72</span>, <span class="dv">65</span>, <span class="dv">78</span>, <span class="dv">70</span>, <span class="dv">63</span>, <span class="dv">75</span>, <span class="dv">81</span>, <span class="dv">69</span>, <span class="dv">74</span>, <span class="dv">66</span>, <span class="dv">71</span>, <span class="dv">77</span>, <span class="dv">73</span>),</span>
<span id="cb702-1085"><a href="#cb702-1085" aria-hidden="true" tabindex="-1"></a>  <span class="at">after =</span> <span class="fu">c</span>(<span class="dv">61</span>, <span class="dv">65</span>, <span class="dv">62</span>, <span class="dv">70</span>, <span class="dv">64</span>, <span class="dv">60</span>, <span class="dv">68</span>, <span class="dv">72</span>, <span class="dv">65</span>, <span class="dv">67</span>, <span class="dv">63</span>, <span class="dv">66</span>, <span class="dv">71</span>, <span class="dv">68</span>)</span>
<span id="cb702-1086"><a href="#cb702-1086" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb702-1087"><a href="#cb702-1087" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1088"><a href="#cb702-1088" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to long format for plotting</span></span>
<span id="cb702-1089"><a href="#cb702-1089" aria-hidden="true" tabindex="-1"></a>anxiety_long <span class="ot">&lt;-</span> anxiety_data <span class="sc">%&gt;%</span></span>
<span id="cb702-1090"><a href="#cb702-1090" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(before, after),</span>
<span id="cb702-1091"><a href="#cb702-1091" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"timepoint"</span>,</span>
<span id="cb702-1092"><a href="#cb702-1092" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"anxiety"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb702-1093"><a href="#cb702-1093" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">timepoint =</span> <span class="fu">factor</span>(timepoint, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"before"</span>, <span class="st">"after"</span>)))</span>
<span id="cb702-1094"><a href="#cb702-1094" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1095"><a href="#cb702-1095" aria-hidden="true" tabindex="-1"></a><span class="co"># Paired plot</span></span>
<span id="cb702-1096"><a href="#cb702-1096" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(anxiety_long, <span class="fu">aes</span>(<span class="at">x =</span> timepoint, <span class="at">y =</span> anxiety, <span class="at">group =</span> client_id)) <span class="sc">+</span></span>
<span id="cb702-1097"><a href="#cb702-1097" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">color =</span> <span class="st">"gray60"</span>) <span class="sc">+</span></span>
<span id="cb702-1098"><a href="#cb702-1098" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> timepoint), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb702-1099"><a href="#cb702-1099" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Anxiety Scores: Before vs. After Mindfulness"</span>,</span>
<span id="cb702-1100"><a href="#cb702-1100" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Each line represents one client"</span>,</span>
<span id="cb702-1101"><a href="#cb702-1101" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Timepoint"</span>,</span>
<span id="cb702-1102"><a href="#cb702-1102" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Anxiety Score (0-100)"</span>) <span class="sc">+</span></span>
<span id="cb702-1103"><a href="#cb702-1103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb702-1104"><a href="#cb702-1104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb702-1105"><a href="#cb702-1105" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-1106"><a href="#cb702-1106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1107"><a href="#cb702-1107" aria-hidden="true" tabindex="-1"></a>**✋ Checkpoint 1:**</span>
<span id="cb702-1108"><a href="#cb702-1108" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Do most lines slope downward? (Yes = anxiety decreased)</span>
<span id="cb702-1109"><a href="#cb702-1109" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Any clients with increased anxiety?</span>
<span id="cb702-1110"><a href="#cb702-1110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1111"><a href="#cb702-1111" aria-hidden="true" tabindex="-1"></a>**💡 Teaching Point:** Paired data show individual change—much more powerful than comparing independent groups!</span>
<span id="cb702-1112"><a href="#cb702-1112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1113"><a href="#cb702-1113" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-1114"><a href="#cb702-1114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1115"><a href="#cb702-1115" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 2: Calculate and Visualize Differences</span></span>
<span id="cb702-1116"><a href="#cb702-1116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1119"><a href="#cb702-1119" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb702-1120"><a href="#cb702-1120" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: lab4-step2</span></span>
<span id="cb702-1121"><a href="#cb702-1121" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Distribution of anxiety score changes"</span></span>
<span id="cb702-1122"><a href="#cb702-1122" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate differences (after - before)</span></span>
<span id="cb702-1123"><a href="#cb702-1123" aria-hidden="true" tabindex="-1"></a>anxiety_data <span class="ot">&lt;-</span> anxiety_data <span class="sc">%&gt;%</span></span>
<span id="cb702-1124"><a href="#cb702-1124" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">difference =</span> after <span class="sc">-</span> before)</span>
<span id="cb702-1125"><a href="#cb702-1125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1126"><a href="#cb702-1126" aria-hidden="true" tabindex="-1"></a><span class="co"># Histogram of differences</span></span>
<span id="cb702-1127"><a href="#cb702-1127" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(anxiety_data, <span class="fu">aes</span>(<span class="at">x =</span> difference)) <span class="sc">+</span></span>
<span id="cb702-1128"><a href="#cb702-1128" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">2</span>, <span class="at">fill =</span> <span class="st">"steelblue"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb702-1129"><a href="#cb702-1129" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> <span class="dv">0</span>), <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb702-1130"><a href="#cb702-1130" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> <span class="fu">median</span>(difference)), </span>
<span id="cb702-1131"><a href="#cb702-1131" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"darkblue"</span>, <span class="at">linetype =</span> <span class="st">"solid"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb702-1132"><a href="#cb702-1132" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Change Scores"</span>,</span>
<span id="cb702-1133"><a href="#cb702-1133" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Red dashed = no change; Blue solid = median change"</span>,</span>
<span id="cb702-1134"><a href="#cb702-1134" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Change in Anxiety (after - before)"</span>,</span>
<span id="cb702-1135"><a href="#cb702-1135" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb702-1136"><a href="#cb702-1136" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb702-1137"><a href="#cb702-1137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1138"><a href="#cb702-1138" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary of differences</span></span>
<span id="cb702-1139"><a href="#cb702-1139" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Summary of Changes:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-1140"><a href="#cb702-1140" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Mean change:"</span>, <span class="fu">round</span>(<span class="fu">mean</span>(anxiety_data<span class="sc">$</span>difference), <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-1141"><a href="#cb702-1141" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Median change:"</span>, <span class="fu">median</span>(anxiety_data<span class="sc">$</span>difference), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-1142"><a href="#cb702-1142" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"SD of change:"</span>, <span class="fu">round</span>(<span class="fu">sd</span>(anxiety_data<span class="sc">$</span>difference), <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-1143"><a href="#cb702-1143" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Clients improved:"</span>, <span class="fu">sum</span>(anxiety_data<span class="sc">$</span>difference <span class="sc">&lt;</span> <span class="dv">0</span>), <span class="st">"out of"</span>, <span class="fu">nrow</span>(anxiety_data), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-1144"><a href="#cb702-1144" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Clients worsened:"</span>, <span class="fu">sum</span>(anxiety_data<span class="sc">$</span>difference <span class="sc">&gt;</span> <span class="dv">0</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-1145"><a href="#cb702-1145" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-1146"><a href="#cb702-1146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1147"><a href="#cb702-1147" aria-hidden="true" tabindex="-1"></a>**❓ Question 1:** Why do we focus on differences rather than before/after separately?</span>
<span id="cb702-1148"><a href="#cb702-1148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1149"><a href="#cb702-1149" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-1150"><a href="#cb702-1150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1151"><a href="#cb702-1151" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 3: Run Wilcoxon Signed-Rank Test</span></span>
<span id="cb702-1152"><a href="#cb702-1152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1155"><a href="#cb702-1155" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb702-1156"><a href="#cb702-1156" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: lab4-step3</span></span>
<span id="cb702-1157"><a href="#cb702-1157" aria-hidden="true" tabindex="-1"></a><span class="co"># Wilcoxon signed-rank test</span></span>
<span id="cb702-1158"><a href="#cb702-1158" aria-hidden="true" tabindex="-1"></a>wilcox_result <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(anxiety_data<span class="sc">$</span>after, </span>
<span id="cb702-1159"><a href="#cb702-1159" aria-hidden="true" tabindex="-1"></a>                              anxiety_data<span class="sc">$</span>before,</span>
<span id="cb702-1160"><a href="#cb702-1160" aria-hidden="true" tabindex="-1"></a>                              <span class="at">paired =</span> <span class="cn">TRUE</span>,</span>
<span id="cb702-1161"><a href="#cb702-1161" aria-hidden="true" tabindex="-1"></a>                              <span class="at">exact =</span> <span class="cn">TRUE</span>,</span>
<span id="cb702-1162"><a href="#cb702-1162" aria-hidden="true" tabindex="-1"></a>                              <span class="at">conf.int =</span> <span class="cn">TRUE</span>)</span>
<span id="cb702-1163"><a href="#cb702-1163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1164"><a href="#cb702-1164" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(wilcox_result)</span>
<span id="cb702-1165"><a href="#cb702-1165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1166"><a href="#cb702-1166" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== Interpretation ===</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-1167"><a href="#cb702-1167" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"V statistic:"</span>, wilcox_result<span class="sc">$</span>statistic, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-1168"><a href="#cb702-1168" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"p-value:"</span>, <span class="fu">round</span>(wilcox_result<span class="sc">$</span>p.value, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-1169"><a href="#cb702-1169" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"95% CI for pseudo-median:"</span>, </span>
<span id="cb702-1170"><a href="#cb702-1170" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(wilcox_result<span class="sc">$</span>conf.int[<span class="dv">1</span>], <span class="dv">1</span>), <span class="st">"to"</span>,</span>
<span id="cb702-1171"><a href="#cb702-1171" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(wilcox_result<span class="sc">$</span>conf.int[<span class="dv">2</span>], <span class="dv">1</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-1172"><a href="#cb702-1172" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-1173"><a href="#cb702-1173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1174"><a href="#cb702-1174" aria-hidden="true" tabindex="-1"></a>**✋ Checkpoint 2:**</span>
<span id="cb702-1175"><a href="#cb702-1175" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Is p &lt; 0.05? (Yes, significant reduction)</span>
<span id="cb702-1176"><a href="#cb702-1176" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>What does the "V statistic" represent? (Sum of positive ranks)</span>
<span id="cb702-1177"><a href="#cb702-1177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1178"><a href="#cb702-1178" aria-hidden="true" tabindex="-1"></a>**💡 Teaching Point:** Wilcoxon signed-rank tests whether the distribution of differences is symmetric around zero.</span>
<span id="cb702-1179"><a href="#cb702-1179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1180"><a href="#cb702-1180" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-1181"><a href="#cb702-1181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1182"><a href="#cb702-1182" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 4: Calculate Effect Size (r)</span></span>
<span id="cb702-1183"><a href="#cb702-1183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1186"><a href="#cb702-1186" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb702-1187"><a href="#cb702-1187" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: lab4-step4</span></span>
<span id="cb702-1188"><a href="#cb702-1188" aria-hidden="true" tabindex="-1"></a><span class="co"># Effect size using rstatix</span></span>
<span id="cb702-1189"><a href="#cb702-1189" aria-hidden="true" tabindex="-1"></a>effect_size <span class="ot">&lt;-</span> <span class="fu">wilcox_effsize</span>(anxiety_long, anxiety <span class="sc">~</span> timepoint, <span class="at">paired =</span> <span class="cn">TRUE</span>)</span>
<span id="cb702-1190"><a href="#cb702-1190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1191"><a href="#cb702-1191" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(effect_size)</span>
<span id="cb702-1192"><a href="#cb702-1192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1193"><a href="#cb702-1193" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Effect Size Interpretation:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-1194"><a href="#cb702-1194" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"r ="</span>, <span class="fu">round</span>(effect_size<span class="sc">$</span>effsize, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-1195"><a href="#cb702-1195" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Small: |r| &lt; 0.3</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-1196"><a href="#cb702-1196" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Medium: |r| = 0.3-0.5</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-1197"><a href="#cb702-1197" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Large: |r| &gt; 0.5</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb702-1198"><a href="#cb702-1198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1199"><a href="#cb702-1199" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">abs</span>(effect_size<span class="sc">$</span>effsize) <span class="sc">&gt;</span> <span class="fl">0.5</span>) {</span>
<span id="cb702-1200"><a href="#cb702-1200" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"→ LARGE effect: Mindfulness program shows substantial benefit</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-1201"><a href="#cb702-1201" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">abs</span>(effect_size<span class="sc">$</span>effsize) <span class="sc">&gt;</span> <span class="fl">0.3</span>) {</span>
<span id="cb702-1202"><a href="#cb702-1202" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"→ MEDIUM effect: Mindfulness program shows moderate benefit</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-1203"><a href="#cb702-1203" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb702-1204"><a href="#cb702-1204" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"→ SMALL effect: Mindfulness program shows modest benefit</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-1205"><a href="#cb702-1205" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb702-1206"><a href="#cb702-1206" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-1207"><a href="#cb702-1207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1208"><a href="#cb702-1208" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-1209"><a href="#cb702-1209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1210"><a href="#cb702-1210" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 5: Compare with Paired t-test</span></span>
<span id="cb702-1211"><a href="#cb702-1211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1214"><a href="#cb702-1214" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb702-1215"><a href="#cb702-1215" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: lab4-step5</span></span>
<span id="cb702-1216"><a href="#cb702-1216" aria-hidden="true" tabindex="-1"></a><span class="co"># Paired t-test for comparison</span></span>
<span id="cb702-1217"><a href="#cb702-1217" aria-hidden="true" tabindex="-1"></a>t_result <span class="ot">&lt;-</span> <span class="fu">t.test</span>(anxiety_data<span class="sc">$</span>after, anxiety_data<span class="sc">$</span>before, <span class="at">paired =</span> <span class="cn">TRUE</span>)</span>
<span id="cb702-1218"><a href="#cb702-1218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1219"><a href="#cb702-1219" aria-hidden="true" tabindex="-1"></a><span class="co"># Cohen's d for paired data</span></span>
<span id="cb702-1220"><a href="#cb702-1220" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">mean</span>(anxiety_data<span class="sc">$</span>difference) <span class="sc">/</span> <span class="fu">sd</span>(anxiety_data<span class="sc">$</span>difference)</span>
<span id="cb702-1221"><a href="#cb702-1221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1222"><a href="#cb702-1222" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"=== Wilcoxon vs. Paired t-test ===</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb702-1223"><a href="#cb702-1223" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Wilcoxon Signed-Rank:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-1224"><a href="#cb702-1224" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  p ="</span>, <span class="fu">round</span>(wilcox_result<span class="sc">$</span>p.value, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-1225"><a href="#cb702-1225" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  r ="</span>, <span class="fu">round</span>(effect_size<span class="sc">$</span>effsize, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb702-1226"><a href="#cb702-1226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1227"><a href="#cb702-1227" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Paired t-test:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-1228"><a href="#cb702-1228" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  p ="</span>, <span class="fu">round</span>(t_result<span class="sc">$</span>p.value, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-1229"><a href="#cb702-1229" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Cohen's d ="</span>, <span class="fu">round</span>(d, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-1230"><a href="#cb702-1230" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  95% CI for mean diff:"</span>, </span>
<span id="cb702-1231"><a href="#cb702-1231" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(t_result<span class="sc">$</span>conf.int[<span class="dv">1</span>], <span class="dv">1</span>), <span class="st">"to"</span>,</span>
<span id="cb702-1232"><a href="#cb702-1232" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(t_result<span class="sc">$</span>conf.int[<span class="dv">2</span>], <span class="dv">1</span>), <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb702-1233"><a href="#cb702-1233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1234"><a href="#cb702-1234" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Conclusion: Both tests agree on significance!</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-1235"><a href="#cb702-1235" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"With n=14, Wilcoxon is safer (fewer assumptions)</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-1236"><a href="#cb702-1236" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-1237"><a href="#cb702-1237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1238"><a href="#cb702-1238" aria-hidden="true" tabindex="-1"></a>**❓ Question 2:** When would the two tests disagree?</span>
<span id="cb702-1239"><a href="#cb702-1239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1240"><a href="#cb702-1240" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-1241"><a href="#cb702-1241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1242"><a href="#cb702-1242" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 6: Check for Outliers in Differences</span></span>
<span id="cb702-1243"><a href="#cb702-1243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1246"><a href="#cb702-1246" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb702-1247"><a href="#cb702-1247" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: lab4-step6</span></span>
<span id="cb702-1248"><a href="#cb702-1248" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Box plot of change scores identifying outliers"</span></span>
<span id="cb702-1249"><a href="#cb702-1249" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(anxiety_data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> difference)) <span class="sc">+</span></span>
<span id="cb702-1250"><a href="#cb702-1250" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">"lightblue"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb702-1251"><a href="#cb702-1251" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb702-1252"><a href="#cb702-1252" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb702-1253"><a href="#cb702-1253" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Change Scores with Outlier Detection"</span>,</span>
<span id="cb702-1254"><a href="#cb702-1254" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Change in Anxiety (after - before)"</span>,</span>
<span id="cb702-1255"><a href="#cb702-1255" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb702-1256"><a href="#cb702-1256" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb702-1257"><a href="#cb702-1257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1258"><a href="#cb702-1258" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify outliers</span></span>
<span id="cb702-1259"><a href="#cb702-1259" aria-hidden="true" tabindex="-1"></a>Q1 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(anxiety_data<span class="sc">$</span>difference, <span class="fl">0.25</span>)</span>
<span id="cb702-1260"><a href="#cb702-1260" aria-hidden="true" tabindex="-1"></a>Q3 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(anxiety_data<span class="sc">$</span>difference, <span class="fl">0.75</span>)</span>
<span id="cb702-1261"><a href="#cb702-1261" aria-hidden="true" tabindex="-1"></a>IQR_val <span class="ot">&lt;-</span> <span class="fu">IQR</span>(anxiety_data<span class="sc">$</span>difference)</span>
<span id="cb702-1262"><a href="#cb702-1262" aria-hidden="true" tabindex="-1"></a>outliers <span class="ot">&lt;-</span> anxiety_data <span class="sc">%&gt;%</span></span>
<span id="cb702-1263"><a href="#cb702-1263" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(difference <span class="sc">&lt;</span> Q1 <span class="sc">-</span> <span class="fl">1.5</span> <span class="sc">*</span> IQR_val <span class="sc">|</span> difference <span class="sc">&gt;</span> Q3 <span class="sc">+</span> <span class="fl">1.5</span> <span class="sc">*</span> IQR_val)</span>
<span id="cb702-1264"><a href="#cb702-1264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1265"><a href="#cb702-1265" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">nrow</span>(outliers) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb702-1266"><a href="#cb702-1266" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Outliers detected:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-1267"><a href="#cb702-1267" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(outliers)</span>
<span id="cb702-1268"><a href="#cb702-1268" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb702-1269"><a href="#cb702-1269" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"No outliers detected</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-1270"><a href="#cb702-1270" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb702-1271"><a href="#cb702-1271" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-1272"><a href="#cb702-1272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1273"><a href="#cb702-1273" aria-hidden="true" tabindex="-1"></a>**💡 Teaching Point:** Wilcoxon is robust to outliers—one reason to prefer it over paired t-test!</span>
<span id="cb702-1274"><a href="#cb702-1274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1275"><a href="#cb702-1275" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-1276"><a href="#cb702-1276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1277"><a href="#cb702-1277" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 7: Create Publication Table</span></span>
<span id="cb702-1278"><a href="#cb702-1278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1281"><a href="#cb702-1281" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb702-1282"><a href="#cb702-1282" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: lab4-step7</span></span>
<span id="cb702-1283"><a href="#cb702-1283" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb702-1284"><a href="#cb702-1284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1285"><a href="#cb702-1285" aria-hidden="true" tabindex="-1"></a>summary_table <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb702-1286"><a href="#cb702-1286" aria-hidden="true" tabindex="-1"></a>  <span class="at">Timepoint =</span> <span class="fu">c</span>(<span class="st">"Before"</span>, <span class="st">"After"</span>, <span class="st">"Change"</span>),</span>
<span id="cb702-1287"><a href="#cb702-1287" aria-hidden="true" tabindex="-1"></a>  <span class="at">N =</span> <span class="fu">c</span>(<span class="dv">14</span>, <span class="dv">14</span>, <span class="dv">14</span>),</span>
<span id="cb702-1288"><a href="#cb702-1288" aria-hidden="true" tabindex="-1"></a>  <span class="at">Median =</span> <span class="fu">c</span>(<span class="fu">median</span>(anxiety_data<span class="sc">$</span>before),</span>
<span id="cb702-1289"><a href="#cb702-1289" aria-hidden="true" tabindex="-1"></a>             <span class="fu">median</span>(anxiety_data<span class="sc">$</span>after),</span>
<span id="cb702-1290"><a href="#cb702-1290" aria-hidden="true" tabindex="-1"></a>             <span class="fu">median</span>(anxiety_data<span class="sc">$</span>difference)),</span>
<span id="cb702-1291"><a href="#cb702-1291" aria-hidden="true" tabindex="-1"></a>  <span class="at">IQR =</span> <span class="fu">c</span>(</span>
<span id="cb702-1292"><a href="#cb702-1292" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="fu">quantile</span>(anxiety_data<span class="sc">$</span>before, <span class="fl">0.25</span>), <span class="st">"–"</span>, </span>
<span id="cb702-1293"><a href="#cb702-1293" aria-hidden="true" tabindex="-1"></a>           <span class="fu">quantile</span>(anxiety_data<span class="sc">$</span>before, <span class="fl">0.75</span>)),</span>
<span id="cb702-1294"><a href="#cb702-1294" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="fu">quantile</span>(anxiety_data<span class="sc">$</span>after, <span class="fl">0.25</span>), <span class="st">"–"</span>, </span>
<span id="cb702-1295"><a href="#cb702-1295" aria-hidden="true" tabindex="-1"></a>           <span class="fu">quantile</span>(anxiety_data<span class="sc">$</span>after, <span class="fl">0.75</span>)),</span>
<span id="cb702-1296"><a href="#cb702-1296" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="fu">quantile</span>(anxiety_data<span class="sc">$</span>difference, <span class="fl">0.25</span>), <span class="st">"–"</span>, </span>
<span id="cb702-1297"><a href="#cb702-1297" aria-hidden="true" tabindex="-1"></a>           <span class="fu">quantile</span>(anxiety_data<span class="sc">$</span>difference, <span class="fl">0.75</span>))</span>
<span id="cb702-1298"><a href="#cb702-1298" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb702-1299"><a href="#cb702-1299" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb702-1300"><a href="#cb702-1300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1301"><a href="#cb702-1301" aria-hidden="true" tabindex="-1"></a>summary_table <span class="sc">%&gt;%</span></span>
<span id="cb702-1302"><a href="#cb702-1302" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb702-1303"><a href="#cb702-1303" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb702-1304"><a href="#cb702-1304" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Anxiety Scores Before and After Mindfulness Program"</span>,</span>
<span id="cb702-1305"><a href="#cb702-1305" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">sprintf</span>(<span class="st">"Wilcoxon signed-rank: p = %.4f, r = %.2f (large effect)"</span>,</span>
<span id="cb702-1306"><a href="#cb702-1306" aria-hidden="true" tabindex="-1"></a>                      wilcox_result<span class="sc">$</span>p.value, effect_size<span class="sc">$</span>effsize)</span>
<span id="cb702-1307"><a href="#cb702-1307" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb702-1308"><a href="#cb702-1308" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_footnote</span>(</span>
<span id="cb702-1309"><a href="#cb702-1309" aria-hidden="true" tabindex="-1"></a>    <span class="at">footnote =</span> <span class="st">"Negative change indicates anxiety reduction"</span>,</span>
<span id="cb702-1310"><a href="#cb702-1310" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_body</span>(<span class="at">columns =</span> Median, <span class="at">rows =</span> <span class="dv">3</span>)</span>
<span id="cb702-1311"><a href="#cb702-1311" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb702-1312"><a href="#cb702-1312" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-1313"><a href="#cb702-1313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1314"><a href="#cb702-1314" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-1315"><a href="#cb702-1315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1316"><a href="#cb702-1316" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 8: Individual Client Profile Plot</span></span>
<span id="cb702-1317"><a href="#cb702-1317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1320"><a href="#cb702-1320" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb702-1321"><a href="#cb702-1321" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: lab4-step8</span></span>
<span id="cb702-1322"><a href="#cb702-1322" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Individual client anxiety trajectories"</span></span>
<span id="cb702-1323"><a href="#cb702-1323" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify clients with largest improvements</span></span>
<span id="cb702-1324"><a href="#cb702-1324" aria-hidden="true" tabindex="-1"></a>top_improvers <span class="ot">&lt;-</span> anxiety_data <span class="sc">%&gt;%</span></span>
<span id="cb702-1325"><a href="#cb702-1325" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(difference) <span class="sc">%&gt;%</span></span>
<span id="cb702-1326"><a href="#cb702-1326" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb702-1327"><a href="#cb702-1327" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(client_id)</span>
<span id="cb702-1328"><a href="#cb702-1328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1329"><a href="#cb702-1329" aria-hidden="true" tabindex="-1"></a>anxiety_long <span class="sc">%&gt;%</span></span>
<span id="cb702-1330"><a href="#cb702-1330" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">highlight =</span> <span class="fu">ifelse</span>(client_id <span class="sc">%in%</span> top_improvers, <span class="st">"Top 3"</span>, <span class="st">"Other"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb702-1331"><a href="#cb702-1331" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> timepoint, <span class="at">y =</span> anxiety, <span class="at">group =</span> client_id)) <span class="sc">+</span></span>
<span id="cb702-1332"><a href="#cb702-1332" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> highlight, <span class="at">linewidth =</span> highlight, <span class="at">alpha =</span> highlight)) <span class="sc">+</span></span>
<span id="cb702-1333"><a href="#cb702-1333" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> highlight), <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb702-1334"><a href="#cb702-1334" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Top 3"</span> <span class="ot">=</span> <span class="st">"darkgreen"</span>, <span class="st">"Other"</span> <span class="ot">=</span> <span class="st">"gray70"</span>)) <span class="sc">+</span></span>
<span id="cb702-1335"><a href="#cb702-1335" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linewidth_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Top 3"</span> <span class="ot">=</span> <span class="fl">1.2</span>, <span class="st">"Other"</span> <span class="ot">=</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb702-1336"><a href="#cb702-1336" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_alpha_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Top 3"</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">"Other"</span> <span class="ot">=</span> <span class="fl">0.3</span>)) <span class="sc">+</span></span>
<span id="cb702-1337"><a href="#cb702-1337" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Client Anxiety Trajectories"</span>,</span>
<span id="cb702-1338"><a href="#cb702-1338" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Green lines = top 3 improvers"</span>,</span>
<span id="cb702-1339"><a href="#cb702-1339" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Timepoint"</span>,</span>
<span id="cb702-1340"><a href="#cb702-1340" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Anxiety Score"</span>) <span class="sc">+</span></span>
<span id="cb702-1341"><a href="#cb702-1341" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb702-1342"><a href="#cb702-1342" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-1343"><a href="#cb702-1343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1344"><a href="#cb702-1344" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-1345"><a href="#cb702-1345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1346"><a href="#cb702-1346" aria-hidden="true" tabindex="-1"></a><span class="fu">### ❓ Discussion Questions</span></span>
<span id="cb702-1347"><a href="#cb702-1347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1348"><a href="#cb702-1348" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Why is paired design more powerful than independent groups?**</span>
<span id="cb702-1349"><a href="#cb702-1349" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Controls for individual differences</span>
<span id="cb702-1350"><a href="#cb702-1350" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Each person is their own control</span>
<span id="cb702-1351"><a href="#cb702-1351" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Reduces variability due to between-person differences</span>
<span id="cb702-1352"><a href="#cb702-1352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1353"><a href="#cb702-1353" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**What does "V statistic" mean in Wilcoxon signed-rank?**</span>
<span id="cb702-1354"><a href="#cb702-1354" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Sum of ranks for positive differences</span>
<span id="cb702-1355"><a href="#cb702-1355" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Large V → most differences are positive</span>
<span id="cb702-1356"><a href="#cb702-1356" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Small V → most differences are negative</span>
<span id="cb702-1357"><a href="#cb702-1357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1358"><a href="#cb702-1358" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**When would you use paired t-test instead?**</span>
<span id="cb702-1359"><a href="#cb702-1359" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Large samples (n &gt; 30 pairs)</span>
<span id="cb702-1360"><a href="#cb702-1360" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Differences are normally distributed</span>
<span id="cb702-1361"><a href="#cb702-1361" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>No outliers in difference scores</span>
<span id="cb702-1362"><a href="#cb702-1362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1363"><a href="#cb702-1363" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**What if some clients had zero change?**</span>
<span id="cb702-1364"><a href="#cb702-1364" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Wilcoxon ignores ties at zero</span>
<span id="cb702-1365"><a href="#cb702-1365" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Reduces sample size for test</span>
<span id="cb702-1366"><a href="#cb702-1366" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Report number of ties</span>
<span id="cb702-1367"><a href="#cb702-1367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1368"><a href="#cb702-1368" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-1369"><a href="#cb702-1369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1370"><a href="#cb702-1370" aria-hidden="true" tabindex="-1"></a><span class="fu">### 💡 Key Takeaways</span></span>
<span id="cb702-1371"><a href="#cb702-1371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1372"><a href="#cb702-1372" aria-hidden="true" tabindex="-1"></a>✅ **Use Wilcoxon signed-rank when:**</span>
<span id="cb702-1373"><a href="#cb702-1373" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Paired/matched data</span>
<span id="cb702-1374"><a href="#cb702-1374" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Non-normal difference scores</span>
<span id="cb702-1375"><a href="#cb702-1375" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Outliers present</span>
<span id="cb702-1376"><a href="#cb702-1376" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Small samples (n &lt; 30 pairs)</span>
<span id="cb702-1377"><a href="#cb702-1377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1378"><a href="#cb702-1378" aria-hidden="true" tabindex="-1"></a>✅ **Wilcoxon tests:**</span>
<span id="cb702-1379"><a href="#cb702-1379" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Whether median difference ≠ 0</span>
<span id="cb702-1380"><a href="#cb702-1380" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Ranks absolute differences, preserving sign</span>
<span id="cb702-1381"><a href="#cb702-1381" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Robust to outliers and skewness</span>
<span id="cb702-1382"><a href="#cb702-1382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1383"><a href="#cb702-1383" aria-hidden="true" tabindex="-1"></a>✅ **Report these components:**</span>
<span id="cb702-1384"><a href="#cb702-1384" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Medians before and after</span>
<span id="cb702-1385"><a href="#cb702-1385" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Median difference with IQR</span>
<span id="cb702-1386"><a href="#cb702-1386" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Wilcoxon p-value and V statistic</span>
<span id="cb702-1387"><a href="#cb702-1387" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Effect size (r)</span>
<span id="cb702-1388"><a href="#cb702-1388" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Number improved vs. worsened</span>
<span id="cb702-1389"><a href="#cb702-1389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1390"><a href="#cb702-1390" aria-hidden="true" tabindex="-1"></a>✅ **Paired data advantages:**</span>
<span id="cb702-1391"><a href="#cb702-1391" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>More statistical power</span>
<span id="cb702-1392"><a href="#cb702-1392" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Smaller sample sizes needed</span>
<span id="cb702-1393"><a href="#cb702-1393" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Controls for individual variability</span>
<span id="cb702-1394"><a href="#cb702-1394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1395"><a href="#cb702-1395" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-1396"><a href="#cb702-1396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1397"><a href="#cb702-1397" aria-hidden="true" tabindex="-1"></a><span class="fu">### 🏠 Homework Exercise</span></span>
<span id="cb702-1398"><a href="#cb702-1398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1399"><a href="#cb702-1399" aria-hidden="true" tabindex="-1"></a>Analyze blood pressure changes after medication for 16 patients:</span>
<span id="cb702-1400"><a href="#cb702-1400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1401"><a href="#cb702-1401" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb702-1402"><a href="#cb702-1402" aria-hidden="true" tabindex="-1"></a>bp_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb702-1403"><a href="#cb702-1403" aria-hidden="true" tabindex="-1"></a>  <span class="at">patient =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">16</span>,</span>
<span id="cb702-1404"><a href="#cb702-1404" aria-hidden="true" tabindex="-1"></a>  <span class="at">baseline =</span> <span class="fu">c</span>(<span class="dv">142</span>, <span class="dv">138</span>, <span class="dv">145</span>, <span class="dv">140</span>, <span class="dv">136</span>, <span class="dv">148</span>, <span class="dv">141</span>, <span class="dv">139</span>, </span>
<span id="cb702-1405"><a href="#cb702-1405" aria-hidden="true" tabindex="-1"></a>               <span class="dv">143</span>, <span class="dv">137</span>, <span class="dv">146</span>, <span class="dv">144</span>, <span class="dv">140</span>, <span class="dv">142</span>, <span class="dv">139</span>, <span class="dv">141</span>),</span>
<span id="cb702-1406"><a href="#cb702-1406" aria-hidden="true" tabindex="-1"></a>  <span class="at">followup =</span> <span class="fu">c</span>(<span class="dv">136</span>, <span class="dv">135</span>, <span class="dv">140</span>, <span class="dv">136</span>, <span class="dv">133</span>, <span class="dv">142</span>, <span class="dv">138</span>, <span class="dv">136</span>,</span>
<span id="cb702-1407"><a href="#cb702-1407" aria-hidden="true" tabindex="-1"></a>               <span class="dv">139</span>, <span class="dv">134</span>, <span class="dv">143</span>, <span class="dv">140</span>, <span class="dv">137</span>, <span class="dv">139</span>, <span class="dv">136</span>, <span class="dv">138</span>)</span>
<span id="cb702-1408"><a href="#cb702-1408" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb702-1409"><a href="#cb702-1409" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-1410"><a href="#cb702-1410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1411"><a href="#cb702-1411" aria-hidden="true" tabindex="-1"></a>**Tasks:**</span>
<span id="cb702-1412"><a href="#cb702-1412" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Create a paired plot (before-after lines)</span>
<span id="cb702-1413"><a href="#cb702-1413" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Calculate and visualize difference scores</span>
<span id="cb702-1414"><a href="#cb702-1414" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Run Wilcoxon signed-rank test</span>
<span id="cb702-1415"><a href="#cb702-1415" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Calculate effect size</span>
<span id="cb702-1416"><a href="#cb702-1416" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>Compare with paired t-test results</span>
<span id="cb702-1417"><a href="#cb702-1417" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span>Create a summary table</span>
<span id="cb702-1418"><a href="#cb702-1418" aria-hidden="true" tabindex="-1"></a><span class="ss">7. </span>Write a 5-sentence results section including:</span>
<span id="cb702-1419"><a href="#cb702-1419" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Descriptive stats (medians before/after)</span>
<span id="cb702-1420"><a href="#cb702-1420" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Number of patients who improved</span>
<span id="cb702-1421"><a href="#cb702-1421" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Test results and p-value</span>
<span id="cb702-1422"><a href="#cb702-1422" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Effect size interpretation</span>
<span id="cb702-1423"><a href="#cb702-1423" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Clinical conclusion</span>
<span id="cb702-1424"><a href="#cb702-1424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1425"><a href="#cb702-1425" aria-hidden="true" tabindex="-1"></a>**Expected finding:** Significant blood pressure reduction with large effect size.</span>
<span id="cb702-1426"><a href="#cb702-1426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1427"><a href="#cb702-1427" aria-hidden="true" tabindex="-1"></a>**Bonus:** What percentage of patients improved? Is this clinically meaningful?</span>
<span id="cb702-1428"><a href="#cb702-1428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1429"><a href="#cb702-1429" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-1430"><a href="#cb702-1430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1431"><a href="#cb702-1431" aria-hidden="true" tabindex="-1"></a><span class="fu">## Lab 5: Firth's Penalized Logistic Regression {#lab-firth}</span></span>
<span id="cb702-1432"><a href="#cb702-1432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1433"><a href="#cb702-1433" aria-hidden="true" tabindex="-1"></a>**Learning Objectives:**</span>
<span id="cb702-1434"><a href="#cb702-1434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1435"><a href="#cb702-1435" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Recognize complete/quasi-complete separation in logistic regression</span>
<span id="cb702-1436"><a href="#cb702-1436" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Apply Firth's penalized likelihood method to handle separation</span>
<span id="cb702-1437"><a href="#cb702-1437" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Compare standard and penalized logistic regression results</span>
<span id="cb702-1438"><a href="#cb702-1438" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Interpret odds ratios and confidence intervals with small samples</span>
<span id="cb702-1439"><a href="#cb702-1439" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Create publication-ready tables for logistic regression</span>
<span id="cb702-1440"><a href="#cb702-1440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1441"><a href="#cb702-1441" aria-hidden="true" tabindex="-1"></a>**Scenario:** You're analyzing pilot data (n=18) from a clinical trial where patients received a new treatment (Yes/No) and the outcome is remission (Yes/No). The treatment group has 10 patients (9 remission, 1 no remission), and the control group has 8 patients (2 remission, 6 no remission).</span>
<span id="cb702-1442"><a href="#cb702-1442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1443"><a href="#cb702-1443" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 1: Set Up and Load Data</span></span>
<span id="cb702-1444"><a href="#cb702-1444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1445"><a href="#cb702-1445" aria-hidden="true" tabindex="-1"></a>Create the dataset and visualize the contingency table:</span>
<span id="cb702-1446"><a href="#cb702-1446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1447"><a href="#cb702-1447" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lab5-data}</span></span>
<span id="cb702-1448"><a href="#cb702-1448" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb702-1449"><a href="#cb702-1449" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(logistf)  <span class="co"># Firth's logistic regression</span></span>
<span id="cb702-1450"><a href="#cb702-1450" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb702-1451"><a href="#cb702-1451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1452"><a href="#cb702-1452" aria-hidden="true" tabindex="-1"></a><span class="co"># Create dataset with separation problem</span></span>
<span id="cb702-1453"><a href="#cb702-1453" aria-hidden="true" tabindex="-1"></a>clinical_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb702-1454"><a href="#cb702-1454" aria-hidden="true" tabindex="-1"></a>  <span class="at">patient_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">18</span>,</span>
<span id="cb702-1455"><a href="#cb702-1455" aria-hidden="true" tabindex="-1"></a>  <span class="at">treatment =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Control"</span>, <span class="st">"Treatment"</span>), <span class="fu">c</span>(<span class="dv">8</span>, <span class="dv">10</span>)),</span>
<span id="cb702-1456"><a href="#cb702-1456" aria-hidden="true" tabindex="-1"></a>  <span class="at">remission =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,  <span class="co"># Control: 2/8 remission</span></span>
<span id="cb702-1457"><a href="#cb702-1457" aria-hidden="true" tabindex="-1"></a>                <span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>)  <span class="co"># Treatment: 9/10 remission</span></span>
<span id="cb702-1458"><a href="#cb702-1458" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb702-1459"><a href="#cb702-1459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1460"><a href="#cb702-1460" aria-hidden="true" tabindex="-1"></a><span class="co"># Contingency table</span></span>
<span id="cb702-1461"><a href="#cb702-1461" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(clinical_data<span class="sc">$</span>treatment, clinical_data<span class="sc">$</span>remission)</span>
<span id="cb702-1462"><a href="#cb702-1462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1463"><a href="#cb702-1463" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization</span></span>
<span id="cb702-1464"><a href="#cb702-1464" aria-hidden="true" tabindex="-1"></a>clinical_data <span class="sc">%&gt;%</span></span>
<span id="cb702-1465"><a href="#cb702-1465" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(treatment, remission) <span class="sc">%&gt;%</span></span>
<span id="cb702-1466"><a href="#cb702-1466" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> treatment, <span class="at">y =</span> n, <span class="at">fill =</span> <span class="fu">factor</span>(remission))) <span class="sc">+</span></span>
<span id="cb702-1467"><a href="#cb702-1467" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"stack"</span>) <span class="sc">+</span></span>
<span id="cb702-1468"><a href="#cb702-1468" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Treatment vs Remission Outcomes"</span>,</span>
<span id="cb702-1469"><a href="#cb702-1469" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>, <span class="at">fill =</span> <span class="st">"Remission"</span>) <span class="sc">+</span></span>
<span id="cb702-1470"><a href="#cb702-1470" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb702-1471"><a href="#cb702-1471" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-1472"><a href="#cb702-1472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1473"><a href="#cb702-1473" aria-hidden="true" tabindex="-1"></a>**Checkpoint:** You should see near-complete separation (9/10 vs 2/8).</span>
<span id="cb702-1474"><a href="#cb702-1474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1475"><a href="#cb702-1475" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-1476"><a href="#cb702-1476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1477"><a href="#cb702-1477" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 2: Attempt Standard Logistic Regression</span></span>
<span id="cb702-1478"><a href="#cb702-1478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1479"><a href="#cb702-1479" aria-hidden="true" tabindex="-1"></a>Try fitting standard logistic regression to see the separation problem:</span>
<span id="cb702-1480"><a href="#cb702-1480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1481"><a href="#cb702-1481" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lab5-standard-glm}</span></span>
<span id="cb702-1482"><a href="#cb702-1482" aria-hidden="true" tabindex="-1"></a><span class="co"># Attempt standard logistic regression</span></span>
<span id="cb702-1483"><a href="#cb702-1483" aria-hidden="true" tabindex="-1"></a>standard_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(remission <span class="sc">~</span> treatment, </span>
<span id="cb702-1484"><a href="#cb702-1484" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> clinical_data,</span>
<span id="cb702-1485"><a href="#cb702-1485" aria-hidden="true" tabindex="-1"></a>                      <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>))</span>
<span id="cb702-1486"><a href="#cb702-1486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1487"><a href="#cb702-1487" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for warning signs</span></span>
<span id="cb702-1488"><a href="#cb702-1488" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(standard_model)</span>
<span id="cb702-1489"><a href="#cb702-1489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1490"><a href="#cb702-1490" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract coefficients</span></span>
<span id="cb702-1491"><a href="#cb702-1491" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(standard_model, <span class="at">exponentiate =</span> <span class="cn">TRUE</span>, <span class="at">conf.int =</span> <span class="cn">TRUE</span>)</span>
<span id="cb702-1492"><a href="#cb702-1492" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-1493"><a href="#cb702-1493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1494"><a href="#cb702-1494" aria-hidden="true" tabindex="-1"></a>**Checkpoint:** Notice extremely large coefficient, very wide confidence interval, or convergence warnings indicating separation.</span>
<span id="cb702-1495"><a href="#cb702-1495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1496"><a href="#cb702-1496" aria-hidden="true" tabindex="-1"></a>**Discussion:** What happens to the odds ratio estimate? Why are the standard errors so large?</span>
<span id="cb702-1497"><a href="#cb702-1497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1498"><a href="#cb702-1498" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-1499"><a href="#cb702-1499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1500"><a href="#cb702-1500" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 3: Apply Firth's Penalized Logistic Regression</span></span>
<span id="cb702-1501"><a href="#cb702-1501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1502"><a href="#cb702-1502" aria-hidden="true" tabindex="-1"></a>Use Firth's method to obtain reliable estimates:</span>
<span id="cb702-1503"><a href="#cb702-1503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1504"><a href="#cb702-1504" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lab5-firth}</span></span>
<span id="cb702-1505"><a href="#cb702-1505" aria-hidden="true" tabindex="-1"></a><span class="co"># Firth's penalized logistic regression</span></span>
<span id="cb702-1506"><a href="#cb702-1506" aria-hidden="true" tabindex="-1"></a>firth_model <span class="ot">&lt;-</span> <span class="fu">logistf</span>(remission <span class="sc">~</span> treatment, </span>
<span id="cb702-1507"><a href="#cb702-1507" aria-hidden="true" tabindex="-1"></a>                       <span class="at">data =</span> clinical_data)</span>
<span id="cb702-1508"><a href="#cb702-1508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1509"><a href="#cb702-1509" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary</span></span>
<span id="cb702-1510"><a href="#cb702-1510" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(firth_model)</span>
<span id="cb702-1511"><a href="#cb702-1511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1512"><a href="#cb702-1512" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract coefficients (manual conversion to OR)</span></span>
<span id="cb702-1513"><a href="#cb702-1513" aria-hidden="true" tabindex="-1"></a>firth_coef <span class="ot">&lt;-</span> <span class="fu">coef</span>(firth_model)[<span class="dv">2</span>]</span>
<span id="cb702-1514"><a href="#cb702-1514" aria-hidden="true" tabindex="-1"></a>firth_or <span class="ot">&lt;-</span> <span class="fu">exp</span>(firth_coef)</span>
<span id="cb702-1515"><a href="#cb702-1515" aria-hidden="true" tabindex="-1"></a>firth_ci <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">confint</span>(firth_model)[<span class="dv">2</span>, ])</span>
<span id="cb702-1516"><a href="#cb702-1516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1517"><a href="#cb702-1517" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Firth's Odds Ratio:"</span>, <span class="fu">round</span>(firth_or, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-1518"><a href="#cb702-1518" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"95% CI:"</span>, <span class="fu">round</span>(firth_ci, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-1519"><a href="#cb702-1519" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-1520"><a href="#cb702-1520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1521"><a href="#cb702-1521" aria-hidden="true" tabindex="-1"></a>**Checkpoint:** Firth's OR should be more reasonable (e.g., 10-30) with narrower CI compared to standard method.</span>
<span id="cb702-1522"><a href="#cb702-1522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1523"><a href="#cb702-1523" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-1524"><a href="#cb702-1524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1525"><a href="#cb702-1525" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 4: Compare Methods Side-by-Side</span></span>
<span id="cb702-1526"><a href="#cb702-1526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1527"><a href="#cb702-1527" aria-hidden="true" tabindex="-1"></a>Create a comparison table:</span>
<span id="cb702-1528"><a href="#cb702-1528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1529"><a href="#cb702-1529" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lab5-comparison}</span></span>
<span id="cb702-1530"><a href="#cb702-1530" aria-hidden="true" tabindex="-1"></a><span class="co"># Standard GLM results</span></span>
<span id="cb702-1531"><a href="#cb702-1531" aria-hidden="true" tabindex="-1"></a>standard_or <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">coef</span>(standard_model)[<span class="dv">2</span>])</span>
<span id="cb702-1532"><a href="#cb702-1532" aria-hidden="true" tabindex="-1"></a>standard_ci <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">confint.default</span>(standard_model)[<span class="dv">2</span>, ])</span>
<span id="cb702-1533"><a href="#cb702-1533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1534"><a href="#cb702-1534" aria-hidden="true" tabindex="-1"></a><span class="co"># Comparison tibble</span></span>
<span id="cb702-1535"><a href="#cb702-1535" aria-hidden="true" tabindex="-1"></a>comparison <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb702-1536"><a href="#cb702-1536" aria-hidden="true" tabindex="-1"></a>  <span class="at">Method =</span> <span class="fu">c</span>(<span class="st">"Standard GLM"</span>, <span class="st">"Firth's Penalized"</span>),</span>
<span id="cb702-1537"><a href="#cb702-1537" aria-hidden="true" tabindex="-1"></a>  <span class="at">OR =</span> <span class="fu">c</span>(standard_or, firth_or),</span>
<span id="cb702-1538"><a href="#cb702-1538" aria-hidden="true" tabindex="-1"></a>  <span class="at">CI_Lower =</span> <span class="fu">c</span>(standard_ci[<span class="dv">1</span>], firth_ci[<span class="dv">1</span>]),</span>
<span id="cb702-1539"><a href="#cb702-1539" aria-hidden="true" tabindex="-1"></a>  <span class="at">CI_Upper =</span> <span class="fu">c</span>(standard_ci[<span class="dv">2</span>], firth_ci[<span class="dv">2</span>]),</span>
<span id="cb702-1540"><a href="#cb702-1540" aria-hidden="true" tabindex="-1"></a>  <span class="at">CI_Width =</span> CI_Upper <span class="sc">-</span> CI_Lower</span>
<span id="cb702-1541"><a href="#cb702-1541" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb702-1542"><a href="#cb702-1542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1543"><a href="#cb702-1543" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(comparison)</span>
<span id="cb702-1544"><a href="#cb702-1544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1545"><a href="#cb702-1545" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization</span></span>
<span id="cb702-1546"><a href="#cb702-1546" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(comparison, <span class="fu">aes</span>(<span class="at">x =</span> Method, <span class="at">y =</span> OR)) <span class="sc">+</span></span>
<span id="cb702-1547"><a href="#cb702-1547" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb702-1548"><a href="#cb702-1548" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> CI_Lower, <span class="at">ymax =</span> CI_Upper), </span>
<span id="cb702-1549"><a href="#cb702-1549" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb702-1550"><a href="#cb702-1550" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb702-1551"><a href="#cb702-1551" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Standard vs Firth's Logistic Regression"</span>,</span>
<span id="cb702-1552"><a href="#cb702-1552" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Odds Ratio (log scale)"</span>) <span class="sc">+</span></span>
<span id="cb702-1553"><a href="#cb702-1553" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb702-1554"><a href="#cb702-1554" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-1555"><a href="#cb702-1555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1556"><a href="#cb702-1556" aria-hidden="true" tabindex="-1"></a>**Checkpoint:** Firth's method produces more conservative (lower) OR and much narrower CI.</span>
<span id="cb702-1557"><a href="#cb702-1557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1558"><a href="#cb702-1558" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-1559"><a href="#cb702-1559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1560"><a href="#cb702-1560" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 5: Assess Model Fit</span></span>
<span id="cb702-1561"><a href="#cb702-1561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1562"><a href="#cb702-1562" aria-hidden="true" tabindex="-1"></a>Check diagnostics for the Firth model:</span>
<span id="cb702-1563"><a href="#cb702-1563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1564"><a href="#cb702-1564" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lab5-diagnostics}</span></span>
<span id="cb702-1565"><a href="#cb702-1565" aria-hidden="true" tabindex="-1"></a><span class="co"># Profile likelihood ratio test for treatment effect</span></span>
<span id="cb702-1566"><a href="#cb702-1566" aria-hidden="true" tabindex="-1"></a>firth_model<span class="sc">$</span>prob  <span class="co"># Profile penalized LR p-value</span></span>
<span id="cb702-1567"><a href="#cb702-1567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1568"><a href="#cb702-1568" aria-hidden="true" tabindex="-1"></a><span class="co"># AIC comparison (lower is better)</span></span>
<span id="cb702-1569"><a href="#cb702-1569" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Standard GLM AIC:"</span>, <span class="fu">AIC</span>(standard_model), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-1570"><a href="#cb702-1570" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Firth's AIC:"</span>, firth_model<span class="sc">$</span>aic, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-1571"><a href="#cb702-1571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1572"><a href="#cb702-1572" aria-hidden="true" tabindex="-1"></a><span class="co"># Raw data proportions</span></span>
<span id="cb702-1573"><a href="#cb702-1573" aria-hidden="true" tabindex="-1"></a>clinical_data <span class="sc">%&gt;%</span></span>
<span id="cb702-1574"><a href="#cb702-1574" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(treatment) <span class="sc">%&gt;%</span></span>
<span id="cb702-1575"><a href="#cb702-1575" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb702-1576"><a href="#cb702-1576" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb702-1577"><a href="#cb702-1577" aria-hidden="true" tabindex="-1"></a>    <span class="at">remission =</span> <span class="fu">sum</span>(remission),</span>
<span id="cb702-1578"><a href="#cb702-1578" aria-hidden="true" tabindex="-1"></a>    <span class="at">proportion =</span> <span class="fu">mean</span>(remission)</span>
<span id="cb702-1579"><a href="#cb702-1579" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb702-1580"><a href="#cb702-1580" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-1581"><a href="#cb702-1581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1582"><a href="#cb702-1582" aria-hidden="true" tabindex="-1"></a>**Checkpoint:** Firth's p-value should indicate significant treatment effect, with better model fit than standard GLM.</span>
<span id="cb702-1583"><a href="#cb702-1583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1584"><a href="#cb702-1584" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-1585"><a href="#cb702-1585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1586"><a href="#cb702-1586" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 6: Predicted Probabilities</span></span>
<span id="cb702-1587"><a href="#cb702-1587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1588"><a href="#cb702-1588" aria-hidden="true" tabindex="-1"></a>Calculate predicted remission probabilities:</span>
<span id="cb702-1589"><a href="#cb702-1589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1590"><a href="#cb702-1590" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lab5-predictions}</span></span>
<span id="cb702-1591"><a href="#cb702-1591" aria-hidden="true" tabindex="-1"></a><span class="co"># Create prediction data</span></span>
<span id="cb702-1592"><a href="#cb702-1592" aria-hidden="true" tabindex="-1"></a>pred_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">treatment =</span> <span class="fu">c</span>(<span class="st">"Control"</span>, <span class="st">"Treatment"</span>))</span>
<span id="cb702-1593"><a href="#cb702-1593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1594"><a href="#cb702-1594" aria-hidden="true" tabindex="-1"></a><span class="co"># Firth's predicted probabilities</span></span>
<span id="cb702-1595"><a href="#cb702-1595" aria-hidden="true" tabindex="-1"></a>pred_probs <span class="ot">&lt;-</span> <span class="fu">predict</span>(firth_model, </span>
<span id="cb702-1596"><a href="#cb702-1596" aria-hidden="true" tabindex="-1"></a>                      <span class="at">newdata =</span> pred_data,</span>
<span id="cb702-1597"><a href="#cb702-1597" aria-hidden="true" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb702-1598"><a href="#cb702-1598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1599"><a href="#cb702-1599" aria-hidden="true" tabindex="-1"></a>pred_results <span class="ot">&lt;-</span> pred_data <span class="sc">%&gt;%</span></span>
<span id="cb702-1600"><a href="#cb702-1600" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">predicted_prob =</span> pred_probs)</span>
<span id="cb702-1601"><a href="#cb702-1601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1602"><a href="#cb702-1602" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pred_results)</span>
<span id="cb702-1603"><a href="#cb702-1603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1604"><a href="#cb702-1604" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare with observed proportions</span></span>
<span id="cb702-1605"><a href="#cb702-1605" aria-hidden="true" tabindex="-1"></a>clinical_data <span class="sc">%&gt;%</span></span>
<span id="cb702-1606"><a href="#cb702-1606" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(treatment) <span class="sc">%&gt;%</span></span>
<span id="cb702-1607"><a href="#cb702-1607" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">observed_prob =</span> <span class="fu">mean</span>(remission)) <span class="sc">%&gt;%</span></span>
<span id="cb702-1608"><a href="#cb702-1608" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(pred_results, <span class="at">by =</span> <span class="st">"treatment"</span>)</span>
<span id="cb702-1609"><a href="#cb702-1609" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-1610"><a href="#cb702-1610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1611"><a href="#cb702-1611" aria-hidden="true" tabindex="-1"></a>**Checkpoint:** Predicted probabilities should be close to observed proportions (0.25 control, 0.90 treatment).</span>
<span id="cb702-1612"><a href="#cb702-1612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1613"><a href="#cb702-1613" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-1614"><a href="#cb702-1614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1615"><a href="#cb702-1615" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 7: Create Publication Table</span></span>
<span id="cb702-1616"><a href="#cb702-1616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1617"><a href="#cb702-1617" aria-hidden="true" tabindex="-1"></a>Format results for publication:</span>
<span id="cb702-1618"><a href="#cb702-1618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1619"><a href="#cb702-1619" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lab5-pub-table}</span></span>
<span id="cb702-1620"><a href="#cb702-1620" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb702-1621"><a href="#cb702-1621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1622"><a href="#cb702-1622" aria-hidden="true" tabindex="-1"></a><span class="co"># Create publication-ready table</span></span>
<span id="cb702-1623"><a href="#cb702-1623" aria-hidden="true" tabindex="-1"></a>pub_table <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb702-1624"><a href="#cb702-1624" aria-hidden="true" tabindex="-1"></a>  <span class="at">Predictor =</span> <span class="st">"Treatment (vs Control)"</span>,</span>
<span id="cb702-1625"><a href="#cb702-1625" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Log OR</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sprintf</span>(<span class="st">"%.2f"</span>, firth_coef),</span>
<span id="cb702-1626"><a href="#cb702-1626" aria-hidden="true" tabindex="-1"></a>  <span class="at">SE =</span> <span class="fu">sprintf</span>(<span class="st">"%.2f"</span>, <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcov</span>(firth_model)))[<span class="dv">2</span>]),</span>
<span id="cb702-1627"><a href="#cb702-1627" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">OR</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sprintf</span>(<span class="st">"%.2f"</span>, firth_or),</span>
<span id="cb702-1628"><a href="#cb702-1628" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">95% CI</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sprintf</span>(<span class="st">"%.2f-%.2f"</span>, firth_ci[<span class="dv">1</span>], firth_ci[<span class="dv">2</span>]),</span>
<span id="cb702-1629"><a href="#cb702-1629" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">p-value</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sprintf</span>(<span class="st">"%.3f"</span>, firth_model<span class="sc">$</span>prob[<span class="dv">2</span>])</span>
<span id="cb702-1630"><a href="#cb702-1630" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb702-1631"><a href="#cb702-1631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1632"><a href="#cb702-1632" aria-hidden="true" tabindex="-1"></a>pub_table <span class="sc">%&gt;%</span></span>
<span id="cb702-1633"><a href="#cb702-1633" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb702-1634"><a href="#cb702-1634" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb702-1635"><a href="#cb702-1635" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Firth's Penalized Logistic Regression"</span>,</span>
<span id="cb702-1636"><a href="#cb702-1636" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Predicting Clinical Remission (n=18)"</span></span>
<span id="cb702-1637"><a href="#cb702-1637" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb702-1638"><a href="#cb702-1638" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_footnote</span>(</span>
<span id="cb702-1639"><a href="#cb702-1639" aria-hidden="true" tabindex="-1"></a>    <span class="at">footnote =</span> <span class="st">"Firth's method used due to quasi-complete separation"</span>,</span>
<span id="cb702-1640"><a href="#cb702-1640" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_column_labels</span>(<span class="at">columns =</span> <span class="st">"OR"</span>)</span>
<span id="cb702-1641"><a href="#cb702-1641" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb702-1642"><a href="#cb702-1642" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-1643"><a href="#cb702-1643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1644"><a href="#cb702-1644" aria-hidden="true" tabindex="-1"></a>**Checkpoint:** Professional table with OR, CI, and p-value formatted for journal submission.</span>
<span id="cb702-1645"><a href="#cb702-1645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1646"><a href="#cb702-1646" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-1647"><a href="#cb702-1647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1648"><a href="#cb702-1648" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 8: Interpret and Report</span></span>
<span id="cb702-1649"><a href="#cb702-1649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1650"><a href="#cb702-1650" aria-hidden="true" tabindex="-1"></a>Summarize the clinical findings:</span>
<span id="cb702-1651"><a href="#cb702-1651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1652"><a href="#cb702-1652" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lab5-interpretation}</span></span>
<span id="cb702-1653"><a href="#cb702-1653" aria-hidden="true" tabindex="-1"></a><span class="co"># Effect size interpretation</span></span>
<span id="cb702-1654"><a href="#cb702-1654" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Interpretation:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-1655"><a href="#cb702-1655" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Treatment increases remission odds by"</span>, </span>
<span id="cb702-1656"><a href="#cb702-1656" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(firth_or, <span class="dv">1</span>), <span class="st">"times</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-1657"><a href="#cb702-1657" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- 95% CI:"</span>, <span class="fu">round</span>(firth_ci, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-1658"><a href="#cb702-1658" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Treatment group: 90% remission</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-1659"><a href="#cb702-1659" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Control group: 25% remission</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-1660"><a href="#cb702-1660" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Risk difference: 65 percentage points</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-1661"><a href="#cb702-1661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1662"><a href="#cb702-1662" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample statement</span></span>
<span id="cb702-1663"><a href="#cb702-1663" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Sample Results Statement:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-1664"><a href="#cb702-1664" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Due to quasi-complete separation in the contingency table,</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-1665"><a href="#cb702-1665" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"we used Firth's penalized logistic regression. Treatment</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-1666"><a href="#cb702-1666" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"significantly increased remission odds (OR ="</span>, <span class="fu">round</span>(firth_or, <span class="dv">2</span>), </span>
<span id="cb702-1667"><a href="#cb702-1667" aria-hidden="true" tabindex="-1"></a>    <span class="st">", 95% CI:"</span>, <span class="fu">paste</span>(<span class="fu">round</span>(firth_ci, <span class="dv">2</span>), <span class="at">collapse =</span> <span class="st">"-"</span>), </span>
<span id="cb702-1668"><a href="#cb702-1668" aria-hidden="true" tabindex="-1"></a>    <span class="st">", p ="</span>, <span class="fu">round</span>(firth_model<span class="sc">$</span>prob[<span class="dv">2</span>], <span class="dv">3</span>), <span class="st">").</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-1669"><a href="#cb702-1669" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-1670"><a href="#cb702-1670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1671"><a href="#cb702-1671" aria-hidden="true" tabindex="-1"></a>**Checkpoint:** Clear interpretation acknowledging the separation problem and reporting penalized estimates.</span>
<span id="cb702-1672"><a href="#cb702-1672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1673"><a href="#cb702-1673" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-1674"><a href="#cb702-1674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1675"><a href="#cb702-1675" aria-hidden="true" tabindex="-1"></a><span class="fu">### Discussion Questions</span></span>
<span id="cb702-1676"><a href="#cb702-1676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1677"><a href="#cb702-1677" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Separation Detection:** How can you identify complete or quasi-complete separation in your data before modeling?</span>
<span id="cb702-1678"><a href="#cb702-1678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1679"><a href="#cb702-1679" aria-hidden="true" tabindex="-1"></a>   *Answer: Check contingency tables for cells with 0 counts, examine coefficient estimates for very large values (&gt;10 in absolute value), look for extremely wide confidence intervals, and watch for convergence warnings.*</span>
<span id="cb702-1680"><a href="#cb702-1680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1681"><a href="#cb702-1681" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Why Firth's Method:** How does Firth's penalized likelihood reduce bias in small samples?</span>
<span id="cb702-1682"><a href="#cb702-1682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1683"><a href="#cb702-1683" aria-hidden="true" tabindex="-1"></a>   *Answer: Firth's method adds a penalty term that shrinks estimates toward zero, reducing the finite-sample bias and preventing infinite estimates that occur with separation.*</span>
<span id="cb702-1684"><a href="#cb702-1684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1685"><a href="#cb702-1685" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Interpretation:** Is the Firth's OR of 20 (example) more reliable than the standard OR of 500?</span>
<span id="cb702-1686"><a href="#cb702-1686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1687"><a href="#cb702-1687" aria-hidden="true" tabindex="-1"></a>   *Answer: Yes, Firth's OR is more realistic and stable. The standard OR is inflated due to separation and has a very wide, unreliable CI. Firth's estimate is appropriately conservative.*</span>
<span id="cb702-1688"><a href="#cb702-1688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1689"><a href="#cb702-1689" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Clinical vs Statistical:** The p-value is significant, but should we conclude the treatment is effective?</span>
<span id="cb702-1690"><a href="#cb702-1690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1691"><a href="#cb702-1691" aria-hidden="true" tabindex="-1"></a>   *Answer: The pilot data are promising (90% vs 25% remission), but n=18 is too small for definitive conclusions. A larger confirmatory trial is needed, though Firth's method provides the best available estimate from these data.*</span>
<span id="cb702-1692"><a href="#cb702-1692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1693"><a href="#cb702-1693" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>**Alternative Approaches:** When might you use exact logistic regression instead of Firth's method?</span>
<span id="cb702-1694"><a href="#cb702-1694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1695"><a href="#cb702-1695" aria-hidden="true" tabindex="-1"></a>   *Answer: Exact logistic regression (e.g., `elrm` package) is preferred when sample size is very small (n&lt;20 total) and you want exact p-values. Firth's method is faster and preferred for moderately small samples (n=20-50).*</span>
<span id="cb702-1696"><a href="#cb702-1696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1697"><a href="#cb702-1697" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-1698"><a href="#cb702-1698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1699"><a href="#cb702-1699" aria-hidden="true" tabindex="-1"></a><span class="fu">### Key Takeaways</span></span>
<span id="cb702-1700"><a href="#cb702-1700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1701"><a href="#cb702-1701" aria-hidden="true" tabindex="-1"></a>✓ **Separation is common in small-sample logistic regression** with unbalanced outcomes  </span>
<span id="cb702-1702"><a href="#cb702-1702" aria-hidden="true" tabindex="-1"></a>✓ **Standard logistic regression fails** with separation (infinite estimates, huge CIs)  </span>
<span id="cb702-1703"><a href="#cb702-1703" aria-hidden="true" tabindex="-1"></a>✓ **Firth's penalized method** provides finite, stable estimates by adding penalty term  </span>
<span id="cb702-1704"><a href="#cb702-1704" aria-hidden="true" tabindex="-1"></a>✓ **Always check for separation** before fitting logistic models in small samples  </span>
<span id="cb702-1705"><a href="#cb702-1705" aria-hidden="true" tabindex="-1"></a>✓ **Report the method used** and acknowledge limitations in pilot data  </span>
<span id="cb702-1706"><a href="#cb702-1706" aria-hidden="true" tabindex="-1"></a>✓ **Firth's estimates are more realistic** but still require cautious interpretation  </span>
<span id="cb702-1707"><a href="#cb702-1707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1708"><a href="#cb702-1708" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-1709"><a href="#cb702-1709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1710"><a href="#cb702-1710" aria-hidden="true" tabindex="-1"></a><span class="fu">### Homework Exercise</span></span>
<span id="cb702-1711"><a href="#cb702-1711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1712"><a href="#cb702-1712" aria-hidden="true" tabindex="-1"></a>**Dataset:** A pilot study (n=22) examined whether a new surgical technique (Technique = "New" vs "Standard") predicts successful outcome (Success = 1 for success, 0 for failure).</span>
<span id="cb702-1713"><a href="#cb702-1713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1714"><a href="#cb702-1714" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lab5-homework-data}</span></span>
<span id="cb702-1715"><a href="#cb702-1715" aria-hidden="true" tabindex="-1"></a>surgery_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb702-1716"><a href="#cb702-1716" aria-hidden="true" tabindex="-1"></a>  <span class="at">patient_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">22</span>,</span>
<span id="cb702-1717"><a href="#cb702-1717" aria-hidden="true" tabindex="-1"></a>  <span class="at">technique =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Standard"</span>, <span class="st">"New"</span>), <span class="fu">c</span>(<span class="dv">11</span>, <span class="dv">11</span>)),</span>
<span id="cb702-1718"><a href="#cb702-1718" aria-hidden="true" tabindex="-1"></a>  <span class="at">success =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,  <span class="co"># Standard: 6/11 success</span></span>
<span id="cb702-1719"><a href="#cb702-1719" aria-hidden="true" tabindex="-1"></a>              <span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>)  <span class="co"># New: 10/11 success</span></span>
<span id="cb702-1720"><a href="#cb702-1720" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb702-1721"><a href="#cb702-1721" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-1722"><a href="#cb702-1722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1723"><a href="#cb702-1723" aria-hidden="true" tabindex="-1"></a>**Your Tasks:**</span>
<span id="cb702-1724"><a href="#cb702-1724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1725"><a href="#cb702-1725" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Create a contingency table and visualize the technique×success relationship</span>
<span id="cb702-1726"><a href="#cb702-1726" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Attempt standard logistic regression and note any separation issues</span>
<span id="cb702-1727"><a href="#cb702-1727" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Fit Firth's penalized logistic regression</span>
<span id="cb702-1728"><a href="#cb702-1728" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Create a comparison table showing standard vs Firth's OR and 95% CI</span>
<span id="cb702-1729"><a href="#cb702-1729" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>Calculate predicted success probabilities for each technique</span>
<span id="cb702-1730"><a href="#cb702-1730" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span>Create a publication-ready results table</span>
<span id="cb702-1731"><a href="#cb702-1731" aria-hidden="true" tabindex="-1"></a><span class="ss">7. </span>Write a 2-3 sentence results statement reporting Firth's estimates</span>
<span id="cb702-1732"><a href="#cb702-1732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1733"><a href="#cb702-1733" aria-hidden="true" tabindex="-1"></a>**Expected Results:**</span>
<span id="cb702-1734"><a href="#cb702-1734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1735"><a href="#cb702-1735" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Quasi-complete separation (10/11 vs 6/11)</span>
<span id="cb702-1736"><a href="#cb702-1736" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Standard glm produces inflated OR (possibly &gt;50) with very wide CI</span>
<span id="cb702-1737"><a href="#cb702-1737" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Firth's OR should be approximately 5-10 with narrower CI</span>
<span id="cb702-1738"><a href="#cb702-1738" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Predicted probabilities: ~55% (Standard), ~90% (New)</span>
<span id="cb702-1739"><a href="#cb702-1739" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Significant p-value (&lt;0.05) from profile likelihood ratio test</span>
<span id="cb702-1740"><a href="#cb702-1740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1741"><a href="#cb702-1741" aria-hidden="true" tabindex="-1"></a>**Hint:** Check <span class="in">`firth_model$prob`</span> for p-values, and use <span class="in">`exp(coef())`</span> and <span class="in">`exp(confint())`</span> to convert log-odds to odds ratios.</span>
<span id="cb702-1742"><a href="#cb702-1742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1743"><a href="#cb702-1743" aria-hidden="true" tabindex="-1"></a>**Bonus:** What is the risk difference (percentage point difference in success rates)? How does this compare to the OR interpretation?</span>
<span id="cb702-1744"><a href="#cb702-1744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1745"><a href="#cb702-1745" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-1746"><a href="#cb702-1746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1747"><a href="#cb702-1747" aria-hidden="true" tabindex="-1"></a><span class="fu">## Lab 6: Bayesian Regression with Small Samples {#lab-bayesian}</span></span>
<span id="cb702-1748"><a href="#cb702-1748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1749"><a href="#cb702-1749" aria-hidden="true" tabindex="-1"></a>**Learning Objectives:**</span>
<span id="cb702-1750"><a href="#cb702-1750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1751"><a href="#cb702-1751" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Specify weakly informative priors for Bayesian regression</span>
<span id="cb702-1752"><a href="#cb702-1752" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Fit Bayesian models using <span class="in">`brms`</span> package</span>
<span id="cb702-1753"><a href="#cb702-1753" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Interpret posterior distributions and credible intervals</span>
<span id="cb702-1754"><a href="#cb702-1754" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Assess MCMC convergence diagnostics (R-hat, effective sample size)</span>
<span id="cb702-1755"><a href="#cb702-1755" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Compare Bayesian and frequentist approaches for small samples</span>
<span id="cb702-1756"><a href="#cb702-1756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1757"><a href="#cb702-1757" aria-hidden="true" tabindex="-1"></a>**Scenario:** You have n=20 participants in a pilot study examining the relationship between study hours (predictor) and exam score (outcome). You'll use Bayesian regression to estimate this relationship with appropriate uncertainty quantification.</span>
<span id="cb702-1758"><a href="#cb702-1758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1759"><a href="#cb702-1759" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 1: Set Up and Load Data</span></span>
<span id="cb702-1760"><a href="#cb702-1760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1761"><a href="#cb702-1761" aria-hidden="true" tabindex="-1"></a>Create the dataset and visualize:</span>
<span id="cb702-1762"><a href="#cb702-1762" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1763"><a href="#cb702-1763" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lab6-data}</span></span>
<span id="cb702-1764"><a href="#cb702-1764" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb702-1765"><a href="#cb702-1765" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(brms)</span>
<span id="cb702-1766"><a href="#cb702-1766" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bayesplot)</span>
<span id="cb702-1767"><a href="#cb702-1767" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidybayes)</span>
<span id="cb702-1768"><a href="#cb702-1768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1769"><a href="#cb702-1769" aria-hidden="true" tabindex="-1"></a><span class="co"># Set seed for reproducibility</span></span>
<span id="cb702-1770"><a href="#cb702-1770" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb702-1771"><a href="#cb702-1771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1772"><a href="#cb702-1772" aria-hidden="true" tabindex="-1"></a><span class="co"># Small sample data</span></span>
<span id="cb702-1773"><a href="#cb702-1773" aria-hidden="true" tabindex="-1"></a>study_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb702-1774"><a href="#cb702-1774" aria-hidden="true" tabindex="-1"></a>  <span class="at">student_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>,</span>
<span id="cb702-1775"><a href="#cb702-1775" aria-hidden="true" tabindex="-1"></a>  <span class="at">study_hours =</span> <span class="fu">round</span>(<span class="fu">runif</span>(<span class="dv">20</span>, <span class="dv">5</span>, <span class="dv">25</span>), <span class="dv">1</span>),</span>
<span id="cb702-1776"><a href="#cb702-1776" aria-hidden="true" tabindex="-1"></a>  <span class="at">exam_score =</span> <span class="fu">round</span>(<span class="dv">50</span> <span class="sc">+</span> <span class="fl">1.5</span> <span class="sc">*</span> study_hours <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="dv">0</span>, <span class="dv">8</span>), <span class="dv">1</span>)</span>
<span id="cb702-1777"><a href="#cb702-1777" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb702-1778"><a href="#cb702-1778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1779"><a href="#cb702-1779" aria-hidden="true" tabindex="-1"></a><span class="co"># Descriptive statistics</span></span>
<span id="cb702-1780"><a href="#cb702-1780" aria-hidden="true" tabindex="-1"></a>study_data <span class="sc">%&gt;%</span></span>
<span id="cb702-1781"><a href="#cb702-1781" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb702-1782"><a href="#cb702-1782" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb702-1783"><a href="#cb702-1783" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_hours =</span> <span class="fu">mean</span>(study_hours),</span>
<span id="cb702-1784"><a href="#cb702-1784" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd_hours =</span> <span class="fu">sd</span>(study_hours),</span>
<span id="cb702-1785"><a href="#cb702-1785" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_score =</span> <span class="fu">mean</span>(exam_score),</span>
<span id="cb702-1786"><a href="#cb702-1786" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd_score =</span> <span class="fu">sd</span>(exam_score)</span>
<span id="cb702-1787"><a href="#cb702-1787" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb702-1788"><a href="#cb702-1788" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1789"><a href="#cb702-1789" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter plot</span></span>
<span id="cb702-1790"><a href="#cb702-1790" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(study_data, <span class="fu">aes</span>(<span class="at">x =</span> study_hours, <span class="at">y =</span> exam_score)) <span class="sc">+</span></span>
<span id="cb702-1791"><a href="#cb702-1791" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb702-1792"><a href="#cb702-1792" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb702-1793"><a href="#cb702-1793" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Study Hours vs Exam Score (n=20)"</span>,</span>
<span id="cb702-1794"><a href="#cb702-1794" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Study Hours"</span>, <span class="at">y =</span> <span class="st">"Exam Score"</span>) <span class="sc">+</span></span>
<span id="cb702-1795"><a href="#cb702-1795" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb702-1796"><a href="#cb702-1796" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-1797"><a href="#cb702-1797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1798"><a href="#cb702-1798" aria-hidden="true" tabindex="-1"></a>**Checkpoint:** You should see n=20 observations with positive relationship between hours and score.</span>
<span id="cb702-1799"><a href="#cb702-1799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1800"><a href="#cb702-1800" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-1801"><a href="#cb702-1801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1802"><a href="#cb702-1802" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 2: Specify Priors</span></span>
<span id="cb702-1803"><a href="#cb702-1803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1804"><a href="#cb702-1804" aria-hidden="true" tabindex="-1"></a>Define weakly informative priors appropriate for the scale of your data:</span>
<span id="cb702-1805"><a href="#cb702-1805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1806"><a href="#cb702-1806" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lab6-priors}</span></span>
<span id="cb702-1807"><a href="#cb702-1807" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine data scale to inform priors</span></span>
<span id="cb702-1808"><a href="#cb702-1808" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(study_data<span class="sc">$</span>exam_score)</span>
<span id="cb702-1809"><a href="#cb702-1809" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(study_data<span class="sc">$</span>study_hours)</span>
<span id="cb702-1810"><a href="#cb702-1810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1811"><a href="#cb702-1811" aria-hidden="true" tabindex="-1"></a><span class="co"># Define priors</span></span>
<span id="cb702-1812"><a href="#cb702-1812" aria-hidden="true" tabindex="-1"></a>priors <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb702-1813"><a href="#cb702-1813" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Intercept: exam scores range 50-100, centered around 70</span></span>
<span id="cb702-1814"><a href="#cb702-1814" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">70</span>, <span class="dv">20</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb702-1815"><a href="#cb702-1815" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb702-1816"><a href="#cb702-1816" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Slope: expect positive but uncertain, allow ±10 points per hour</span></span>
<span id="cb702-1817"><a href="#cb702-1817" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">5</span>), <span class="at">class =</span> b),</span>
<span id="cb702-1818"><a href="#cb702-1818" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb702-1819"><a href="#cb702-1819" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Residual SD: exam scores vary, allow reasonable range</span></span>
<span id="cb702-1820"><a href="#cb702-1820" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">student_t</span>(<span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">10</span>), <span class="at">class =</span> sigma)</span>
<span id="cb702-1821"><a href="#cb702-1821" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb702-1822"><a href="#cb702-1822" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1823"><a href="#cb702-1823" aria-hidden="true" tabindex="-1"></a><span class="co"># Prior predictive check (simulate data from priors)</span></span>
<span id="cb702-1824"><a href="#cb702-1824" aria-hidden="true" tabindex="-1"></a>prior_model <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb702-1825"><a href="#cb702-1825" aria-hidden="true" tabindex="-1"></a>  exam_score <span class="sc">~</span> study_hours,</span>
<span id="cb702-1826"><a href="#cb702-1826" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> study_data,</span>
<span id="cb702-1827"><a href="#cb702-1827" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior =</span> priors,</span>
<span id="cb702-1828"><a href="#cb702-1828" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">gaussian</span>(),</span>
<span id="cb702-1829"><a href="#cb702-1829" aria-hidden="true" tabindex="-1"></a>  <span class="at">sample_prior =</span> <span class="st">"only"</span>,  <span class="co"># Only sample from priors</span></span>
<span id="cb702-1830"><a href="#cb702-1830" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">2</span>,</span>
<span id="cb702-1831"><a href="#cb702-1831" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter =</span> <span class="dv">2000</span>,</span>
<span id="cb702-1832"><a href="#cb702-1832" aria-hidden="true" tabindex="-1"></a>  <span class="at">refresh =</span> <span class="dv">0</span>  <span class="co"># Suppress iteration messages</span></span>
<span id="cb702-1833"><a href="#cb702-1833" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb702-1834"><a href="#cb702-1834" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1835"><a href="#cb702-1835" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize prior predictions</span></span>
<span id="cb702-1836"><a href="#cb702-1836" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(prior_model, <span class="at">ndraws =</span> <span class="dv">50</span>) <span class="sc">+</span></span>
<span id="cb702-1837"><a href="#cb702-1837" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Prior Predictive Check"</span>,</span>
<span id="cb702-1838"><a href="#cb702-1838" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Do priors allow reasonable exam scores?"</span>)</span>
<span id="cb702-1839"><a href="#cb702-1839" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-1840"><a href="#cb702-1840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1841"><a href="#cb702-1841" aria-hidden="true" tabindex="-1"></a>**Checkpoint:** Prior predictions should span 0-100 range but not produce absurd values (e.g., negative scores or scores &gt;150).</span>
<span id="cb702-1842"><a href="#cb702-1842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1843"><a href="#cb702-1843" aria-hidden="true" tabindex="-1"></a>**Discussion:** Are your priors too informative or too vague? Adjust if prior predictions are unrealistic.</span>
<span id="cb702-1844"><a href="#cb702-1844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1845"><a href="#cb702-1845" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-1846"><a href="#cb702-1846" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1847"><a href="#cb702-1847" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 3: Fit Bayesian Model</span></span>
<span id="cb702-1848"><a href="#cb702-1848" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1849"><a href="#cb702-1849" aria-hidden="true" tabindex="-1"></a>Fit the model with MCMC sampling:</span>
<span id="cb702-1850"><a href="#cb702-1850" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1851"><a href="#cb702-1851" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lab6-fit}</span></span>
<span id="cb702-1852"><a href="#cb702-1852" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit Bayesian model</span></span>
<span id="cb702-1853"><a href="#cb702-1853" aria-hidden="true" tabindex="-1"></a>bayes_model <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb702-1854"><a href="#cb702-1854" aria-hidden="true" tabindex="-1"></a>  exam_score <span class="sc">~</span> study_hours,</span>
<span id="cb702-1855"><a href="#cb702-1855" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> study_data,</span>
<span id="cb702-1856"><a href="#cb702-1856" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior =</span> priors,</span>
<span id="cb702-1857"><a href="#cb702-1857" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">gaussian</span>(),</span>
<span id="cb702-1858"><a href="#cb702-1858" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>,           <span class="co"># Run 4 chains</span></span>
<span id="cb702-1859"><a href="#cb702-1859" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter =</span> <span class="dv">4000</span>,          <span class="co"># 4000 iterations per chain</span></span>
<span id="cb702-1860"><a href="#cb702-1860" aria-hidden="true" tabindex="-1"></a>  <span class="at">warmup =</span> <span class="dv">2000</span>,        <span class="co"># 2000 warmup (burn-in)</span></span>
<span id="cb702-1861"><a href="#cb702-1861" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">2025</span>,</span>
<span id="cb702-1862"><a href="#cb702-1862" aria-hidden="true" tabindex="-1"></a>  <span class="at">refresh =</span> <span class="dv">0</span></span>
<span id="cb702-1863"><a href="#cb702-1863" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb702-1864"><a href="#cb702-1864" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1865"><a href="#cb702-1865" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary</span></span>
<span id="cb702-1866"><a href="#cb702-1866" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bayes_model)</span>
<span id="cb702-1867"><a href="#cb702-1867" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-1868"><a href="#cb702-1868" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1869"><a href="#cb702-1869" aria-hidden="true" tabindex="-1"></a>**Checkpoint:** Model should converge (Rhat ≈ 1.00, ESS &gt; 1000). Posterior mean for slope should be positive.</span>
<span id="cb702-1870"><a href="#cb702-1870" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1871"><a href="#cb702-1871" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-1872"><a href="#cb702-1872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1873"><a href="#cb702-1873" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 4: Check MCMC Diagnostics</span></span>
<span id="cb702-1874"><a href="#cb702-1874" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1875"><a href="#cb702-1875" aria-hidden="true" tabindex="-1"></a>Assess convergence and mixing:</span>
<span id="cb702-1876"><a href="#cb702-1876" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1877"><a href="#cb702-1877" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lab6-diagnostics}</span></span>
<span id="cb702-1878"><a href="#cb702-1878" aria-hidden="true" tabindex="-1"></a><span class="co"># Check convergence summary from brms</span></span>
<span id="cb702-1879"><a href="#cb702-1879" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bayes_model)</span>
<span id="cb702-1880"><a href="#cb702-1880" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1881"><a href="#cb702-1881" aria-hidden="true" tabindex="-1"></a><span class="co"># R-hat values (should be &lt; 1.01) - extract from summary</span></span>
<span id="cb702-1882"><a href="#cb702-1882" aria-hidden="true" tabindex="-1"></a>rhat_values <span class="ot">&lt;-</span> brms<span class="sc">::</span><span class="fu">rhat</span>(bayes_model)</span>
<span id="cb702-1883"><a href="#cb702-1883" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(rhat_values)</span>
<span id="cb702-1884"><a href="#cb702-1884" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1885"><a href="#cb702-1885" aria-hidden="true" tabindex="-1"></a><span class="co"># Effective sample size - extract from summary</span></span>
<span id="cb702-1886"><a href="#cb702-1886" aria-hidden="true" tabindex="-1"></a>ess_values <span class="ot">&lt;-</span> brms<span class="sc">::</span><span class="fu">neff_ratio</span>(bayes_model)</span>
<span id="cb702-1887"><a href="#cb702-1887" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(ess_values)</span>
<span id="cb702-1888"><a href="#cb702-1888" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1889"><a href="#cb702-1889" aria-hidden="true" tabindex="-1"></a><span class="co"># Trace plots (chains should mix well)</span></span>
<span id="cb702-1890"><a href="#cb702-1890" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(bayes_model, <span class="at">pars =</span> <span class="fu">c</span>(<span class="st">"b_Intercept"</span>, <span class="st">"b_study_hours"</span>, <span class="st">"sigma"</span>))</span>
<span id="cb702-1891"><a href="#cb702-1891" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-1892"><a href="#cb702-1892" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1893"><a href="#cb702-1893" aria-hidden="true" tabindex="-1"></a>**Checkpoint:** </span>
<span id="cb702-1894"><a href="#cb702-1894" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>All Rhat values &lt; 1.01 (convergence achieved)</span>
<span id="cb702-1895"><a href="#cb702-1895" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>ESS ratios &gt; 0.5 (sufficient effective samples)</span>
<span id="cb702-1896"><a href="#cb702-1896" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Trace plots show "hairy caterpillar" (good mixing)</span>
<span id="cb702-1897"><a href="#cb702-1897" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Rank plots show uniform overlap (no divergences)</span>
<span id="cb702-1898"><a href="#cb702-1898" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1899"><a href="#cb702-1899" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-1900"><a href="#cb702-1900" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1901"><a href="#cb702-1901" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 5: Extract and Visualize Posteriors</span></span>
<span id="cb702-1902"><a href="#cb702-1902" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1903"><a href="#cb702-1903" aria-hidden="true" tabindex="-1"></a>Examine posterior distributions:</span>
<span id="cb702-1904"><a href="#cb702-1904" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1905"><a href="#cb702-1905" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lab6-posteriors}</span></span>
<span id="cb702-1906"><a href="#cb702-1906" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract posterior draws</span></span>
<span id="cb702-1907"><a href="#cb702-1907" aria-hidden="true" tabindex="-1"></a>posterior_draws <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(bayes_model)</span>
<span id="cb702-1908"><a href="#cb702-1908" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1909"><a href="#cb702-1909" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize posteriors</span></span>
<span id="cb702-1910"><a href="#cb702-1910" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_areas</span>(bayes_model, </span>
<span id="cb702-1911"><a href="#cb702-1911" aria-hidden="true" tabindex="-1"></a>           <span class="at">pars =</span> <span class="fu">c</span>(<span class="st">"b_Intercept"</span>, <span class="st">"b_study_hours"</span>),</span>
<span id="cb702-1912"><a href="#cb702-1912" aria-hidden="true" tabindex="-1"></a>           <span class="at">prob =</span> <span class="fl">0.95</span>) <span class="sc">+</span></span>
<span id="cb702-1913"><a href="#cb702-1913" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Posterior Distributions with 95% Credible Intervals"</span>)</span>
<span id="cb702-1914"><a href="#cb702-1914" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1915"><a href="#cb702-1915" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary statistics</span></span>
<span id="cb702-1916"><a href="#cb702-1916" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior_summary</span>(bayes_model, <span class="at">pars =</span> <span class="fu">c</span>(<span class="st">"b_Intercept"</span>, <span class="st">"b_study_hours"</span>, <span class="st">"sigma"</span>))</span>
<span id="cb702-1917"><a href="#cb702-1917" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1918"><a href="#cb702-1918" aria-hidden="true" tabindex="-1"></a><span class="co"># Interpretation</span></span>
<span id="cb702-1919"><a href="#cb702-1919" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"For each additional study hour, exam scores increase by:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-1920"><a href="#cb702-1920" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Median:"</span>, <span class="fu">round</span>(<span class="fu">median</span>(posterior_draws<span class="sc">$</span>b_study_hours), <span class="dv">2</span>), <span class="st">"points</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-1921"><a href="#cb702-1921" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"95% Credible Interval:"</span>, </span>
<span id="cb702-1922"><a href="#cb702-1922" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">quantile</span>(posterior_draws<span class="sc">$</span>b_study_hours, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>)), <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-1923"><a href="#cb702-1923" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-1924"><a href="#cb702-1924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1925"><a href="#cb702-1925" aria-hidden="true" tabindex="-1"></a>**Checkpoint:** Posterior for slope should be clearly positive (95% CI excludes zero), indicating reliable relationship.</span>
<span id="cb702-1926"><a href="#cb702-1926" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1927"><a href="#cb702-1927" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-1928"><a href="#cb702-1928" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1929"><a href="#cb702-1929" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 6: Posterior Predictive Checks</span></span>
<span id="cb702-1930"><a href="#cb702-1930" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1931"><a href="#cb702-1931" aria-hidden="true" tabindex="-1"></a>Assess model fit:</span>
<span id="cb702-1932"><a href="#cb702-1932" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1933"><a href="#cb702-1933" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lab6-ppc}</span></span>
<span id="cb702-1934"><a href="#cb702-1934" aria-hidden="true" tabindex="-1"></a><span class="co"># Posterior predictive check</span></span>
<span id="cb702-1935"><a href="#cb702-1935" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(bayes_model, <span class="at">ndraws =</span> <span class="dv">50</span>) <span class="sc">+</span></span>
<span id="cb702-1936"><a href="#cb702-1936" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Posterior Predictive Check"</span>,</span>
<span id="cb702-1937"><a href="#cb702-1937" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Does model reproduce observed data distribution?"</span>)</span>
<span id="cb702-1938"><a href="#cb702-1938" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1939"><a href="#cb702-1939" aria-hidden="true" tabindex="-1"></a><span class="co"># Individual data points</span></span>
<span id="cb702-1940"><a href="#cb702-1940" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(bayes_model, <span class="at">type =</span> <span class="st">"scatter_avg"</span>) <span class="sc">+</span></span>
<span id="cb702-1941"><a href="#cb702-1941" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Observed vs Predicted Exam Scores"</span>)</span>
<span id="cb702-1942"><a href="#cb702-1942" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1943"><a href="#cb702-1943" aria-hidden="true" tabindex="-1"></a><span class="co"># Prediction intervals for new data</span></span>
<span id="cb702-1944"><a href="#cb702-1944" aria-hidden="true" tabindex="-1"></a>new_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">study_hours =</span> <span class="fu">seq</span>(<span class="dv">5</span>, <span class="dv">25</span>, <span class="at">by =</span> <span class="dv">5</span>))</span>
<span id="cb702-1945"><a href="#cb702-1945" aria-hidden="true" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">posterior_predict</span>(bayes_model, <span class="at">newdata =</span> new_data)</span>
<span id="cb702-1946"><a href="#cb702-1946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1947"><a href="#cb702-1947" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize with uncertainty</span></span>
<span id="cb702-1948"><a href="#cb702-1948" aria-hidden="true" tabindex="-1"></a>new_data <span class="sc">%&gt;%</span></span>
<span id="cb702-1949"><a href="#cb702-1949" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb702-1950"><a href="#cb702-1950" aria-hidden="true" tabindex="-1"></a>    <span class="at">median_score =</span> <span class="fu">apply</span>(predictions, <span class="dv">2</span>, median),</span>
<span id="cb702-1951"><a href="#cb702-1951" aria-hidden="true" tabindex="-1"></a>    <span class="at">lower =</span> <span class="fu">apply</span>(predictions, <span class="dv">2</span>, quantile, <span class="fl">0.025</span>),</span>
<span id="cb702-1952"><a href="#cb702-1952" aria-hidden="true" tabindex="-1"></a>    <span class="at">upper =</span> <span class="fu">apply</span>(predictions, <span class="dv">2</span>, quantile, <span class="fl">0.975</span>)</span>
<span id="cb702-1953"><a href="#cb702-1953" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb702-1954"><a href="#cb702-1954" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> study_hours)) <span class="sc">+</span></span>
<span id="cb702-1955"><a href="#cb702-1955" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> lower, <span class="at">ymax =</span> upper), <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb702-1956"><a href="#cb702-1956" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> median_score), <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb702-1957"><a href="#cb702-1957" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> study_data, <span class="fu">aes</span>(<span class="at">y =</span> exam_score), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb702-1958"><a href="#cb702-1958" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Bayesian Regression with 95% Prediction Intervals"</span>,</span>
<span id="cb702-1959"><a href="#cb702-1959" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Study Hours"</span>, <span class="at">y =</span> <span class="st">"Exam Score"</span>) <span class="sc">+</span></span>
<span id="cb702-1960"><a href="#cb702-1960" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb702-1961"><a href="#cb702-1961" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-1962"><a href="#cb702-1962" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1963"><a href="#cb702-1963" aria-hidden="true" tabindex="-1"></a>**Checkpoint:** Model should reproduce the observed data distribution well. Prediction intervals should capture most observed points.</span>
<span id="cb702-1964"><a href="#cb702-1964" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1965"><a href="#cb702-1965" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-1966"><a href="#cb702-1966" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1967"><a href="#cb702-1967" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 7: Compare with Frequentist Approach</span></span>
<span id="cb702-1968"><a href="#cb702-1968" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1969"><a href="#cb702-1969" aria-hidden="true" tabindex="-1"></a>Contrast Bayesian and frequentist results:</span>
<span id="cb702-1970"><a href="#cb702-1970" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1971"><a href="#cb702-1971" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lab6-comparison}</span></span>
<span id="cb702-1972"><a href="#cb702-1972" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit frequentist model</span></span>
<span id="cb702-1973"><a href="#cb702-1973" aria-hidden="true" tabindex="-1"></a>freq_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(exam_score <span class="sc">~</span> study_hours, <span class="at">data =</span> study_data)</span>
<span id="cb702-1974"><a href="#cb702-1974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1975"><a href="#cb702-1975" aria-hidden="true" tabindex="-1"></a><span class="co"># Comparison table</span></span>
<span id="cb702-1976"><a href="#cb702-1976" aria-hidden="true" tabindex="-1"></a>comparison <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb702-1977"><a href="#cb702-1977" aria-hidden="true" tabindex="-1"></a>  <span class="at">Parameter =</span> <span class="fu">c</span>(<span class="st">"Intercept"</span>, <span class="st">"Slope (study_hours)"</span>, <span class="st">"Residual SD"</span>),</span>
<span id="cb702-1978"><a href="#cb702-1978" aria-hidden="true" tabindex="-1"></a>  <span class="at">Frequentist_Estimate =</span> <span class="fu">c</span>(<span class="fu">coef</span>(freq_model)[<span class="dv">1</span>], </span>
<span id="cb702-1979"><a href="#cb702-1979" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">coef</span>(freq_model)[<span class="dv">2</span>], </span>
<span id="cb702-1980"><a href="#cb702-1980" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">sigma</span>(freq_model)),</span>
<span id="cb702-1981"><a href="#cb702-1981" aria-hidden="true" tabindex="-1"></a>  <span class="at">Frequentist_SE =</span> <span class="fu">c</span>(<span class="fu">summary</span>(freq_model)<span class="sc">$</span>coef[<span class="dv">1</span>, <span class="dv">2</span>],</span>
<span id="cb702-1982"><a href="#cb702-1982" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">summary</span>(freq_model)<span class="sc">$</span>coef[<span class="dv">2</span>, <span class="dv">2</span>],</span>
<span id="cb702-1983"><a href="#cb702-1983" aria-hidden="true" tabindex="-1"></a>                     <span class="cn">NA</span>),</span>
<span id="cb702-1984"><a href="#cb702-1984" aria-hidden="true" tabindex="-1"></a>  <span class="at">Bayesian_Median =</span> <span class="fu">c</span>(<span class="fu">median</span>(posterior_draws<span class="sc">$</span>b_Intercept),</span>
<span id="cb702-1985"><a href="#cb702-1985" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">median</span>(posterior_draws<span class="sc">$</span>b_study_hours),</span>
<span id="cb702-1986"><a href="#cb702-1986" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">median</span>(posterior_draws<span class="sc">$</span>sigma)),</span>
<span id="cb702-1987"><a href="#cb702-1987" aria-hidden="true" tabindex="-1"></a>  <span class="at">Bayesian_MAD =</span> <span class="fu">c</span>(<span class="fu">mad</span>(posterior_draws<span class="sc">$</span>b_Intercept),</span>
<span id="cb702-1988"><a href="#cb702-1988" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mad</span>(posterior_draws<span class="sc">$</span>b_study_hours),</span>
<span id="cb702-1989"><a href="#cb702-1989" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mad</span>(posterior_draws<span class="sc">$</span>sigma))</span>
<span id="cb702-1990"><a href="#cb702-1990" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb702-1991"><a href="#cb702-1991" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1992"><a href="#cb702-1992" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(comparison)</span>
<span id="cb702-1993"><a href="#cb702-1993" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1994"><a href="#cb702-1994" aria-hidden="true" tabindex="-1"></a><span class="co"># Credible vs Confidence Intervals</span></span>
<span id="cb702-1995"><a href="#cb702-1995" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">95% Confidence Interval (Frequentist):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-1996"><a href="#cb702-1996" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">confint</span>(freq_model))</span>
<span id="cb702-1997"><a href="#cb702-1997" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-1998"><a href="#cb702-1998" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">95% Credible Interval (Bayesian):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-1999"><a href="#cb702-1999" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Intercept:"</span>, <span class="fu">quantile</span>(posterior_draws<span class="sc">$</span>b_Intercept, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>)), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-2000"><a href="#cb702-2000" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Slope:"</span>, <span class="fu">quantile</span>(posterior_draws<span class="sc">$</span>b_study_hours, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>)), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-2001"><a href="#cb702-2001" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-2002"><a href="#cb702-2002" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2003"><a href="#cb702-2003" aria-hidden="true" tabindex="-1"></a>**Checkpoint:** Bayesian and frequentist estimates should be very similar with weakly informative priors. Bayesian approach provides full posterior distribution, not just point estimates.</span>
<span id="cb702-2004"><a href="#cb702-2004" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2005"><a href="#cb702-2005" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-2006"><a href="#cb702-2006" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2007"><a href="#cb702-2007" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 8: Interpret and Report</span></span>
<span id="cb702-2008"><a href="#cb702-2008" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2009"><a href="#cb702-2009" aria-hidden="true" tabindex="-1"></a>Summarize findings:</span>
<span id="cb702-2010"><a href="#cb702-2010" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2011"><a href="#cb702-2011" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lab6-interpretation}</span></span>
<span id="cb702-2012"><a href="#cb702-2012" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate probability of positive effect</span></span>
<span id="cb702-2013"><a href="#cb702-2013" aria-hidden="true" tabindex="-1"></a>prob_positive <span class="ot">&lt;-</span> <span class="fu">mean</span>(posterior_draws<span class="sc">$</span>b_study_hours <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb702-2014"><a href="#cb702-2014" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2015"><a href="#cb702-2015" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Interpretation:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-2016"><a href="#cb702-2016" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Median slope:"</span>, <span class="fu">round</span>(<span class="fu">median</span>(posterior_draws<span class="sc">$</span>b_study_hours), <span class="dv">2</span>), </span>
<span id="cb702-2017"><a href="#cb702-2017" aria-hidden="true" tabindex="-1"></a>    <span class="st">"points per hour</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-2018"><a href="#cb702-2018" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- 95% Credible Interval:"</span>, </span>
<span id="cb702-2019"><a href="#cb702-2019" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">quantile</span>(posterior_draws<span class="sc">$</span>b_study_hours, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>)), <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-2020"><a href="#cb702-2020" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Probability that slope &gt; 0:"</span>, <span class="fu">round</span>(prob_positive, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-2021"><a href="#cb702-2021" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Interpretation: For each additional study hour, exam scores</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-2022"><a href="#cb702-2022" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  increase by approximately"</span>, </span>
<span id="cb702-2023"><a href="#cb702-2023" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">median</span>(posterior_draws<span class="sc">$</span>b_study_hours), <span class="dv">1</span>), </span>
<span id="cb702-2024"><a href="#cb702-2024" aria-hidden="true" tabindex="-1"></a>    <span class="st">"points (95% CI:"</span>, </span>
<span id="cb702-2025"><a href="#cb702-2025" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste</span>(<span class="fu">round</span>(<span class="fu">quantile</span>(posterior_draws<span class="sc">$</span>b_study_hours, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>)), <span class="dv">1</span>), </span>
<span id="cb702-2026"><a href="#cb702-2026" aria-hidden="true" tabindex="-1"></a>          <span class="at">collapse =</span> <span class="st">" to "</span>), <span class="st">").</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-2027"><a href="#cb702-2027" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2028"><a href="#cb702-2028" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample results statement</span></span>
<span id="cb702-2029"><a href="#cb702-2029" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Sample Results Statement:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-2030"><a href="#cb702-2030" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"We used Bayesian linear regression with weakly informative priors</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-2031"><a href="#cb702-2031" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"(n=20, 4 chains, 8000 iterations). MCMC diagnostics indicated adequate</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-2032"><a href="#cb702-2032" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"convergence (all Rhat &lt; 1.01, ESS &gt; 1000). Study hours positively</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-2033"><a href="#cb702-2033" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"predicted exam scores (β ="</span>, <span class="fu">round</span>(<span class="fu">median</span>(posterior_draws<span class="sc">$</span>b_study_hours), <span class="dv">2</span>),</span>
<span id="cb702-2034"><a href="#cb702-2034" aria-hidden="true" tabindex="-1"></a>    <span class="st">", 95% CrI ["</span>, <span class="fu">paste</span>(<span class="fu">round</span>(<span class="fu">quantile</span>(posterior_draws<span class="sc">$</span>b_study_hours, </span>
<span id="cb702-2035"><a href="#cb702-2035" aria-hidden="true" tabindex="-1"></a>                                         <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>)), <span class="dv">2</span>), <span class="at">collapse =</span> <span class="st">", "</span>),</span>
<span id="cb702-2036"><a href="#cb702-2036" aria-hidden="true" tabindex="-1"></a>    <span class="st">"], P(β &gt; 0) = "</span>, <span class="fu">round</span>(prob_positive, <span class="dv">3</span>), <span class="st">").</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-2037"><a href="#cb702-2037" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-2038"><a href="#cb702-2038" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2039"><a href="#cb702-2039" aria-hidden="true" tabindex="-1"></a>**Checkpoint:** Clear interpretation with credible intervals and probability statements that are unique to Bayesian approach.</span>
<span id="cb702-2040"><a href="#cb702-2040" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2041"><a href="#cb702-2041" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-2042"><a href="#cb702-2042" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2043"><a href="#cb702-2043" aria-hidden="true" tabindex="-1"></a><span class="fu">### Discussion Questions</span></span>
<span id="cb702-2044"><a href="#cb702-2044" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2045"><a href="#cb702-2045" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Prior Sensitivity:** How would results change with more informative priors (e.g., prior(normal(2, 1), class = b))?</span>
<span id="cb702-2046"><a href="#cb702-2046" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2047"><a href="#cb702-2047" aria-hidden="true" tabindex="-1"></a>   *Answer: More informative priors would pull estimates toward the prior mean (2), resulting in less influence from data. With n=20, data should dominate weakly informative priors, but stronger priors would shrink estimates.*</span>
<span id="cb702-2048"><a href="#cb702-2048" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2049"><a href="#cb702-2049" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Credible vs Confidence:** What's the difference between a 95% credible interval and a 95% confidence interval?</span>
<span id="cb702-2050"><a href="#cb702-2050" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2051"><a href="#cb702-2051" aria-hidden="true" tabindex="-1"></a>   *Answer: A 95% credible interval says "the parameter has 95% probability of being in this range" (Bayesian). A 95% confidence interval says "if we repeated the study many times, 95% of intervals would contain the true parameter" (frequentist). Credible intervals are more intuitive.*</span>
<span id="cb702-2052"><a href="#cb702-2052" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2053"><a href="#cb702-2053" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Small Sample Advantage:** Why might Bayesian methods be preferred for small samples?</span>
<span id="cb702-2054"><a href="#cb702-2054" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2055"><a href="#cb702-2055" aria-hidden="true" tabindex="-1"></a>   *Answer: Bayesian methods explicitly quantify uncertainty, incorporate prior information to stabilize estimates, don't rely on asymptotic approximations (which fail in small samples), and provide probability statements about parameters.*</span>
<span id="cb702-2056"><a href="#cb702-2056" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2057"><a href="#cb702-2057" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**MCMC Diagnostics:** What would you do if Rhat &gt; 1.01 or ESS &lt; 400?</span>
<span id="cb702-2058"><a href="#cb702-2058" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2059"><a href="#cb702-2059" aria-hidden="true" tabindex="-1"></a>   *Answer: Increase iterations (e.g., iter=10000), increase warmup (e.g., warmup=5000), check for divergent transitions (indicating prior-likelihood conflict), consider reparameterization, or use stronger priors to improve geometry.*</span>
<span id="cb702-2060"><a href="#cb702-2060" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2061"><a href="#cb702-2061" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>**Reporting:** What information should you include when reporting Bayesian regression results?</span>
<span id="cb702-2062"><a href="#cb702-2062" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2063"><a href="#cb702-2063" aria-hidden="true" tabindex="-1"></a>   *Answer: Prior specifications, MCMC settings (chains, iterations, warmup), convergence diagnostics (Rhat, ESS), posterior summaries (median or mean, credible intervals), and interpretation using probability statements.*</span>
<span id="cb702-2064"><a href="#cb702-2064" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2065"><a href="#cb702-2065" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-2066"><a href="#cb702-2066" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2067"><a href="#cb702-2067" aria-hidden="true" tabindex="-1"></a><span class="fu">### Key Takeaways</span></span>
<span id="cb702-2068"><a href="#cb702-2068" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2069"><a href="#cb702-2069" aria-hidden="true" tabindex="-1"></a>✓ **Bayesian regression provides full uncertainty quantification** through posterior distributions  </span>
<span id="cb702-2070"><a href="#cb702-2070" aria-hidden="true" tabindex="-1"></a>✓ **Weakly informative priors** regularize estimates without dominating small-sample data  </span>
<span id="cb702-2071"><a href="#cb702-2071" aria-hidden="true" tabindex="-1"></a>✓ **MCMC diagnostics are critical**: Always check Rhat, ESS, trace plots, and divergences  </span>
<span id="cb702-2072"><a href="#cb702-2072" aria-hidden="true" tabindex="-1"></a>✓ **Posterior predictive checks** assess model fit and identify misspecification  </span>
<span id="cb702-2073"><a href="#cb702-2073" aria-hidden="true" tabindex="-1"></a>✓ **Credible intervals have intuitive interpretation**: Direct probability statements about parameters  </span>
<span id="cb702-2074"><a href="#cb702-2074" aria-hidden="true" tabindex="-1"></a>✓ **Bayesian methods excel in small samples** where frequentist asymptotics break down  </span>
<span id="cb702-2075"><a href="#cb702-2075" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2076"><a href="#cb702-2076" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-2077"><a href="#cb702-2077" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2078"><a href="#cb702-2078" aria-hidden="true" tabindex="-1"></a><span class="fu">### Homework Exercise</span></span>
<span id="cb702-2079"><a href="#cb702-2079" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2080"><a href="#cb702-2080" aria-hidden="true" tabindex="-1"></a>**Dataset:** A pilot study (n=18) examined whether training hours predict performance scores.</span>
<span id="cb702-2081"><a href="#cb702-2081" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2082"><a href="#cb702-2082" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lab6-homework-data}</span></span>
<span id="cb702-2083"><a href="#cb702-2083" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb702-2084"><a href="#cb702-2084" aria-hidden="true" tabindex="-1"></a>training_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb702-2085"><a href="#cb702-2085" aria-hidden="true" tabindex="-1"></a>  <span class="at">employee_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">18</span>,</span>
<span id="cb702-2086"><a href="#cb702-2086" aria-hidden="true" tabindex="-1"></a>  <span class="at">training_hours =</span> <span class="fu">round</span>(<span class="fu">runif</span>(<span class="dv">18</span>, <span class="dv">10</span>, <span class="dv">40</span>), <span class="dv">1</span>),</span>
<span id="cb702-2087"><a href="#cb702-2087" aria-hidden="true" tabindex="-1"></a>  <span class="at">performance_score =</span> <span class="fu">round</span>(<span class="dv">60</span> <span class="sc">+</span> <span class="fl">0.8</span> <span class="sc">*</span> training_hours <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">18</span>, <span class="dv">0</span>, <span class="dv">6</span>), <span class="dv">1</span>)</span>
<span id="cb702-2088"><a href="#cb702-2088" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb702-2089"><a href="#cb702-2089" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-2090"><a href="#cb702-2090" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2091"><a href="#cb702-2091" aria-hidden="true" tabindex="-1"></a>**Your Tasks:**</span>
<span id="cb702-2092"><a href="#cb702-2092" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2093"><a href="#cb702-2093" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Create a scatter plot of training hours vs performance score</span>
<span id="cb702-2094"><a href="#cb702-2094" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Specify weakly informative priors (justify your choices)</span>
<span id="cb702-2095"><a href="#cb702-2095" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Fit a Bayesian linear regression model with brms (4 chains, 4000 iterations)</span>
<span id="cb702-2096"><a href="#cb702-2096" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Check MCMC diagnostics (Rhat, ESS, trace plots)</span>
<span id="cb702-2097"><a href="#cb702-2097" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>Visualize posterior distributions for intercept and slope</span>
<span id="cb702-2098"><a href="#cb702-2098" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span>Perform posterior predictive checks</span>
<span id="cb702-2099"><a href="#cb702-2099" aria-hidden="true" tabindex="-1"></a><span class="ss">7. </span>Compare Bayesian and frequentist estimates</span>
<span id="cb702-2100"><a href="#cb702-2100" aria-hidden="true" tabindex="-1"></a><span class="ss">8. </span>Calculate P(slope &gt; 0) and interpret</span>
<span id="cb702-2101"><a href="#cb702-2101" aria-hidden="true" tabindex="-1"></a><span class="ss">9. </span>Create a plot with median regression line and 95% credible intervals</span>
<span id="cb702-2102"><a href="#cb702-2102" aria-hidden="true" tabindex="-1"></a><span class="ss">10. </span>Write a results statement reporting Bayesian estimates</span>
<span id="cb702-2103"><a href="#cb702-2103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2104"><a href="#cb702-2104" aria-hidden="true" tabindex="-1"></a>**Expected Results:**</span>
<span id="cb702-2105"><a href="#cb702-2105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2106"><a href="#cb702-2106" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Positive relationship between training and performance</span>
<span id="cb702-2107"><a href="#cb702-2107" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Slope posterior: median ≈ 0.7-0.9, 95% CrI roughly <span class="co">[</span><span class="ot">0.4, 1.2</span><span class="co">]</span></span>
<span id="cb702-2108"><a href="#cb702-2108" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>All Rhat &lt; 1.01, ESS &gt; 1000 (good convergence)</span>
<span id="cb702-2109"><a href="#cb702-2109" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>P(slope &gt; 0) &gt; 0.99 (strong evidence for positive effect)</span>
<span id="cb702-2110"><a href="#cb702-2110" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Bayesian and frequentist estimates very similar</span>
<span id="cb702-2111"><a href="#cb702-2111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2112"><a href="#cb702-2112" aria-hidden="true" tabindex="-1"></a>**Hints:**</span>
<span id="cb702-2113"><a href="#cb702-2113" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>For priors: performance scores range 60-90, training hours range 10-40</span>
<span id="cb702-2114"><a href="#cb702-2114" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Use <span class="in">`prior(normal(75, 20), class = Intercept)`</span> and <span class="in">`prior(normal(0, 2), class = b)`</span></span>
<span id="cb702-2115"><a href="#cb702-2115" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Extract posteriors with <span class="in">`as_draws_df(model)`</span> and calculate probabilities with <span class="in">`mean(posterior_draws$parameter &gt; value)`</span></span>
<span id="cb702-2116"><a href="#cb702-2116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2117"><a href="#cb702-2117" aria-hidden="true" tabindex="-1"></a>**Bonus:** Re-fit the model with more informative priors (e.g., prior(normal(1, 0.5), class = b) assuming we expect slopes near 1). How much do results change? What does this reveal about data vs prior influence with n=18?</span>
<span id="cb702-2118"><a href="#cb702-2118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2119"><a href="#cb702-2119" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-2120"><a href="#cb702-2120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2121"><a href="#cb702-2121" aria-hidden="true" tabindex="-1"></a><span class="fu">## Lab 7: Reliability Analysis with Cronbach's Alpha {#lab-reliability}</span></span>
<span id="cb702-2122"><a href="#cb702-2122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2123"><a href="#cb702-2123" aria-hidden="true" tabindex="-1"></a>**Learning Objectives:**</span>
<span id="cb702-2124"><a href="#cb702-2124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2125"><a href="#cb702-2125" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Calculate Cronbach's alpha for internal consistency</span>
<span id="cb702-2126"><a href="#cb702-2126" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Conduct item-total correlation analysis</span>
<span id="cb702-2127"><a href="#cb702-2127" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Interpret "alpha if item deleted" diagnostics</span>
<span id="cb702-2128"><a href="#cb702-2128" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Identify and remove problematic scale items</span>
<span id="cb702-2129"><a href="#cb702-2129" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Report reliability estimates with confidence intervals</span>
<span id="cb702-2130"><a href="#cb702-2130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2131"><a href="#cb702-2131" aria-hidden="true" tabindex="-1"></a>**Scenario:** You're developing a 6-item Job Satisfaction Scale in a pilot sample (n=25 employees). You need to assess internal consistency, identify any poor items, and refine the scale.</span>
<span id="cb702-2132"><a href="#cb702-2132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2133"><a href="#cb702-2133" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 1: Set Up and Load Data</span></span>
<span id="cb702-2134"><a href="#cb702-2134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2135"><a href="#cb702-2135" aria-hidden="true" tabindex="-1"></a>Create pilot data with responses to 6 job satisfaction items:</span>
<span id="cb702-2136"><a href="#cb702-2136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2137"><a href="#cb702-2137" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lab7-data}</span></span>
<span id="cb702-2138"><a href="#cb702-2138" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb702-2139"><a href="#cb702-2139" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb702-2140"><a href="#cb702-2140" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb702-2141"><a href="#cb702-2141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2142"><a href="#cb702-2142" aria-hidden="true" tabindex="-1"></a><span class="co"># Set seed for reproducibility</span></span>
<span id="cb702-2143"><a href="#cb702-2143" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb702-2144"><a href="#cb702-2144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2145"><a href="#cb702-2145" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate 6-item scale responses (1=Strongly Disagree, 5=Strongly Agree)</span></span>
<span id="cb702-2146"><a href="#cb702-2146" aria-hidden="true" tabindex="-1"></a><span class="co"># Item 3 is intentionally problematic (reverse-coded but not reversed)</span></span>
<span id="cb702-2147"><a href="#cb702-2147" aria-hidden="true" tabindex="-1"></a>job_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb702-2148"><a href="#cb702-2148" aria-hidden="true" tabindex="-1"></a>  <span class="at">employee_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>,</span>
<span id="cb702-2149"><a href="#cb702-2149" aria-hidden="true" tabindex="-1"></a>  <span class="at">item1 =</span> <span class="fu">sample</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">25</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.3</span>, <span class="fl">0.4</span>, <span class="fl">0.2</span>)),</span>
<span id="cb702-2150"><a href="#cb702-2150" aria-hidden="true" tabindex="-1"></a>  <span class="at">item2 =</span> <span class="fu">sample</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">25</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span>)),</span>
<span id="cb702-2151"><a href="#cb702-2151" aria-hidden="true" tabindex="-1"></a>  <span class="at">item3 =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">25</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.3</span>, <span class="fl">0.4</span>, <span class="fl">0.2</span>, <span class="fl">0.1</span>)),  <span class="co"># Problematic</span></span>
<span id="cb702-2152"><a href="#cb702-2152" aria-hidden="true" tabindex="-1"></a>  <span class="at">item4 =</span> <span class="fu">sample</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">25</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.4</span>, <span class="fl">0.3</span>)),</span>
<span id="cb702-2153"><a href="#cb702-2153" aria-hidden="true" tabindex="-1"></a>  <span class="at">item5 =</span> <span class="fu">sample</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">25</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span>)),</span>
<span id="cb702-2154"><a href="#cb702-2154" aria-hidden="true" tabindex="-1"></a>  <span class="at">item6 =</span> <span class="fu">sample</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">25</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span>))</span>
<span id="cb702-2155"><a href="#cb702-2155" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb702-2156"><a href="#cb702-2156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2157"><a href="#cb702-2157" aria-hidden="true" tabindex="-1"></a><span class="co"># Item descriptions</span></span>
<span id="cb702-2158"><a href="#cb702-2158" aria-hidden="true" tabindex="-1"></a>item_labels <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb702-2159"><a href="#cb702-2159" aria-hidden="true" tabindex="-1"></a>  <span class="st">"item1"</span> <span class="ot">=</span> <span class="st">"I enjoy my work tasks"</span>,</span>
<span id="cb702-2160"><a href="#cb702-2160" aria-hidden="true" tabindex="-1"></a>  <span class="st">"item2"</span> <span class="ot">=</span> <span class="st">"I feel valued by my employer"</span>,</span>
<span id="cb702-2161"><a href="#cb702-2161" aria-hidden="true" tabindex="-1"></a>  <span class="st">"item3"</span> <span class="ot">=</span> <span class="st">"I often feel stressed at work (R)"</span>,  <span class="co"># Reverse-coded</span></span>
<span id="cb702-2162"><a href="#cb702-2162" aria-hidden="true" tabindex="-1"></a>  <span class="st">"item4"</span> <span class="ot">=</span> <span class="st">"I would recommend this workplace"</span>,</span>
<span id="cb702-2163"><a href="#cb702-2163" aria-hidden="true" tabindex="-1"></a>  <span class="st">"item5"</span> <span class="ot">=</span> <span class="st">"My work is meaningful"</span>,</span>
<span id="cb702-2164"><a href="#cb702-2164" aria-hidden="true" tabindex="-1"></a>  <span class="st">"item6"</span> <span class="ot">=</span> <span class="st">"I have good work-life balance"</span></span>
<span id="cb702-2165"><a href="#cb702-2165" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb702-2166"><a href="#cb702-2166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2167"><a href="#cb702-2167" aria-hidden="true" tabindex="-1"></a><span class="co"># Descriptive statistics</span></span>
<span id="cb702-2168"><a href="#cb702-2168" aria-hidden="true" tabindex="-1"></a>job_data <span class="sc">%&gt;%</span></span>
<span id="cb702-2169"><a href="#cb702-2169" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"item"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb702-2170"><a href="#cb702-2170" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span>
<span id="cb702-2171"><a href="#cb702-2171" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-2172"><a href="#cb702-2172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2173"><a href="#cb702-2173" aria-hidden="true" tabindex="-1"></a>**Checkpoint:** You should have n=25 employees with responses to 6 items on a 1-5 scale.</span>
<span id="cb702-2174"><a href="#cb702-2174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2175"><a href="#cb702-2175" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-2176"><a href="#cb702-2176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2177"><a href="#cb702-2177" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 2: Visualize Inter-Item Correlations</span></span>
<span id="cb702-2178"><a href="#cb702-2178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2179"><a href="#cb702-2179" aria-hidden="true" tabindex="-1"></a>Examine correlation matrix:</span>
<span id="cb702-2180"><a href="#cb702-2180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2181"><a href="#cb702-2181" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lab7-correlations}</span></span>
<span id="cb702-2182"><a href="#cb702-2182" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract item columns</span></span>
<span id="cb702-2183"><a href="#cb702-2183" aria-hidden="true" tabindex="-1"></a>items <span class="ot">&lt;-</span> job_data <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"item"</span>))</span>
<span id="cb702-2184"><a href="#cb702-2184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2185"><a href="#cb702-2185" aria-hidden="true" tabindex="-1"></a><span class="co"># Correlation matrix</span></span>
<span id="cb702-2186"><a href="#cb702-2186" aria-hidden="true" tabindex="-1"></a>cor_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(items)</span>
<span id="cb702-2187"><a href="#cb702-2187" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(cor_matrix, <span class="dv">2</span>))</span>
<span id="cb702-2188"><a href="#cb702-2188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2189"><a href="#cb702-2189" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize correlations</span></span>
<span id="cb702-2190"><a href="#cb702-2190" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(cor_matrix, </span>
<span id="cb702-2191"><a href="#cb702-2191" aria-hidden="true" tabindex="-1"></a>         <span class="at">method =</span> <span class="st">"color"</span>, </span>
<span id="cb702-2192"><a href="#cb702-2192" aria-hidden="true" tabindex="-1"></a>         <span class="at">type =</span> <span class="st">"upper"</span>,</span>
<span id="cb702-2193"><a href="#cb702-2193" aria-hidden="true" tabindex="-1"></a>         <span class="at">addCoef.col =</span> <span class="st">"black"</span>,</span>
<span id="cb702-2194"><a href="#cb702-2194" aria-hidden="true" tabindex="-1"></a>         <span class="at">tl.col =</span> <span class="st">"black"</span>,</span>
<span id="cb702-2195"><a href="#cb702-2195" aria-hidden="true" tabindex="-1"></a>         <span class="at">tl.srt =</span> <span class="dv">45</span>,</span>
<span id="cb702-2196"><a href="#cb702-2196" aria-hidden="true" tabindex="-1"></a>         <span class="at">title =</span> <span class="st">"Inter-Item Correlations"</span>,</span>
<span id="cb702-2197"><a href="#cb702-2197" aria-hidden="true" tabindex="-1"></a>         <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">0</span>))</span>
<span id="cb702-2198"><a href="#cb702-2198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2199"><a href="#cb702-2199" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify problematic correlations</span></span>
<span id="cb702-2200"><a href="#cb702-2200" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Items with low/negative correlations:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-2201"><a href="#cb702-2201" aria-hidden="true" tabindex="-1"></a><span class="fu">which</span>(cor_matrix <span class="sc">&lt;</span> <span class="fl">0.2</span> <span class="sc">&amp;</span> cor_matrix <span class="sc">&lt;</span> <span class="dv">1</span>, <span class="at">arr.ind =</span> <span class="cn">TRUE</span>)</span>
<span id="cb702-2202"><a href="#cb702-2202" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-2203"><a href="#cb702-2203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2204"><a href="#cb702-2204" aria-hidden="true" tabindex="-1"></a>**Checkpoint:** Most items should correlate positively (r &gt; 0.3). Item 3 likely shows weak or negative correlations.</span>
<span id="cb702-2205"><a href="#cb702-2205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2206"><a href="#cb702-2206" aria-hidden="true" tabindex="-1"></a>**Discussion:** Why do we want items to be positively correlated? What do low/negative correlations suggest?</span>
<span id="cb702-2207"><a href="#cb702-2207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2208"><a href="#cb702-2208" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-2209"><a href="#cb702-2209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2210"><a href="#cb702-2210" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 3: Calculate Cronbach's Alpha</span></span>
<span id="cb702-2211"><a href="#cb702-2211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2212"><a href="#cb702-2212" aria-hidden="true" tabindex="-1"></a>Compute reliability for the full 6-item scale:</span>
<span id="cb702-2213"><a href="#cb702-2213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2214"><a href="#cb702-2214" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lab7-alpha}</span></span>
<span id="cb702-2215"><a href="#cb702-2215" aria-hidden="true" tabindex="-1"></a><span class="co"># Cronbach's alpha with detailed output</span></span>
<span id="cb702-2216"><a href="#cb702-2216" aria-hidden="true" tabindex="-1"></a>alpha_result <span class="ot">&lt;-</span> psych<span class="sc">::</span><span class="fu">alpha</span>(items)</span>
<span id="cb702-2217"><a href="#cb702-2217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2218"><a href="#cb702-2218" aria-hidden="true" tabindex="-1"></a><span class="co"># Print full output</span></span>
<span id="cb702-2219"><a href="#cb702-2219" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(alpha_result)</span>
<span id="cb702-2220"><a href="#cb702-2220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2221"><a href="#cb702-2221" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract key statistics safely using as.numeric() to ensure atomic values</span></span>
<span id="cb702-2222"><a href="#cb702-2222" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Cronbach's Alpha:"</span>, <span class="fu">round</span>(<span class="fu">as.numeric</span>(alpha_result<span class="sc">$</span>total<span class="sc">$</span>raw_alpha), <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-2223"><a href="#cb702-2223" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Standardized Alpha:"</span>, <span class="fu">round</span>(<span class="fu">as.numeric</span>(alpha_result<span class="sc">$</span>total<span class="sc">$</span>std.alpha), <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-2224"><a href="#cb702-2224" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Number of items:"</span>, <span class="fu">as.numeric</span>(alpha_result<span class="sc">$</span>total<span class="sc">$</span>nvar), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-2225"><a href="#cb702-2225" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Sample size:"</span>, <span class="fu">as.numeric</span>(alpha_result<span class="sc">$</span>total<span class="sc">$</span>n), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-2226"><a href="#cb702-2226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2227"><a href="#cb702-2227" aria-hidden="true" tabindex="-1"></a><span class="co"># 95% Confidence interval for alpha (if available)</span></span>
<span id="cb702-2228"><a href="#cb702-2228" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(alpha_result<span class="sc">$</span>feldt) <span class="sc">&amp;&amp;</span> <span class="fu">is.data.frame</span>(alpha_result<span class="sc">$</span>feldt) <span class="sc">&amp;&amp;</span> <span class="fu">nrow</span>(alpha_result<span class="sc">$</span>feldt) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb702-2229"><a href="#cb702-2229" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"95% CI for Alpha:"</span>, </span>
<span id="cb702-2230"><a href="#cb702-2230" aria-hidden="true" tabindex="-1"></a>      <span class="fu">round</span>(<span class="fu">as.numeric</span>(alpha_result<span class="sc">$</span>feldt<span class="sc">$</span>lower.ci), <span class="dv">3</span>), <span class="st">"-"</span>,</span>
<span id="cb702-2231"><a href="#cb702-2231" aria-hidden="true" tabindex="-1"></a>      <span class="fu">round</span>(<span class="fu">as.numeric</span>(alpha_result<span class="sc">$</span>feldt<span class="sc">$</span>upper.ci), <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-2232"><a href="#cb702-2232" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb702-2233"><a href="#cb702-2233" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-2234"><a href="#cb702-2234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2235"><a href="#cb702-2235" aria-hidden="true" tabindex="-1"></a>**Checkpoint:** Initial alpha should be moderate (0.60-0.75), with wide CI due to small sample.</span>
<span id="cb702-2236"><a href="#cb702-2236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2237"><a href="#cb702-2237" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-2238"><a href="#cb702-2238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2239"><a href="#cb702-2239" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 4: Item-Total Correlations</span></span>
<span id="cb702-2240"><a href="#cb702-2240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2241"><a href="#cb702-2241" aria-hidden="true" tabindex="-1"></a>Examine how each item relates to total score:</span>
<span id="cb702-2242"><a href="#cb702-2242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2243"><a href="#cb702-2243" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lab7-item-total}</span></span>
<span id="cb702-2244"><a href="#cb702-2244" aria-hidden="true" tabindex="-1"></a><span class="co"># Item statistics</span></span>
<span id="cb702-2245"><a href="#cb702-2245" aria-hidden="true" tabindex="-1"></a>item_stats <span class="ot">&lt;-</span> alpha_result<span class="sc">$</span>item.stats</span>
<span id="cb702-2246"><a href="#cb702-2246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2247"><a href="#cb702-2247" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(item_stats)</span>
<span id="cb702-2248"><a href="#cb702-2248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2249"><a href="#cb702-2249" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize item-total correlations</span></span>
<span id="cb702-2250"><a href="#cb702-2250" aria-hidden="true" tabindex="-1"></a>item_stats <span class="sc">%&gt;%</span></span>
<span id="cb702-2251"><a href="#cb702-2251" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"item"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb702-2252"><a href="#cb702-2252" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> item, <span class="at">y =</span> r.cor)) <span class="sc">+</span></span>
<span id="cb702-2253"><a href="#cb702-2253" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb702-2254"><a href="#cb702-2254" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.3</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb702-2255"><a href="#cb702-2255" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Corrected Item-Total Correlations"</span>,</span>
<span id="cb702-2256"><a href="#cb702-2256" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Red line = 0.30 threshold"</span>,</span>
<span id="cb702-2257"><a href="#cb702-2257" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Item"</span>, <span class="at">y =</span> <span class="st">"Correlation with Total"</span>) <span class="sc">+</span></span>
<span id="cb702-2258"><a href="#cb702-2258" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb702-2259"><a href="#cb702-2259" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb702-2260"><a href="#cb702-2260" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-2261"><a href="#cb702-2261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2262"><a href="#cb702-2262" aria-hidden="true" tabindex="-1"></a>**Checkpoint:** Item 3 should show low corrected item-total correlation (r &lt; 0.30), flagging it as problematic.</span>
<span id="cb702-2263"><a href="#cb702-2263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2264"><a href="#cb702-2264" aria-hidden="true" tabindex="-1"></a>**Discussion:** What does a low item-total correlation mean? Should we remove this item?</span>
<span id="cb702-2265"><a href="#cb702-2265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2266"><a href="#cb702-2266" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-2267"><a href="#cb702-2267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2268"><a href="#cb702-2268" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 5: "Alpha if Item Deleted" Analysis</span></span>
<span id="cb702-2269"><a href="#cb702-2269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2270"><a href="#cb702-2270" aria-hidden="true" tabindex="-1"></a>See how alpha changes if each item is removed:</span>
<span id="cb702-2271"><a href="#cb702-2271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2272"><a href="#cb702-2272" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lab7-alpha-deleted}</span></span>
<span id="cb702-2273"><a href="#cb702-2273" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract "alpha if item deleted"</span></span>
<span id="cb702-2274"><a href="#cb702-2274" aria-hidden="true" tabindex="-1"></a>alpha_if_deleted <span class="ot">&lt;-</span> alpha_result<span class="sc">$</span>alpha.drop</span>
<span id="cb702-2275"><a href="#cb702-2275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2276"><a href="#cb702-2276" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(alpha_if_deleted)</span>
<span id="cb702-2277"><a href="#cb702-2277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2278"><a href="#cb702-2278" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize impact</span></span>
<span id="cb702-2279"><a href="#cb702-2279" aria-hidden="true" tabindex="-1"></a>alpha_if_deleted <span class="sc">%&gt;%</span></span>
<span id="cb702-2280"><a href="#cb702-2280" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"item"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb702-2281"><a href="#cb702-2281" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> item, <span class="at">y =</span> raw_alpha)) <span class="sc">+</span></span>
<span id="cb702-2282"><a href="#cb702-2282" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">"coral"</span>) <span class="sc">+</span></span>
<span id="cb702-2283"><a href="#cb702-2283" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> alpha_result<span class="sc">$</span>total<span class="sc">$</span>raw_alpha, </span>
<span id="cb702-2284"><a href="#cb702-2284" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb702-2285"><a href="#cb702-2285" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Alpha if Item Deleted"</span>,</span>
<span id="cb702-2286"><a href="#cb702-2286" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Blue line = Current alpha"</span>,</span>
<span id="cb702-2287"><a href="#cb702-2287" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Item"</span>, <span class="at">y =</span> <span class="st">"Alpha without this item"</span>) <span class="sc">+</span></span>
<span id="cb702-2288"><a href="#cb702-2288" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb702-2289"><a href="#cb702-2289" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb702-2290"><a href="#cb702-2290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2291"><a href="#cb702-2291" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify items that improve alpha if deleted</span></span>
<span id="cb702-2292"><a href="#cb702-2292" aria-hidden="true" tabindex="-1"></a>items_to_consider <span class="ot">&lt;-</span> alpha_if_deleted <span class="sc">%&gt;%</span></span>
<span id="cb702-2293"><a href="#cb702-2293" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(raw_alpha <span class="sc">&gt;</span> alpha_result<span class="sc">$</span>total<span class="sc">$</span>raw_alpha)</span>
<span id="cb702-2294"><a href="#cb702-2294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2295"><a href="#cb702-2295" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">nrow</span>(items_to_consider) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb702-2296"><a href="#cb702-2296" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Removing these items would INCREASE alpha:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-2297"><a href="#cb702-2297" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">rownames</span>(items_to_consider))</span>
<span id="cb702-2298"><a href="#cb702-2298" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb702-2299"><a href="#cb702-2299" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-2300"><a href="#cb702-2300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2301"><a href="#cb702-2301" aria-hidden="true" tabindex="-1"></a>**Checkpoint:** Removing item 3 should increase alpha, suggesting it should be deleted.</span>
<span id="cb702-2302"><a href="#cb702-2302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2303"><a href="#cb702-2303" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-2304"><a href="#cb702-2304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2305"><a href="#cb702-2305" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 6: Recompute Alpha Without Problematic Item</span></span>
<span id="cb702-2306"><a href="#cb702-2306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2307"><a href="#cb702-2307" aria-hidden="true" tabindex="-1"></a>Remove item 3 and reassess reliability:</span>
<span id="cb702-2308"><a href="#cb702-2308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2309"><a href="#cb702-2309" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lab7-alpha-revised}</span></span>
<span id="cb702-2310"><a href="#cb702-2310" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove item 3</span></span>
<span id="cb702-2311"><a href="#cb702-2311" aria-hidden="true" tabindex="-1"></a>items_revised <span class="ot">&lt;-</span> items <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>item3)</span>
<span id="cb702-2312"><a href="#cb702-2312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2313"><a href="#cb702-2313" aria-hidden="true" tabindex="-1"></a><span class="co"># Recompute alpha</span></span>
<span id="cb702-2314"><a href="#cb702-2314" aria-hidden="true" tabindex="-1"></a>alpha_revised <span class="ot">&lt;-</span> psych<span class="sc">::</span><span class="fu">alpha</span>(items_revised)</span>
<span id="cb702-2315"><a href="#cb702-2315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2316"><a href="#cb702-2316" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(alpha_revised)</span>
<span id="cb702-2317"><a href="#cb702-2317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2318"><a href="#cb702-2318" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare original vs revised</span></span>
<span id="cb702-2319"><a href="#cb702-2319" aria-hidden="true" tabindex="-1"></a>comparison <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb702-2320"><a href="#cb702-2320" aria-hidden="true" tabindex="-1"></a>  <span class="at">Version =</span> <span class="fu">c</span>(<span class="st">"Original (6 items)"</span>, <span class="st">"Revised (5 items)"</span>),</span>
<span id="cb702-2321"><a href="#cb702-2321" aria-hidden="true" tabindex="-1"></a>  <span class="at">Alpha =</span> <span class="fu">c</span>(alpha_result<span class="sc">$</span>total<span class="sc">$</span>raw_alpha, </span>
<span id="cb702-2322"><a href="#cb702-2322" aria-hidden="true" tabindex="-1"></a>            alpha_revised<span class="sc">$</span>total<span class="sc">$</span>raw_alpha),</span>
<span id="cb702-2323"><a href="#cb702-2323" aria-hidden="true" tabindex="-1"></a>  <span class="at">CI_Lower =</span> <span class="fu">c</span>(alpha_result<span class="sc">$</span>feldt<span class="sc">$</span>lower.ci,</span>
<span id="cb702-2324"><a href="#cb702-2324" aria-hidden="true" tabindex="-1"></a>               alpha_revised<span class="sc">$</span>feldt<span class="sc">$</span>lower.ci),</span>
<span id="cb702-2325"><a href="#cb702-2325" aria-hidden="true" tabindex="-1"></a>  <span class="at">CI_Upper =</span> <span class="fu">c</span>(alpha_result<span class="sc">$</span>feldt<span class="sc">$</span>upper.ci,</span>
<span id="cb702-2326"><a href="#cb702-2326" aria-hidden="true" tabindex="-1"></a>               alpha_revised<span class="sc">$</span>feldt<span class="sc">$</span>upper.ci),</span>
<span id="cb702-2327"><a href="#cb702-2327" aria-hidden="true" tabindex="-1"></a>  <span class="at">Mean_r =</span> <span class="fu">c</span>(alpha_result<span class="sc">$</span>total<span class="sc">$</span>average_r,</span>
<span id="cb702-2328"><a href="#cb702-2328" aria-hidden="true" tabindex="-1"></a>             alpha_revised<span class="sc">$</span>total<span class="sc">$</span>average_r)</span>
<span id="cb702-2329"><a href="#cb702-2329" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb702-2330"><a href="#cb702-2330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2331"><a href="#cb702-2331" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(comparison)</span>
<span id="cb702-2332"><a href="#cb702-2332" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-2333"><a href="#cb702-2333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2334"><a href="#cb702-2334" aria-hidden="true" tabindex="-1"></a>**Checkpoint:** Revised alpha should improve (e.g., from 0.65 to 0.78), with all item-total correlations now &gt; 0.30.</span>
<span id="cb702-2335"><a href="#cb702-2335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2336"><a href="#cb702-2336" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-2337"><a href="#cb702-2337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2338"><a href="#cb702-2338" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 7: Final Scale Scoring</span></span>
<span id="cb702-2339"><a href="#cb702-2339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2340"><a href="#cb702-2340" aria-hidden="true" tabindex="-1"></a>Calculate total scores for the refined 5-item scale:</span>
<span id="cb702-2341"><a href="#cb702-2341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2342"><a href="#cb702-2342" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lab7-scoring}</span></span>
<span id="cb702-2343"><a href="#cb702-2343" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate total scores</span></span>
<span id="cb702-2344"><a href="#cb702-2344" aria-hidden="true" tabindex="-1"></a>job_data_scored <span class="ot">&lt;-</span> job_data <span class="sc">%&gt;%</span></span>
<span id="cb702-2345"><a href="#cb702-2345" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb702-2346"><a href="#cb702-2346" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_score_original =</span> <span class="fu">rowSums</span>(<span class="fu">select</span>(., <span class="fu">starts_with</span>(<span class="st">"item"</span>))),</span>
<span id="cb702-2347"><a href="#cb702-2347" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_score_revised =</span> <span class="fu">rowSums</span>(<span class="fu">select</span>(., item1, item2, item4, item5, item6)),</span>
<span id="cb702-2348"><a href="#cb702-2348" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_score_revised =</span> total_score_revised <span class="sc">/</span> <span class="dv">5</span></span>
<span id="cb702-2349"><a href="#cb702-2349" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb702-2350"><a href="#cb702-2350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2351"><a href="#cb702-2351" aria-hidden="true" tabindex="-1"></a><span class="co"># Descriptive statistics for final scale</span></span>
<span id="cb702-2352"><a href="#cb702-2352" aria-hidden="true" tabindex="-1"></a>job_data_scored <span class="sc">%&gt;%</span></span>
<span id="cb702-2353"><a href="#cb702-2353" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb702-2354"><a href="#cb702-2354" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb702-2355"><a href="#cb702-2355" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean =</span> <span class="fu">mean</span>(mean_score_revised),</span>
<span id="cb702-2356"><a href="#cb702-2356" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd =</span> <span class="fu">sd</span>(mean_score_revised),</span>
<span id="cb702-2357"><a href="#cb702-2357" aria-hidden="true" tabindex="-1"></a>    <span class="at">min =</span> <span class="fu">min</span>(mean_score_revised),</span>
<span id="cb702-2358"><a href="#cb702-2358" aria-hidden="true" tabindex="-1"></a>    <span class="at">max =</span> <span class="fu">max</span>(mean_score_revised)</span>
<span id="cb702-2359"><a href="#cb702-2359" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb702-2360"><a href="#cb702-2360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2361"><a href="#cb702-2361" aria-hidden="true" tabindex="-1"></a><span class="co"># Distribution of scores</span></span>
<span id="cb702-2362"><a href="#cb702-2362" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(job_data_scored, <span class="fu">aes</span>(<span class="at">x =</span> mean_score_revised)) <span class="sc">+</span></span>
<span id="cb702-2363"><a href="#cb702-2363" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">10</span>, <span class="at">fill =</span> <span class="st">"skyblue"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb702-2364"><a href="#cb702-2364" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Job Satisfaction Scores (Revised Scale)"</span>,</span>
<span id="cb702-2365"><a href="#cb702-2365" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Mean Score (1-5)"</span>, <span class="at">y =</span> <span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb702-2366"><a href="#cb702-2366" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb702-2367"><a href="#cb702-2367" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-2368"><a href="#cb702-2368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2369"><a href="#cb702-2369" aria-hidden="true" tabindex="-1"></a>**Checkpoint:** Mean satisfaction score should be in reasonable range (e.g., 2.5-4.0 on 1-5 scale).</span>
<span id="cb702-2370"><a href="#cb702-2370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2371"><a href="#cb702-2371" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-2372"><a href="#cb702-2372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2373"><a href="#cb702-2373" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 8: Create Publication Table</span></span>
<span id="cb702-2374"><a href="#cb702-2374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2375"><a href="#cb702-2375" aria-hidden="true" tabindex="-1"></a>Summarize reliability analysis for reporting:</span>
<span id="cb702-2376"><a href="#cb702-2376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2377"><a href="#cb702-2377" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lab7-pub-table}</span></span>
<span id="cb702-2378"><a href="#cb702-2378" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb702-2379"><a href="#cb702-2379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2380"><a href="#cb702-2380" aria-hidden="true" tabindex="-1"></a><span class="co"># Item-level summary for revised scale</span></span>
<span id="cb702-2381"><a href="#cb702-2381" aria-hidden="true" tabindex="-1"></a>item_summary <span class="ot">&lt;-</span> alpha_revised<span class="sc">$</span>item.stats <span class="sc">%&gt;%</span></span>
<span id="cb702-2382"><a href="#cb702-2382" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"item"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb702-2383"><a href="#cb702-2383" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb702-2384"><a href="#cb702-2384" aria-hidden="true" tabindex="-1"></a>    <span class="at">Item_Label =</span> item_labels[item],</span>
<span id="cb702-2385"><a href="#cb702-2385" aria-hidden="true" tabindex="-1"></a>    <span class="at">M =</span> <span class="fu">round</span>(mean, <span class="dv">2</span>),</span>
<span id="cb702-2386"><a href="#cb702-2386" aria-hidden="true" tabindex="-1"></a>    <span class="at">SD =</span> <span class="fu">round</span>(sd, <span class="dv">2</span>),</span>
<span id="cb702-2387"><a href="#cb702-2387" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">r (item-total)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(r.cor, <span class="dv">2</span>)</span>
<span id="cb702-2388"><a href="#cb702-2388" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb702-2389"><a href="#cb702-2389" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(item, Item_Label, M, SD, <span class="st">`</span><span class="at">r (item-total)</span><span class="st">`</span>)</span>
<span id="cb702-2390"><a href="#cb702-2390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2391"><a href="#cb702-2391" aria-hidden="true" tabindex="-1"></a>item_summary <span class="sc">%&gt;%</span></span>
<span id="cb702-2392"><a href="#cb702-2392" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb702-2393"><a href="#cb702-2393" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb702-2394"><a href="#cb702-2394" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Job Satisfaction Scale: Item Analysis"</span>,</span>
<span id="cb702-2395"><a href="#cb702-2395" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Revised 5-Item Scale (n=25)"</span></span>
<span id="cb702-2396"><a href="#cb702-2396" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb702-2397"><a href="#cb702-2397" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_footnote</span>(</span>
<span id="cb702-2398"><a href="#cb702-2398" aria-hidden="true" tabindex="-1"></a>    <span class="at">footnote =</span> <span class="fu">sprintf</span>(<span class="st">"Cronbach's α = %.2f, 95%% CI [%.2f, %.2f]"</span>,</span>
<span id="cb702-2399"><a href="#cb702-2399" aria-hidden="true" tabindex="-1"></a>                       alpha_revised<span class="sc">$</span>total<span class="sc">$</span>raw_alpha,</span>
<span id="cb702-2400"><a href="#cb702-2400" aria-hidden="true" tabindex="-1"></a>                       alpha_revised<span class="sc">$</span>feldt<span class="sc">$</span>lower.ci,</span>
<span id="cb702-2401"><a href="#cb702-2401" aria-hidden="true" tabindex="-1"></a>                       alpha_revised<span class="sc">$</span>feldt<span class="sc">$</span>upper.ci),</span>
<span id="cb702-2402"><a href="#cb702-2402" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_column_labels</span>(<span class="at">columns =</span> <span class="st">"r (item-total)"</span>)</span>
<span id="cb702-2403"><a href="#cb702-2403" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb702-2404"><a href="#cb702-2404" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_footnote</span>(</span>
<span id="cb702-2405"><a href="#cb702-2405" aria-hidden="true" tabindex="-1"></a>    <span class="at">footnote =</span> <span class="st">"Item 3 removed due to low item-total correlation"</span>,</span>
<span id="cb702-2406"><a href="#cb702-2406" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_title</span>()</span>
<span id="cb702-2407"><a href="#cb702-2407" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb702-2408"><a href="#cb702-2408" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-2409"><a href="#cb702-2409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2410"><a href="#cb702-2410" aria-hidden="true" tabindex="-1"></a>**Checkpoint:** Professional table showing item statistics and reliability for the refined scale.</span>
<span id="cb702-2411"><a href="#cb702-2411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2412"><a href="#cb702-2412" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-2413"><a href="#cb702-2413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2414"><a href="#cb702-2414" aria-hidden="true" tabindex="-1"></a><span class="fu">### Discussion Questions</span></span>
<span id="cb702-2415"><a href="#cb702-2415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2416"><a href="#cb702-2416" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Acceptability Thresholds:** Is α = 0.78 acceptable for a pilot scale with n=25?</span>
<span id="cb702-2417"><a href="#cb702-2417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2418"><a href="#cb702-2418" aria-hidden="true" tabindex="-1"></a>   *Answer: Yes. For pilot research, α &gt; 0.70 is acceptable. The value 0.78 suggests adequate internal consistency. However, the wide CI (e.g., 0.65-0.88) reflects uncertainty due to small n.*</span>
<span id="cb702-2419"><a href="#cb702-2419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2420"><a href="#cb702-2420" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Item Deletion:** Should you always remove items with low item-total correlations?</span>
<span id="cb702-2421"><a href="#cb702-2421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2422"><a href="#cb702-2422" aria-hidden="true" tabindex="-1"></a>   *Answer: Not automatically. Consider (1) theoretical importance of the item, (2) whether it measures a different facet, (3) whether reverse-coding was done correctly, (4) impact on content validity. Sometimes low correlations indicate multidimensionality rather than bad items.*</span>
<span id="cb702-2423"><a href="#cb702-2423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2424"><a href="#cb702-2424" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Sample Size:** How does n=25 affect reliability estimates?</span>
<span id="cb702-2425"><a href="#cb702-2425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2426"><a href="#cb702-2426" aria-hidden="true" tabindex="-1"></a>   *Answer: Small samples produce wider confidence intervals and less stable estimates. Alpha can be inflated or deflated. Ideally, n&gt;100 for reliability studies, but pilot data (n=25-50) provide initial evidence.*</span>
<span id="cb702-2427"><a href="#cb702-2427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2428"><a href="#cb702-2428" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Alpha Limitations:** What are weaknesses of Cronbach's alpha?</span>
<span id="cb702-2429"><a href="#cb702-2429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2430"><a href="#cb702-2430" aria-hidden="true" tabindex="-1"></a>   *Answer: Assumes tau-equivalent model (equal item-total correlations), sensitive to number of items (more items → higher alpha), doesn't detect multidimensionality, can be high even with low inter-item correlations if many items.*</span>
<span id="cb702-2431"><a href="#cb702-2431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2432"><a href="#cb702-2432" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>**Reporting:** What should you include when reporting reliability?</span>
<span id="cb702-2433"><a href="#cb702-2433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2434"><a href="#cb702-2434" aria-hidden="true" tabindex="-1"></a>   *Answer: Cronbach's alpha, 95% CI, sample size, number of items, mean inter-item correlation, item-total correlations, and whether any items were deleted (with justification).*</span>
<span id="cb702-2435"><a href="#cb702-2435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2436"><a href="#cb702-2436" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-2437"><a href="#cb702-2437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2438"><a href="#cb702-2438" aria-hidden="true" tabindex="-1"></a><span class="fu">### Key Takeaways</span></span>
<span id="cb702-2439"><a href="#cb702-2439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2440"><a href="#cb702-2440" aria-hidden="true" tabindex="-1"></a>✓ **Cronbach's alpha assesses internal consistency** (typical goal: α &gt; 0.70)  </span>
<span id="cb702-2441"><a href="#cb702-2441" aria-hidden="true" tabindex="-1"></a>✓ **Item-total correlations** identify problematic items (threshold: r &gt; 0.30)  </span>
<span id="cb702-2442"><a href="#cb702-2442" aria-hidden="true" tabindex="-1"></a>✓ **"Alpha if deleted" analysis** guides scale refinement decisions  </span>
<span id="cb702-2443"><a href="#cb702-2443" aria-hidden="true" tabindex="-1"></a>✓ **Small samples (n&lt;50) produce wide CIs** for reliability estimates  </span>
<span id="cb702-2444"><a href="#cb702-2444" aria-hidden="true" tabindex="-1"></a>✓ **Item deletion must be justified theoretically**, not just statistically  </span>
<span id="cb702-2445"><a href="#cb702-2445" aria-hidden="true" tabindex="-1"></a>✓ **Always report confidence intervals** and sample size with alpha  </span>
<span id="cb702-2446"><a href="#cb702-2446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2447"><a href="#cb702-2447" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-2448"><a href="#cb702-2448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2449"><a href="#cb702-2449" aria-hidden="true" tabindex="-1"></a><span class="fu">### Homework Exercise</span></span>
<span id="cb702-2450"><a href="#cb702-2450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2451"><a href="#cb702-2451" aria-hidden="true" tabindex="-1"></a>**Dataset:** A 5-item Self-Efficacy Scale piloted with n=30 students.</span>
<span id="cb702-2452"><a href="#cb702-2452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2453"><a href="#cb702-2453" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lab7-homework-data}</span></span>
<span id="cb702-2454"><a href="#cb702-2454" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">456</span>)</span>
<span id="cb702-2455"><a href="#cb702-2455" aria-hidden="true" tabindex="-1"></a>efficacy_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb702-2456"><a href="#cb702-2456" aria-hidden="true" tabindex="-1"></a>  <span class="at">student_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>,</span>
<span id="cb702-2457"><a href="#cb702-2457" aria-hidden="true" tabindex="-1"></a>  <span class="at">item1 =</span> <span class="fu">sample</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">30</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.3</span>, <span class="fl">0.4</span>, <span class="fl">0.2</span>)),</span>
<span id="cb702-2458"><a href="#cb702-2458" aria-hidden="true" tabindex="-1"></a>  <span class="at">item2 =</span> <span class="fu">sample</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">30</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.4</span>, <span class="fl">0.3</span>)),</span>
<span id="cb702-2459"><a href="#cb702-2459" aria-hidden="true" tabindex="-1"></a>  <span class="at">item3 =</span> <span class="fu">sample</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">30</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span>)),</span>
<span id="cb702-2460"><a href="#cb702-2460" aria-hidden="true" tabindex="-1"></a>  <span class="at">item4 =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">30</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>)),  <span class="co"># Potentially problematic</span></span>
<span id="cb702-2461"><a href="#cb702-2461" aria-hidden="true" tabindex="-1"></a>  <span class="at">item5 =</span> <span class="fu">sample</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">30</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.3</span>, <span class="fl">0.4</span>))</span>
<span id="cb702-2462"><a href="#cb702-2462" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb702-2463"><a href="#cb702-2463" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-2464"><a href="#cb702-2464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2465"><a href="#cb702-2465" aria-hidden="true" tabindex="-1"></a>**Your Tasks:**</span>
<span id="cb702-2466"><a href="#cb702-2466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2467"><a href="#cb702-2467" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Create a correlation matrix heatmap for the 5 items</span>
<span id="cb702-2468"><a href="#cb702-2468" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Calculate Cronbach's alpha for the full 5-item scale</span>
<span id="cb702-2469"><a href="#cb702-2469" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Report alpha with 95% confidence interval</span>
<span id="cb702-2470"><a href="#cb702-2470" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Create a bar chart of corrected item-total correlations</span>
<span id="cb702-2471"><a href="#cb702-2471" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>Identify items with r &lt; 0.30</span>
<span id="cb702-2472"><a href="#cb702-2472" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span>Examine "alpha if item deleted" – would removing any item increase alpha?</span>
<span id="cb702-2473"><a href="#cb702-2473" aria-hidden="true" tabindex="-1"></a><span class="ss">7. </span>If needed, recompute alpha with problematic item(s) removed</span>
<span id="cb702-2474"><a href="#cb702-2474" aria-hidden="true" tabindex="-1"></a><span class="ss">8. </span>Create a comparison table (original vs revised scale)</span>
<span id="cb702-2475"><a href="#cb702-2475" aria-hidden="true" tabindex="-1"></a><span class="ss">9. </span>Calculate mean self-efficacy scores for the final scale</span>
<span id="cb702-2476"><a href="#cb702-2476" aria-hidden="true" tabindex="-1"></a><span class="ss">10. </span>Create a publication-ready table with item statistics and alpha</span>
<span id="cb702-2477"><a href="#cb702-2477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2478"><a href="#cb702-2478" aria-hidden="true" tabindex="-1"></a>**Expected Results:**</span>
<span id="cb702-2479"><a href="#cb702-2479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2480"><a href="#cb702-2480" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Original alpha approximately 0.72-0.78</span>
<span id="cb702-2481"><a href="#cb702-2481" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Item 4 may show lower item-total correlation (r ≈ 0.25-0.35)</span>
<span id="cb702-2482"><a href="#cb702-2482" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Removing item 4 might increase alpha to ~0.80-0.85</span>
<span id="cb702-2483"><a href="#cb702-2483" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Mean self-efficacy score: 3.0-3.5 on 1-5 scale</span>
<span id="cb702-2484"><a href="#cb702-2484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2485"><a href="#cb702-2485" aria-hidden="true" tabindex="-1"></a>**Hints:**</span>
<span id="cb702-2486"><a href="#cb702-2486" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Use <span class="in">`psych::alpha(items)`</span> for comprehensive output</span>
<span id="cb702-2487"><a href="#cb702-2487" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Check <span class="in">`alpha_result$item.stats`</span> for item-total correlations</span>
<span id="cb702-2488"><a href="#cb702-2488" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Check <span class="in">`alpha_result$alpha.drop`</span> for "alpha if deleted"</span>
<span id="cb702-2489"><a href="#cb702-2489" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Use <span class="in">`corrplot()`</span> for visualization</span>
<span id="cb702-2490"><a href="#cb702-2490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2491"><a href="#cb702-2491" aria-hidden="true" tabindex="-1"></a>**Bonus:** Calculate standardized alpha vs raw alpha. When are they different, and which should you report? How does scale length (number of items) affect alpha?</span>
<span id="cb702-2492"><a href="#cb702-2492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2493"><a href="#cb702-2493" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-2494"><a href="#cb702-2494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2495"><a href="#cb702-2495" aria-hidden="true" tabindex="-1"></a><span class="fu">## Lab 8: Power Analysis for Study Planning {#lab-power}</span></span>
<span id="cb702-2496"><a href="#cb702-2496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2497"><a href="#cb702-2497" aria-hidden="true" tabindex="-1"></a>**Learning Objectives:**</span>
<span id="cb702-2498"><a href="#cb702-2498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2499"><a href="#cb702-2499" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Calculate statistical power for t-tests and ANOVA</span>
<span id="cb702-2500"><a href="#cb702-2500" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Determine required sample size for desired power</span>
<span id="cb702-2501"><a href="#cb702-2501" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Create power curves visualizing power-sample size trade-offs</span>
<span id="cb702-2502"><a href="#cb702-2502" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Justify sample size decisions in research proposals</span>
<span id="cb702-2503"><a href="#cb702-2503" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Understand effect size estimation and Cohen's benchmarks</span>
<span id="cb702-2504"><a href="#cb702-2504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2505"><a href="#cb702-2505" aria-hidden="true" tabindex="-1"></a>**Scenario:** You're planning a randomized trial comparing a new therapy (treatment) vs standard care (control) on depression scores. You need to determine the required sample size to detect a meaningful effect with 80% power.</span>
<span id="cb702-2506"><a href="#cb702-2506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2507"><a href="#cb702-2507" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 1: Set Up and Define Parameters</span></span>
<span id="cb702-2508"><a href="#cb702-2508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2509"><a href="#cb702-2509" aria-hidden="true" tabindex="-1"></a>Specify effect size and significance level:</span>
<span id="cb702-2510"><a href="#cb702-2510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2511"><a href="#cb702-2511" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lab8-setup}</span></span>
<span id="cb702-2512"><a href="#cb702-2512" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb702-2513"><a href="#cb702-2513" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pwr)</span>
<span id="cb702-2514"><a href="#cb702-2514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2515"><a href="#cb702-2515" aria-hidden="true" tabindex="-1"></a><span class="co"># Define study parameters</span></span>
<span id="cb702-2516"><a href="#cb702-2516" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span>        <span class="co"># Significance level (two-tailed)</span></span>
<span id="cb702-2517"><a href="#cb702-2517" aria-hidden="true" tabindex="-1"></a>power_target <span class="ot">&lt;-</span> <span class="fl">0.80</span>  <span class="co"># Desired power (80%)</span></span>
<span id="cb702-2518"><a href="#cb702-2518" aria-hidden="true" tabindex="-1"></a>effect_size <span class="ot">&lt;-</span> <span class="fl">0.5</span>    <span class="co"># Cohen's d = 0.5 (medium effect)</span></span>
<span id="cb702-2519"><a href="#cb702-2519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2520"><a href="#cb702-2520" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Study Planning Parameters:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-2521"><a href="#cb702-2521" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Significance level (α):"</span>, alpha, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-2522"><a href="#cb702-2522" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Desired power (1-β):"</span>, power_target, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-2523"><a href="#cb702-2523" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Expected effect size (Cohen's d):"</span>, effect_size, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-2524"><a href="#cb702-2524" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Test type: Two-sample t-test (two-tailed)</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-2525"><a href="#cb702-2525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2526"><a href="#cb702-2526" aria-hidden="true" tabindex="-1"></a><span class="co"># Cohen's effect size benchmarks</span></span>
<span id="cb702-2527"><a href="#cb702-2527" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(</span>
<span id="cb702-2528"><a href="#cb702-2528" aria-hidden="true" tabindex="-1"></a>  <span class="at">Magnitude =</span> <span class="fu">c</span>(<span class="st">"Small"</span>, <span class="st">"Medium"</span>, <span class="st">"Large"</span>),</span>
<span id="cb702-2529"><a href="#cb702-2529" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Cohen's d</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.5</span>, <span class="fl">0.8</span>),</span>
<span id="cb702-2530"><a href="#cb702-2530" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Cohen's f (ANOVA)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.10</span>, <span class="fl">0.25</span>, <span class="fl">0.40</span>),</span>
<span id="cb702-2531"><a href="#cb702-2531" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">R² (Regression)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.09</span>, <span class="fl">0.25</span>)</span>
<span id="cb702-2532"><a href="#cb702-2532" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb702-2533"><a href="#cb702-2533" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-2534"><a href="#cb702-2534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2535"><a href="#cb702-2535" aria-hidden="true" tabindex="-1"></a>**Checkpoint:** You've defined α=0.05, power=0.80, and d=0.5 for planning.</span>
<span id="cb702-2536"><a href="#cb702-2536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2537"><a href="#cb702-2537" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-2538"><a href="#cb702-2538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2539"><a href="#cb702-2539" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 2: Calculate Required Sample Size</span></span>
<span id="cb702-2540"><a href="#cb702-2540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2541"><a href="#cb702-2541" aria-hidden="true" tabindex="-1"></a>Determine n per group for target power:</span>
<span id="cb702-2542"><a href="#cb702-2542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2543"><a href="#cb702-2543" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lab8-sample-size}</span></span>
<span id="cb702-2544"><a href="#cb702-2544" aria-hidden="true" tabindex="-1"></a><span class="co"># Power analysis for two-sample t-test</span></span>
<span id="cb702-2545"><a href="#cb702-2545" aria-hidden="true" tabindex="-1"></a>power_result <span class="ot">&lt;-</span> <span class="fu">pwr.t.test</span>(</span>
<span id="cb702-2546"><a href="#cb702-2546" aria-hidden="true" tabindex="-1"></a>  <span class="at">d =</span> effect_size,</span>
<span id="cb702-2547"><a href="#cb702-2547" aria-hidden="true" tabindex="-1"></a>  <span class="at">sig.level =</span> alpha,</span>
<span id="cb702-2548"><a href="#cb702-2548" aria-hidden="true" tabindex="-1"></a>  <span class="at">power =</span> power_target,</span>
<span id="cb702-2549"><a href="#cb702-2549" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"two.sample"</span>,</span>
<span id="cb702-2550"><a href="#cb702-2550" aria-hidden="true" tabindex="-1"></a>  <span class="at">alternative =</span> <span class="st">"two.sided"</span></span>
<span id="cb702-2551"><a href="#cb702-2551" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb702-2552"><a href="#cb702-2552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2553"><a href="#cb702-2553" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(power_result)</span>
<span id="cb702-2554"><a href="#cb702-2554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2555"><a href="#cb702-2555" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract required n per group</span></span>
<span id="cb702-2556"><a href="#cb702-2556" aria-hidden="true" tabindex="-1"></a>n_per_group <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(power_result<span class="sc">$</span>n)</span>
<span id="cb702-2557"><a href="#cb702-2557" aria-hidden="true" tabindex="-1"></a>total_n <span class="ot">&lt;-</span> n_per_group <span class="sc">*</span> <span class="dv">2</span></span>
<span id="cb702-2558"><a href="#cb702-2558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2559"><a href="#cb702-2559" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Required Sample Size:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-2560"><a href="#cb702-2560" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Per group:"</span>, n_per_group, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-2561"><a href="#cb702-2561" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Total:"</span>, total_n, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-2562"><a href="#cb702-2562" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"- To detect d=%.1f with %.0f%% power at α=%.2f</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb702-2563"><a href="#cb702-2563" aria-hidden="true" tabindex="-1"></a>            effect_size, power_target<span class="sc">*</span><span class="dv">100</span>, alpha))</span>
<span id="cb702-2564"><a href="#cb702-2564" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-2565"><a href="#cb702-2565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2566"><a href="#cb702-2566" aria-hidden="true" tabindex="-1"></a>**Checkpoint:** For d=0.5, you should need approximately n=64 per group (128 total).</span>
<span id="cb702-2567"><a href="#cb702-2567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2568"><a href="#cb702-2568" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-2569"><a href="#cb702-2569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2570"><a href="#cb702-2570" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 3: Create Power Curves</span></span>
<span id="cb702-2571"><a href="#cb702-2571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2572"><a href="#cb702-2572" aria-hidden="true" tabindex="-1"></a>Visualize power as a function of sample size:</span>
<span id="cb702-2573"><a href="#cb702-2573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2574"><a href="#cb702-2574" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lab8-power-curves}</span></span>
<span id="cb702-2575"><a href="#cb702-2575" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate power curves for different effect sizes</span></span>
<span id="cb702-2576"><a href="#cb702-2576" aria-hidden="true" tabindex="-1"></a>sample_sizes <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">10</span>, <span class="dv">150</span>, <span class="at">by =</span> <span class="dv">5</span>)</span>
<span id="cb702-2577"><a href="#cb702-2577" aria-hidden="true" tabindex="-1"></a>effect_sizes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.5</span>, <span class="fl">0.8</span>)</span>
<span id="cb702-2578"><a href="#cb702-2578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2579"><a href="#cb702-2579" aria-hidden="true" tabindex="-1"></a>power_curves <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(</span>
<span id="cb702-2580"><a href="#cb702-2580" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> sample_sizes,</span>
<span id="cb702-2581"><a href="#cb702-2581" aria-hidden="true" tabindex="-1"></a>  <span class="at">d =</span> effect_sizes</span>
<span id="cb702-2582"><a href="#cb702-2582" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb702-2583"><a href="#cb702-2583" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb702-2584"><a href="#cb702-2584" aria-hidden="true" tabindex="-1"></a>    <span class="at">power =</span> <span class="fu">map2_dbl</span>(d, n, <span class="sc">~</span><span class="fu">pwr.t.test</span>(</span>
<span id="cb702-2585"><a href="#cb702-2585" aria-hidden="true" tabindex="-1"></a>      <span class="at">d =</span> .x, <span class="at">n =</span> .y, <span class="at">sig.level =</span> alpha,</span>
<span id="cb702-2586"><a href="#cb702-2586" aria-hidden="true" tabindex="-1"></a>      <span class="at">type =</span> <span class="st">"two.sample"</span>, <span class="at">alternative =</span> <span class="st">"two.sided"</span></span>
<span id="cb702-2587"><a href="#cb702-2587" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">$</span>power)</span>
<span id="cb702-2588"><a href="#cb702-2588" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb702-2589"><a href="#cb702-2589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2590"><a href="#cb702-2590" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot power curves</span></span>
<span id="cb702-2591"><a href="#cb702-2591" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(power_curves, <span class="fu">aes</span>(<span class="at">x =</span> n, <span class="at">y =</span> power, <span class="at">color =</span> <span class="fu">factor</span>(d))) <span class="sc">+</span></span>
<span id="cb702-2592"><a href="#cb702-2592" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb702-2593"><a href="#cb702-2593" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.80</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb702-2594"><a href="#cb702-2594" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> n_per_group, <span class="at">linetype =</span> <span class="st">"dotted"</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb702-2595"><a href="#cb702-2595" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb702-2596"><a href="#cb702-2596" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"green"</span>, <span class="st">"blue"</span>, <span class="st">"purple"</span>),</span>
<span id="cb702-2597"><a href="#cb702-2597" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"d=0.2 (small)"</span>, <span class="st">"d=0.5 (medium)"</span>, <span class="st">"d=0.8 (large)"</span>)</span>
<span id="cb702-2598"><a href="#cb702-2598" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb702-2599"><a href="#cb702-2599" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb702-2600"><a href="#cb702-2600" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Power Curves for Two-Sample t-Test"</span>,</span>
<span id="cb702-2601"><a href="#cb702-2601" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">sprintf</span>(<span class="st">"α=%.2f, two-tailed"</span>, alpha),</span>
<span id="cb702-2602"><a href="#cb702-2602" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Sample Size (per group)"</span>,</span>
<span id="cb702-2603"><a href="#cb702-2603" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Statistical Power (1-β)"</span>,</span>
<span id="cb702-2604"><a href="#cb702-2604" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Effect Size"</span></span>
<span id="cb702-2605"><a href="#cb702-2605" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb702-2606"><a href="#cb702-2606" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb702-2607"><a href="#cb702-2607" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb702-2608"><a href="#cb702-2608" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-2609"><a href="#cb702-2609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2610"><a href="#cb702-2610" aria-hidden="true" tabindex="-1"></a>**Checkpoint:** Power increases with larger n and larger effect sizes. Red line shows 80% power threshold.</span>
<span id="cb702-2611"><a href="#cb702-2611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2612"><a href="#cb702-2612" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-2613"><a href="#cb702-2613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2614"><a href="#cb702-2614" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 4: Explore Effect of Alpha on Power</span></span>
<span id="cb702-2615"><a href="#cb702-2615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2616"><a href="#cb702-2616" aria-hidden="true" tabindex="-1"></a>Compare power with different significance levels:</span>
<span id="cb702-2617"><a href="#cb702-2617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2618"><a href="#cb702-2618" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lab8-alpha-power}</span></span>
<span id="cb702-2619"><a href="#cb702-2619" aria-hidden="true" tabindex="-1"></a><span class="co"># Power for different alpha levels</span></span>
<span id="cb702-2620"><a href="#cb702-2620" aria-hidden="true" tabindex="-1"></a>alphas <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="fl">0.10</span>)</span>
<span id="cb702-2621"><a href="#cb702-2621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2622"><a href="#cb702-2622" aria-hidden="true" tabindex="-1"></a>alpha_comparison <span class="ot">&lt;-</span> <span class="fu">map_df</span>(alphas, <span class="cf">function</span>(a) {</span>
<span id="cb702-2623"><a href="#cb702-2623" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">pwr.t.test</span>(</span>
<span id="cb702-2624"><a href="#cb702-2624" aria-hidden="true" tabindex="-1"></a>    <span class="at">d =</span> effect_size,</span>
<span id="cb702-2625"><a href="#cb702-2625" aria-hidden="true" tabindex="-1"></a>    <span class="at">sig.level =</span> a,</span>
<span id="cb702-2626"><a href="#cb702-2626" aria-hidden="true" tabindex="-1"></a>    <span class="at">power =</span> power_target,</span>
<span id="cb702-2627"><a href="#cb702-2627" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">"two.sample"</span></span>
<span id="cb702-2628"><a href="#cb702-2628" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb702-2629"><a href="#cb702-2629" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb702-2630"><a href="#cb702-2630" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> a,</span>
<span id="cb702-2631"><a href="#cb702-2631" aria-hidden="true" tabindex="-1"></a>    <span class="at">required_n =</span> <span class="fu">ceiling</span>(result<span class="sc">$</span>n),</span>
<span id="cb702-2632"><a href="#cb702-2632" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_n =</span> <span class="fu">ceiling</span>(result<span class="sc">$</span>n) <span class="sc">*</span> <span class="dv">2</span></span>
<span id="cb702-2633"><a href="#cb702-2633" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb702-2634"><a href="#cb702-2634" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb702-2635"><a href="#cb702-2635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2636"><a href="#cb702-2636" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(alpha_comparison)</span>
<span id="cb702-2637"><a href="#cb702-2637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2638"><a href="#cb702-2638" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization</span></span>
<span id="cb702-2639"><a href="#cb702-2639" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(alpha_comparison, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(alpha), <span class="at">y =</span> required_n)) <span class="sc">+</span></span>
<span id="cb702-2640"><a href="#cb702-2640" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb702-2641"><a href="#cb702-2641" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> required_n), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb702-2642"><a href="#cb702-2642" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb702-2643"><a href="#cb702-2643" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Required Sample Size vs Significance Level"</span>,</span>
<span id="cb702-2644"><a href="#cb702-2644" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">sprintf</span>(<span class="st">"For d=%.1f and power=%.0f%%"</span>, </span>
<span id="cb702-2645"><a href="#cb702-2645" aria-hidden="true" tabindex="-1"></a>                      effect_size, power_target<span class="sc">*</span><span class="dv">100</span>),</span>
<span id="cb702-2646"><a href="#cb702-2646" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Significance Level (α)"</span>,</span>
<span id="cb702-2647"><a href="#cb702-2647" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Required n per Group"</span></span>
<span id="cb702-2648"><a href="#cb702-2648" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb702-2649"><a href="#cb702-2649" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb702-2650"><a href="#cb702-2650" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-2651"><a href="#cb702-2651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2652"><a href="#cb702-2652" aria-hidden="true" tabindex="-1"></a>**Checkpoint:** More stringent α (e.g., 0.01) requires larger samples to maintain 80% power.</span>
<span id="cb702-2653"><a href="#cb702-2653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2654"><a href="#cb702-2654" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-2655"><a href="#cb702-2655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2656"><a href="#cb702-2656" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 5: ANOVA Power Analysis</span></span>
<span id="cb702-2657"><a href="#cb702-2657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2658"><a href="#cb702-2658" aria-hidden="true" tabindex="-1"></a>Calculate power for one-way ANOVA with multiple groups:</span>
<span id="cb702-2659"><a href="#cb702-2659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2660"><a href="#cb702-2660" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lab8-anova}</span></span>
<span id="cb702-2661"><a href="#cb702-2661" aria-hidden="true" tabindex="-1"></a><span class="co"># Scenario: Compare 3 groups (Control, Treatment A, Treatment B)</span></span>
<span id="cb702-2662"><a href="#cb702-2662" aria-hidden="true" tabindex="-1"></a>k_groups <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb702-2663"><a href="#cb702-2663" aria-hidden="true" tabindex="-1"></a>effect_size_anova <span class="ot">&lt;-</span> <span class="fl">0.25</span>  <span class="co"># Cohen's f = 0.25 (medium effect for ANOVA)</span></span>
<span id="cb702-2664"><a href="#cb702-2664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2665"><a href="#cb702-2665" aria-hidden="true" tabindex="-1"></a><span class="co"># Power analysis for ANOVA</span></span>
<span id="cb702-2666"><a href="#cb702-2666" aria-hidden="true" tabindex="-1"></a>anova_result <span class="ot">&lt;-</span> <span class="fu">pwr.anova.test</span>(</span>
<span id="cb702-2667"><a href="#cb702-2667" aria-hidden="true" tabindex="-1"></a>  <span class="at">k =</span> k_groups,</span>
<span id="cb702-2668"><a href="#cb702-2668" aria-hidden="true" tabindex="-1"></a>  <span class="at">f =</span> effect_size_anova,</span>
<span id="cb702-2669"><a href="#cb702-2669" aria-hidden="true" tabindex="-1"></a>  <span class="at">sig.level =</span> alpha,</span>
<span id="cb702-2670"><a href="#cb702-2670" aria-hidden="true" tabindex="-1"></a>  <span class="at">power =</span> power_target</span>
<span id="cb702-2671"><a href="#cb702-2671" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb702-2672"><a href="#cb702-2672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2673"><a href="#cb702-2673" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(anova_result)</span>
<span id="cb702-2674"><a href="#cb702-2674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2675"><a href="#cb702-2675" aria-hidden="true" tabindex="-1"></a>n_per_group_anova <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(anova_result<span class="sc">$</span>n)</span>
<span id="cb702-2676"><a href="#cb702-2676" aria-hidden="true" tabindex="-1"></a>total_n_anova <span class="ot">&lt;-</span> n_per_group_anova <span class="sc">*</span> k_groups</span>
<span id="cb702-2677"><a href="#cb702-2677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2678"><a href="#cb702-2678" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">ANOVA Sample Size:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-2679"><a href="#cb702-2679" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Groups:"</span>, k_groups, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-2680"><a href="#cb702-2680" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Per group:"</span>, n_per_group_anova, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-2681"><a href="#cb702-2681" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Total:"</span>, total_n_anova, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-2682"><a href="#cb702-2682" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-2683"><a href="#cb702-2683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2684"><a href="#cb702-2684" aria-hidden="true" tabindex="-1"></a>**Checkpoint:** For f=0.25 and 3 groups, you should need approximately n=52 per group (156 total).</span>
<span id="cb702-2685"><a href="#cb702-2685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2686"><a href="#cb702-2686" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-2687"><a href="#cb702-2687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2688"><a href="#cb702-2688" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 6: Post-Hoc Power Analysis (Observed Effect)</span></span>
<span id="cb702-2689"><a href="#cb702-2689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2690"><a href="#cb702-2690" aria-hidden="true" tabindex="-1"></a>Suppose you conducted a pilot study (n=20 per group) and observed d=0.45. What was achieved power?</span>
<span id="cb702-2691"><a href="#cb702-2691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2692"><a href="#cb702-2692" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lab8-posthoc}</span></span>
<span id="cb702-2693"><a href="#cb702-2693" aria-hidden="true" tabindex="-1"></a><span class="co"># Pilot study parameters</span></span>
<span id="cb702-2694"><a href="#cb702-2694" aria-hidden="true" tabindex="-1"></a>pilot_n <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb702-2695"><a href="#cb702-2695" aria-hidden="true" tabindex="-1"></a>observed_d <span class="ot">&lt;-</span> <span class="fl">0.45</span></span>
<span id="cb702-2696"><a href="#cb702-2696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2697"><a href="#cb702-2697" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate achieved power</span></span>
<span id="cb702-2698"><a href="#cb702-2698" aria-hidden="true" tabindex="-1"></a>achieved_power <span class="ot">&lt;-</span> <span class="fu">pwr.t.test</span>(</span>
<span id="cb702-2699"><a href="#cb702-2699" aria-hidden="true" tabindex="-1"></a>  <span class="at">d =</span> observed_d,</span>
<span id="cb702-2700"><a href="#cb702-2700" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> pilot_n,</span>
<span id="cb702-2701"><a href="#cb702-2701" aria-hidden="true" tabindex="-1"></a>  <span class="at">sig.level =</span> alpha,</span>
<span id="cb702-2702"><a href="#cb702-2702" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"two.sample"</span>,</span>
<span id="cb702-2703"><a href="#cb702-2703" aria-hidden="true" tabindex="-1"></a>  <span class="at">alternative =</span> <span class="st">"two.sided"</span></span>
<span id="cb702-2704"><a href="#cb702-2704" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb702-2705"><a href="#cb702-2705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2706"><a href="#cb702-2706" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(achieved_power)</span>
<span id="cb702-2707"><a href="#cb702-2707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2708"><a href="#cb702-2708" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Pilot Study Power:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-2709"><a href="#cb702-2709" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Sample size:"</span>, pilot_n, <span class="st">"per group</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-2710"><a href="#cb702-2710" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Observed effect:"</span>, observed_d, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-2711"><a href="#cb702-2711" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Achieved power:"</span>, <span class="fu">round</span>(achieved_power<span class="sc">$</span>power, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-2712"><a href="#cb702-2712" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Interpretation:"</span>, </span>
<span id="cb702-2713"><a href="#cb702-2713" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ifelse</span>(achieved_power<span class="sc">$</span>power <span class="sc">&lt;</span> <span class="fl">0.80</span>, </span>
<span id="cb702-2714"><a href="#cb702-2714" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Underpowered - consider larger sample for main study"</span>,</span>
<span id="cb702-2715"><a href="#cb702-2715" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Adequately powered"</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-2716"><a href="#cb702-2716" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-2717"><a href="#cb702-2717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2718"><a href="#cb702-2718" aria-hidden="true" tabindex="-1"></a>**Checkpoint:** With n=20 and d=0.45, power is only ~0.35 (35%), indicating the pilot was underpowered.</span>
<span id="cb702-2719"><a href="#cb702-2719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2720"><a href="#cb702-2720" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-2721"><a href="#cb702-2721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2722"><a href="#cb702-2722" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 7: Sensitivity Analysis</span></span>
<span id="cb702-2723"><a href="#cb702-2723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2724"><a href="#cb702-2724" aria-hidden="true" tabindex="-1"></a>For a fixed sample size, what is the minimum detectable effect (MDE)?</span>
<span id="cb702-2725"><a href="#cb702-2725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2726"><a href="#cb702-2726" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lab8-sensitivity}</span></span>
<span id="cb702-2727"><a href="#cb702-2727" aria-hidden="true" tabindex="-1"></a><span class="co"># Available sample: n=40 per group</span></span>
<span id="cb702-2728"><a href="#cb702-2728" aria-hidden="true" tabindex="-1"></a>available_n <span class="ot">&lt;-</span> <span class="dv">40</span></span>
<span id="cb702-2729"><a href="#cb702-2729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2730"><a href="#cb702-2730" aria-hidden="true" tabindex="-1"></a><span class="co"># Minimum detectable effect with 80% power</span></span>
<span id="cb702-2731"><a href="#cb702-2731" aria-hidden="true" tabindex="-1"></a>mde_result <span class="ot">&lt;-</span> <span class="fu">pwr.t.test</span>(</span>
<span id="cb702-2732"><a href="#cb702-2732" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> available_n,</span>
<span id="cb702-2733"><a href="#cb702-2733" aria-hidden="true" tabindex="-1"></a>  <span class="at">sig.level =</span> alpha,</span>
<span id="cb702-2734"><a href="#cb702-2734" aria-hidden="true" tabindex="-1"></a>  <span class="at">power =</span> power_target,</span>
<span id="cb702-2735"><a href="#cb702-2735" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"two.sample"</span>,</span>
<span id="cb702-2736"><a href="#cb702-2736" aria-hidden="true" tabindex="-1"></a>  <span class="at">alternative =</span> <span class="st">"two.sided"</span></span>
<span id="cb702-2737"><a href="#cb702-2737" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb702-2738"><a href="#cb702-2738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2739"><a href="#cb702-2739" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(mde_result)</span>
<span id="cb702-2740"><a href="#cb702-2740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2741"><a href="#cb702-2741" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Sensitivity Analysis:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-2742"><a href="#cb702-2742" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Available sample:"</span>, available_n, <span class="st">"per group</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-2743"><a href="#cb702-2743" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Minimum detectable effect (80% power):"</span>, <span class="fu">round</span>(mde_result<span class="sc">$</span>d, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-2744"><a href="#cb702-2744" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Interpretation: Can detect effects of d ≥"</span>, </span>
<span id="cb702-2745"><a href="#cb702-2745" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(mde_result<span class="sc">$</span>d, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-2746"><a href="#cb702-2746" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-2747"><a href="#cb702-2747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2748"><a href="#cb702-2748" aria-hidden="true" tabindex="-1"></a>**Checkpoint:** With n=40 per group, you can detect effects of d≥0.64 with 80% power (between medium and large).</span>
<span id="cb702-2749"><a href="#cb702-2749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2750"><a href="#cb702-2750" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-2751"><a href="#cb702-2751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2752"><a href="#cb702-2752" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 8: Create Sample Size Justification</span></span>
<span id="cb702-2753"><a href="#cb702-2753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2754"><a href="#cb702-2754" aria-hidden="true" tabindex="-1"></a>Write a formal justification for grant/ethics applications:</span>
<span id="cb702-2755"><a href="#cb702-2755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2756"><a href="#cb702-2756" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lab8-justification}</span></span>
<span id="cb702-2757"><a href="#cb702-2757" aria-hidden="true" tabindex="-1"></a><span class="co"># Final recommended sample size</span></span>
<span id="cb702-2758"><a href="#cb702-2758" aria-hidden="true" tabindex="-1"></a>recommended_n <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(power_result<span class="sc">$</span>n) <span class="sc">*</span> <span class="fl">1.15</span>  <span class="co"># Add 15% for attrition</span></span>
<span id="cb702-2759"><a href="#cb702-2759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2760"><a href="#cb702-2760" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"SAMPLE SIZE JUSTIFICATION</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-2761"><a href="#cb702-2761" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"===========================</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb702-2762"><a href="#cb702-2762" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Research Question: Does the new therapy reduce depression scores</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-2763"><a href="#cb702-2763" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"compared to standard care?</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb702-2764"><a href="#cb702-2764" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Statistical Test: Independent samples t-test (two-tailed)</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb702-2765"><a href="#cb702-2765" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Effect Size Estimation:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-2766"><a href="#cb702-2766" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Based on meta-analysis (Smith et al., 2023), similar therapies</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-2767"><a href="#cb702-2767" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  produce medium effects (d=0.50, range: 0.35-0.65)</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-2768"><a href="#cb702-2768" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- We conservatively assume d=0.50</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb702-2769"><a href="#cb702-2769" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Power Analysis:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-2770"><a href="#cb702-2770" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"- Significance level: α=%.2f</span><span class="sc">\n</span><span class="st">"</span>, alpha))</span>
<span id="cb702-2771"><a href="#cb702-2771" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"- Desired power: %.0f%%</span><span class="sc">\n</span><span class="st">"</span>, power_target<span class="sc">*</span><span class="dv">100</span>))</span>
<span id="cb702-2772"><a href="#cb702-2772" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"- Effect size: d=%.2f</span><span class="sc">\n</span><span class="st">"</span>, effect_size))</span>
<span id="cb702-2773"><a href="#cb702-2773" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"- Required sample: n=%d per group (%d total)</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb702-2774"><a href="#cb702-2774" aria-hidden="true" tabindex="-1"></a>            n_per_group, total_n))</span>
<span id="cb702-2775"><a href="#cb702-2775" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"- With 15%% attrition: n=%d per group (%d total)</span><span class="sc">\n\n</span><span class="st">"</span>,</span>
<span id="cb702-2776"><a href="#cb702-2776" aria-hidden="true" tabindex="-1"></a>            <span class="fu">ceiling</span>(recommended_n), <span class="fu">ceiling</span>(recommended_n)<span class="sc">*</span><span class="dv">2</span>))</span>
<span id="cb702-2777"><a href="#cb702-2777" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Justification:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-2778"><a href="#cb702-2778" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"This sample size provides 80% power to detect a medium effect (d=0.50)</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-2779"><a href="#cb702-2779" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"at the conventional α=0.05 significance level. We will recruit</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-2780"><a href="#cb702-2780" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"n=%d per group (accounting for expected 15%% dropout) to ensure</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb702-2781"><a href="#cb702-2781" aria-hidden="true" tabindex="-1"></a>            <span class="fu">ceiling</span>(recommended_n)))</span>
<span id="cb702-2782"><a href="#cb702-2782" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"adequate power for the primary analysis.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-2783"><a href="#cb702-2783" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-2784"><a href="#cb702-2784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2785"><a href="#cb702-2785" aria-hidden="true" tabindex="-1"></a>**Checkpoint:** Professional justification suitable for research proposals.</span>
<span id="cb702-2786"><a href="#cb702-2786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2787"><a href="#cb702-2787" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-2788"><a href="#cb702-2788" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2789"><a href="#cb702-2789" aria-hidden="true" tabindex="-1"></a><span class="fu">### Discussion Questions</span></span>
<span id="cb702-2790"><a href="#cb702-2790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2791"><a href="#cb702-2791" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**A Priori vs Post-Hoc:** Why is a priori power analysis preferred over post-hoc power analysis?</span>
<span id="cb702-2792"><a href="#cb702-2792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2793"><a href="#cb702-2793" aria-hidden="true" tabindex="-1"></a>   *Answer: A priori analysis plans sample size before data collection, maximizing power while minimizing resources. Post-hoc analysis is circular (uses observed effect), uninformative (you already know if the result is significant), and can mislead (low power with significant result suggests lucky sample).*</span>
<span id="cb702-2794"><a href="#cb702-2794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2795"><a href="#cb702-2795" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Effect Size Estimation:** How should you choose an effect size for planning?</span>
<span id="cb702-2796"><a href="#cb702-2796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2797"><a href="#cb702-2797" aria-hidden="true" tabindex="-1"></a>   *Answer: Base on (1) prior literature/meta-analyses, (2) pilot data, (3) smallest effect of practical interest (SESOI), (4) expert judgment. Be conservative – overestimating effect size leads to underpowered studies.*</span>
<span id="cb702-2798"><a href="#cb702-2798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2799"><a href="#cb702-2799" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Trade-offs:** If you can only recruit n=30 per group (not the required 64), what should you do?</span>
<span id="cb702-2800"><a href="#cb702-2800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2801"><a href="#cb702-2801" aria-hidden="true" tabindex="-1"></a>   *Answer: Options: (1) acknowledge lower power (report achieved power), (2) increase effect size claims (detect only larger effects), (3) use more powerful design (repeated measures), (4) collaborate to increase n, (5) delay until sufficient resources available.*</span>
<span id="cb702-2802"><a href="#cb702-2802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2803"><a href="#cb702-2803" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Multiple Comparisons:** How does power change with multiple outcome tests?</span>
<span id="cb702-2804"><a href="#cb702-2804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2805"><a href="#cb702-2805" aria-hidden="true" tabindex="-1"></a>   *Answer: Multiple comparisons require adjusted alpha (e.g., Bonferroni), which decreases power for each test. Need larger samples to maintain power when testing multiple hypotheses.*</span>
<span id="cb702-2806"><a href="#cb702-2806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2807"><a href="#cb702-2807" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>**Reporting:** What power information should you include in a paper?</span>
<span id="cb702-2808"><a href="#cb702-2808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2809"><a href="#cb702-2809" aria-hidden="true" tabindex="-1"></a>   *Answer: For planning: a priori power analysis with effect size justification. For results: achieved sample size, observed effect size with CI. Do NOT report post-hoc power for non-significant results (it's always low).*</span>
<span id="cb702-2810"><a href="#cb702-2810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2811"><a href="#cb702-2811" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-2812"><a href="#cb702-2812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2813"><a href="#cb702-2813" aria-hidden="true" tabindex="-1"></a><span class="fu">### Key Takeaways</span></span>
<span id="cb702-2814"><a href="#cb702-2814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2815"><a href="#cb702-2815" aria-hidden="true" tabindex="-1"></a>✓ **A priori power analysis guides sample size planning** before data collection  </span>
<span id="cb702-2816"><a href="#cb702-2816" aria-hidden="true" tabindex="-1"></a>✓ **Power depends on**: effect size, sample size, significance level, and test type  </span>
<span id="cb702-2817"><a href="#cb702-2817" aria-hidden="true" tabindex="-1"></a>✓ **80% power is conventional minimum**; 90% preferred when feasible  </span>
<span id="cb702-2818"><a href="#cb702-2818" aria-hidden="true" tabindex="-1"></a>✓ **Effect size estimation is critical** – base on literature, not wishful thinking  </span>
<span id="cb702-2819"><a href="#cb702-2819" aria-hidden="true" tabindex="-1"></a>✓ **Power curves visualize trade-offs** between n, effect size, and power  </span>
<span id="cb702-2820"><a href="#cb702-2820" aria-hidden="true" tabindex="-1"></a>✓ **Account for attrition** by recruiting 10-20% more than calculated n  </span>
<span id="cb702-2821"><a href="#cb702-2821" aria-hidden="true" tabindex="-1"></a>✓ **Underpowered studies are unethical** – they waste resources and participant time  </span>
<span id="cb702-2822"><a href="#cb702-2822" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2823"><a href="#cb702-2823" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-2824"><a href="#cb702-2824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2825"><a href="#cb702-2825" aria-hidden="true" tabindex="-1"></a><span class="fu">### Homework Exercise</span></span>
<span id="cb702-2826"><a href="#cb702-2826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2827"><a href="#cb702-2827" aria-hidden="true" tabindex="-1"></a>**Scenario:** You're planning a within-subjects study where n=25 participants complete a task before and after an intervention. You expect a medium effect (d=0.50) and want to know if this sample provides adequate power.</span>
<span id="cb702-2828"><a href="#cb702-2828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2829"><a href="#cb702-2829" aria-hidden="true" tabindex="-1"></a>**Your Tasks:**</span>
<span id="cb702-2830"><a href="#cb702-2830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2831"><a href="#cb702-2831" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Calculate power for a paired t-test with n=25, d=0.50, α=0.05</span>
<span id="cb702-2832"><a href="#cb702-2832" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Determine the required sample size for 80% power</span>
<span id="cb702-2833"><a href="#cb702-2833" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Create a power curve showing power vs n (n=10 to 50) for d=0.3, 0.5, 0.8</span>
<span id="cb702-2834"><a href="#cb702-2834" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Calculate the minimum detectable effect with n=25 and 80% power</span>
<span id="cb702-2835"><a href="#cb702-2835" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>Perform a sensitivity analysis: What power do you have to detect d=0.40 with n=25?</span>
<span id="cb702-2836"><a href="#cb702-2836" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span>Compare power for paired vs independent t-tests (use n=25 per group for independent)</span>
<span id="cb702-2837"><a href="#cb702-2837" aria-hidden="true" tabindex="-1"></a><span class="ss">7. </span>Create a table comparing required n for 70%, 80%, and 90% power (d=0.50)</span>
<span id="cb702-2838"><a href="#cb702-2838" aria-hidden="true" tabindex="-1"></a><span class="ss">8. </span>Write a 3-4 sentence sample size justification for a grant proposal</span>
<span id="cb702-2839"><a href="#cb702-2839" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2840"><a href="#cb702-2840" aria-hidden="true" tabindex="-1"></a>**Expected Results:**</span>
<span id="cb702-2841"><a href="#cb702-2841" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2842"><a href="#cb702-2842" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>With n=25 paired, d=0.50: power ≈ 0.85 (adequately powered)</span>
<span id="cb702-2843"><a href="#cb702-2843" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Required n for 80% power: approximately 27-34 (paired t-test)</span>
<span id="cb702-2844"><a href="#cb702-2844" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Minimum detectable effect: d ≈ 0.57-0.58</span>
<span id="cb702-2845"><a href="#cb702-2845" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Paired design is more powerful than independent (requires ~60% fewer participants)</span>
<span id="cb702-2846"><a href="#cb702-2846" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2847"><a href="#cb702-2847" aria-hidden="true" tabindex="-1"></a>**Hints:**</span>
<span id="cb702-2848"><a href="#cb702-2848" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Use <span class="in">`pwr.t.test()`</span> with <span class="in">`type = "paired"`</span> for within-subjects</span>
<span id="cb702-2849"><a href="#cb702-2849" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Use <span class="in">`map_df()`</span> or loops to create power curves over multiple n values</span>
<span id="cb702-2850"><a href="#cb702-2850" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>For sensitivity, solve for d given n and power</span>
<span id="cb702-2851"><a href="#cb702-2851" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2852"><a href="#cb702-2852" aria-hidden="true" tabindex="-1"></a>**Bonus:** Suppose you can only recruit n=20 (not 27). Should you proceed? Calculate the achieved power and interpret what this means for your ability to detect the expected effect. What alternatives might you consider?</span>
<span id="cb702-2853"><a href="#cb702-2853" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2854"><a href="#cb702-2854" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-2855"><a href="#cb702-2855" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2856"><a href="#cb702-2856" aria-hidden="true" tabindex="-1"></a><span class="fu">## Lab 9: Multiple Imputation with MICE {#lab-mice}</span></span>
<span id="cb702-2857"><a href="#cb702-2857" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2858"><a href="#cb702-2858" aria-hidden="true" tabindex="-1"></a>**Learning Objectives:**</span>
<span id="cb702-2859"><a href="#cb702-2859" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2860"><a href="#cb702-2860" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Identify missing data patterns and mechanisms (MCAR, MAR, MNAR)</span>
<span id="cb702-2861"><a href="#cb702-2861" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Perform multiple imputation using the MICE algorithm</span>
<span id="cb702-2862"><a href="#cb702-2862" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Assess convergence through trace plots and diagnostics</span>
<span id="cb702-2863"><a href="#cb702-2863" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Pool results across imputed datasets</span>
<span id="cb702-2864"><a href="#cb702-2864" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Compare complete-case vs multiple imputation analyses</span>
<span id="cb702-2865"><a href="#cb702-2865" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Report imputation procedures appropriately</span>
<span id="cb702-2866"><a href="#cb702-2866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2867"><a href="#cb702-2867" aria-hidden="true" tabindex="-1"></a>**Scenario:** You have survey data from n=50 employees measuring job satisfaction, stress, and performance. However, 20% of values are missing due to survey non-response. You'll use multiple imputation to handle missing data appropriately.</span>
<span id="cb702-2868"><a href="#cb702-2868" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2869"><a href="#cb702-2869" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 1: Set Up and Create Data with Missing Values</span></span>
<span id="cb702-2870"><a href="#cb702-2870" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2871"><a href="#cb702-2871" aria-hidden="true" tabindex="-1"></a>Create realistic dataset with missing data:</span>
<span id="cb702-2872"><a href="#cb702-2872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2873"><a href="#cb702-2873" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lab9-data}</span></span>
<span id="cb702-2874"><a href="#cb702-2874" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb702-2875"><a href="#cb702-2875" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mice)</span>
<span id="cb702-2876"><a href="#cb702-2876" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(naniar)  <span class="co"># For missing data visualization</span></span>
<span id="cb702-2877"><a href="#cb702-2877" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(VIM)     <span class="co"># For missing data patterns</span></span>
<span id="cb702-2878"><a href="#cb702-2878" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2879"><a href="#cb702-2879" aria-hidden="true" tabindex="-1"></a><span class="co"># Set seed for reproducibility</span></span>
<span id="cb702-2880"><a href="#cb702-2880" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb702-2881"><a href="#cb702-2881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2882"><a href="#cb702-2882" aria-hidden="true" tabindex="-1"></a><span class="co"># Complete data (for comparison later)</span></span>
<span id="cb702-2883"><a href="#cb702-2883" aria-hidden="true" tabindex="-1"></a>complete_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb702-2884"><a href="#cb702-2884" aria-hidden="true" tabindex="-1"></a>  <span class="at">employee_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>,</span>
<span id="cb702-2885"><a href="#cb702-2885" aria-hidden="true" tabindex="-1"></a>  <span class="at">age =</span> <span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="dv">35</span>, <span class="dv">8</span>)),</span>
<span id="cb702-2886"><a href="#cb702-2886" aria-hidden="true" tabindex="-1"></a>  <span class="at">tenure_years =</span> <span class="fu">round</span>(<span class="fu">runif</span>(<span class="dv">50</span>, <span class="dv">1</span>, <span class="dv">15</span>), <span class="dv">1</span>),</span>
<span id="cb702-2887"><a href="#cb702-2887" aria-hidden="true" tabindex="-1"></a>  <span class="at">job_satisfaction =</span> <span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="dv">70</span>, <span class="dv">12</span>)),</span>
<span id="cb702-2888"><a href="#cb702-2888" aria-hidden="true" tabindex="-1"></a>  <span class="at">stress_level =</span> <span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="dv">55</span>, <span class="dv">15</span>)),</span>
<span id="cb702-2889"><a href="#cb702-2889" aria-hidden="true" tabindex="-1"></a>  <span class="at">performance_score =</span> <span class="fu">round</span>(<span class="dv">60</span> <span class="sc">+</span> <span class="fl">0.3</span> <span class="sc">*</span> job_satisfaction <span class="sc">-</span> <span class="fl">0.2</span> <span class="sc">*</span> stress_level <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="dv">0</span>, <span class="dv">8</span>))</span>
<span id="cb702-2890"><a href="#cb702-2890" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb702-2891"><a href="#cb702-2891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2892"><a href="#cb702-2892" aria-hidden="true" tabindex="-1"></a><span class="co"># Introduce missing data (MAR mechanism)</span></span>
<span id="cb702-2893"><a href="#cb702-2893" aria-hidden="true" tabindex="-1"></a><span class="co"># Higher stress predicts missingness in job_satisfaction</span></span>
<span id="cb702-2894"><a href="#cb702-2894" aria-hidden="true" tabindex="-1"></a><span class="co"># Lower performance predicts missingness in stress_level</span></span>
<span id="cb702-2895"><a href="#cb702-2895" aria-hidden="true" tabindex="-1"></a>survey_data <span class="ot">&lt;-</span> complete_data <span class="sc">%&gt;%</span></span>
<span id="cb702-2896"><a href="#cb702-2896" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb702-2897"><a href="#cb702-2897" aria-hidden="true" tabindex="-1"></a>    <span class="at">job_satisfaction =</span> <span class="fu">if_else</span>(</span>
<span id="cb702-2898"><a href="#cb702-2898" aria-hidden="true" tabindex="-1"></a>      stress_level <span class="sc">&gt;</span> <span class="dv">60</span> <span class="sc">&amp;</span> <span class="fu">runif</span>(<span class="dv">50</span>) <span class="sc">&lt;</span> <span class="fl">0.3</span>, </span>
<span id="cb702-2899"><a href="#cb702-2899" aria-hidden="true" tabindex="-1"></a>      <span class="cn">NA_real_</span>, </span>
<span id="cb702-2900"><a href="#cb702-2900" aria-hidden="true" tabindex="-1"></a>      job_satisfaction</span>
<span id="cb702-2901"><a href="#cb702-2901" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb702-2902"><a href="#cb702-2902" aria-hidden="true" tabindex="-1"></a>    <span class="at">stress_level =</span> <span class="fu">if_else</span>(</span>
<span id="cb702-2903"><a href="#cb702-2903" aria-hidden="true" tabindex="-1"></a>      performance_score <span class="sc">&lt;</span> <span class="dv">65</span> <span class="sc">&amp;</span> <span class="fu">runif</span>(<span class="dv">50</span>) <span class="sc">&lt;</span> <span class="fl">0.25</span>,</span>
<span id="cb702-2904"><a href="#cb702-2904" aria-hidden="true" tabindex="-1"></a>      <span class="cn">NA_real_</span>,</span>
<span id="cb702-2905"><a href="#cb702-2905" aria-hidden="true" tabindex="-1"></a>      stress_level</span>
<span id="cb702-2906"><a href="#cb702-2906" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb702-2907"><a href="#cb702-2907" aria-hidden="true" tabindex="-1"></a>    <span class="at">performance_score =</span> <span class="fu">if_else</span>(</span>
<span id="cb702-2908"><a href="#cb702-2908" aria-hidden="true" tabindex="-1"></a>      <span class="fu">runif</span>(<span class="dv">50</span>) <span class="sc">&lt;</span> <span class="fl">0.15</span>,</span>
<span id="cb702-2909"><a href="#cb702-2909" aria-hidden="true" tabindex="-1"></a>      <span class="cn">NA_real_</span>,</span>
<span id="cb702-2910"><a href="#cb702-2910" aria-hidden="true" tabindex="-1"></a>      performance_score</span>
<span id="cb702-2911"><a href="#cb702-2911" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb702-2912"><a href="#cb702-2912" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb702-2913"><a href="#cb702-2913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2914"><a href="#cb702-2914" aria-hidden="true" tabindex="-1"></a><span class="co"># Missing data summary</span></span>
<span id="cb702-2915"><a href="#cb702-2915" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Missing Data Summary:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-2916"><a href="#cb702-2916" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(survey_data)</span>
<span id="cb702-2917"><a href="#cb702-2917" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2918"><a href="#cb702-2918" aria-hidden="true" tabindex="-1"></a><span class="co"># Proportion missing per variable</span></span>
<span id="cb702-2919"><a href="#cb702-2919" aria-hidden="true" tabindex="-1"></a><span class="fu">miss_var_summary</span>(survey_data)</span>
<span id="cb702-2920"><a href="#cb702-2920" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-2921"><a href="#cb702-2921" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2922"><a href="#cb702-2922" aria-hidden="true" tabindex="-1"></a>**Checkpoint:** You should have ~20% missing data across job_satisfaction, stress_level, and performance_score.</span>
<span id="cb702-2923"><a href="#cb702-2923" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2924"><a href="#cb702-2924" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-2925"><a href="#cb702-2925" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2926"><a href="#cb702-2926" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 2: Visualize Missing Data Patterns</span></span>
<span id="cb702-2927"><a href="#cb702-2927" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2928"><a href="#cb702-2928" aria-hidden="true" tabindex="-1"></a>Examine patterns and mechanisms:</span>
<span id="cb702-2929"><a href="#cb702-2929" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2930"><a href="#cb702-2930" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lab9-patterns}</span></span>
<span id="cb702-2931"><a href="#cb702-2931" aria-hidden="true" tabindex="-1"></a><span class="co"># Missing data pattern visualization</span></span>
<span id="cb702-2932"><a href="#cb702-2932" aria-hidden="true" tabindex="-1"></a><span class="fu">gg_miss_var</span>(survey_data) <span class="sc">+</span></span>
<span id="cb702-2933"><a href="#cb702-2933" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Missing Data by Variable"</span>)</span>
<span id="cb702-2934"><a href="#cb702-2934" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2935"><a href="#cb702-2935" aria-hidden="true" tabindex="-1"></a><span class="co"># Missing data pattern combinations</span></span>
<span id="cb702-2936"><a href="#cb702-2936" aria-hidden="true" tabindex="-1"></a>md_pattern <span class="ot">&lt;-</span> <span class="fu">md.pattern</span>(survey_data, <span class="at">rotate.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb702-2937"><a href="#cb702-2937" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2938"><a href="#cb702-2938" aria-hidden="true" tabindex="-1"></a><span class="co"># Upset plot showing missing combinations</span></span>
<span id="cb702-2939"><a href="#cb702-2939" aria-hidden="true" tabindex="-1"></a><span class="fu">gg_miss_upset</span>(survey_data)</span>
<span id="cb702-2940"><a href="#cb702-2940" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2941"><a href="#cb702-2941" aria-hidden="true" tabindex="-1"></a><span class="co"># Check relationships between missingness and observed values</span></span>
<span id="cb702-2942"><a href="#cb702-2942" aria-hidden="true" tabindex="-1"></a><span class="co"># Is missingness related to other variables? (MAR test)</span></span>
<span id="cb702-2943"><a href="#cb702-2943" aria-hidden="true" tabindex="-1"></a>survey_data <span class="sc">%&gt;%</span></span>
<span id="cb702-2944"><a href="#cb702-2944" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb702-2945"><a href="#cb702-2945" aria-hidden="true" tabindex="-1"></a>    <span class="at">satisfaction_missing =</span> <span class="fu">is.na</span>(job_satisfaction),</span>
<span id="cb702-2946"><a href="#cb702-2946" aria-hidden="true" tabindex="-1"></a>    <span class="at">stress_missing =</span> <span class="fu">is.na</span>(stress_level)</span>
<span id="cb702-2947"><a href="#cb702-2947" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb702-2948"><a href="#cb702-2948" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(satisfaction_missing) <span class="sc">%&gt;%</span></span>
<span id="cb702-2949"><a href="#cb702-2949" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb702-2950"><a href="#cb702-2950" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb702-2951"><a href="#cb702-2951" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_stress_observed =</span> <span class="fu">mean</span>(stress_level, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb702-2952"><a href="#cb702-2952" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_age =</span> <span class="fu">mean</span>(age, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb702-2953"><a href="#cb702-2953" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb702-2954"><a href="#cb702-2954" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-2955"><a href="#cb702-2955" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2956"><a href="#cb702-2956" aria-hidden="true" tabindex="-1"></a>**Checkpoint:** You should see that missingness is not completely random (MAR mechanism confirmed).</span>
<span id="cb702-2957"><a href="#cb702-2957" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2958"><a href="#cb702-2958" aria-hidden="true" tabindex="-1"></a>**Discussion:** What's the difference between MCAR (Missing Completely at Random), MAR (Missing at Random), and MNAR (Missing Not at Random)?</span>
<span id="cb702-2959"><a href="#cb702-2959" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2960"><a href="#cb702-2960" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-2961"><a href="#cb702-2961" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2962"><a href="#cb702-2962" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 3: Perform Multiple Imputation</span></span>
<span id="cb702-2963"><a href="#cb702-2963" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2964"><a href="#cb702-2964" aria-hidden="true" tabindex="-1"></a>Run MICE algorithm with m=20 imputations:</span>
<span id="cb702-2965"><a href="#cb702-2965" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2966"><a href="#cb702-2966" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lab9-impute}</span></span>
<span id="cb702-2967"><a href="#cb702-2967" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up imputation</span></span>
<span id="cb702-2968"><a href="#cb702-2968" aria-hidden="true" tabindex="-1"></a><span class="co"># Exclude employee_id from imputation model</span></span>
<span id="cb702-2969"><a href="#cb702-2969" aria-hidden="true" tabindex="-1"></a>impute_vars <span class="ot">&lt;-</span> survey_data <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>employee_id)</span>
<span id="cb702-2970"><a href="#cb702-2970" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2971"><a href="#cb702-2971" aria-hidden="true" tabindex="-1"></a><span class="co"># Run MICE</span></span>
<span id="cb702-2972"><a href="#cb702-2972" aria-hidden="true" tabindex="-1"></a><span class="co"># m = 20 imputed datasets</span></span>
<span id="cb702-2973"><a href="#cb702-2973" aria-hidden="true" tabindex="-1"></a><span class="co"># maxit = 20 iterations</span></span>
<span id="cb702-2974"><a href="#cb702-2974" aria-hidden="true" tabindex="-1"></a><span class="co"># method = "pmm" (predictive mean matching) for continuous variables</span></span>
<span id="cb702-2975"><a href="#cb702-2975" aria-hidden="true" tabindex="-1"></a>mice_result <span class="ot">&lt;-</span> <span class="fu">mice</span>(</span>
<span id="cb702-2976"><a href="#cb702-2976" aria-hidden="true" tabindex="-1"></a>  impute_vars,</span>
<span id="cb702-2977"><a href="#cb702-2977" aria-hidden="true" tabindex="-1"></a>  <span class="at">m =</span> <span class="dv">20</span>,</span>
<span id="cb702-2978"><a href="#cb702-2978" aria-hidden="true" tabindex="-1"></a>  <span class="at">maxit =</span> <span class="dv">20</span>,</span>
<span id="cb702-2979"><a href="#cb702-2979" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"pmm"</span>,</span>
<span id="cb702-2980"><a href="#cb702-2980" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">2025</span>,</span>
<span id="cb702-2981"><a href="#cb702-2981" aria-hidden="true" tabindex="-1"></a>  <span class="at">print =</span> <span class="cn">FALSE</span></span>
<span id="cb702-2982"><a href="#cb702-2982" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb702-2983"><a href="#cb702-2983" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2984"><a href="#cb702-2984" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary of imputation</span></span>
<span id="cb702-2985"><a href="#cb702-2985" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(mice_result)</span>
<span id="cb702-2986"><a href="#cb702-2986" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2987"><a href="#cb702-2987" aria-hidden="true" tabindex="-1"></a><span class="co"># Check imputation methods used</span></span>
<span id="cb702-2988"><a href="#cb702-2988" aria-hidden="true" tabindex="-1"></a>mice_result<span class="sc">$</span>method</span>
<span id="cb702-2989"><a href="#cb702-2989" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-2990"><a href="#cb702-2990" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2991"><a href="#cb702-2991" aria-hidden="true" tabindex="-1"></a>**Checkpoint:** MICE should complete 20 imputations with 20 iterations each. Method "pmm" used for continuous variables.</span>
<span id="cb702-2992"><a href="#cb702-2992" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2993"><a href="#cb702-2993" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-2994"><a href="#cb702-2994" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2995"><a href="#cb702-2995" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 4: Check Convergence Diagnostics</span></span>
<span id="cb702-2996"><a href="#cb702-2996" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2997"><a href="#cb702-2997" aria-hidden="true" tabindex="-1"></a>Assess whether MICE algorithm converged:</span>
<span id="cb702-2998"><a href="#cb702-2998" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-2999"><a href="#cb702-2999" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lab9-convergence}</span></span>
<span id="cb702-3000"><a href="#cb702-3000" aria-hidden="true" tabindex="-1"></a><span class="co"># Trace plots (should show mixing without trends)</span></span>
<span id="cb702-3001"><a href="#cb702-3001" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mice_result, <span class="fu">c</span>(<span class="st">"job_satisfaction"</span>, <span class="st">"stress_level"</span>, <span class="st">"performance_score"</span>))</span>
<span id="cb702-3002"><a href="#cb702-3002" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3003"><a href="#cb702-3003" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternative: ggplot version for publication</span></span>
<span id="cb702-3004"><a href="#cb702-3004" aria-hidden="true" tabindex="-1"></a>convergence_data <span class="ot">&lt;-</span> mice_result<span class="sc">$</span>chainMean <span class="sc">%&gt;%</span></span>
<span id="cb702-3005"><a href="#cb702-3005" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb702-3006"><a href="#cb702-3006" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">iteration =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb702-3007"><a href="#cb702-3007" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>iteration, <span class="at">names_to =</span> <span class="st">"variable"</span>, <span class="at">values_to =</span> <span class="st">"mean"</span>)</span>
<span id="cb702-3008"><a href="#cb702-3008" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3009"><a href="#cb702-3009" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(convergence_data, <span class="fu">aes</span>(<span class="at">x =</span> iteration, <span class="at">y =</span> mean, <span class="at">color =</span> variable)) <span class="sc">+</span></span>
<span id="cb702-3010"><a href="#cb702-3010" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb702-3011"><a href="#cb702-3011" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>variable, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb702-3012"><a href="#cb702-3012" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb702-3013"><a href="#cb702-3013" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"MICE Convergence: Trace Plots of Imputed Means"</span>,</span>
<span id="cb702-3014"><a href="#cb702-3014" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Lines should stabilize and mix (no trends)"</span>,</span>
<span id="cb702-3015"><a href="#cb702-3015" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Iteration"</span>, <span class="at">y =</span> <span class="st">"Mean of Imputed Values"</span></span>
<span id="cb702-3016"><a href="#cb702-3016" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb702-3017"><a href="#cb702-3017" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb702-3018"><a href="#cb702-3018" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb702-3019"><a href="#cb702-3019" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-3020"><a href="#cb702-3020" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3021"><a href="#cb702-3021" aria-hidden="true" tabindex="-1"></a>**Checkpoint:** Trace plots should show stable streams without upward/downward trends (convergence achieved).</span>
<span id="cb702-3022"><a href="#cb702-3022" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3023"><a href="#cb702-3023" aria-hidden="true" tabindex="-1"></a>**Discussion:** What would non-convergence look like? What should you do if chains don't converge?</span>
<span id="cb702-3024"><a href="#cb702-3024" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3025"><a href="#cb702-3025" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-3026"><a href="#cb702-3026" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3027"><a href="#cb702-3027" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 5: Inspect Imputed Values</span></span>
<span id="cb702-3028"><a href="#cb702-3028" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3029"><a href="#cb702-3029" aria-hidden="true" tabindex="-1"></a>Check plausibility of imputed data:</span>
<span id="cb702-3030"><a href="#cb702-3030" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3031"><a href="#cb702-3031" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lab9-inspect}</span></span>
<span id="cb702-3032"><a href="#cb702-3032" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare distributions: observed vs imputed</span></span>
<span id="cb702-3033"><a href="#cb702-3033" aria-hidden="true" tabindex="-1"></a><span class="fu">densityplot</span>(mice_result, <span class="sc">~</span>job_satisfaction <span class="sc">+</span> stress_level <span class="sc">+</span> performance_score)</span>
<span id="cb702-3034"><a href="#cb702-3034" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3035"><a href="#cb702-3035" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatterplot: observed (blue) vs imputed (red)</span></span>
<span id="cb702-3036"><a href="#cb702-3036" aria-hidden="true" tabindex="-1"></a><span class="fu">xyplot</span>(mice_result, </span>
<span id="cb702-3037"><a href="#cb702-3037" aria-hidden="true" tabindex="-1"></a>       job_satisfaction <span class="sc">~</span> stress_level <span class="sc">+</span> performance_score,</span>
<span id="cb702-3038"><a href="#cb702-3038" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">20</span>), </span>
<span id="cb702-3039"><a href="#cb702-3039" aria-hidden="true" tabindex="-1"></a>       <span class="at">cex =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">1.5</span>))</span>
<span id="cb702-3040"><a href="#cb702-3040" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3041"><a href="#cb702-3041" aria-hidden="true" tabindex="-1"></a><span class="co"># Numerical comparison</span></span>
<span id="cb702-3042"><a href="#cb702-3042" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract first imputed dataset</span></span>
<span id="cb702-3043"><a href="#cb702-3043" aria-hidden="true" tabindex="-1"></a>imputed_data_1 <span class="ot">&lt;-</span> <span class="fu">complete</span>(mice_result, <span class="dv">1</span>)</span>
<span id="cb702-3044"><a href="#cb702-3044" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3045"><a href="#cb702-3045" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare observed vs imputed distributions</span></span>
<span id="cb702-3046"><a href="#cb702-3046" aria-hidden="true" tabindex="-1"></a>comparison_summary <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb702-3047"><a href="#cb702-3047" aria-hidden="true" tabindex="-1"></a>  <span class="at">Variable =</span> <span class="fu">c</span>(<span class="st">"job_satisfaction"</span>, <span class="st">"stress_level"</span>, <span class="st">"performance_score"</span>),</span>
<span id="cb702-3048"><a href="#cb702-3048" aria-hidden="true" tabindex="-1"></a>  <span class="at">Observed_Mean =</span> <span class="fu">c</span>(</span>
<span id="cb702-3049"><a href="#cb702-3049" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mean</span>(survey_data<span class="sc">$</span>job_satisfaction, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb702-3050"><a href="#cb702-3050" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mean</span>(survey_data<span class="sc">$</span>stress_level, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb702-3051"><a href="#cb702-3051" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mean</span>(survey_data<span class="sc">$</span>performance_score, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb702-3052"><a href="#cb702-3052" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb702-3053"><a href="#cb702-3053" aria-hidden="true" tabindex="-1"></a>  <span class="at">Imputed_Mean =</span> <span class="fu">c</span>(</span>
<span id="cb702-3054"><a href="#cb702-3054" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mean</span>(imputed_data_1<span class="sc">$</span>job_satisfaction),</span>
<span id="cb702-3055"><a href="#cb702-3055" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mean</span>(imputed_data_1<span class="sc">$</span>stress_level),</span>
<span id="cb702-3056"><a href="#cb702-3056" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mean</span>(imputed_data_1<span class="sc">$</span>performance_score)</span>
<span id="cb702-3057"><a href="#cb702-3057" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb702-3058"><a href="#cb702-3058" aria-hidden="true" tabindex="-1"></a>  <span class="at">Observed_SD =</span> <span class="fu">c</span>(</span>
<span id="cb702-3059"><a href="#cb702-3059" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sd</span>(survey_data<span class="sc">$</span>job_satisfaction, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb702-3060"><a href="#cb702-3060" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sd</span>(survey_data<span class="sc">$</span>stress_level, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb702-3061"><a href="#cb702-3061" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sd</span>(survey_data<span class="sc">$</span>performance_score, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb702-3062"><a href="#cb702-3062" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb702-3063"><a href="#cb702-3063" aria-hidden="true" tabindex="-1"></a>  <span class="at">Imputed_SD =</span> <span class="fu">c</span>(</span>
<span id="cb702-3064"><a href="#cb702-3064" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sd</span>(imputed_data_1<span class="sc">$</span>job_satisfaction),</span>
<span id="cb702-3065"><a href="#cb702-3065" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sd</span>(imputed_data_1<span class="sc">$</span>stress_level),</span>
<span id="cb702-3066"><a href="#cb702-3066" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sd</span>(imputed_data_1<span class="sc">$</span>performance_score)</span>
<span id="cb702-3067"><a href="#cb702-3067" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb702-3068"><a href="#cb702-3068" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb702-3069"><a href="#cb702-3069" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3070"><a href="#cb702-3070" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(comparison_summary)</span>
<span id="cb702-3071"><a href="#cb702-3071" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-3072"><a href="#cb702-3072" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3073"><a href="#cb702-3073" aria-hidden="true" tabindex="-1"></a>**Checkpoint:** Imputed values should be plausible (within observed range) and distributions should be similar to observed data.</span>
<span id="cb702-3074"><a href="#cb702-3074" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3075"><a href="#cb702-3075" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-3076"><a href="#cb702-3076" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3077"><a href="#cb702-3077" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 6: Analyze Imputed Data and Pool Results</span></span>
<span id="cb702-3078"><a href="#cb702-3078" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3079"><a href="#cb702-3079" aria-hidden="true" tabindex="-1"></a>Fit regression model across all imputed datasets:</span>
<span id="cb702-3080"><a href="#cb702-3080" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3081"><a href="#cb702-3081" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lab9-analysis}</span></span>
<span id="cb702-3082"><a href="#cb702-3082" aria-hidden="true" tabindex="-1"></a><span class="co"># Research question: Does job satisfaction predict performance,</span></span>
<span id="cb702-3083"><a href="#cb702-3083" aria-hidden="true" tabindex="-1"></a><span class="co"># controlling for stress and age?</span></span>
<span id="cb702-3084"><a href="#cb702-3084" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3085"><a href="#cb702-3085" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit model to each imputed dataset</span></span>
<span id="cb702-3086"><a href="#cb702-3086" aria-hidden="true" tabindex="-1"></a>fitted_models <span class="ot">&lt;-</span> <span class="fu">with</span>(mice_result, </span>
<span id="cb702-3087"><a href="#cb702-3087" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">lm</span>(performance_score <span class="sc">~</span> job_satisfaction <span class="sc">+</span> stress_level <span class="sc">+</span> age))</span>
<span id="cb702-3088"><a href="#cb702-3088" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3089"><a href="#cb702-3089" aria-hidden="true" tabindex="-1"></a><span class="co"># Pool results using Rubin's rules</span></span>
<span id="cb702-3090"><a href="#cb702-3090" aria-hidden="true" tabindex="-1"></a>pooled_results <span class="ot">&lt;-</span> <span class="fu">pool</span>(fitted_models)</span>
<span id="cb702-3091"><a href="#cb702-3091" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3092"><a href="#cb702-3092" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary of pooled estimates</span></span>
<span id="cb702-3093"><a href="#cb702-3093" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pooled_results, <span class="at">conf.int =</span> <span class="cn">TRUE</span>)</span>
<span id="cb702-3094"><a href="#cb702-3094" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3095"><a href="#cb702-3095" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract key statistics</span></span>
<span id="cb702-3096"><a href="#cb702-3096" aria-hidden="true" tabindex="-1"></a>pooled_summary <span class="ot">&lt;-</span> <span class="fu">summary</span>(pooled_results, <span class="at">conf.int =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb702-3097"><a href="#cb702-3097" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb702-3098"><a href="#cb702-3098" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb702-3099"><a href="#cb702-3099" aria-hidden="true" tabindex="-1"></a>    <span class="at">term =</span> term,</span>
<span id="cb702-3100"><a href="#cb702-3100" aria-hidden="true" tabindex="-1"></a>    <span class="at">estimate =</span> <span class="fu">round</span>(estimate, <span class="dv">3</span>),</span>
<span id="cb702-3101"><a href="#cb702-3101" aria-hidden="true" tabindex="-1"></a>    <span class="at">std.error =</span> <span class="fu">round</span>(std.error, <span class="dv">3</span>),</span>
<span id="cb702-3102"><a href="#cb702-3102" aria-hidden="true" tabindex="-1"></a>    <span class="at">statistic =</span> <span class="fu">round</span>(statistic, <span class="dv">2</span>),</span>
<span id="cb702-3103"><a href="#cb702-3103" aria-hidden="true" tabindex="-1"></a>    <span class="at">p.value =</span> <span class="fu">round</span>(p.value, <span class="dv">4</span>),</span>
<span id="cb702-3104"><a href="#cb702-3104" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">95% CI</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sprintf</span>(<span class="st">"[%.2f, %.2f]"</span>, <span class="st">`</span><span class="at">2.5 %</span><span class="st">`</span>, <span class="st">`</span><span class="at">97.5 %</span><span class="st">`</span>)</span>
<span id="cb702-3105"><a href="#cb702-3105" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb702-3106"><a href="#cb702-3106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(term, estimate, std.error, statistic, p.value, <span class="st">`</span><span class="at">95% CI</span><span class="st">`</span>)</span>
<span id="cb702-3107"><a href="#cb702-3107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3108"><a href="#cb702-3108" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pooled_summary)</span>
<span id="cb702-3109"><a href="#cb702-3109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3110"><a href="#cb702-3110" aria-hidden="true" tabindex="-1"></a><span class="co"># Fraction of missing information (FMI)</span></span>
<span id="cb702-3111"><a href="#cb702-3111" aria-hidden="true" tabindex="-1"></a><span class="co"># Higher FMI = more uncertainty due to missing data</span></span>
<span id="cb702-3112"><a href="#cb702-3112" aria-hidden="true" tabindex="-1"></a><span class="fu">pool.r.squared</span>(fitted_models)</span>
<span id="cb702-3113"><a href="#cb702-3113" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-3114"><a href="#cb702-3114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3115"><a href="#cb702-3115" aria-hidden="true" tabindex="-1"></a>**Checkpoint:** Pooled regression results should show relationship between job satisfaction and performance, with appropriate standard errors accounting for imputation uncertainty.</span>
<span id="cb702-3116"><a href="#cb702-3116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3117"><a href="#cb702-3117" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-3118"><a href="#cb702-3118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3119"><a href="#cb702-3119" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 7: Compare with Complete-Case Analysis</span></span>
<span id="cb702-3120"><a href="#cb702-3120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3121"><a href="#cb702-3121" aria-hidden="true" tabindex="-1"></a>Contrast MI results with naive complete-case deletion:</span>
<span id="cb702-3122"><a href="#cb702-3122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3123"><a href="#cb702-3123" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lab9-comparison}</span></span>
<span id="cb702-3124"><a href="#cb702-3124" aria-hidden="true" tabindex="-1"></a><span class="co"># Complete-case analysis (list-wise deletion)</span></span>
<span id="cb702-3125"><a href="#cb702-3125" aria-hidden="true" tabindex="-1"></a>complete_case_data <span class="ot">&lt;-</span> survey_data <span class="sc">%&gt;%</span> </span>
<span id="cb702-3126"><a href="#cb702-3126" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>employee_id) <span class="sc">%&gt;%</span></span>
<span id="cb702-3127"><a href="#cb702-3127" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>()</span>
<span id="cb702-3128"><a href="#cb702-3128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3129"><a href="#cb702-3129" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Sample sizes:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-3130"><a href="#cb702-3130" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Complete-case analysis:"</span>, <span class="fu">nrow</span>(complete_case_data), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-3131"><a href="#cb702-3131" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Multiple imputation:"</span>, <span class="fu">nrow</span>(survey_data), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-3132"><a href="#cb702-3132" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Cases lost:"</span>, <span class="fu">nrow</span>(survey_data) <span class="sc">-</span> <span class="fu">nrow</span>(complete_case_data), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-3133"><a href="#cb702-3133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3134"><a href="#cb702-3134" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit complete-case model</span></span>
<span id="cb702-3135"><a href="#cb702-3135" aria-hidden="true" tabindex="-1"></a>cc_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(performance_score <span class="sc">~</span> job_satisfaction <span class="sc">+</span> stress_level <span class="sc">+</span> age,</span>
<span id="cb702-3136"><a href="#cb702-3136" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> complete_case_data)</span>
<span id="cb702-3137"><a href="#cb702-3137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3138"><a href="#cb702-3138" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare estimates</span></span>
<span id="cb702-3139"><a href="#cb702-3139" aria-hidden="true" tabindex="-1"></a>comparison_table <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb702-3140"><a href="#cb702-3140" aria-hidden="true" tabindex="-1"></a>  <span class="at">Predictor =</span> <span class="fu">c</span>(<span class="st">"Intercept"</span>, <span class="st">"Job Satisfaction"</span>, <span class="st">"Stress Level"</span>, <span class="st">"Age"</span>),</span>
<span id="cb702-3141"><a href="#cb702-3141" aria-hidden="true" tabindex="-1"></a>  <span class="at">CC_Estimate =</span> <span class="fu">round</span>(<span class="fu">coef</span>(cc_model), <span class="dv">3</span>),</span>
<span id="cb702-3142"><a href="#cb702-3142" aria-hidden="true" tabindex="-1"></a>  <span class="at">CC_SE =</span> <span class="fu">round</span>(<span class="fu">summary</span>(cc_model)<span class="sc">$</span>coef[, <span class="dv">2</span>], <span class="dv">3</span>),</span>
<span id="cb702-3143"><a href="#cb702-3143" aria-hidden="true" tabindex="-1"></a>  <span class="at">MI_Estimate =</span> <span class="fu">round</span>(<span class="fu">summary</span>(pooled_results)<span class="sc">$</span>estimate, <span class="dv">3</span>),</span>
<span id="cb702-3144"><a href="#cb702-3144" aria-hidden="true" tabindex="-1"></a>  <span class="at">MI_SE =</span> <span class="fu">round</span>(<span class="fu">summary</span>(pooled_results)<span class="sc">$</span>std.error, <span class="dv">3</span>),</span>
<span id="cb702-3145"><a href="#cb702-3145" aria-hidden="true" tabindex="-1"></a>  <span class="at">Difference =</span> <span class="fu">round</span>(<span class="fu">abs</span>(<span class="fu">coef</span>(cc_model) <span class="sc">-</span> <span class="fu">summary</span>(pooled_results)<span class="sc">$</span>estimate), <span class="dv">3</span>)</span>
<span id="cb702-3146"><a href="#cb702-3146" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb702-3147"><a href="#cb702-3147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3148"><a href="#cb702-3148" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(comparison_table)</span>
<span id="cb702-3149"><a href="#cb702-3149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3150"><a href="#cb702-3150" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization</span></span>
<span id="cb702-3151"><a href="#cb702-3151" aria-hidden="true" tabindex="-1"></a>comparison_long <span class="ot">&lt;-</span> comparison_table <span class="sc">%&gt;%</span></span>
<span id="cb702-3152"><a href="#cb702-3152" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Predictor, CC_Estimate, MI_Estimate) <span class="sc">%&gt;%</span></span>
<span id="cb702-3153"><a href="#cb702-3153" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Predictor <span class="sc">!=</span> <span class="st">"Intercept"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb702-3154"><a href="#cb702-3154" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>Predictor, <span class="at">names_to =</span> <span class="st">"Method"</span>, <span class="at">values_to =</span> <span class="st">"Estimate"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb702-3155"><a href="#cb702-3155" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Method =</span> <span class="fu">recode</span>(Method, </span>
<span id="cb702-3156"><a href="#cb702-3156" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"CC_Estimate"</span> <span class="ot">=</span> <span class="st">"Complete Case"</span>,</span>
<span id="cb702-3157"><a href="#cb702-3157" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"MI_Estimate"</span> <span class="ot">=</span> <span class="st">"Multiple Imputation"</span>))</span>
<span id="cb702-3158"><a href="#cb702-3158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3159"><a href="#cb702-3159" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(comparison_long, <span class="fu">aes</span>(<span class="at">x =</span> Predictor, <span class="at">y =</span> Estimate, <span class="at">fill =</span> Method)) <span class="sc">+</span></span>
<span id="cb702-3160"><a href="#cb702-3160" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb702-3161"><a href="#cb702-3161" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb702-3162"><a href="#cb702-3162" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Complete-Case vs Multiple Imputation"</span>,</span>
<span id="cb702-3163"><a href="#cb702-3163" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Regression Coefficient Estimates"</span>,</span>
<span id="cb702-3164"><a href="#cb702-3164" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Coefficient Estimate"</span></span>
<span id="cb702-3165"><a href="#cb702-3165" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb702-3166"><a href="#cb702-3166" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb702-3167"><a href="#cb702-3167" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb702-3168"><a href="#cb702-3168" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-3169"><a href="#cb702-3169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3170"><a href="#cb702-3170" aria-hidden="true" tabindex="-1"></a>**Checkpoint:** Complete-case analysis loses power (smaller n) and may produce biased estimates if data are MAR. MI preserves full sample and accounts for uncertainty.</span>
<span id="cb702-3171"><a href="#cb702-3171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3172"><a href="#cb702-3172" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-3173"><a href="#cb702-3173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3174"><a href="#cb702-3174" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 8: Report Imputation Procedures</span></span>
<span id="cb702-3175"><a href="#cb702-3175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3176"><a href="#cb702-3176" aria-hidden="true" tabindex="-1"></a>Create publication-ready summary:</span>
<span id="cb702-3177"><a href="#cb702-3177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3178"><a href="#cb702-3178" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lab9-reporting}</span></span>
<span id="cb702-3179"><a href="#cb702-3179" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb702-3180"><a href="#cb702-3180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3181"><a href="#cb702-3181" aria-hidden="true" tabindex="-1"></a><span class="co"># Publication table</span></span>
<span id="cb702-3182"><a href="#cb702-3182" aria-hidden="true" tabindex="-1"></a>pooled_summary <span class="sc">%&gt;%</span></span>
<span id="cb702-3183"><a href="#cb702-3183" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb702-3184"><a href="#cb702-3184" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb702-3185"><a href="#cb702-3185" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Multiple Imputation Regression Results"</span>,</span>
<span id="cb702-3186"><a href="#cb702-3186" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Predicting Employee Performance (N=50, m=20 imputations)"</span></span>
<span id="cb702-3187"><a href="#cb702-3187" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb702-3188"><a href="#cb702-3188" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(</span>
<span id="cb702-3189"><a href="#cb702-3189" aria-hidden="true" tabindex="-1"></a>    <span class="at">term =</span> <span class="st">"Predictor"</span>,</span>
<span id="cb702-3190"><a href="#cb702-3190" aria-hidden="true" tabindex="-1"></a>    <span class="at">estimate =</span> <span class="st">"B"</span>,</span>
<span id="cb702-3191"><a href="#cb702-3191" aria-hidden="true" tabindex="-1"></a>    <span class="at">std.error =</span> <span class="st">"SE"</span>,</span>
<span id="cb702-3192"><a href="#cb702-3192" aria-hidden="true" tabindex="-1"></a>    <span class="at">statistic =</span> <span class="st">"t"</span>,</span>
<span id="cb702-3193"><a href="#cb702-3193" aria-hidden="true" tabindex="-1"></a>    <span class="at">p.value =</span> <span class="st">"p"</span></span>
<span id="cb702-3194"><a href="#cb702-3194" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb702-3195"><a href="#cb702-3195" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_footnote</span>(</span>
<span id="cb702-3196"><a href="#cb702-3196" aria-hidden="true" tabindex="-1"></a>    <span class="at">footnote =</span> <span class="st">"Multiple imputation performed using MICE (predictive mean matching)"</span>,</span>
<span id="cb702-3197"><a href="#cb702-3197" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_column_labels</span>(<span class="at">columns =</span> <span class="st">"estimate"</span>)</span>
<span id="cb702-3198"><a href="#cb702-3198" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb702-3199"><a href="#cb702-3199" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_footnote</span>(</span>
<span id="cb702-3200"><a href="#cb702-3200" aria-hidden="true" tabindex="-1"></a>    <span class="at">footnote =</span> <span class="fu">sprintf</span>(<span class="st">"Missing data: job_satisfaction (%.0f%%), stress_level (%.0f%%), performance_score (%.0f%%)"</span>,</span>
<span id="cb702-3201"><a href="#cb702-3201" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">mean</span>(<span class="fu">is.na</span>(survey_data<span class="sc">$</span>job_satisfaction))<span class="sc">*</span><span class="dv">100</span>,</span>
<span id="cb702-3202"><a href="#cb702-3202" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">mean</span>(<span class="fu">is.na</span>(survey_data<span class="sc">$</span>stress_level))<span class="sc">*</span><span class="dv">100</span>,</span>
<span id="cb702-3203"><a href="#cb702-3203" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">mean</span>(<span class="fu">is.na</span>(survey_data<span class="sc">$</span>performance_score))<span class="sc">*</span><span class="dv">100</span>),</span>
<span id="cb702-3204"><a href="#cb702-3204" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_title</span>()</span>
<span id="cb702-3205"><a href="#cb702-3205" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb702-3206"><a href="#cb702-3206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3207"><a href="#cb702-3207" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample methods statement</span></span>
<span id="cb702-3208"><a href="#cb702-3208" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Sample Methods Statement:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-3209"><a href="#cb702-3209" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Missing data were handled using multiple imputation (MI) with the</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-3210"><a href="#cb702-3210" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"MICE algorithm (van Buuren &amp; Groothuis-Oudshoorn, 2011). Variables</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-3211"><a href="#cb702-3211" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"ranged from"</span>, <span class="fu">round</span>(<span class="fu">min</span>(<span class="fu">miss_var_summary</span>(survey_data)<span class="sc">$</span>pct_miss), <span class="dv">1</span>), </span>
<span id="cb702-3212"><a href="#cb702-3212" aria-hidden="true" tabindex="-1"></a>    <span class="st">"% to"</span>, <span class="fu">round</span>(<span class="fu">max</span>(<span class="fu">miss_var_summary</span>(survey_data)<span class="sc">$</span>pct_miss), <span class="dv">1</span>), </span>
<span id="cb702-3213"><a href="#cb702-3213" aria-hidden="true" tabindex="-1"></a>    <span class="st">"% missing.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-3214"><a href="#cb702-3214" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"We generated m=20 imputed datasets using predictive mean matching</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-3215"><a href="#cb702-3215" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"(PMM) with 20 iterations. Convergence diagnostics (trace plots)</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-3216"><a href="#cb702-3216" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"indicated adequate convergence. Regression analyses were performed</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-3217"><a href="#cb702-3217" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"on each imputed dataset, and results were pooled using Rubin's rules.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-3218"><a href="#cb702-3218" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Complete-case analysis (n="</span>, <span class="fu">nrow</span>(complete_case_data), </span>
<span id="cb702-3219"><a href="#cb702-3219" aria-hidden="true" tabindex="-1"></a>    <span class="st">") yielded similar results,</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-3220"><a href="#cb702-3220" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"but MI retained the full sample (N=50) and appropriately quantified</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-3221"><a href="#cb702-3221" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"uncertainty due to missing data.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-3222"><a href="#cb702-3222" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-3223"><a href="#cb702-3223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3224"><a href="#cb702-3224" aria-hidden="true" tabindex="-1"></a>**Checkpoint:** Professional reporting following MI best practices.</span>
<span id="cb702-3225"><a href="#cb702-3225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3226"><a href="#cb702-3226" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-3227"><a href="#cb702-3227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3228"><a href="#cb702-3228" aria-hidden="true" tabindex="-1"></a><span class="fu">### Discussion Questions</span></span>
<span id="cb702-3229"><a href="#cb702-3229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3230"><a href="#cb702-3230" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Missing Data Mechanisms:** How can you determine if data are MCAR, MAR, or MNAR?</span>
<span id="cb702-3231"><a href="#cb702-3231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3232"><a href="#cb702-3232" aria-hidden="true" tabindex="-1"></a>   *Answer: Use Little's MCAR test (null hypothesis: data are MCAR), examine correlations between missingness indicators and observed variables (MAR if related), and consider theory (MNAR if missingness depends on unobserved values). MNAR cannot be tested statistically and requires assumptions.*</span>
<span id="cb702-3233"><a href="#cb702-3233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3234"><a href="#cb702-3234" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Number of Imputations:** Why use m=20 imputations instead of the traditional m=5?</span>
<span id="cb702-3235"><a href="#cb702-3235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3236"><a href="#cb702-3236" aria-hidden="true" tabindex="-1"></a>   *Answer: Modern recommendations suggest m ≥ 20 (or equal to percentage missing) for more stable estimates and better power. More imputations improve precision and reproducibility, especially with high missingness or small samples.*</span>
<span id="cb702-3237"><a href="#cb702-3237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3238"><a href="#cb702-3238" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**PMM vs Other Methods:** Why use predictive mean matching (pmm) instead of regression imputation?</span>
<span id="cb702-3239"><a href="#cb702-3239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3240"><a href="#cb702-3240" aria-hidden="true" tabindex="-1"></a>   *Answer: PMM imputes actual observed values (not predictions), preserving data distribution and avoiding impossible values (e.g., negative scores). Regression imputation can produce out-of-range values and underestimate variability.*</span>
<span id="cb702-3241"><a href="#cb702-3241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3242"><a href="#cb702-3242" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**When Not to Use MI:** Are there situations where you shouldn't use multiple imputation?</span>
<span id="cb702-3243"><a href="#cb702-3243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3244"><a href="#cb702-3244" aria-hidden="true" tabindex="-1"></a>   *Answer: (1) MNAR data (requires specialized models), (2) &gt;40-50% missing (insufficient information), (3) key variables completely missing for subgroups, (4) missing data on outcome only (can bias estimates), (5) when missingness IS the research question.*</span>
<span id="cb702-3245"><a href="#cb702-3245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3246"><a href="#cb702-3246" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>**Complete-Case Bias:** Why might complete-case analysis produce biased results even if data are MAR?</span>
<span id="cb702-3247"><a href="#cb702-3247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3248"><a href="#cb702-3248" aria-hidden="true" tabindex="-1"></a>   *Answer: Complete-case deletion excludes systematically different cases (e.g., those with high stress), reducing generalizability and potentially biasing estimates. MI uses all available information and maintains proper statistical relationships.*</span>
<span id="cb702-3249"><a href="#cb702-3249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3250"><a href="#cb702-3250" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-3251"><a href="#cb702-3251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3252"><a href="#cb702-3252" aria-hidden="true" tabindex="-1"></a><span class="fu">### Key Takeaways</span></span>
<span id="cb702-3253"><a href="#cb702-3253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3254"><a href="#cb702-3254" aria-hidden="true" tabindex="-1"></a>✓ **Missing data are common in small samples** – handle appropriately, don't ignore  </span>
<span id="cb702-3255"><a href="#cb702-3255" aria-hidden="true" tabindex="-1"></a>✓ **Multiple imputation preserves sample size** and accounts for uncertainty  </span>
<span id="cb702-3256"><a href="#cb702-3256" aria-hidden="true" tabindex="-1"></a>✓ **MICE is flexible**: handles different variable types and missing patterns  </span>
<span id="cb702-3257"><a href="#cb702-3257" aria-hidden="true" tabindex="-1"></a>✓ **Check convergence**: Trace plots must show stable streams without trends  </span>
<span id="cb702-3258"><a href="#cb702-3258" aria-hidden="true" tabindex="-1"></a>✓ **Imputed values should be plausible** – visually inspect distributions  </span>
<span id="cb702-3259"><a href="#cb702-3259" aria-hidden="true" tabindex="-1"></a>✓ **Pool results using Rubin's rules** – don't analyze single imputed dataset  </span>
<span id="cb702-3260"><a href="#cb702-3260" aria-hidden="true" tabindex="-1"></a>✓ **Always report imputation procedures**: m, iterations, methods, convergence  </span>
<span id="cb702-3261"><a href="#cb702-3261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3262"><a href="#cb702-3262" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-3263"><a href="#cb702-3263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3264"><a href="#cb702-3264" aria-hidden="true" tabindex="-1"></a><span class="fu">### Homework Exercise</span></span>
<span id="cb702-3265"><a href="#cb702-3265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3266"><a href="#cb702-3266" aria-hidden="true" tabindex="-1"></a>**Dataset:** A quality improvement study (n=35) measuring patient satisfaction, wait time, and treatment effectiveness. Data have ~25% missingness.</span>
<span id="cb702-3267"><a href="#cb702-3267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3268"><a href="#cb702-3268" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lab9-homework-data}</span></span>
<span id="cb702-3269"><a href="#cb702-3269" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">789</span>)</span>
<span id="cb702-3270"><a href="#cb702-3270" aria-hidden="true" tabindex="-1"></a>patient_data_complete <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb702-3271"><a href="#cb702-3271" aria-hidden="true" tabindex="-1"></a>  <span class="at">patient_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">35</span>,</span>
<span id="cb702-3272"><a href="#cb702-3272" aria-hidden="true" tabindex="-1"></a>  <span class="at">age =</span> <span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="dv">35</span>, <span class="dv">55</span>, <span class="dv">12</span>)),</span>
<span id="cb702-3273"><a href="#cb702-3273" aria-hidden="true" tabindex="-1"></a>  <span class="at">wait_time_mins =</span> <span class="fu">round</span>(<span class="fu">runif</span>(<span class="dv">35</span>, <span class="dv">10</span>, <span class="dv">90</span>)),</span>
<span id="cb702-3274"><a href="#cb702-3274" aria-hidden="true" tabindex="-1"></a>  <span class="at">satisfaction_score =</span> <span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="dv">35</span>, <span class="dv">75</span>, <span class="dv">15</span>)),</span>
<span id="cb702-3275"><a href="#cb702-3275" aria-hidden="true" tabindex="-1"></a>  <span class="at">effectiveness_score =</span> <span class="fu">round</span>(<span class="dv">70</span> <span class="sc">+</span> <span class="fl">0.2</span> <span class="sc">*</span> satisfaction_score <span class="sc">-</span> <span class="fl">0.1</span> <span class="sc">*</span> wait_time_mins <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">35</span>, <span class="dv">0</span>, <span class="dv">10</span>))</span>
<span id="cb702-3276"><a href="#cb702-3276" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb702-3277"><a href="#cb702-3277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3278"><a href="#cb702-3278" aria-hidden="true" tabindex="-1"></a><span class="co"># Introduce MAR missingness</span></span>
<span id="cb702-3279"><a href="#cb702-3279" aria-hidden="true" tabindex="-1"></a>patient_data <span class="ot">&lt;-</span> patient_data_complete <span class="sc">%&gt;%</span></span>
<span id="cb702-3280"><a href="#cb702-3280" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb702-3281"><a href="#cb702-3281" aria-hidden="true" tabindex="-1"></a>    <span class="at">satisfaction_score =</span> <span class="fu">if_else</span>(wait_time_mins <span class="sc">&gt;</span> <span class="dv">60</span> <span class="sc">&amp;</span> <span class="fu">runif</span>(<span class="dv">35</span>) <span class="sc">&lt;</span> <span class="fl">0.35</span>, <span class="cn">NA_real_</span>, satisfaction_score),</span>
<span id="cb702-3282"><a href="#cb702-3282" aria-hidden="true" tabindex="-1"></a>    <span class="at">effectiveness_score =</span> <span class="fu">if_else</span>(satisfaction_score <span class="sc">&lt;</span> <span class="dv">65</span> <span class="sc">&amp;</span> <span class="fu">runif</span>(<span class="dv">35</span>) <span class="sc">&lt;</span> <span class="fl">0.30</span>, <span class="cn">NA_real_</span>, effectiveness_score),</span>
<span id="cb702-3283"><a href="#cb702-3283" aria-hidden="true" tabindex="-1"></a>    <span class="at">wait_time_mins =</span> <span class="fu">if_else</span>(<span class="fu">runif</span>(<span class="dv">35</span>) <span class="sc">&lt;</span> <span class="fl">0.20</span>, <span class="cn">NA_real_</span>, wait_time_mins)</span>
<span id="cb702-3284"><a href="#cb702-3284" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb702-3285"><a href="#cb702-3285" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-3286"><a href="#cb702-3286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3287"><a href="#cb702-3287" aria-hidden="true" tabindex="-1"></a>**Your Tasks:**</span>
<span id="cb702-3288"><a href="#cb702-3288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3289"><a href="#cb702-3289" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Calculate the proportion of missing data for each variable</span>
<span id="cb702-3290"><a href="#cb702-3290" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Visualize missing data patterns using <span class="in">`gg_miss_upset()`</span> and <span class="in">`md.pattern()`</span></span>
<span id="cb702-3291"><a href="#cb702-3291" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Perform multiple imputation with m=25 imputations, 25 iterations</span>
<span id="cb702-3292"><a href="#cb702-3292" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Create trace plots and assess convergence</span>
<span id="cb702-3293"><a href="#cb702-3293" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>Inspect imputed values using <span class="in">`densityplot()`</span> – are they plausible?</span>
<span id="cb702-3294"><a href="#cb702-3294" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span>Fit a regression model predicting effectiveness from satisfaction and wait time</span>
<span id="cb702-3295"><a href="#cb702-3295" aria-hidden="true" tabindex="-1"></a><span class="ss">7. </span>Pool results across imputed datasets</span>
<span id="cb702-3296"><a href="#cb702-3296" aria-hidden="true" tabindex="-1"></a><span class="ss">8. </span>Compare MI results with complete-case analysis (report both n's and estimates)</span>
<span id="cb702-3297"><a href="#cb702-3297" aria-hidden="true" tabindex="-1"></a><span class="ss">9. </span>Create a publication-ready table of pooled regression results</span>
<span id="cb702-3298"><a href="#cb702-3298" aria-hidden="true" tabindex="-1"></a><span class="ss">10. </span>Write a methods paragraph describing the imputation procedure</span>
<span id="cb702-3299"><a href="#cb702-3299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3300"><a href="#cb702-3300" aria-hidden="true" tabindex="-1"></a>**Expected Results:**</span>
<span id="cb702-3301"><a href="#cb702-3301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3302"><a href="#cb702-3302" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>~25-30% missing across variables</span>
<span id="cb702-3303"><a href="#cb702-3303" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Good convergence (stable trace plots)</span>
<span id="cb702-3304"><a href="#cb702-3304" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Satisfaction positively predicts effectiveness (β ≈ 0.15-0.25)</span>
<span id="cb702-3305"><a href="#cb702-3305" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Wait time negatively predicts effectiveness (β ≈ -0.08 to -0.15)</span>
<span id="cb702-3306"><a href="#cb702-3306" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Complete-case n ≈ 20-25 (vs N=35 for MI)</span>
<span id="cb702-3307"><a href="#cb702-3307" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>MI standard errors slightly larger than complete-case (accounting for imputation uncertainty)</span>
<span id="cb702-3308"><a href="#cb702-3308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3309"><a href="#cb702-3309" aria-hidden="true" tabindex="-1"></a>**Hints:**</span>
<span id="cb702-3310"><a href="#cb702-3310" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Use <span class="in">`miss_var_summary(data)`</span> for missing percentages</span>
<span id="cb702-3311"><a href="#cb702-3311" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Check <span class="in">`mice_result$loggedEvents`</span> for any imputation warnings</span>
<span id="cb702-3312"><a href="#cb702-3312" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Extract pooled R² with <span class="in">`pool.r.squared(fitted_models)`</span></span>
<span id="cb702-3313"><a href="#cb702-3313" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Compare FMI (fraction of missing information) across predictors</span>
<span id="cb702-3314"><a href="#cb702-3314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3315"><a href="#cb702-3315" aria-hidden="true" tabindex="-1"></a>**Bonus:** Perform a sensitivity analysis by re-running MICE with different methods (e.g., "norm" for Bayesian linear regression instead of "pmm"). Do results substantively change? What does this reveal about robustness of findings?</span>
<span id="cb702-3316"><a href="#cb702-3316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3317"><a href="#cb702-3317" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-3318"><a href="#cb702-3318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3319"><a href="#cb702-3319" aria-hidden="true" tabindex="-1"></a><span class="fu">## Lab 10: Data Screening and Outlier Detection {#lab-screening}</span></span>
<span id="cb702-3320"><a href="#cb702-3320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3321"><a href="#cb702-3321" aria-hidden="true" tabindex="-1"></a>**Learning Objectives:**</span>
<span id="cb702-3322"><a href="#cb702-3322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3323"><a href="#cb702-3323" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Screen small-sample data for outliers using multiple methods</span>
<span id="cb702-3324"><a href="#cb702-3324" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Apply univariate detection (z-scores, boxplots, Tukey fences)</span>
<span id="cb702-3325"><a href="#cb702-3325" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Use multivariate detection (Mahalanobis distance, Cook's D)</span>
<span id="cb702-3326"><a href="#cb702-3326" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Assess normality assumptions with Q-Q plots and tests</span>
<span id="cb702-3327"><a href="#cb702-3327" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Make principled decisions about outlier treatment</span>
<span id="cb702-3328"><a href="#cb702-3328" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Document data screening procedures for transparency</span>
<span id="cb702-3329"><a href="#cb702-3329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3330"><a href="#cb702-3330" aria-hidden="true" tabindex="-1"></a>**Scenario:** You have collected cognitive performance data (n=30) from a pilot intervention study. Before analysis, you need to screen for outliers, assess normality, and check for influential cases that might distort results.</span>
<span id="cb702-3331"><a href="#cb702-3331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3332"><a href="#cb702-3332" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 1: Set Up and Load Data</span></span>
<span id="cb702-3333"><a href="#cb702-3333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3334"><a href="#cb702-3334" aria-hidden="true" tabindex="-1"></a>Create dataset with some outliers:</span>
<span id="cb702-3335"><a href="#cb702-3335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3336"><a href="#cb702-3336" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lab10-data}</span></span>
<span id="cb702-3337"><a href="#cb702-3337" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb702-3338"><a href="#cb702-3338" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)        <span class="co"># For outlier tests</span></span>
<span id="cb702-3339"><a href="#cb702-3339" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performance) <span class="co"># For check_outliers()</span></span>
<span id="cb702-3340"><a href="#cb702-3340" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MVN)        <span class="co"># For multivariate normality</span></span>
<span id="cb702-3341"><a href="#cb702-3341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3342"><a href="#cb702-3342" aria-hidden="true" tabindex="-1"></a><span class="co"># Set seed for reproducibility</span></span>
<span id="cb702-3343"><a href="#cb702-3343" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb702-3344"><a href="#cb702-3344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3345"><a href="#cb702-3345" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data with outliers</span></span>
<span id="cb702-3346"><a href="#cb702-3346" aria-hidden="true" tabindex="-1"></a>cognitive_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb702-3347"><a href="#cb702-3347" aria-hidden="true" tabindex="-1"></a>  <span class="at">participant_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>,</span>
<span id="cb702-3348"><a href="#cb702-3348" aria-hidden="true" tabindex="-1"></a>  <span class="at">age =</span> <span class="fu">c</span>(<span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="dv">28</span>, <span class="dv">25</span>, <span class="dv">4</span>)), <span class="dv">45</span>, <span class="dv">50</span>),  <span class="co"># 2 age outliers</span></span>
<span id="cb702-3349"><a href="#cb702-3349" aria-hidden="true" tabindex="-1"></a>  <span class="at">baseline_score =</span> <span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="dv">30</span>, <span class="dv">50</span>, <span class="dv">8</span>)),</span>
<span id="cb702-3350"><a href="#cb702-3350" aria-hidden="true" tabindex="-1"></a>  <span class="at">post_score =</span> <span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="dv">30</span>, <span class="dv">55</span>, <span class="dv">9</span>)),</span>
<span id="cb702-3351"><a href="#cb702-3351" aria-hidden="true" tabindex="-1"></a>  <span class="at">improvement =</span> post_score <span class="sc">-</span> baseline_score</span>
<span id="cb702-3352"><a href="#cb702-3352" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb702-3353"><a href="#cb702-3353" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb702-3354"><a href="#cb702-3354" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add one multivariate outlier (high age, low scores)</span></span>
<span id="cb702-3355"><a href="#cb702-3355" aria-hidden="true" tabindex="-1"></a>    <span class="at">baseline_score =</span> <span class="fu">if_else</span>(participant_id <span class="sc">==</span> <span class="dv">29</span>, <span class="dv">25</span>, baseline_score),</span>
<span id="cb702-3356"><a href="#cb702-3356" aria-hidden="true" tabindex="-1"></a>    <span class="at">post_score =</span> <span class="fu">if_else</span>(participant_id <span class="sc">==</span> <span class="dv">29</span>, <span class="dv">28</span>, post_score),</span>
<span id="cb702-3357"><a href="#cb702-3357" aria-hidden="true" tabindex="-1"></a>    <span class="at">improvement =</span> post_score <span class="sc">-</span> baseline_score</span>
<span id="cb702-3358"><a href="#cb702-3358" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb702-3359"><a href="#cb702-3359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3360"><a href="#cb702-3360" aria-hidden="true" tabindex="-1"></a><span class="co"># Descriptive statistics</span></span>
<span id="cb702-3361"><a href="#cb702-3361" aria-hidden="true" tabindex="-1"></a>cognitive_data <span class="sc">%&gt;%</span></span>
<span id="cb702-3362"><a href="#cb702-3362" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>participant_id) <span class="sc">%&gt;%</span></span>
<span id="cb702-3363"><a href="#cb702-3363" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span>
<span id="cb702-3364"><a href="#cb702-3364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3365"><a href="#cb702-3365" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize raw data</span></span>
<span id="cb702-3366"><a href="#cb702-3366" aria-hidden="true" tabindex="-1"></a>cognitive_data <span class="sc">%&gt;%</span></span>
<span id="cb702-3367"><a href="#cb702-3367" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(age, baseline_score, post_score, improvement) <span class="sc">%&gt;%</span></span>
<span id="cb702-3368"><a href="#cb702-3368" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">"variable"</span>, <span class="at">values_to =</span> <span class="st">"value"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb702-3369"><a href="#cb702-3369" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> variable, <span class="at">y =</span> value)) <span class="sc">+</span></span>
<span id="cb702-3370"><a href="#cb702-3370" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">"lightblue"</span>) <span class="sc">+</span></span>
<span id="cb702-3371"><a href="#cb702-3371" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb702-3372"><a href="#cb702-3372" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Variables (Boxplots)"</span>,</span>
<span id="cb702-3373"><a href="#cb702-3373" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Variable"</span>, <span class="at">y =</span> <span class="st">"Value"</span>) <span class="sc">+</span></span>
<span id="cb702-3374"><a href="#cb702-3374" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb702-3375"><a href="#cb702-3375" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb702-3376"><a href="#cb702-3376" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-3377"><a href="#cb702-3377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3378"><a href="#cb702-3378" aria-hidden="true" tabindex="-1"></a>**Checkpoint:** You should see n=30 participants with visible outliers in age and possibly in scores.</span>
<span id="cb702-3379"><a href="#cb702-3379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3380"><a href="#cb702-3380" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-3381"><a href="#cb702-3381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3382"><a href="#cb702-3382" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 2: Univariate Outlier Detection with Z-Scores</span></span>
<span id="cb702-3383"><a href="#cb702-3383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3384"><a href="#cb702-3384" aria-hidden="true" tabindex="-1"></a>Identify outliers using standardized scores:</span>
<span id="cb702-3385"><a href="#cb702-3385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3386"><a href="#cb702-3386" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lab10-zscores}</span></span>
<span id="cb702-3387"><a href="#cb702-3387" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate z-scores for all numeric variables</span></span>
<span id="cb702-3388"><a href="#cb702-3388" aria-hidden="true" tabindex="-1"></a>cognitive_zscores <span class="ot">&lt;-</span> cognitive_data <span class="sc">%&gt;%</span></span>
<span id="cb702-3389"><a href="#cb702-3389" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb702-3390"><a href="#cb702-3390" aria-hidden="true" tabindex="-1"></a>    <span class="at">z_age =</span> <span class="fu">scale</span>(age)[,<span class="dv">1</span>],</span>
<span id="cb702-3391"><a href="#cb702-3391" aria-hidden="true" tabindex="-1"></a>    <span class="at">z_baseline =</span> <span class="fu">scale</span>(baseline_score)[,<span class="dv">1</span>],</span>
<span id="cb702-3392"><a href="#cb702-3392" aria-hidden="true" tabindex="-1"></a>    <span class="at">z_post =</span> <span class="fu">scale</span>(post_score)[,<span class="dv">1</span>],</span>
<span id="cb702-3393"><a href="#cb702-3393" aria-hidden="true" tabindex="-1"></a>    <span class="at">z_improvement =</span> <span class="fu">scale</span>(improvement)[,<span class="dv">1</span>]</span>
<span id="cb702-3394"><a href="#cb702-3394" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb702-3395"><a href="#cb702-3395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3396"><a href="#cb702-3396" aria-hidden="true" tabindex="-1"></a><span class="co"># Flag outliers (|z| &gt; 3.0 for small samples, or &gt; 2.5)</span></span>
<span id="cb702-3397"><a href="#cb702-3397" aria-hidden="true" tabindex="-1"></a>threshold <span class="ot">&lt;-</span> <span class="fl">2.5</span></span>
<span id="cb702-3398"><a href="#cb702-3398" aria-hidden="true" tabindex="-1"></a>outliers_zscore <span class="ot">&lt;-</span> cognitive_zscores <span class="sc">%&gt;%</span></span>
<span id="cb702-3399"><a href="#cb702-3399" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb702-3400"><a href="#cb702-3400" aria-hidden="true" tabindex="-1"></a>    <span class="at">outlier_age =</span> <span class="fu">abs</span>(z_age) <span class="sc">&gt;</span> threshold,</span>
<span id="cb702-3401"><a href="#cb702-3401" aria-hidden="true" tabindex="-1"></a>    <span class="at">outlier_baseline =</span> <span class="fu">abs</span>(z_baseline) <span class="sc">&gt;</span> threshold,</span>
<span id="cb702-3402"><a href="#cb702-3402" aria-hidden="true" tabindex="-1"></a>    <span class="at">outlier_post =</span> <span class="fu">abs</span>(z_post) <span class="sc">&gt;</span> threshold,</span>
<span id="cb702-3403"><a href="#cb702-3403" aria-hidden="true" tabindex="-1"></a>    <span class="at">outlier_improvement =</span> <span class="fu">abs</span>(z_improvement) <span class="sc">&gt;</span> threshold,</span>
<span id="cb702-3404"><a href="#cb702-3404" aria-hidden="true" tabindex="-1"></a>    <span class="at">any_outlier =</span> outlier_age <span class="sc">|</span> outlier_baseline <span class="sc">|</span> outlier_post <span class="sc">|</span> outlier_improvement</span>
<span id="cb702-3405"><a href="#cb702-3405" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb702-3406"><a href="#cb702-3406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3407"><a href="#cb702-3407" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary of outliers</span></span>
<span id="cb702-3408"><a href="#cb702-3408" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Z-Score Outliers (|z| &gt;"</span>, threshold, <span class="st">"):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-3409"><a href="#cb702-3409" aria-hidden="true" tabindex="-1"></a>outliers_zscore <span class="sc">%&gt;%</span></span>
<span id="cb702-3410"><a href="#cb702-3410" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(any_outlier) <span class="sc">%&gt;%</span></span>
<span id="cb702-3411"><a href="#cb702-3411" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(participant_id, age, z_age, baseline_score, z_baseline, </span>
<span id="cb702-3412"><a href="#cb702-3412" aria-hidden="true" tabindex="-1"></a>         post_score, z_post, improvement, z_improvement)</span>
<span id="cb702-3413"><a href="#cb702-3413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3414"><a href="#cb702-3414" aria-hidden="true" tabindex="-1"></a><span class="co"># Count outliers per variable</span></span>
<span id="cb702-3415"><a href="#cb702-3415" aria-hidden="true" tabindex="-1"></a>outliers_zscore <span class="sc">%&gt;%</span></span>
<span id="cb702-3416"><a href="#cb702-3416" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb702-3417"><a href="#cb702-3417" aria-hidden="true" tabindex="-1"></a>    <span class="at">age_outliers =</span> <span class="fu">sum</span>(outlier_age),</span>
<span id="cb702-3418"><a href="#cb702-3418" aria-hidden="true" tabindex="-1"></a>    <span class="at">baseline_outliers =</span> <span class="fu">sum</span>(outlier_baseline),</span>
<span id="cb702-3419"><a href="#cb702-3419" aria-hidden="true" tabindex="-1"></a>    <span class="at">post_outliers =</span> <span class="fu">sum</span>(outlier_post),</span>
<span id="cb702-3420"><a href="#cb702-3420" aria-hidden="true" tabindex="-1"></a>    <span class="at">improvement_outliers =</span> <span class="fu">sum</span>(outlier_improvement),</span>
<span id="cb702-3421"><a href="#cb702-3421" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_flagged =</span> <span class="fu">sum</span>(any_outlier)</span>
<span id="cb702-3422"><a href="#cb702-3422" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb702-3423"><a href="#cb702-3423" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-3424"><a href="#cb702-3424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3425"><a href="#cb702-3425" aria-hidden="true" tabindex="-1"></a>**Checkpoint:** Participants 29 and 30 should be flagged as outliers on age; participant 29 also on baseline/post scores.</span>
<span id="cb702-3426"><a href="#cb702-3426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3427"><a href="#cb702-3427" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-3428"><a href="#cb702-3428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3429"><a href="#cb702-3429" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 3: Tukey Fences (Boxplot Method)</span></span>
<span id="cb702-3430"><a href="#cb702-3430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3431"><a href="#cb702-3431" aria-hidden="true" tabindex="-1"></a>Apply IQR-based outlier detection:</span>
<span id="cb702-3432"><a href="#cb702-3432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3433"><a href="#cb702-3433" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lab10-tukey}</span></span>
<span id="cb702-3434"><a href="#cb702-3434" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to calculate Tukey fences</span></span>
<span id="cb702-3435"><a href="#cb702-3435" aria-hidden="true" tabindex="-1"></a>tukey_outliers <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb702-3436"><a href="#cb702-3436" aria-hidden="true" tabindex="-1"></a>  Q1 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(x, <span class="fl">0.25</span>)</span>
<span id="cb702-3437"><a href="#cb702-3437" aria-hidden="true" tabindex="-1"></a>  Q3 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(x, <span class="fl">0.75</span>)</span>
<span id="cb702-3438"><a href="#cb702-3438" aria-hidden="true" tabindex="-1"></a>  IQR <span class="ot">&lt;-</span> Q3 <span class="sc">-</span> Q1</span>
<span id="cb702-3439"><a href="#cb702-3439" aria-hidden="true" tabindex="-1"></a>  lower_fence <span class="ot">&lt;-</span> Q1 <span class="sc">-</span> <span class="fl">1.5</span> <span class="sc">*</span> IQR</span>
<span id="cb702-3440"><a href="#cb702-3440" aria-hidden="true" tabindex="-1"></a>  upper_fence <span class="ot">&lt;-</span> Q3 <span class="sc">+</span> <span class="fl">1.5</span> <span class="sc">*</span> IQR</span>
<span id="cb702-3441"><a href="#cb702-3441" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x <span class="sc">&lt;</span> lower_fence <span class="sc">|</span> x <span class="sc">&gt;</span> upper_fence)</span>
<span id="cb702-3442"><a href="#cb702-3442" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb702-3443"><a href="#cb702-3443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3444"><a href="#cb702-3444" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify Tukey outliers</span></span>
<span id="cb702-3445"><a href="#cb702-3445" aria-hidden="true" tabindex="-1"></a>cognitive_tukey <span class="ot">&lt;-</span> cognitive_data <span class="sc">%&gt;%</span></span>
<span id="cb702-3446"><a href="#cb702-3446" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb702-3447"><a href="#cb702-3447" aria-hidden="true" tabindex="-1"></a>    <span class="at">tukey_age =</span> <span class="fu">tukey_outliers</span>(age),</span>
<span id="cb702-3448"><a href="#cb702-3448" aria-hidden="true" tabindex="-1"></a>    <span class="at">tukey_baseline =</span> <span class="fu">tukey_outliers</span>(baseline_score),</span>
<span id="cb702-3449"><a href="#cb702-3449" aria-hidden="true" tabindex="-1"></a>    <span class="at">tukey_post =</span> <span class="fu">tukey_outliers</span>(post_score),</span>
<span id="cb702-3450"><a href="#cb702-3450" aria-hidden="true" tabindex="-1"></a>    <span class="at">tukey_improvement =</span> <span class="fu">tukey_outliers</span>(improvement),</span>
<span id="cb702-3451"><a href="#cb702-3451" aria-hidden="true" tabindex="-1"></a>    <span class="at">any_tukey_outlier =</span> tukey_age <span class="sc">|</span> tukey_baseline <span class="sc">|</span> tukey_post <span class="sc">|</span> tukey_improvement</span>
<span id="cb702-3452"><a href="#cb702-3452" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb702-3453"><a href="#cb702-3453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3454"><a href="#cb702-3454" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary</span></span>
<span id="cb702-3455"><a href="#cb702-3455" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Tukey Fence Outliers:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-3456"><a href="#cb702-3456" aria-hidden="true" tabindex="-1"></a>cognitive_tukey <span class="sc">%&gt;%</span></span>
<span id="cb702-3457"><a href="#cb702-3457" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(any_tukey_outlier) <span class="sc">%&gt;%</span></span>
<span id="cb702-3458"><a href="#cb702-3458" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(participant_id, age, tukey_age, baseline_score, tukey_baseline,</span>
<span id="cb702-3459"><a href="#cb702-3459" aria-hidden="true" tabindex="-1"></a>         post_score, tukey_post)</span>
<span id="cb702-3460"><a href="#cb702-3460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3461"><a href="#cb702-3461" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize with outliers highlighted</span></span>
<span id="cb702-3462"><a href="#cb702-3462" aria-hidden="true" tabindex="-1"></a>cognitive_tukey <span class="sc">%&gt;%</span></span>
<span id="cb702-3463"><a href="#cb702-3463" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> improvement, <span class="at">color =</span> any_tukey_outlier)) <span class="sc">+</span></span>
<span id="cb702-3464"><a href="#cb702-3464" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb702-3465"><a href="#cb702-3465" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">if_else</span>(any_tukey_outlier, </span>
<span id="cb702-3466"><a href="#cb702-3466" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">as.character</span>(participant_id), <span class="st">""</span>)),</span>
<span id="cb702-3467"><a href="#cb702-3467" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.8</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb702-3468"><a href="#cb702-3468" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"red"</span>), </span>
<span id="cb702-3469"><a href="#cb702-3469" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Normal"</span>, <span class="st">"Outlier"</span>)) <span class="sc">+</span></span>
<span id="cb702-3470"><a href="#cb702-3470" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Age vs Improvement: Tukey Outliers Highlighted"</span>,</span>
<span id="cb702-3471"><a href="#cb702-3471" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Age"</span>, <span class="at">y =</span> <span class="st">"Improvement Score"</span>, <span class="at">color =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb702-3472"><a href="#cb702-3472" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb702-3473"><a href="#cb702-3473" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-3474"><a href="#cb702-3474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3475"><a href="#cb702-3475" aria-hidden="true" tabindex="-1"></a>**Checkpoint:** Tukey method should identify similar outliers as z-scores, particularly on age variable.</span>
<span id="cb702-3476"><a href="#cb702-3476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3477"><a href="#cb702-3477" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-3478"><a href="#cb702-3478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3479"><a href="#cb702-3479" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 4: Multivariate Outlier Detection (Mahalanobis Distance)</span></span>
<span id="cb702-3480"><a href="#cb702-3480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3481"><a href="#cb702-3481" aria-hidden="true" tabindex="-1"></a>Detect cases that are outlying in multivariate space:</span>
<span id="cb702-3482"><a href="#cb702-3482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3483"><a href="#cb702-3483" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lab10-mahalanobis}</span></span>
<span id="cb702-3484"><a href="#cb702-3484" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate Mahalanobis distance</span></span>
<span id="cb702-3485"><a href="#cb702-3485" aria-hidden="true" tabindex="-1"></a><span class="co"># Include age, baseline, post scores</span></span>
<span id="cb702-3486"><a href="#cb702-3486" aria-hidden="true" tabindex="-1"></a>outlier_vars <span class="ot">&lt;-</span> cognitive_data <span class="sc">%&gt;%</span></span>
<span id="cb702-3487"><a href="#cb702-3487" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(age, baseline_score, post_score) <span class="sc">%&gt;%</span></span>
<span id="cb702-3488"><a href="#cb702-3488" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>()</span>
<span id="cb702-3489"><a href="#cb702-3489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3490"><a href="#cb702-3490" aria-hidden="true" tabindex="-1"></a><span class="co"># Center and covariance</span></span>
<span id="cb702-3491"><a href="#cb702-3491" aria-hidden="true" tabindex="-1"></a>center <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(outlier_vars)</span>
<span id="cb702-3492"><a href="#cb702-3492" aria-hidden="true" tabindex="-1"></a>cov_matrix <span class="ot">&lt;-</span> <span class="fu">cov</span>(outlier_vars)</span>
<span id="cb702-3493"><a href="#cb702-3493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3494"><a href="#cb702-3494" aria-hidden="true" tabindex="-1"></a><span class="co"># Mahalanobis distances</span></span>
<span id="cb702-3495"><a href="#cb702-3495" aria-hidden="true" tabindex="-1"></a>mahal_dist <span class="ot">&lt;-</span> <span class="fu">mahalanobis</span>(outlier_vars, center, cov_matrix)</span>
<span id="cb702-3496"><a href="#cb702-3496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3497"><a href="#cb702-3497" aria-hidden="true" tabindex="-1"></a><span class="co"># Chi-square critical value (df = number of variables)</span></span>
<span id="cb702-3498"><a href="#cb702-3498" aria-hidden="true" tabindex="-1"></a><span class="co"># For 3 variables, chi-sq(3, 0.001) ≈ 13.8</span></span>
<span id="cb702-3499"><a href="#cb702-3499" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">ncol</span>(outlier_vars)</span>
<span id="cb702-3500"><a href="#cb702-3500" aria-hidden="true" tabindex="-1"></a>critical_value <span class="ot">&lt;-</span> <span class="fu">qchisq</span>(<span class="fl">0.999</span>, df)  <span class="co"># p &lt; 0.001</span></span>
<span id="cb702-3501"><a href="#cb702-3501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3502"><a href="#cb702-3502" aria-hidden="true" tabindex="-1"></a><span class="co"># Flag multivariate outliers</span></span>
<span id="cb702-3503"><a href="#cb702-3503" aria-hidden="true" tabindex="-1"></a>cognitive_mahal <span class="ot">&lt;-</span> cognitive_data <span class="sc">%&gt;%</span></span>
<span id="cb702-3504"><a href="#cb702-3504" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb702-3505"><a href="#cb702-3505" aria-hidden="true" tabindex="-1"></a>    <span class="at">mahal_distance =</span> mahal_dist,</span>
<span id="cb702-3506"><a href="#cb702-3506" aria-hidden="true" tabindex="-1"></a>    <span class="at">mahal_outlier =</span> mahal_dist <span class="sc">&gt;</span> critical_value,</span>
<span id="cb702-3507"><a href="#cb702-3507" aria-hidden="true" tabindex="-1"></a>    <span class="at">mahal_p =</span> <span class="fu">pchisq</span>(mahal_dist, df, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb702-3508"><a href="#cb702-3508" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb702-3509"><a href="#cb702-3509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3510"><a href="#cb702-3510" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary</span></span>
<span id="cb702-3511"><a href="#cb702-3511" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Mahalanobis Distance Outliers (χ² p &lt; 0.001):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-3512"><a href="#cb702-3512" aria-hidden="true" tabindex="-1"></a>cognitive_mahal <span class="sc">%&gt;%</span></span>
<span id="cb702-3513"><a href="#cb702-3513" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(mahal_outlier) <span class="sc">%&gt;%</span></span>
<span id="cb702-3514"><a href="#cb702-3514" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(participant_id, age, baseline_score, post_score, </span>
<span id="cb702-3515"><a href="#cb702-3515" aria-hidden="true" tabindex="-1"></a>         mahal_distance, mahal_p) <span class="sc">%&gt;%</span></span>
<span id="cb702-3516"><a href="#cb702-3516" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(mahal_distance))</span>
<span id="cb702-3517"><a href="#cb702-3517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3518"><a href="#cb702-3518" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize</span></span>
<span id="cb702-3519"><a href="#cb702-3519" aria-hidden="true" tabindex="-1"></a>cognitive_mahal <span class="sc">%&gt;%</span></span>
<span id="cb702-3520"><a href="#cb702-3520" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> participant_id, <span class="at">y =</span> mahal_distance, </span>
<span id="cb702-3521"><a href="#cb702-3521" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> mahal_outlier)) <span class="sc">+</span></span>
<span id="cb702-3522"><a href="#cb702-3522" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb702-3523"><a href="#cb702-3523" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> critical_value, <span class="at">linetype =</span> <span class="st">"dashed"</span>, </span>
<span id="cb702-3524"><a href="#cb702-3524" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb702-3525"><a href="#cb702-3525" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">if_else</span>(mahal_outlier, </span>
<span id="cb702-3526"><a href="#cb702-3526" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">as.character</span>(participant_id), <span class="st">""</span>)),</span>
<span id="cb702-3527"><a href="#cb702-3527" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.8</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb702-3528"><a href="#cb702-3528" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"red"</span>)) <span class="sc">+</span></span>
<span id="cb702-3529"><a href="#cb702-3529" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Mahalanobis Distance: Multivariate Outliers"</span>,</span>
<span id="cb702-3530"><a href="#cb702-3530" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">sprintf</span>(<span class="st">"Red line = critical value (χ²(%.0f) = %.2f)"</span>, </span>
<span id="cb702-3531"><a href="#cb702-3531" aria-hidden="true" tabindex="-1"></a>                         df, critical_value),</span>
<span id="cb702-3532"><a href="#cb702-3532" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Participant ID"</span>, <span class="at">y =</span> <span class="st">"Mahalanobis Distance"</span>) <span class="sc">+</span></span>
<span id="cb702-3533"><a href="#cb702-3533" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb702-3534"><a href="#cb702-3534" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb702-3535"><a href="#cb702-3535" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-3536"><a href="#cb702-3536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3537"><a href="#cb702-3537" aria-hidden="true" tabindex="-1"></a>**Checkpoint:** Participant 29 should be flagged as multivariate outlier (unusual combination of high age + low scores).</span>
<span id="cb702-3538"><a href="#cb702-3538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3539"><a href="#cb702-3539" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-3540"><a href="#cb702-3540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3541"><a href="#cb702-3541" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 5: Influential Cases (Cook's Distance)</span></span>
<span id="cb702-3542"><a href="#cb702-3542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3543"><a href="#cb702-3543" aria-hidden="true" tabindex="-1"></a>Identify cases with high influence on regression results:</span>
<span id="cb702-3544"><a href="#cb702-3544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3545"><a href="#cb702-3545" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lab10-cooks}</span></span>
<span id="cb702-3546"><a href="#cb702-3546" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit regression model (predicting improvement from age and baseline)</span></span>
<span id="cb702-3547"><a href="#cb702-3547" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(improvement <span class="sc">~</span> age <span class="sc">+</span> baseline_score, <span class="at">data =</span> cognitive_data)</span>
<span id="cb702-3548"><a href="#cb702-3548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3549"><a href="#cb702-3549" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate Cook's distance</span></span>
<span id="cb702-3550"><a href="#cb702-3550" aria-hidden="true" tabindex="-1"></a>cooks_d <span class="ot">&lt;-</span> <span class="fu">cooks.distance</span>(model)</span>
<span id="cb702-3551"><a href="#cb702-3551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3552"><a href="#cb702-3552" aria-hidden="true" tabindex="-1"></a><span class="co"># Flag influential cases (Cook's D &gt; 4/n threshold)</span></span>
<span id="cb702-3553"><a href="#cb702-3553" aria-hidden="true" tabindex="-1"></a>threshold_cooks <span class="ot">&lt;-</span> <span class="dv">4</span> <span class="sc">/</span> <span class="fu">nrow</span>(cognitive_data)</span>
<span id="cb702-3554"><a href="#cb702-3554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3555"><a href="#cb702-3555" aria-hidden="true" tabindex="-1"></a>cognitive_cooks <span class="ot">&lt;-</span> cognitive_data <span class="sc">%&gt;%</span></span>
<span id="cb702-3556"><a href="#cb702-3556" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb702-3557"><a href="#cb702-3557" aria-hidden="true" tabindex="-1"></a>    <span class="at">cooks_d =</span> cooks_d,</span>
<span id="cb702-3558"><a href="#cb702-3558" aria-hidden="true" tabindex="-1"></a>    <span class="at">influential =</span> cooks_d <span class="sc">&gt;</span> threshold_cooks</span>
<span id="cb702-3559"><a href="#cb702-3559" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb702-3560"><a href="#cb702-3560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3561"><a href="#cb702-3561" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary</span></span>
<span id="cb702-3562"><a href="#cb702-3562" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Influential Cases (Cook's D &gt; 4/n ="</span>, <span class="fu">round</span>(threshold_cooks, <span class="dv">3</span>), <span class="st">"):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-3563"><a href="#cb702-3563" aria-hidden="true" tabindex="-1"></a>cognitive_cooks <span class="sc">%&gt;%</span></span>
<span id="cb702-3564"><a href="#cb702-3564" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(influential) <span class="sc">%&gt;%</span></span>
<span id="cb702-3565"><a href="#cb702-3565" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(participant_id, age, baseline_score, improvement, cooks_d) <span class="sc">%&gt;%</span></span>
<span id="cb702-3566"><a href="#cb702-3566" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(cooks_d))</span>
<span id="cb702-3567"><a href="#cb702-3567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3568"><a href="#cb702-3568" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization with Cook's distance plot</span></span>
<span id="cb702-3569"><a href="#cb702-3569" aria-hidden="true" tabindex="-1"></a>cognitive_cooks <span class="sc">%&gt;%</span></span>
<span id="cb702-3570"><a href="#cb702-3570" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> participant_id, <span class="at">y =</span> cooks_d, <span class="at">fill =</span> influential)) <span class="sc">+</span></span>
<span id="cb702-3571"><a href="#cb702-3571" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb702-3572"><a href="#cb702-3572" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> threshold_cooks, <span class="at">linetype =</span> <span class="st">"dashed"</span>, </span>
<span id="cb702-3573"><a href="#cb702-3573" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb702-3574"><a href="#cb702-3574" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"gray70"</span>, <span class="st">"coral"</span>)) <span class="sc">+</span></span>
<span id="cb702-3575"><a href="#cb702-3575" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Cook's Distance: Influential Cases"</span>,</span>
<span id="cb702-3576"><a href="#cb702-3576" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">sprintf</span>(<span class="st">"Threshold = 4/n = %.3f"</span>, threshold_cooks),</span>
<span id="cb702-3577"><a href="#cb702-3577" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Participant ID"</span>, <span class="at">y =</span> <span class="st">"Cook's Distance"</span>) <span class="sc">+</span></span>
<span id="cb702-3578"><a href="#cb702-3578" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb702-3579"><a href="#cb702-3579" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb702-3580"><a href="#cb702-3580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3581"><a href="#cb702-3581" aria-hidden="true" tabindex="-1"></a><span class="co"># Influence plot</span></span>
<span id="cb702-3582"><a href="#cb702-3582" aria-hidden="true" tabindex="-1"></a><span class="fu">influencePlot</span>(model, <span class="at">main =</span> <span class="st">"Influence Plot"</span>, </span>
<span id="cb702-3583"><a href="#cb702-3583" aria-hidden="true" tabindex="-1"></a>              <span class="at">id =</span> <span class="fu">list</span>(<span class="at">n =</span> <span class="dv">3</span>, <span class="at">labels =</span> cognitive_data<span class="sc">$</span>participant_id))</span>
<span id="cb702-3584"><a href="#cb702-3584" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-3585"><a href="#cb702-3585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3586"><a href="#cb702-3586" aria-hidden="true" tabindex="-1"></a>**Checkpoint:** Some outliers (especially participant 29) should show high Cook's D, indicating strong influence on regression coefficients.</span>
<span id="cb702-3587"><a href="#cb702-3587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3588"><a href="#cb702-3588" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-3589"><a href="#cb702-3589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3590"><a href="#cb702-3590" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 6: Assess Normality Assumptions</span></span>
<span id="cb702-3591"><a href="#cb702-3591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3592"><a href="#cb702-3592" aria-hidden="true" tabindex="-1"></a>Check if data meet normality assumptions:</span>
<span id="cb702-3593"><a href="#cb702-3593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3594"><a href="#cb702-3594" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lab10-normality}</span></span>
<span id="cb702-3595"><a href="#cb702-3595" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb702-3596"><a href="#cb702-3596" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb702-3597"><a href="#cb702-3597" aria-hidden="true" tabindex="-1"></a><span class="co"># Q-Q plots for key variables</span></span>
<span id="cb702-3598"><a href="#cb702-3598" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb702-3599"><a href="#cb702-3599" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(cognitive_data<span class="sc">$</span>age, <span class="at">main =</span> <span class="st">"Q-Q Plot: Age"</span>)</span>
<span id="cb702-3600"><a href="#cb702-3600" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(cognitive_data<span class="sc">$</span>age, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb702-3601"><a href="#cb702-3601" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(cognitive_data<span class="sc">$</span>baseline_score, <span class="at">main =</span> <span class="st">"Q-Q Plot: Baseline"</span>)</span>
<span id="cb702-3602"><a href="#cb702-3602" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(cognitive_data<span class="sc">$</span>baseline_score, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb702-3603"><a href="#cb702-3603" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(cognitive_data<span class="sc">$</span>post_score, <span class="at">main =</span> <span class="st">"Q-Q Plot: Post"</span>)</span>
<span id="cb702-3604"><a href="#cb702-3604" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(cognitive_data<span class="sc">$</span>post_score, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb702-3605"><a href="#cb702-3605" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(cognitive_data<span class="sc">$</span>improvement, <span class="at">main =</span> <span class="st">"Q-Q Plot: Improvement"</span>)</span>
<span id="cb702-3606"><a href="#cb702-3606" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(cognitive_data<span class="sc">$</span>improvement, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb702-3607"><a href="#cb702-3607" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb702-3608"><a href="#cb702-3608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3609"><a href="#cb702-3609" aria-hidden="true" tabindex="-1"></a><span class="co"># Shapiro-Wilk tests</span></span>
<span id="cb702-3610"><a href="#cb702-3610" aria-hidden="true" tabindex="-1"></a>shapiro_results <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb702-3611"><a href="#cb702-3611" aria-hidden="true" tabindex="-1"></a>  <span class="at">Variable =</span> <span class="fu">c</span>(<span class="st">"Age"</span>, <span class="st">"Baseline Score"</span>, <span class="st">"Post Score"</span>, <span class="st">"Improvement"</span>),</span>
<span id="cb702-3612"><a href="#cb702-3612" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">W statistic</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb702-3613"><a href="#cb702-3613" aria-hidden="true" tabindex="-1"></a>    <span class="fu">shapiro.test</span>(cognitive_data<span class="sc">$</span>age)<span class="sc">$</span>statistic,</span>
<span id="cb702-3614"><a href="#cb702-3614" aria-hidden="true" tabindex="-1"></a>    <span class="fu">shapiro.test</span>(cognitive_data<span class="sc">$</span>baseline_score)<span class="sc">$</span>statistic,</span>
<span id="cb702-3615"><a href="#cb702-3615" aria-hidden="true" tabindex="-1"></a>    <span class="fu">shapiro.test</span>(cognitive_data<span class="sc">$</span>post_score)<span class="sc">$</span>statistic,</span>
<span id="cb702-3616"><a href="#cb702-3616" aria-hidden="true" tabindex="-1"></a>    <span class="fu">shapiro.test</span>(cognitive_data<span class="sc">$</span>improvement)<span class="sc">$</span>statistic</span>
<span id="cb702-3617"><a href="#cb702-3617" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb702-3618"><a href="#cb702-3618" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">p-value</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb702-3619"><a href="#cb702-3619" aria-hidden="true" tabindex="-1"></a>    <span class="fu">shapiro.test</span>(cognitive_data<span class="sc">$</span>age)<span class="sc">$</span>p.value,</span>
<span id="cb702-3620"><a href="#cb702-3620" aria-hidden="true" tabindex="-1"></a>    <span class="fu">shapiro.test</span>(cognitive_data<span class="sc">$</span>baseline_score)<span class="sc">$</span>p.value,</span>
<span id="cb702-3621"><a href="#cb702-3621" aria-hidden="true" tabindex="-1"></a>    <span class="fu">shapiro.test</span>(cognitive_data<span class="sc">$</span>post_score)<span class="sc">$</span>p.value,</span>
<span id="cb702-3622"><a href="#cb702-3622" aria-hidden="true" tabindex="-1"></a>    <span class="fu">shapiro.test</span>(cognitive_data<span class="sc">$</span>improvement)<span class="sc">$</span>p.value</span>
<span id="cb702-3623"><a href="#cb702-3623" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb702-3624"><a href="#cb702-3624" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Normal?</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">if_else</span>(<span class="st">`</span><span class="at">p-value</span><span class="st">`</span> <span class="sc">&gt;</span> <span class="fl">0.05</span>, <span class="st">"Yes"</span>, <span class="st">"No"</span>)</span>
<span id="cb702-3625"><a href="#cb702-3625" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb702-3626"><a href="#cb702-3626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3627"><a href="#cb702-3627" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(shapiro_results)</span>
<span id="cb702-3628"><a href="#cb702-3628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3629"><a href="#cb702-3629" aria-hidden="true" tabindex="-1"></a><span class="co"># Multivariate normality (Mardia's test)</span></span>
<span id="cb702-3630"><a href="#cb702-3630" aria-hidden="true" tabindex="-1"></a>mvn_result <span class="ot">&lt;-</span> <span class="fu">mvn</span>(cognitive_data <span class="sc">%&gt;%</span> <span class="fu">select</span>(age, baseline_score, post_score),</span>
<span id="cb702-3631"><a href="#cb702-3631" aria-hidden="true" tabindex="-1"></a>                  <span class="at">mvnTest =</span> <span class="st">"mardia"</span>)</span>
<span id="cb702-3632"><a href="#cb702-3632" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(mvn_result<span class="sc">$</span>multivariateNormality)</span>
<span id="cb702-3633"><a href="#cb702-3633" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-3634"><a href="#cb702-3634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3635"><a href="#cb702-3635" aria-hidden="true" tabindex="-1"></a>**Checkpoint:** Age likely violates normality (due to outliers). Other variables may be approximately normal.</span>
<span id="cb702-3636"><a href="#cb702-3636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3637"><a href="#cb702-3637" aria-hidden="true" tabindex="-1"></a>**Discussion:** When do normality violations matter? When can you proceed despite non-normality?</span>
<span id="cb702-3638"><a href="#cb702-3638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3639"><a href="#cb702-3639" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-3640"><a href="#cb702-3640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3641"><a href="#cb702-3641" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 7: Compare Analyses With/Without Outliers</span></span>
<span id="cb702-3642"><a href="#cb702-3642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3643"><a href="#cb702-3643" aria-hidden="true" tabindex="-1"></a>Assess impact of outliers on results:</span>
<span id="cb702-3644"><a href="#cb702-3644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3645"><a href="#cb702-3645" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lab10-impact}</span></span>
<span id="cb702-3646"><a href="#cb702-3646" aria-hidden="true" tabindex="-1"></a><span class="co"># Original model (with outliers)</span></span>
<span id="cb702-3647"><a href="#cb702-3647" aria-hidden="true" tabindex="-1"></a>model_full <span class="ot">&lt;-</span> <span class="fu">lm</span>(improvement <span class="sc">~</span> age <span class="sc">+</span> baseline_score, <span class="at">data =</span> cognitive_data)</span>
<span id="cb702-3648"><a href="#cb702-3648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3649"><a href="#cb702-3649" aria-hidden="true" tabindex="-1"></a><span class="co"># Model without identified outliers</span></span>
<span id="cb702-3650"><a href="#cb702-3650" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove participants flagged by multiple methods</span></span>
<span id="cb702-3651"><a href="#cb702-3651" aria-hidden="true" tabindex="-1"></a>outliers_to_remove <span class="ot">&lt;-</span> cognitive_mahal <span class="sc">%&gt;%</span></span>
<span id="cb702-3652"><a href="#cb702-3652" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(mahal_outlier) <span class="sc">%&gt;%</span></span>
<span id="cb702-3653"><a href="#cb702-3653" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(participant_id)</span>
<span id="cb702-3654"><a href="#cb702-3654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3655"><a href="#cb702-3655" aria-hidden="true" tabindex="-1"></a>cognitive_clean <span class="ot">&lt;-</span> cognitive_data <span class="sc">%&gt;%</span></span>
<span id="cb702-3656"><a href="#cb702-3656" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>participant_id <span class="sc">%in%</span> outliers_to_remove)</span>
<span id="cb702-3657"><a href="#cb702-3657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3658"><a href="#cb702-3658" aria-hidden="true" tabindex="-1"></a>model_clean <span class="ot">&lt;-</span> <span class="fu">lm</span>(improvement <span class="sc">~</span> age <span class="sc">+</span> baseline_score, <span class="at">data =</span> cognitive_clean)</span>
<span id="cb702-3659"><a href="#cb702-3659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3660"><a href="#cb702-3660" aria-hidden="true" tabindex="-1"></a><span class="co"># Comparison table</span></span>
<span id="cb702-3661"><a href="#cb702-3661" aria-hidden="true" tabindex="-1"></a>comparison <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb702-3662"><a href="#cb702-3662" aria-hidden="true" tabindex="-1"></a>  <span class="at">Model =</span> <span class="fu">c</span>(<span class="st">"With Outliers"</span>, <span class="st">"Without Outliers"</span>),</span>
<span id="cb702-3663"><a href="#cb702-3663" aria-hidden="true" tabindex="-1"></a>  <span class="at">N =</span> <span class="fu">c</span>(<span class="fu">nrow</span>(cognitive_data), <span class="fu">nrow</span>(cognitive_clean)),</span>
<span id="cb702-3664"><a href="#cb702-3664" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Intercept</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">coef</span>(model_full)[<span class="dv">1</span>], <span class="fu">coef</span>(model_clean)[<span class="dv">1</span>]),</span>
<span id="cb702-3665"><a href="#cb702-3665" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">β (Age)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">coef</span>(model_full)[<span class="dv">2</span>], <span class="fu">coef</span>(model_clean)[<span class="dv">2</span>]),</span>
<span id="cb702-3666"><a href="#cb702-3666" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">β (Baseline)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">coef</span>(model_full)[<span class="dv">3</span>], <span class="fu">coef</span>(model_clean)[<span class="dv">3</span>]),</span>
<span id="cb702-3667"><a href="#cb702-3667" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">R²</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">summary</span>(model_full)<span class="sc">$</span>r.squared, <span class="fu">summary</span>(model_clean)<span class="sc">$</span>r.squared),</span>
<span id="cb702-3668"><a href="#cb702-3668" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">RMSE</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">sigma</span>(model_full), <span class="fu">sigma</span>(model_clean))</span>
<span id="cb702-3669"><a href="#cb702-3669" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb702-3670"><a href="#cb702-3670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3671"><a href="#cb702-3671" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(comparison)</span>
<span id="cb702-3672"><a href="#cb702-3672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3673"><a href="#cb702-3673" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization</span></span>
<span id="cb702-3674"><a href="#cb702-3674" aria-hidden="true" tabindex="-1"></a>comparison <span class="sc">%&gt;%</span></span>
<span id="cb702-3675"><a href="#cb702-3675" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Model, <span class="st">`</span><span class="at">β (Age)</span><span class="st">`</span>, <span class="st">`</span><span class="at">β (Baseline)</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb702-3676"><a href="#cb702-3676" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>Model, <span class="at">names_to =</span> <span class="st">"Coefficient"</span>, <span class="at">values_to =</span> <span class="st">"Estimate"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb702-3677"><a href="#cb702-3677" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Coefficient, <span class="at">y =</span> Estimate, <span class="at">fill =</span> Model)) <span class="sc">+</span></span>
<span id="cb702-3678"><a href="#cb702-3678" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb702-3679"><a href="#cb702-3679" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Regression Coefficients: With vs Without Outliers"</span>,</span>
<span id="cb702-3680"><a href="#cb702-3680" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Coefficient Estimate"</span>) <span class="sc">+</span></span>
<span id="cb702-3681"><a href="#cb702-3681" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb702-3682"><a href="#cb702-3682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3683"><a href="#cb702-3683" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Interpretation:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-3684"><a href="#cb702-3684" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Removing outliers changed coefficients by:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-3685"><a href="#cb702-3685" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Age:"</span>, <span class="fu">round</span>(<span class="fu">abs</span>(<span class="fu">coef</span>(model_full)[<span class="dv">2</span>] <span class="sc">-</span> <span class="fu">coef</span>(model_clean)[<span class="dv">2</span>]), <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-3686"><a href="#cb702-3686" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Baseline:"</span>, <span class="fu">round</span>(<span class="fu">abs</span>(<span class="fu">coef</span>(model_full)[<span class="dv">3</span>] <span class="sc">-</span> <span class="fu">coef</span>(model_clean)[<span class="dv">3</span>]), <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-3687"><a href="#cb702-3687" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- R² increased by:"</span>, </span>
<span id="cb702-3688"><a href="#cb702-3688" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>((<span class="fu">summary</span>(model_clean)<span class="sc">$</span>r.squared <span class="sc">-</span> <span class="fu">summary</span>(model_full)<span class="sc">$</span>r.squared), <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-3689"><a href="#cb702-3689" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-3690"><a href="#cb702-3690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3691"><a href="#cb702-3691" aria-hidden="true" tabindex="-1"></a>**Checkpoint:** Removing outliers should improve model fit (higher R²) and potentially change coefficient estimates.</span>
<span id="cb702-3692"><a href="#cb702-3692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3693"><a href="#cb702-3693" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-3694"><a href="#cb702-3694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3695"><a href="#cb702-3695" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 8: Document Screening Decisions</span></span>
<span id="cb702-3696"><a href="#cb702-3696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3697"><a href="#cb702-3697" aria-hidden="true" tabindex="-1"></a>Create transparent reporting:</span>
<span id="cb702-3698"><a href="#cb702-3698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3699"><a href="#cb702-3699" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lab10-reporting}</span></span>
<span id="cb702-3700"><a href="#cb702-3700" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb702-3701"><a href="#cb702-3701" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb702-3702"><a href="#cb702-3702" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb702-3703"><a href="#cb702-3703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3704"><a href="#cb702-3704" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary of screening process</span></span>
<span id="cb702-3705"><a href="#cb702-3705" aria-hidden="true" tabindex="-1"></a>screening_summary <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb702-3706"><a href="#cb702-3706" aria-hidden="true" tabindex="-1"></a>  <span class="at">Method =</span> <span class="fu">c</span>(<span class="st">"Z-score (|z| &gt; 2.5)"</span>, </span>
<span id="cb702-3707"><a href="#cb702-3707" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Tukey Fences (1.5×IQR)"</span>,</span>
<span id="cb702-3708"><a href="#cb702-3708" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Mahalanobis Distance (χ² p &lt; .001)"</span>,</span>
<span id="cb702-3709"><a href="#cb702-3709" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Cook's Distance (&gt; 4/n)"</span>),</span>
<span id="cb702-3710"><a href="#cb702-3710" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Cases Flagged</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb702-3711"><a href="#cb702-3711" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sum</span>(outliers_zscore<span class="sc">$</span>any_outlier),</span>
<span id="cb702-3712"><a href="#cb702-3712" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sum</span>(cognitive_tukey<span class="sc">$</span>any_tukey_outlier),</span>
<span id="cb702-3713"><a href="#cb702-3713" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sum</span>(cognitive_mahal<span class="sc">$</span>mahal_outlier),</span>
<span id="cb702-3714"><a href="#cb702-3714" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sum</span>(cognitive_cooks<span class="sc">$</span>influential)</span>
<span id="cb702-3715"><a href="#cb702-3715" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb702-3716"><a href="#cb702-3716" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Cases Removed</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fu">length</span>(outliers_to_remove), <span class="cn">NA</span>),</span>
<span id="cb702-3717"><a href="#cb702-3717" aria-hidden="true" tabindex="-1"></a>  <span class="at">Decision =</span> <span class="fu">c</span>(<span class="st">"Noted"</span>, <span class="st">"Noted"</span>, <span class="st">"Removed from primary analysis"</span>, <span class="st">"Noted"</span>)</span>
<span id="cb702-3718"><a href="#cb702-3718" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb702-3719"><a href="#cb702-3719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3720"><a href="#cb702-3720" aria-hidden="true" tabindex="-1"></a>screening_summary <span class="sc">%&gt;%</span></span>
<span id="cb702-3721"><a href="#cb702-3721" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb702-3722"><a href="#cb702-3722" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb702-3723"><a href="#cb702-3723" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Data Screening Summary"</span>,</span>
<span id="cb702-3724"><a href="#cb702-3724" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Cognitive Performance Study (N=30)"</span></span>
<span id="cb702-3725"><a href="#cb702-3725" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb702-3726"><a href="#cb702-3726" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_footnote</span>(</span>
<span id="cb702-3727"><a href="#cb702-3727" aria-hidden="true" tabindex="-1"></a>    <span class="at">footnote =</span> <span class="fu">sprintf</span>(<span class="st">"Participants removed: %s"</span>, </span>
<span id="cb702-3728"><a href="#cb702-3728" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">paste</span>(outliers_to_remove, <span class="at">collapse =</span> <span class="st">", "</span>)),</span>
<span id="cb702-3729"><a href="#cb702-3729" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_body</span>(<span class="at">columns =</span> <span class="st">`</span><span class="at">Cases Removed</span><span class="st">`</span>, <span class="at">rows =</span> <span class="dv">3</span>)</span>
<span id="cb702-3730"><a href="#cb702-3730" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb702-3731"><a href="#cb702-3731" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_source_note</span>(</span>
<span id="cb702-3732"><a href="#cb702-3732" aria-hidden="true" tabindex="-1"></a>    <span class="at">source_note =</span> <span class="st">"Removed cases were multivariate outliers confirmed by multiple methods"</span></span>
<span id="cb702-3733"><a href="#cb702-3733" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb702-3734"><a href="#cb702-3734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3735"><a href="#cb702-3735" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample reporting paragraph</span></span>
<span id="cb702-3736"><a href="#cb702-3736" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Sample Reporting Statement:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-3737"><a href="#cb702-3737" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Data screening was conducted following established protocols. We examined</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-3738"><a href="#cb702-3738" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"univariate outliers using z-scores (|z| &gt; 2.5) and Tukey fences (1.5×IQR),</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-3739"><a href="#cb702-3739" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"multivariate outliers using Mahalanobis distance (χ² p &lt; .001), and</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-3740"><a href="#cb702-3740" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"influential cases using Cook's distance (&gt; 4/n). Participant 29 was</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-3741"><a href="#cb702-3741" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"identified as a multivariate outlier (extreme combination of age and</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-3742"><a href="#cb702-3742" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"cognitive scores) and removed from primary analyses. All analyses were</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-3743"><a href="#cb702-3743" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"also conducted with the full sample; substantive conclusions remained</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-3744"><a href="#cb702-3744" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"unchanged. Normality was assessed using Shapiro-Wilk tests and Q-Q plots;</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-3745"><a href="#cb702-3745" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"distributions were approximately normal except for age (W = "</span>,</span>
<span id="cb702-3746"><a href="#cb702-3746" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(shapiro_results<span class="sc">$</span><span class="st">`</span><span class="at">W statistic</span><span class="st">`</span>[<span class="dv">1</span>], <span class="dv">3</span>), <span class="st">", p = "</span>,</span>
<span id="cb702-3747"><a href="#cb702-3747" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(shapiro_results<span class="sc">$</span><span class="st">`</span><span class="at">p-value</span><span class="st">`</span>[<span class="dv">1</span>], <span class="dv">3</span>), <span class="st">").</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-3748"><a href="#cb702-3748" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-3749"><a href="#cb702-3749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3750"><a href="#cb702-3750" aria-hidden="true" tabindex="-1"></a>**Checkpoint:** Professional documentation suitable for methods section or supplementary materials.</span>
<span id="cb702-3751"><a href="#cb702-3751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3752"><a href="#cb702-3752" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-3753"><a href="#cb702-3753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3754"><a href="#cb702-3754" aria-hidden="true" tabindex="-1"></a><span class="fu">### Discussion Questions</span></span>
<span id="cb702-3755"><a href="#cb702-3755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3756"><a href="#cb702-3756" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Multiple Methods:** Why use multiple outlier detection methods instead of just one?</span>
<span id="cb702-3757"><a href="#cb702-3757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3758"><a href="#cb702-3758" aria-hidden="true" tabindex="-1"></a>   *Answer: Different methods detect different types of outliers (univariate vs multivariate, influential vs extreme). Convergent evidence from multiple methods increases confidence. Cases flagged by only one method may be borderline and warrant closer inspection.*</span>
<span id="cb702-3759"><a href="#cb702-3759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3760"><a href="#cb702-3760" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**To Remove or Not:** When should you remove outliers vs retain them?</span>
<span id="cb702-3761"><a href="#cb702-3761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3762"><a href="#cb702-3762" aria-hidden="true" tabindex="-1"></a>   *Answer: Remove if: (1) data entry error (verify first), (2) procedural error (e.g., equipment malfunction), (3) not from target population. Retain if: (1) legitimate extreme values from population, (2) no clear reason for exclusion, (3) reflects real variability. Always report analyses both ways.*</span>
<span id="cb702-3763"><a href="#cb702-3763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3764"><a href="#cb702-3764" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Small Sample Impact:** Why are outliers particularly problematic in small samples?</span>
<span id="cb702-3765"><a href="#cb702-3765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3766"><a href="#cb702-3766" aria-hidden="true" tabindex="-1"></a>   *Answer: With small n, a single outlier can have disproportionate influence on means, correlations, and regression coefficients. One case can change statistical significance. Effect is diluted in large samples.*</span>
<span id="cb702-3767"><a href="#cb702-3767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3768"><a href="#cb702-3768" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Normality Violations:** The Shapiro-Wilk test rejected normality, but should you still use parametric tests?</span>
<span id="cb702-3769"><a href="#cb702-3769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3770"><a href="#cb702-3770" aria-hidden="true" tabindex="-1"></a>   *Answer: Depends on: (1) severity of violation, (2) sample size (CLT helps with larger n), (3) robustness of test (t-tests are robust to moderate non-normality), (4) availability of alternatives (nonparametric tests, transformations, robust methods).*</span>
<span id="cb702-3771"><a href="#cb702-3771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3772"><a href="#cb702-3772" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>**Transparency:** What should you report about outlier treatment?</span>
<span id="cb702-3773"><a href="#cb702-3773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3774"><a href="#cb702-3774" aria-hidden="true" tabindex="-1"></a>   *Answer: Report: (1) detection methods used, (2) number and identification of outliers, (3) decisions made (kept/removed), (4) justification for decisions, (5) sensitivity analyses showing results with/without outliers. Pre-register outlier criteria when possible.*</span>
<span id="cb702-3775"><a href="#cb702-3775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3776"><a href="#cb702-3776" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-3777"><a href="#cb702-3777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3778"><a href="#cb702-3778" aria-hidden="true" tabindex="-1"></a><span class="fu">### Key Takeaways</span></span>
<span id="cb702-3779"><a href="#cb702-3779" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3780"><a href="#cb702-3780" aria-hidden="true" tabindex="-1"></a>✓ **Screen data systematically** using multiple detection methods  </span>
<span id="cb702-3781"><a href="#cb702-3781" aria-hidden="true" tabindex="-1"></a>✓ **Univariate outliers** (z-scores, Tukey) detect extreme values on single variables  </span>
<span id="cb702-3782"><a href="#cb702-3782" aria-hidden="true" tabindex="-1"></a>✓ **Multivariate outliers** (Mahalanobis) detect unusual combinations of values  </span>
<span id="cb702-3783"><a href="#cb702-3783" aria-hidden="true" tabindex="-1"></a>✓ **Influential cases** (Cook's D) have high leverage on regression results  </span>
<span id="cb702-3784"><a href="#cb702-3784" aria-hidden="true" tabindex="-1"></a>✓ **Always compare results** with and without outliers (sensitivity analysis)  </span>
<span id="cb702-3785"><a href="#cb702-3785" aria-hidden="true" tabindex="-1"></a>✓ **Document decisions transparently** – report criteria, cases removed, justification  </span>
<span id="cb702-3786"><a href="#cb702-3786" aria-hidden="true" tabindex="-1"></a>✓ **In small samples**, outliers have disproportionate impact on results  </span>
<span id="cb702-3787"><a href="#cb702-3787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3788"><a href="#cb702-3788" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-3789"><a href="#cb702-3789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3790"><a href="#cb702-3790" aria-hidden="true" tabindex="-1"></a><span class="fu">### Homework Exercise</span></span>
<span id="cb702-3791"><a href="#cb702-3791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3792"><a href="#cb702-3792" aria-hidden="true" tabindex="-1"></a>**Dataset:** A pilot training study (n=28) measuring reaction time, accuracy, and learning rate.</span>
<span id="cb702-3793"><a href="#cb702-3793" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3794"><a href="#cb702-3794" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lab10-homework-data}</span></span>
<span id="cb702-3795"><a href="#cb702-3795" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">321</span>)</span>
<span id="cb702-3796"><a href="#cb702-3796" aria-hidden="true" tabindex="-1"></a>training_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb702-3797"><a href="#cb702-3797" aria-hidden="true" tabindex="-1"></a>  <span class="at">participant_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">28</span>,</span>
<span id="cb702-3798"><a href="#cb702-3798" aria-hidden="true" tabindex="-1"></a>  <span class="at">reaction_time_ms =</span> <span class="fu">c</span>(<span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="dv">26</span>, <span class="dv">300</span>, <span class="dv">40</span>)), <span class="dv">150</span>, <span class="dv">520</span>),  <span class="co"># 2 outliers</span></span>
<span id="cb702-3799"><a href="#cb702-3799" aria-hidden="true" tabindex="-1"></a>  <span class="at">accuracy_pct =</span> <span class="fu">c</span>(<span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="dv">26</span>, <span class="dv">85</span>, <span class="dv">8</span>)), <span class="dv">55</span>, <span class="dv">98</span>),</span>
<span id="cb702-3800"><a href="#cb702-3800" aria-hidden="true" tabindex="-1"></a>  <span class="at">learning_rate =</span> <span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="dv">28</span>, <span class="dv">12</span>, <span class="dv">4</span>), <span class="dv">1</span>)</span>
<span id="cb702-3801"><a href="#cb702-3801" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb702-3802"><a href="#cb702-3802" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb702-3803"><a href="#cb702-3803" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add multivariate outlier</span></span>
<span id="cb702-3804"><a href="#cb702-3804" aria-hidden="true" tabindex="-1"></a>    <span class="at">accuracy_pct =</span> <span class="fu">if_else</span>(participant_id <span class="sc">==</span> <span class="dv">27</span>, <span class="dv">55</span>, accuracy_pct),</span>
<span id="cb702-3805"><a href="#cb702-3805" aria-hidden="true" tabindex="-1"></a>    <span class="at">learning_rate =</span> <span class="fu">if_else</span>(participant_id <span class="sc">==</span> <span class="dv">27</span>, <span class="dv">3</span>, learning_rate)</span>
<span id="cb702-3806"><a href="#cb702-3806" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb702-3807"><a href="#cb702-3807" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-3808"><a href="#cb702-3808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3809"><a href="#cb702-3809" aria-hidden="true" tabindex="-1"></a>**Your Tasks:**</span>
<span id="cb702-3810"><a href="#cb702-3810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3811"><a href="#cb702-3811" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Create boxplots for all three variables</span>
<span id="cb702-3812"><a href="#cb702-3812" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Calculate z-scores and flag outliers (|z| &gt; 2.5)</span>
<span id="cb702-3813"><a href="#cb702-3813" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Apply Tukey fences to identify IQR-based outliers</span>
<span id="cb702-3814"><a href="#cb702-3814" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Calculate Mahalanobis distances and flag multivariate outliers (p &lt; .001)</span>
<span id="cb702-3815"><a href="#cb702-3815" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>Fit a regression model (reaction_time ~ accuracy + learning_rate) and calculate Cook's D</span>
<span id="cb702-3816"><a href="#cb702-3816" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span>Identify influential cases (Cook's D &gt; 4/n)</span>
<span id="cb702-3817"><a href="#cb702-3817" aria-hidden="true" tabindex="-1"></a><span class="ss">7. </span>Create Q-Q plots and run Shapiro-Wilk tests for normality</span>
<span id="cb702-3818"><a href="#cb702-3818" aria-hidden="true" tabindex="-1"></a><span class="ss">8. </span>Compare regression results with vs without identified outliers</span>
<span id="cb702-3819"><a href="#cb702-3819" aria-hidden="true" tabindex="-1"></a><span class="ss">9. </span>Create a data screening summary table</span>
<span id="cb702-3820"><a href="#cb702-3820" aria-hidden="true" tabindex="-1"></a><span class="ss">10. </span>Write a methods paragraph documenting your screening process</span>
<span id="cb702-3821"><a href="#cb702-3821" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3822"><a href="#cb702-3822" aria-hidden="true" tabindex="-1"></a>**Expected Results:**</span>
<span id="cb702-3823"><a href="#cb702-3823" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3824"><a href="#cb702-3824" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Participants 27 and 28 flagged by multiple methods</span>
<span id="cb702-3825"><a href="#cb702-3825" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Participant 27: multivariate outlier (low accuracy + low learning rate)</span>
<span id="cb702-3826"><a href="#cb702-3826" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Participant 28: univariate outlier (high reaction time)</span>
<span id="cb702-3827"><a href="#cb702-3827" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Shapiro-Wilk may reject normality for reaction_time</span>
<span id="cb702-3828"><a href="#cb702-3828" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Removing outliers should improve regression R² and reduce RMSE</span>
<span id="cb702-3829"><a href="#cb702-3829" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>At least 2-3 cases exceed Cook's D threshold</span>
<span id="cb702-3830"><a href="#cb702-3830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3831"><a href="#cb702-3831" aria-hidden="true" tabindex="-1"></a>**Hints:**</span>
<span id="cb702-3832"><a href="#cb702-3832" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Use <span class="in">`scale()`</span> for z-scores</span>
<span id="cb702-3833"><a href="#cb702-3833" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>For Mahalanobis: <span class="in">`mahalanobis(data, center, cov)`</span> with <span class="in">`qchisq(0.999, df)`</span></span>
<span id="cb702-3834"><a href="#cb702-3834" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Check <span class="in">`influencePlot(model)`</span> for visual diagnostic</span>
<span id="cb702-3835"><a href="#cb702-3835" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Compare <span class="in">`summary(model_full)`</span> vs <span class="in">`summary(model_clean)`</span></span>
<span id="cb702-3836"><a href="#cb702-3836" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3837"><a href="#cb702-3837" aria-hidden="true" tabindex="-1"></a>**Bonus:** Perform a Winsorization alternative: instead of removing outliers, replace them with the value at the 5th/95th percentile. Compare results from (1) original data, (2) outliers removed, and (3) outliers Winsorized. Which approach is most conservative? Most liberal?</span>
<span id="cb702-3838"><a href="#cb702-3838" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3839"><a href="#cb702-3839" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-3840"><a href="#cb702-3840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3841"><a href="#cb702-3841" aria-hidden="true" tabindex="-1"></a><span class="fu">## Lab 11: Effect Sizes and Confidence Intervals {#lab-effect-sizes}</span></span>
<span id="cb702-3842"><a href="#cb702-3842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3843"><a href="#cb702-3843" aria-hidden="true" tabindex="-1"></a>**Learning Objectives:**</span>
<span id="cb702-3844"><a href="#cb702-3844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3845"><a href="#cb702-3845" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Calculate standardized effect sizes (Cohen's d, r, odds ratios)</span>
<span id="cb702-3846"><a href="#cb702-3846" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Compute confidence intervals for effect sizes</span>
<span id="cb702-3847"><a href="#cb702-3847" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Interpret effect size magnitudes using Cohen's benchmarks</span>
<span id="cb702-3848"><a href="#cb702-3848" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Distinguish between statistical and practical significance</span>
<span id="cb702-3849"><a href="#cb702-3849" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Report effect sizes following APA guidelines</span>
<span id="cb702-3850"><a href="#cb702-3850" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Visualize effect sizes with forest plots</span>
<span id="cb702-3851"><a href="#cb702-3851" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3852"><a href="#cb702-3852" aria-hidden="true" tabindex="-1"></a>**Scenario:** You conducted a small pilot study (n=24, 12 per group) comparing two teaching methods on test scores. The results are statistically significant, but you need to quantify and interpret the effect size to assess practical importance.</span>
<span id="cb702-3853"><a href="#cb702-3853" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3854"><a href="#cb702-3854" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 1: Set Up and Load Data</span></span>
<span id="cb702-3855"><a href="#cb702-3855" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3856"><a href="#cb702-3856" aria-hidden="true" tabindex="-1"></a>Create two-group comparison data:</span>
<span id="cb702-3857"><a href="#cb702-3857" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3858"><a href="#cb702-3858" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lab11-data}</span></span>
<span id="cb702-3859"><a href="#cb702-3859" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb702-3860"><a href="#cb702-3860" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(effsize)    <span class="co"># For effect size calculations</span></span>
<span id="cb702-3861"><a href="#cb702-3861" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MBESS)      <span class="co"># For CIs on effect sizes</span></span>
<span id="cb702-3862"><a href="#cb702-3862" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb702-3863"><a href="#cb702-3863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3864"><a href="#cb702-3864" aria-hidden="true" tabindex="-1"></a><span class="co"># Set seed for reproducibility</span></span>
<span id="cb702-3865"><a href="#cb702-3865" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb702-3866"><a href="#cb702-3866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3867"><a href="#cb702-3867" aria-hidden="true" tabindex="-1"></a><span class="co"># Two-group study: Method A vs Method B</span></span>
<span id="cb702-3868"><a href="#cb702-3868" aria-hidden="true" tabindex="-1"></a>teaching_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb702-3869"><a href="#cb702-3869" aria-hidden="true" tabindex="-1"></a>  <span class="at">student_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">24</span>,</span>
<span id="cb702-3870"><a href="#cb702-3870" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Method A"</span>, <span class="st">"Method B"</span>), <span class="at">each =</span> <span class="dv">12</span>),</span>
<span id="cb702-3871"><a href="#cb702-3871" aria-hidden="true" tabindex="-1"></a>  <span class="at">test_score =</span> <span class="fu">c</span>(</span>
<span id="cb702-3872"><a href="#cb702-3872" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="dv">12</span>, <span class="dv">75</span>, <span class="dv">10</span>)),  <span class="co"># Method A: M=75, SD=10</span></span>
<span id="cb702-3873"><a href="#cb702-3873" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="dv">12</span>, <span class="dv">85</span>, <span class="dv">12</span>))   <span class="co"># Method B: M=85, SD=12</span></span>
<span id="cb702-3874"><a href="#cb702-3874" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb702-3875"><a href="#cb702-3875" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb702-3876"><a href="#cb702-3876" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3877"><a href="#cb702-3877" aria-hidden="true" tabindex="-1"></a><span class="co"># Descriptive statistics</span></span>
<span id="cb702-3878"><a href="#cb702-3878" aria-hidden="true" tabindex="-1"></a>teaching_summary <span class="ot">&lt;-</span> teaching_data <span class="sc">%&gt;%</span></span>
<span id="cb702-3879"><a href="#cb702-3879" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(method) <span class="sc">%&gt;%</span></span>
<span id="cb702-3880"><a href="#cb702-3880" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb702-3881"><a href="#cb702-3881" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb702-3882"><a href="#cb702-3882" aria-hidden="true" tabindex="-1"></a>    <span class="at">M =</span> <span class="fu">mean</span>(test_score),</span>
<span id="cb702-3883"><a href="#cb702-3883" aria-hidden="true" tabindex="-1"></a>    <span class="at">SD =</span> <span class="fu">sd</span>(test_score),</span>
<span id="cb702-3884"><a href="#cb702-3884" aria-hidden="true" tabindex="-1"></a>    <span class="at">SE =</span> SD <span class="sc">/</span> <span class="fu">sqrt</span>(n),</span>
<span id="cb702-3885"><a href="#cb702-3885" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb702-3886"><a href="#cb702-3886" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb702-3887"><a href="#cb702-3887" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3888"><a href="#cb702-3888" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(teaching_summary)</span>
<span id="cb702-3889"><a href="#cb702-3889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3890"><a href="#cb702-3890" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize raw data</span></span>
<span id="cb702-3891"><a href="#cb702-3891" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(teaching_data, <span class="fu">aes</span>(<span class="at">x =</span> method, <span class="at">y =</span> test_score, <span class="at">fill =</span> method)) <span class="sc">+</span></span>
<span id="cb702-3892"><a href="#cb702-3892" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb702-3893"><a href="#cb702-3893" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb702-3894"><a href="#cb702-3894" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"point"</span>, <span class="at">shape =</span> <span class="dv">23</span>, </span>
<span id="cb702-3895"><a href="#cb702-3895" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">4</span>, <span class="at">fill =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb702-3896"><a href="#cb702-3896" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Test Scores by Teaching Method"</span>,</span>
<span id="cb702-3897"><a href="#cb702-3897" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Teaching Method"</span>, <span class="at">y =</span> <span class="st">"Test Score"</span>) <span class="sc">+</span></span>
<span id="cb702-3898"><a href="#cb702-3898" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb702-3899"><a href="#cb702-3899" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb702-3900"><a href="#cb702-3900" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-3901"><a href="#cb702-3901" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3902"><a href="#cb702-3902" aria-hidden="true" tabindex="-1"></a>**Checkpoint:** You should see n=12 per group with Method B showing higher mean scores.</span>
<span id="cb702-3903"><a href="#cb702-3903" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3904"><a href="#cb702-3904" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-3905"><a href="#cb702-3905" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3906"><a href="#cb702-3906" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 2: Calculate Cohen's d</span></span>
<span id="cb702-3907"><a href="#cb702-3907" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3908"><a href="#cb702-3908" aria-hidden="true" tabindex="-1"></a>Compute standardized mean difference:</span>
<span id="cb702-3909"><a href="#cb702-3909" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3910"><a href="#cb702-3910" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lab11-cohens-d}</span></span>
<span id="cb702-3911"><a href="#cb702-3911" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract groups</span></span>
<span id="cb702-3912"><a href="#cb702-3912" aria-hidden="true" tabindex="-1"></a>method_a <span class="ot">&lt;-</span> teaching_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(method <span class="sc">==</span> <span class="st">"Method A"</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(test_score)</span>
<span id="cb702-3913"><a href="#cb702-3913" aria-hidden="true" tabindex="-1"></a>method_b <span class="ot">&lt;-</span> teaching_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(method <span class="sc">==</span> <span class="st">"Method B"</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(test_score)</span>
<span id="cb702-3914"><a href="#cb702-3914" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3915"><a href="#cb702-3915" aria-hidden="true" tabindex="-1"></a><span class="co"># Cohen's d with pooled SD</span></span>
<span id="cb702-3916"><a href="#cb702-3916" aria-hidden="true" tabindex="-1"></a>cohen_d_result <span class="ot">&lt;-</span> <span class="fu">cohen.d</span>(method_b, method_a)</span>
<span id="cb702-3917"><a href="#cb702-3917" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cohen_d_result)</span>
<span id="cb702-3918"><a href="#cb702-3918" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3919"><a href="#cb702-3919" aria-hidden="true" tabindex="-1"></a><span class="co"># Manual calculation for verification</span></span>
<span id="cb702-3920"><a href="#cb702-3920" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(method_a)</span>
<span id="cb702-3921"><a href="#cb702-3921" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">mean</span>(method_b)</span>
<span id="cb702-3922"><a href="#cb702-3922" aria-hidden="true" tabindex="-1"></a>sd1 <span class="ot">&lt;-</span> <span class="fu">sd</span>(method_a)</span>
<span id="cb702-3923"><a href="#cb702-3923" aria-hidden="true" tabindex="-1"></a>sd2 <span class="ot">&lt;-</span> <span class="fu">sd</span>(method_b)</span>
<span id="cb702-3924"><a href="#cb702-3924" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="fu">length</span>(method_a)</span>
<span id="cb702-3925"><a href="#cb702-3925" aria-hidden="true" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> <span class="fu">length</span>(method_b)</span>
<span id="cb702-3926"><a href="#cb702-3926" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3927"><a href="#cb702-3927" aria-hidden="true" tabindex="-1"></a><span class="co"># Pooled SD</span></span>
<span id="cb702-3928"><a href="#cb702-3928" aria-hidden="true" tabindex="-1"></a>pooled_sd <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(((n1 <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> sd1<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (n2 <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> sd2<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> (n1 <span class="sc">+</span> n2 <span class="sc">-</span> <span class="dv">2</span>))</span>
<span id="cb702-3929"><a href="#cb702-3929" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3930"><a href="#cb702-3930" aria-hidden="true" tabindex="-1"></a><span class="co"># Cohen's d</span></span>
<span id="cb702-3931"><a href="#cb702-3931" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> (m2 <span class="sc">-</span> m1) <span class="sc">/</span> pooled_sd</span>
<span id="cb702-3932"><a href="#cb702-3932" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3933"><a href="#cb702-3933" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Manual Calculation:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-3934"><a href="#cb702-3934" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Mean difference:"</span>, <span class="fu">round</span>(m2 <span class="sc">-</span> m1, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-3935"><a href="#cb702-3935" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Pooled SD:"</span>, <span class="fu">round</span>(pooled_sd, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-3936"><a href="#cb702-3936" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Cohen's d:"</span>, <span class="fu">round</span>(d, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-3937"><a href="#cb702-3937" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3938"><a href="#cb702-3938" aria-hidden="true" tabindex="-1"></a><span class="co"># Interpretation using Cohen's benchmarks</span></span>
<span id="cb702-3939"><a href="#cb702-3939" aria-hidden="true" tabindex="-1"></a>interpretation <span class="ot">&lt;-</span> <span class="fu">case_when</span>(</span>
<span id="cb702-3940"><a href="#cb702-3940" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abs</span>(d) <span class="sc">&lt;</span> <span class="fl">0.2</span> <span class="sc">~</span> <span class="st">"Negligible"</span>,</span>
<span id="cb702-3941"><a href="#cb702-3941" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abs</span>(d) <span class="sc">&lt;</span> <span class="fl">0.5</span> <span class="sc">~</span> <span class="st">"Small"</span>,</span>
<span id="cb702-3942"><a href="#cb702-3942" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abs</span>(d) <span class="sc">&lt;</span> <span class="fl">0.8</span> <span class="sc">~</span> <span class="st">"Medium"</span>,</span>
<span id="cb702-3943"><a href="#cb702-3943" aria-hidden="true" tabindex="-1"></a>  <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Large"</span></span>
<span id="cb702-3944"><a href="#cb702-3944" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb702-3945"><a href="#cb702-3945" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Interpretation:"</span>, interpretation, <span class="st">"effect</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-3946"><a href="#cb702-3946" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-3947"><a href="#cb702-3947" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3948"><a href="#cb702-3948" aria-hidden="true" tabindex="-1"></a>**Checkpoint:** Cohen's d should be approximately 0.6-0.9 (medium to large effect).</span>
<span id="cb702-3949"><a href="#cb702-3949" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3950"><a href="#cb702-3950" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-3951"><a href="#cb702-3951" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3952"><a href="#cb702-3952" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 3: Compute Confidence Interval for d</span></span>
<span id="cb702-3953"><a href="#cb702-3953" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3954"><a href="#cb702-3954" aria-hidden="true" tabindex="-1"></a>Calculate 95% CI around the effect size:</span>
<span id="cb702-3955"><a href="#cb702-3955" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3956"><a href="#cb702-3956" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lab11-ci-d}</span></span>
<span id="cb702-3957"><a href="#cb702-3957" aria-hidden="true" tabindex="-1"></a><span class="co"># Confidence interval for Cohen's d using MBESS</span></span>
<span id="cb702-3958"><a href="#cb702-3958" aria-hidden="true" tabindex="-1"></a>ci_d <span class="ot">&lt;-</span> <span class="fu">ci.smd</span>(</span>
<span id="cb702-3959"><a href="#cb702-3959" aria-hidden="true" tabindex="-1"></a>  <span class="at">smd =</span> d,</span>
<span id="cb702-3960"><a href="#cb702-3960" aria-hidden="true" tabindex="-1"></a>  <span class="at">n.1 =</span> n1,</span>
<span id="cb702-3961"><a href="#cb702-3961" aria-hidden="true" tabindex="-1"></a>  <span class="at">n.2 =</span> n2,</span>
<span id="cb702-3962"><a href="#cb702-3962" aria-hidden="true" tabindex="-1"></a>  <span class="at">conf.level =</span> <span class="fl">0.95</span></span>
<span id="cb702-3963"><a href="#cb702-3963" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb702-3964"><a href="#cb702-3964" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3965"><a href="#cb702-3965" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"95% Confidence Interval for Cohen's d:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-3966"><a href="#cb702-3966" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"["</span>, <span class="fu">round</span>(ci_d<span class="sc">$</span>Lower.Conf.Limit.smd, <span class="dv">3</span>), <span class="st">", "</span>,</span>
<span id="cb702-3967"><a href="#cb702-3967" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(ci_d<span class="sc">$</span>Upper.Conf.Limit.smd, <span class="dv">3</span>), <span class="st">"]</span><span class="sc">\n</span><span class="st">"</span>, <span class="at">sep =</span> <span class="st">""</span>)</span>
<span id="cb702-3968"><a href="#cb702-3968" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3969"><a href="#cb702-3969" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternative: bootstrap CI</span></span>
<span id="cb702-3970"><a href="#cb702-3970" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb702-3971"><a href="#cb702-3971" aria-hidden="true" tabindex="-1"></a>cohens_d_boot <span class="ot">&lt;-</span> <span class="cf">function</span>(data, indices) {</span>
<span id="cb702-3972"><a href="#cb702-3972" aria-hidden="true" tabindex="-1"></a>  d <span class="ot">&lt;-</span> data[indices, ]</span>
<span id="cb702-3973"><a href="#cb702-3973" aria-hidden="true" tabindex="-1"></a>  a <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> <span class="fu">filter</span>(method <span class="sc">==</span> <span class="st">"Method A"</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(test_score)</span>
<span id="cb702-3974"><a href="#cb702-3974" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> <span class="fu">filter</span>(method <span class="sc">==</span> <span class="st">"Method B"</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(test_score)</span>
<span id="cb702-3975"><a href="#cb702-3975" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb702-3976"><a href="#cb702-3976" aria-hidden="true" tabindex="-1"></a>  m_a <span class="ot">&lt;-</span> <span class="fu">mean</span>(a)</span>
<span id="cb702-3977"><a href="#cb702-3977" aria-hidden="true" tabindex="-1"></a>  m_b <span class="ot">&lt;-</span> <span class="fu">mean</span>(b)</span>
<span id="cb702-3978"><a href="#cb702-3978" aria-hidden="true" tabindex="-1"></a>  sd_pooled <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(((<span class="fu">length</span>(a) <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">sd</span>(a)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> </span>
<span id="cb702-3979"><a href="#cb702-3979" aria-hidden="true" tabindex="-1"></a>                      (<span class="fu">length</span>(b) <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">sd</span>(b)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> </span>
<span id="cb702-3980"><a href="#cb702-3980" aria-hidden="true" tabindex="-1"></a>                     (<span class="fu">length</span>(a) <span class="sc">+</span> <span class="fu">length</span>(b) <span class="sc">-</span> <span class="dv">2</span>))</span>
<span id="cb702-3981"><a href="#cb702-3981" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb702-3982"><a href="#cb702-3982" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>((m_b <span class="sc">-</span> m_a) <span class="sc">/</span> sd_pooled)</span>
<span id="cb702-3983"><a href="#cb702-3983" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb702-3984"><a href="#cb702-3984" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3985"><a href="#cb702-3985" aria-hidden="true" tabindex="-1"></a>boot_result <span class="ot">&lt;-</span> <span class="fu">boot</span>(teaching_data, cohens_d_boot, <span class="at">R =</span> <span class="dv">2000</span>)</span>
<span id="cb702-3986"><a href="#cb702-3986" aria-hidden="true" tabindex="-1"></a>boot_ci <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(boot_result, <span class="at">type =</span> <span class="st">"bca"</span>)</span>
<span id="cb702-3987"><a href="#cb702-3987" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3988"><a href="#cb702-3988" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Bootstrap 95% CI (BCa method):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-3989"><a href="#cb702-3989" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"["</span>, <span class="fu">round</span>(boot_ci<span class="sc">$</span>bca[<span class="dv">4</span>], <span class="dv">3</span>), <span class="st">", "</span>, </span>
<span id="cb702-3990"><a href="#cb702-3990" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(boot_ci<span class="sc">$</span>bca[<span class="dv">5</span>], <span class="dv">3</span>), <span class="st">"]</span><span class="sc">\n</span><span class="st">"</span>, <span class="at">sep =</span> <span class="st">""</span>)</span>
<span id="cb702-3991"><a href="#cb702-3991" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-3992"><a href="#cb702-3992" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize effect size with CI</span></span>
<span id="cb702-3993"><a href="#cb702-3993" aria-hidden="true" tabindex="-1"></a>effect_plot_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb702-3994"><a href="#cb702-3994" aria-hidden="true" tabindex="-1"></a>  <span class="at">Effect =</span> <span class="st">"Cohen's d"</span>,</span>
<span id="cb702-3995"><a href="#cb702-3995" aria-hidden="true" tabindex="-1"></a>  <span class="at">Estimate =</span> d,</span>
<span id="cb702-3996"><a href="#cb702-3996" aria-hidden="true" tabindex="-1"></a>  <span class="at">Lower =</span> ci_d<span class="sc">$</span>Lower.Conf.Limit.smd,</span>
<span id="cb702-3997"><a href="#cb702-3997" aria-hidden="true" tabindex="-1"></a>  <span class="at">Upper =</span> ci_d<span class="sc">$</span>Upper.Conf.Limit.smd</span>
<span id="cb702-3998"><a href="#cb702-3998" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb702-3999"><a href="#cb702-3999" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4000"><a href="#cb702-4000" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(effect_plot_data, <span class="fu">aes</span>(<span class="at">x =</span> Effect, <span class="at">y =</span> Estimate)) <span class="sc">+</span></span>
<span id="cb702-4001"><a href="#cb702-4001" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb702-4002"><a href="#cb702-4002" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> Lower, <span class="at">ymax =</span> Upper), <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb702-4003"><a href="#cb702-4003" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"gray50"</span>) <span class="sc">+</span></span>
<span id="cb702-4004"><a href="#cb702-4004" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.5</span>, <span class="fl">0.8</span>), </span>
<span id="cb702-4005"><a href="#cb702-4005" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dotted"</span>, <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb702-4006"><a href="#cb702-4006" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">1.3</span>, <span class="at">y =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.5</span>, <span class="fl">0.8</span>), </span>
<span id="cb702-4007"><a href="#cb702-4007" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"Small"</span>, <span class="st">"Medium"</span>, <span class="st">"Large"</span>), </span>
<span id="cb702-4008"><a href="#cb702-4008" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb702-4009"><a href="#cb702-4009" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Effect Size with 95% Confidence Interval"</span>,</span>
<span id="cb702-4010"><a href="#cb702-4010" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Method B vs Method A"</span>,</span>
<span id="cb702-4011"><a href="#cb702-4011" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Cohen's d"</span>) <span class="sc">+</span></span>
<span id="cb702-4012"><a href="#cb702-4012" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb702-4013"><a href="#cb702-4013" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-4014"><a href="#cb702-4014" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4015"><a href="#cb702-4015" aria-hidden="true" tabindex="-1"></a>**Checkpoint:** 95% CI should exclude zero, confirming significant difference. Width reflects small sample uncertainty.</span>
<span id="cb702-4016"><a href="#cb702-4016" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4017"><a href="#cb702-4017" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-4018"><a href="#cb702-4018" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4019"><a href="#cb702-4019" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 4: Calculate Alternative Effect Sizes</span></span>
<span id="cb702-4020"><a href="#cb702-4020" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4021"><a href="#cb702-4021" aria-hidden="true" tabindex="-1"></a>Compute correlation-based effect size:</span>
<span id="cb702-4022"><a href="#cb702-4022" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4023"><a href="#cb702-4023" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lab11-other-effects}</span></span>
<span id="cb702-4024"><a href="#cb702-4024" aria-hidden="true" tabindex="-1"></a><span class="co"># Point-biserial correlation (r)</span></span>
<span id="cb702-4025"><a href="#cb702-4025" aria-hidden="true" tabindex="-1"></a><span class="co"># Create binary group variable (0 = Method A, 1 = Method B)</span></span>
<span id="cb702-4026"><a href="#cb702-4026" aria-hidden="true" tabindex="-1"></a>teaching_data_binary <span class="ot">&lt;-</span> teaching_data <span class="sc">%&gt;%</span></span>
<span id="cb702-4027"><a href="#cb702-4027" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group_code =</span> <span class="fu">if_else</span>(method <span class="sc">==</span> <span class="st">"Method A"</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb702-4028"><a href="#cb702-4028" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4029"><a href="#cb702-4029" aria-hidden="true" tabindex="-1"></a>r_pb <span class="ot">&lt;-</span> <span class="fu">cor</span>(teaching_data_binary<span class="sc">$</span>group_code, teaching_data_binary<span class="sc">$</span>test_score)</span>
<span id="cb702-4030"><a href="#cb702-4030" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4031"><a href="#cb702-4031" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Point-Biserial Correlation: r ="</span>, <span class="fu">round</span>(r_pb, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-4032"><a href="#cb702-4032" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4033"><a href="#cb702-4033" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert between d and r</span></span>
<span id="cb702-4034"><a href="#cb702-4034" aria-hidden="true" tabindex="-1"></a>r_from_d <span class="ot">&lt;-</span> d <span class="sc">/</span> <span class="fu">sqrt</span>(d<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="dv">4</span>)</span>
<span id="cb702-4035"><a href="#cb702-4035" aria-hidden="true" tabindex="-1"></a>d_from_r <span class="ot">&lt;-</span> (<span class="dv">2</span> <span class="sc">*</span> r_pb) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">1</span> <span class="sc">-</span> r_pb<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb702-4036"><a href="#cb702-4036" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4037"><a href="#cb702-4037" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Conversion: d ="</span>, <span class="fu">round</span>(d, <span class="dv">3</span>), <span class="st">"→ r ="</span>, <span class="fu">round</span>(r_from_d, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-4038"><a href="#cb702-4038" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Conversion: r ="</span>, <span class="fu">round</span>(r_pb, <span class="dv">3</span>), <span class="st">"→ d ="</span>, <span class="fu">round</span>(d_from_r, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-4039"><a href="#cb702-4039" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4040"><a href="#cb702-4040" aria-hidden="true" tabindex="-1"></a><span class="co"># R-squared (proportion of variance explained)</span></span>
<span id="cb702-4041"><a href="#cb702-4041" aria-hidden="true" tabindex="-1"></a>r_squared <span class="ot">&lt;-</span> r_pb<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb702-4042"><a href="#cb702-4042" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">R² (variance explained):"</span>, <span class="fu">round</span>(r_squared, <span class="dv">3</span>), </span>
<span id="cb702-4043"><a href="#cb702-4043" aria-hidden="true" tabindex="-1"></a>    <span class="st">"("</span>, <span class="fu">round</span>(r_squared <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>), <span class="st">"%)</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-4044"><a href="#cb702-4044" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4045"><a href="#cb702-4045" aria-hidden="true" tabindex="-1"></a><span class="co"># Number Needed to Treat (NNT) approximation</span></span>
<span id="cb702-4046"><a href="#cb702-4046" aria-hidden="true" tabindex="-1"></a><span class="co"># Assumes binary outcome; here illustrative only</span></span>
<span id="cb702-4047"><a href="#cb702-4047" aria-hidden="true" tabindex="-1"></a><span class="co"># For continuous outcome, use BESD or CLES</span></span>
<span id="cb702-4048"><a href="#cb702-4048" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4049"><a href="#cb702-4049" aria-hidden="true" tabindex="-1"></a><span class="co"># Common Language Effect Size (CLES)</span></span>
<span id="cb702-4050"><a href="#cb702-4050" aria-hidden="true" tabindex="-1"></a><span class="co"># Probability that random Method B score &gt; Method A score</span></span>
<span id="cb702-4051"><a href="#cb702-4051" aria-hidden="true" tabindex="-1"></a>cles <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(d <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">2</span>))</span>
<span id="cb702-4052"><a href="#cb702-4052" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Common Language Effect Size:"</span>, <span class="fu">round</span>(cles, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-4053"><a href="#cb702-4053" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Interpretation:"</span>, <span class="fu">round</span>(cles <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>), </span>
<span id="cb702-4054"><a href="#cb702-4054" aria-hidden="true" tabindex="-1"></a>    <span class="st">"% chance Method B student scores higher</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-4055"><a href="#cb702-4055" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-4056"><a href="#cb702-4056" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4057"><a href="#cb702-4057" aria-hidden="true" tabindex="-1"></a>**Checkpoint:** Point-biserial r should be around 0.4-0.5. CLES ~70-75% (Method B advantage).</span>
<span id="cb702-4058"><a href="#cb702-4058" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4059"><a href="#cb702-4059" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-4060"><a href="#cb702-4060" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4061"><a href="#cb702-4061" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 5: Statistical vs Practical Significance</span></span>
<span id="cb702-4062"><a href="#cb702-4062" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4063"><a href="#cb702-4063" aria-hidden="true" tabindex="-1"></a>Compare p-value and effect size interpretations:</span>
<span id="cb702-4064"><a href="#cb702-4064" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4065"><a href="#cb702-4065" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lab11-significance}</span></span>
<span id="cb702-4066"><a href="#cb702-4066" aria-hidden="true" tabindex="-1"></a><span class="co"># t-test for statistical significance</span></span>
<span id="cb702-4067"><a href="#cb702-4067" aria-hidden="true" tabindex="-1"></a>t_test_result <span class="ot">&lt;-</span> <span class="fu">t.test</span>(test_score <span class="sc">~</span> method, <span class="at">data =</span> teaching_data, </span>
<span id="cb702-4068"><a href="#cb702-4068" aria-hidden="true" tabindex="-1"></a>                        <span class="at">var.equal =</span> <span class="cn">TRUE</span>)</span>
<span id="cb702-4069"><a href="#cb702-4069" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4070"><a href="#cb702-4070" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Statistical Significance:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-4071"><a href="#cb702-4071" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"t("</span>, t_test_result<span class="sc">$</span>parameter, <span class="st">") = "</span>, </span>
<span id="cb702-4072"><a href="#cb702-4072" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(t_test_result<span class="sc">$</span>statistic, <span class="dv">2</span>), </span>
<span id="cb702-4073"><a href="#cb702-4073" aria-hidden="true" tabindex="-1"></a>    <span class="st">", p = "</span>, <span class="fu">round</span>(t_test_result<span class="sc">$</span>p.value, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="at">sep =</span> <span class="st">""</span>)</span>
<span id="cb702-4074"><a href="#cb702-4074" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Conclusion:"</span>, </span>
<span id="cb702-4075"><a href="#cb702-4075" aria-hidden="true" tabindex="-1"></a>    <span class="fu">if_else</span>(t_test_result<span class="sc">$</span>p.value <span class="sc">&lt;</span> <span class="fl">0.05</span>, </span>
<span id="cb702-4076"><a href="#cb702-4076" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Statistically significant"</span>, </span>
<span id="cb702-4077"><a href="#cb702-4077" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Not statistically significant"</span>), <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb702-4078"><a href="#cb702-4078" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4079"><a href="#cb702-4079" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Practical Significance:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-4080"><a href="#cb702-4080" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Cohen's d ="</span>, <span class="fu">round</span>(d, <span class="dv">2</span>), <span class="st">"("</span>, interpretation, <span class="st">"effect)</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-4081"><a href="#cb702-4081" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Mean difference:"</span>, <span class="fu">round</span>(m2 <span class="sc">-</span> m1, <span class="dv">1</span>), <span class="st">"points</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-4082"><a href="#cb702-4082" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"95% CI for difference: ["</span>, </span>
<span id="cb702-4083"><a href="#cb702-4083" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(t_test_result<span class="sc">$</span>conf.int[<span class="dv">1</span>], <span class="dv">1</span>), <span class="st">", "</span>,</span>
<span id="cb702-4084"><a href="#cb702-4084" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(t_test_result<span class="sc">$</span>conf.int[<span class="dv">2</span>], <span class="dv">1</span>), <span class="st">"]</span><span class="sc">\n</span><span class="st">"</span>, <span class="at">sep =</span> <span class="st">""</span>)</span>
<span id="cb702-4085"><a href="#cb702-4085" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4086"><a href="#cb702-4086" aria-hidden="true" tabindex="-1"></a><span class="co"># Scenario analysis</span></span>
<span id="cb702-4087"><a href="#cb702-4087" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Practical Interpretation:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-4088"><a href="#cb702-4088" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- A"</span>, <span class="fu">round</span>(m2 <span class="sc">-</span> m1, <span class="dv">1</span>), <span class="st">"point improvement on a 100-point test</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-4089"><a href="#cb702-4089" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Represents approximately"</span>, <span class="fu">round</span>((m2 <span class="sc">-</span> m1) <span class="sc">/</span> m1 <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>), </span>
<span id="cb702-4090"><a href="#cb702-4090" aria-hidden="true" tabindex="-1"></a>    <span class="st">"% improvement over Method A</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-4091"><a href="#cb702-4091" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- CLES ="</span>, <span class="fu">round</span>(cles, <span class="dv">2</span>), </span>
<span id="cb702-4092"><a href="#cb702-4092" aria-hidden="true" tabindex="-1"></a>    <span class="st">": ~75% of Method B students outperform average Method A student</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-4093"><a href="#cb702-4093" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Question: Is this improvement worth the cost/effort of Method B?</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-4094"><a href="#cb702-4094" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-4095"><a href="#cb702-4095" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4096"><a href="#cb702-4096" aria-hidden="true" tabindex="-1"></a>**Checkpoint:** Result may be both statistically and practically significant, but small sample yields uncertainty.</span>
<span id="cb702-4097"><a href="#cb702-4097" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4098"><a href="#cb702-4098" aria-hidden="true" tabindex="-1"></a>**Discussion:** Can a result be statistically significant but not practically important? Vice versa?</span>
<span id="cb702-4099"><a href="#cb702-4099" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4100"><a href="#cb702-4100" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-4101"><a href="#cb702-4101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4102"><a href="#cb702-4102" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 6: Effect Sizes for Categorical Outcomes</span></span>
<span id="cb702-4103"><a href="#cb702-4103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4104"><a href="#cb702-4104" aria-hidden="true" tabindex="-1"></a>Calculate odds ratios (illustrative with dichotomized outcome):</span>
<span id="cb702-4105"><a href="#cb702-4105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4106"><a href="#cb702-4106" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lab11-odds-ratio}</span></span>
<span id="cb702-4107"><a href="#cb702-4107" aria-hidden="true" tabindex="-1"></a><span class="co"># Dichotomize test scores (pass = ≥80, fail = &lt;80)</span></span>
<span id="cb702-4108"><a href="#cb702-4108" aria-hidden="true" tabindex="-1"></a>teaching_dichot <span class="ot">&lt;-</span> teaching_data <span class="sc">%&gt;%</span></span>
<span id="cb702-4109"><a href="#cb702-4109" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb702-4110"><a href="#cb702-4110" aria-hidden="true" tabindex="-1"></a>    <span class="at">pass =</span> <span class="fu">if_else</span>(test_score <span class="sc">&gt;=</span> <span class="dv">80</span>, <span class="st">"Pass"</span>, <span class="st">"Fail"</span>),</span>
<span id="cb702-4111"><a href="#cb702-4111" aria-hidden="true" tabindex="-1"></a>    <span class="at">pass_binary =</span> <span class="fu">if_else</span>(pass <span class="sc">==</span> <span class="st">"Pass"</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb702-4112"><a href="#cb702-4112" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb702-4113"><a href="#cb702-4113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4114"><a href="#cb702-4114" aria-hidden="true" tabindex="-1"></a><span class="co"># Contingency table</span></span>
<span id="cb702-4115"><a href="#cb702-4115" aria-hidden="true" tabindex="-1"></a>cont_table <span class="ot">&lt;-</span> <span class="fu">table</span>(teaching_dichot<span class="sc">$</span>method, teaching_dichot<span class="sc">$</span>pass)</span>
<span id="cb702-4116"><a href="#cb702-4116" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cont_table)</span>
<span id="cb702-4117"><a href="#cb702-4117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4118"><a href="#cb702-4118" aria-hidden="true" tabindex="-1"></a><span class="co"># Proportions</span></span>
<span id="cb702-4119"><a href="#cb702-4119" aria-hidden="true" tabindex="-1"></a>prop_table <span class="ot">&lt;-</span> <span class="fu">prop.table</span>(cont_table, <span class="at">margin =</span> <span class="dv">1</span>)</span>
<span id="cb702-4120"><a href="#cb702-4120" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(prop_table, <span class="dv">3</span>))</span>
<span id="cb702-4121"><a href="#cb702-4121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4122"><a href="#cb702-4122" aria-hidden="true" tabindex="-1"></a><span class="co"># Odds ratio</span></span>
<span id="cb702-4123"><a href="#cb702-4123" aria-hidden="true" tabindex="-1"></a>odds_a <span class="ot">&lt;-</span> cont_table[<span class="dv">1</span>, <span class="dv">2</span>] <span class="sc">/</span> cont_table[<span class="dv">1</span>, <span class="dv">1</span>]  <span class="co"># Pass/Fail for Method A</span></span>
<span id="cb702-4124"><a href="#cb702-4124" aria-hidden="true" tabindex="-1"></a>odds_b <span class="ot">&lt;-</span> cont_table[<span class="dv">2</span>, <span class="dv">2</span>] <span class="sc">/</span> cont_table[<span class="dv">2</span>, <span class="dv">1</span>]  <span class="co"># Pass/Fail for Method B</span></span>
<span id="cb702-4125"><a href="#cb702-4125" aria-hidden="true" tabindex="-1"></a>odds_ratio <span class="ot">&lt;-</span> odds_b <span class="sc">/</span> odds_a</span>
<span id="cb702-4126"><a href="#cb702-4126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4127"><a href="#cb702-4127" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Odds Ratio:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-4128"><a href="#cb702-4128" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Odds (Method A):"</span>, <span class="fu">round</span>(odds_a, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-4129"><a href="#cb702-4129" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Odds (Method B):"</span>, <span class="fu">round</span>(odds_b, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-4130"><a href="#cb702-4130" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"OR ="</span>, <span class="fu">round</span>(odds_ratio, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-4131"><a href="#cb702-4131" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Interpretation: Method B students have"</span>, <span class="fu">round</span>(odds_ratio, <span class="dv">2</span>), </span>
<span id="cb702-4132"><a href="#cb702-4132" aria-hidden="true" tabindex="-1"></a>    <span class="st">"times the odds of passing</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-4133"><a href="#cb702-4133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4134"><a href="#cb702-4134" aria-hidden="true" tabindex="-1"></a><span class="co"># Risk Ratio (RR)</span></span>
<span id="cb702-4135"><a href="#cb702-4135" aria-hidden="true" tabindex="-1"></a>risk_a <span class="ot">&lt;-</span> cont_table[<span class="dv">1</span>, <span class="dv">2</span>] <span class="sc">/</span> <span class="fu">sum</span>(cont_table[<span class="dv">1</span>, ])</span>
<span id="cb702-4136"><a href="#cb702-4136" aria-hidden="true" tabindex="-1"></a>risk_b <span class="ot">&lt;-</span> cont_table[<span class="dv">2</span>, <span class="dv">2</span>] <span class="sc">/</span> <span class="fu">sum</span>(cont_table[<span class="dv">2</span>, ])</span>
<span id="cb702-4137"><a href="#cb702-4137" aria-hidden="true" tabindex="-1"></a>risk_ratio <span class="ot">&lt;-</span> risk_b <span class="sc">/</span> risk_a</span>
<span id="cb702-4138"><a href="#cb702-4138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4139"><a href="#cb702-4139" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Risk Ratio:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-4140"><a href="#cb702-4140" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Risk (Method A):"</span>, <span class="fu">round</span>(risk_a, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-4141"><a href="#cb702-4141" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Risk (Method B):"</span>, <span class="fu">round</span>(risk_b, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-4142"><a href="#cb702-4142" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"RR ="</span>, <span class="fu">round</span>(risk_ratio, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-4143"><a href="#cb702-4143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4144"><a href="#cb702-4144" aria-hidden="true" tabindex="-1"></a><span class="co"># Risk difference</span></span>
<span id="cb702-4145"><a href="#cb702-4145" aria-hidden="true" tabindex="-1"></a>risk_diff <span class="ot">&lt;-</span> risk_b <span class="sc">-</span> risk_a</span>
<span id="cb702-4146"><a href="#cb702-4146" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Risk Difference:"</span>, <span class="fu">round</span>(risk_diff, <span class="dv">3</span>), </span>
<span id="cb702-4147"><a href="#cb702-4147" aria-hidden="true" tabindex="-1"></a>    <span class="st">"("</span>, <span class="fu">round</span>(risk_diff <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>), <span class="st">" percentage points)</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-4148"><a href="#cb702-4148" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-4149"><a href="#cb702-4149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4150"><a href="#cb702-4150" aria-hidden="true" tabindex="-1"></a>**Checkpoint:** OR and RR should show Method B advantage in passing rates.</span>
<span id="cb702-4151"><a href="#cb702-4151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4152"><a href="#cb702-4152" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-4153"><a href="#cb702-4153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4154"><a href="#cb702-4154" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 7: Create Forest Plot</span></span>
<span id="cb702-4155"><a href="#cb702-4155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4156"><a href="#cb702-4156" aria-hidden="true" tabindex="-1"></a>Visualize multiple effect sizes:</span>
<span id="cb702-4157"><a href="#cb702-4157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4158"><a href="#cb702-4158" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lab11-forest-plot}</span></span>
<span id="cb702-4159"><a href="#cb702-4159" aria-hidden="true" tabindex="-1"></a><span class="co"># Compile effect sizes</span></span>
<span id="cb702-4160"><a href="#cb702-4160" aria-hidden="true" tabindex="-1"></a>forest_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb702-4161"><a href="#cb702-4161" aria-hidden="true" tabindex="-1"></a>  <span class="at">Metric =</span> <span class="fu">c</span>(<span class="st">"Cohen's d"</span>, <span class="st">"Point-Biserial r"</span>, <span class="st">"CLES"</span>, </span>
<span id="cb702-4162"><a href="#cb702-4162" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Mean Difference"</span>, <span class="st">"Odds Ratio"</span>, <span class="st">"Risk Ratio"</span>),</span>
<span id="cb702-4163"><a href="#cb702-4163" aria-hidden="true" tabindex="-1"></a>  <span class="at">Estimate =</span> <span class="fu">c</span>(d, r_pb, cles, m2 <span class="sc">-</span> m1, odds_ratio, risk_ratio),</span>
<span id="cb702-4164"><a href="#cb702-4164" aria-hidden="true" tabindex="-1"></a>  <span class="at">Lower =</span> <span class="fu">c</span>(ci_d<span class="sc">$</span>Lower.Conf.Limit.smd, <span class="cn">NA</span>, <span class="cn">NA</span>, </span>
<span id="cb702-4165"><a href="#cb702-4165" aria-hidden="true" tabindex="-1"></a>            t_test_result<span class="sc">$</span>conf.int[<span class="dv">1</span>], <span class="cn">NA</span>, <span class="cn">NA</span>),</span>
<span id="cb702-4166"><a href="#cb702-4166" aria-hidden="true" tabindex="-1"></a>  <span class="at">Upper =</span> <span class="fu">c</span>(ci_d<span class="sc">$</span>Upper.Conf.Limit.smd, <span class="cn">NA</span>, <span class="cn">NA</span>,</span>
<span id="cb702-4167"><a href="#cb702-4167" aria-hidden="true" tabindex="-1"></a>            t_test_result<span class="sc">$</span>conf.int[<span class="dv">2</span>], <span class="cn">NA</span>, <span class="cn">NA</span>),</span>
<span id="cb702-4168"><a href="#cb702-4168" aria-hidden="true" tabindex="-1"></a>  <span class="at">Category =</span> <span class="fu">c</span>(<span class="st">"Standardized"</span>, <span class="st">"Standardized"</span>, <span class="st">"Probability"</span>,</span>
<span id="cb702-4169"><a href="#cb702-4169" aria-hidden="true" tabindex="-1"></a>               <span class="st">"Unstandardized"</span>, <span class="st">"Categorical"</span>, <span class="st">"Categorical"</span>)</span>
<span id="cb702-4170"><a href="#cb702-4170" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb702-4171"><a href="#cb702-4171" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Lower))  <span class="co"># Keep only metrics with CIs</span></span>
<span id="cb702-4172"><a href="#cb702-4172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4173"><a href="#cb702-4173" aria-hidden="true" tabindex="-1"></a><span class="co"># Forest plot</span></span>
<span id="cb702-4174"><a href="#cb702-4174" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(forest_data, <span class="fu">aes</span>(<span class="at">x =</span> Estimate, <span class="at">y =</span> Metric, <span class="at">color =</span> Category)) <span class="sc">+</span></span>
<span id="cb702-4175"><a href="#cb702-4175" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb702-4176"><a href="#cb702-4176" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> Lower, <span class="at">xmax =</span> Upper), <span class="at">height =</span> <span class="fl">0.2</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb702-4177"><a href="#cb702-4177" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"gray50"</span>) <span class="sc">+</span></span>
<span id="cb702-4178"><a href="#cb702-4178" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Effect Sizes with 95% Confidence Intervals"</span>,</span>
<span id="cb702-4179"><a href="#cb702-4179" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Method B vs Method A"</span>,</span>
<span id="cb702-4180"><a href="#cb702-4180" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Effect Size Estimate"</span>, <span class="at">y =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb702-4181"><a href="#cb702-4181" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb702-4182"><a href="#cb702-4182" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb702-4183"><a href="#cb702-4183" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-4184"><a href="#cb702-4184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4185"><a href="#cb702-4185" aria-hidden="true" tabindex="-1"></a>**Checkpoint:** Forest plot displays effect sizes with uncertainty intervals in publication-ready format.</span>
<span id="cb702-4186"><a href="#cb702-4186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4187"><a href="#cb702-4187" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-4188"><a href="#cb702-4188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4189"><a href="#cb702-4189" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 8: Report Effect Sizes (APA Style)</span></span>
<span id="cb702-4190"><a href="#cb702-4190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4191"><a href="#cb702-4191" aria-hidden="true" tabindex="-1"></a>Create publication-ready summary:</span>
<span id="cb702-4192"><a href="#cb702-4192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4193"><a href="#cb702-4193" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lab11-reporting}</span></span>
<span id="cb702-4194"><a href="#cb702-4194" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb702-4195"><a href="#cb702-4195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4196"><a href="#cb702-4196" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary table</span></span>
<span id="cb702-4197"><a href="#cb702-4197" aria-hidden="true" tabindex="-1"></a>effect_summary <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb702-4198"><a href="#cb702-4198" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Effect Size Metric</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Cohen's d"</span>, <span class="st">"95% CI"</span>, <span class="st">"Point-Biserial r"</span>, </span>
<span id="cb702-4199"><a href="#cb702-4199" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"R²"</span>, <span class="st">"CLES"</span>, <span class="st">"Mean Difference"</span>),</span>
<span id="cb702-4200"><a href="#cb702-4200" aria-hidden="true" tabindex="-1"></a>  <span class="at">Value =</span> <span class="fu">c</span>(</span>
<span id="cb702-4201"><a href="#cb702-4201" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">"%.2f"</span>, d),</span>
<span id="cb702-4202"><a href="#cb702-4202" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">"[%.2f, %.2f]"</span>, ci_d<span class="sc">$</span>Lower.Conf.Limit.smd, ci_d<span class="sc">$</span>Upper.Conf.Limit.smd),</span>
<span id="cb702-4203"><a href="#cb702-4203" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">"%.2f"</span>, r_pb),</span>
<span id="cb702-4204"><a href="#cb702-4204" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">"%.3f (%.1f%%)"</span>, r_squared, r_squared <span class="sc">*</span> <span class="dv">100</span>),</span>
<span id="cb702-4205"><a href="#cb702-4205" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">"%.2f (%.0f%%)"</span>, cles, cles <span class="sc">*</span> <span class="dv">100</span>),</span>
<span id="cb702-4206"><a href="#cb702-4206" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">"%.1f points"</span>, m2 <span class="sc">-</span> m1)</span>
<span id="cb702-4207"><a href="#cb702-4207" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb702-4208"><a href="#cb702-4208" aria-hidden="true" tabindex="-1"></a>  <span class="at">Interpretation =</span> <span class="fu">c</span>(</span>
<span id="cb702-4209"><a href="#cb702-4209" aria-hidden="true" tabindex="-1"></a>    interpretation,</span>
<span id="cb702-4210"><a href="#cb702-4210" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Excludes zero"</span>,</span>
<span id="cb702-4211"><a href="#cb702-4211" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Medium association"</span>,</span>
<span id="cb702-4212"><a href="#cb702-4212" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">"%.1f%% variance explained"</span>, r_squared <span class="sc">*</span> <span class="dv">100</span>),</span>
<span id="cb702-4213"><a href="#cb702-4213" aria-hidden="true" tabindex="-1"></a>    <span class="st">"~3 in 4 advantage"</span>,</span>
<span id="cb702-4214"><a href="#cb702-4214" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">"%.1f%% improvement"</span>, (m2 <span class="sc">-</span> m1) <span class="sc">/</span> m1 <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb702-4215"><a href="#cb702-4215" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb702-4216"><a href="#cb702-4216" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb702-4217"><a href="#cb702-4217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4218"><a href="#cb702-4218" aria-hidden="true" tabindex="-1"></a>effect_summary <span class="sc">%&gt;%</span></span>
<span id="cb702-4219"><a href="#cb702-4219" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb702-4220"><a href="#cb702-4220" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb702-4221"><a href="#cb702-4221" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Effect Size Summary"</span>,</span>
<span id="cb702-4222"><a href="#cb702-4222" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Teaching Method Comparison (n=24)"</span></span>
<span id="cb702-4223"><a href="#cb702-4223" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb702-4224"><a href="#cb702-4224" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_source_note</span>(</span>
<span id="cb702-4225"><a href="#cb702-4225" aria-hidden="true" tabindex="-1"></a>    <span class="at">source_note =</span> <span class="st">"Cohen's benchmarks: small (0.2), medium (0.5), large (0.8)"</span></span>
<span id="cb702-4226"><a href="#cb702-4226" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb702-4227"><a href="#cb702-4227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4228"><a href="#cb702-4228" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample Results Statement</span></span>
<span id="cb702-4229"><a href="#cb702-4229" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Sample APA-Style Results Statement:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-4230"><a href="#cb702-4230" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Method B (M ="</span>, <span class="fu">round</span>(m2, <span class="dv">1</span>), <span class="st">", SD ="</span>, <span class="fu">round</span>(sd2, <span class="dv">1</span>), </span>
<span id="cb702-4231"><a href="#cb702-4231" aria-hidden="true" tabindex="-1"></a>    <span class="st">") produced significantly higher</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-4232"><a href="#cb702-4232" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"test scores than Method A (M ="</span>, <span class="fu">round</span>(m1, <span class="dv">1</span>), <span class="st">", SD ="</span>, <span class="fu">round</span>(sd1, <span class="dv">1</span>), </span>
<span id="cb702-4233"><a href="#cb702-4233" aria-hidden="true" tabindex="-1"></a>    <span class="st">"), t("</span>, t_test_result<span class="sc">$</span>parameter, <span class="st">") =</span><span class="sc">\n</span><span class="st">"</span>, <span class="at">sep =</span> <span class="st">""</span>)</span>
<span id="cb702-4234"><a href="#cb702-4234" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">round</span>(t_test_result<span class="sc">$</span>statistic, <span class="dv">2</span>), <span class="st">", p ="</span>, </span>
<span id="cb702-4235"><a href="#cb702-4235" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(t_test_result<span class="sc">$</span>p.value, <span class="dv">3</span>), <span class="st">", d ="</span>, <span class="fu">round</span>(d, <span class="dv">2</span>), </span>
<span id="cb702-4236"><a href="#cb702-4236" aria-hidden="true" tabindex="-1"></a>    <span class="st">", 95% CI ["</span>, <span class="fu">round</span>(ci_d<span class="sc">$</span>Lower.Conf.Limit.smd, <span class="dv">2</span>), <span class="st">", "</span>,</span>
<span id="cb702-4237"><a href="#cb702-4237" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(ci_d<span class="sc">$</span>Upper.Conf.Limit.smd, <span class="dv">2</span>), <span class="st">"].</span><span class="sc">\n</span><span class="st">"</span>, <span class="at">sep =</span> <span class="st">""</span>)</span>
<span id="cb702-4238"><a href="#cb702-4238" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"This represents a"</span>, <span class="fu">tolower</span>(interpretation), </span>
<span id="cb702-4239"><a href="#cb702-4239" aria-hidden="true" tabindex="-1"></a>    <span class="st">"effect, with approximately"</span>, <span class="fu">round</span>(cles <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">0</span>), </span>
<span id="cb702-4240"><a href="#cb702-4240" aria-hidden="true" tabindex="-1"></a>    <span class="st">"% of Method B</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-4241"><a href="#cb702-4241" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"students scoring above the average Method A student (CLES).</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-4242"><a href="#cb702-4242" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-4243"><a href="#cb702-4243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4244"><a href="#cb702-4244" aria-hidden="true" tabindex="-1"></a>**Checkpoint:** Professional reporting with multiple effect size metrics and clear interpretation.</span>
<span id="cb702-4245"><a href="#cb702-4245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4246"><a href="#cb702-4246" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-4247"><a href="#cb702-4247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4248"><a href="#cb702-4248" aria-hidden="true" tabindex="-1"></a><span class="fu">### Discussion Questions</span></span>
<span id="cb702-4249"><a href="#cb702-4249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4250"><a href="#cb702-4250" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Why Report Effect Sizes:** What information does an effect size provide that a p-value doesn't?</span>
<span id="cb702-4251"><a href="#cb702-4251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4252"><a href="#cb702-4252" aria-hidden="true" tabindex="-1"></a>   *Answer: Effect sizes quantify magnitude of difference/association (how big?), are independent of sample size, allow comparison across studies, inform practical importance, and enable meta-analysis. P-values only indicate probability under null hypothesis.*</span>
<span id="cb702-4253"><a href="#cb702-4253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4254"><a href="#cb702-4254" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Which Effect Size:** When should you report Cohen's d vs r vs odds ratios?</span>
<span id="cb702-4255"><a href="#cb702-4255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4256"><a href="#cb702-4256" aria-hidden="true" tabindex="-1"></a>   *Answer: Cohen's d for mean differences (t-tests, ANOVA), r for correlations, odds/risk ratios for categorical outcomes. Report the metric most appropriate for your design and most interpretable for your audience. Multiple metrics often helpful.*</span>
<span id="cb702-4257"><a href="#cb702-4257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4258"><a href="#cb702-4258" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Confidence Intervals:** Why are CIs for effect sizes important, especially in small samples?</span>
<span id="cb702-4259"><a href="#cb702-4259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4260"><a href="#cb702-4260" aria-hidden="true" tabindex="-1"></a>   *Answer: CIs quantify precision/uncertainty around effect size estimate. In small samples, CIs are wide, revealing substantial uncertainty even when result is significant. Helps distinguish "precisely small" from "imprecisely estimated."*</span>
<span id="cb702-4261"><a href="#cb702-4261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4262"><a href="#cb702-4262" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Practical vs Statistical:** Give an example where d=0.3 might be practically important despite being "small."</span>
<span id="cb702-4263"><a href="#cb702-4263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4264"><a href="#cb702-4264" aria-hidden="true" tabindex="-1"></a>   *Answer: In education, a d=0.3 improvement in test scores with no added cost might benefit millions of students. In medicine, small effects on mortality are critically important. "Small" is context-dependent.*</span>
<span id="cb702-4265"><a href="#cb702-4265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4266"><a href="#cb702-4266" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>**Reporting Standards:** What effect size information should you always report?</span>
<span id="cb702-4267"><a href="#cb702-4267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4268"><a href="#cb702-4268" aria-hidden="true" tabindex="-1"></a>   *Answer: (1) Point estimate (e.g., d=0.65), (2) 95% CI, (3) sample sizes, (4) interpretation (small/medium/large or context-specific), (5) unstandardized effect when meaningful (e.g., 10-point difference).*</span>
<span id="cb702-4269"><a href="#cb702-4269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4270"><a href="#cb702-4270" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-4271"><a href="#cb702-4271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4272"><a href="#cb702-4272" aria-hidden="true" tabindex="-1"></a><span class="fu">### Key Takeaways</span></span>
<span id="cb702-4273"><a href="#cb702-4273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4274"><a href="#cb702-4274" aria-hidden="true" tabindex="-1"></a>✓ **Effect sizes quantify magnitude**, not just significance  </span>
<span id="cb702-4275"><a href="#cb702-4275" aria-hidden="true" tabindex="-1"></a>✓ **Cohen's d is standardized** – comparable across studies  </span>
<span id="cb702-4276"><a href="#cb702-4276" aria-hidden="true" tabindex="-1"></a>✓ **Always report confidence intervals** for effect sizes  </span>
<span id="cb702-4277"><a href="#cb702-4277" aria-hidden="true" tabindex="-1"></a>✓ **Multiple effect size metrics** provide complementary perspectives  </span>
<span id="cb702-4278"><a href="#cb702-4278" aria-hidden="true" tabindex="-1"></a>✓ **Practical significance ≠ statistical significance** – consider context  </span>
<span id="cb702-4279"><a href="#cb702-4279" aria-hidden="true" tabindex="-1"></a>✓ **Small samples yield wide CIs** – interpret effect sizes cautiously  </span>
<span id="cb702-4280"><a href="#cb702-4280" aria-hidden="true" tabindex="-1"></a>✓ **APA guidelines require effect sizes** in results sections  </span>
<span id="cb702-4281"><a href="#cb702-4281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4282"><a href="#cb702-4282" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-4283"><a href="#cb702-4283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4284"><a href="#cb702-4284" aria-hidden="true" tabindex="-1"></a><span class="fu">### Homework Exercise</span></span>
<span id="cb702-4285"><a href="#cb702-4285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4286"><a href="#cb702-4286" aria-hidden="true" tabindex="-1"></a>**Dataset:** A wellness intervention study (n=20, 10 per group) measuring stress reduction.</span>
<span id="cb702-4287"><a href="#cb702-4287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4288"><a href="#cb702-4288" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lab11-homework-data}</span></span>
<span id="cb702-4289"><a href="#cb702-4289" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">654</span>)</span>
<span id="cb702-4290"><a href="#cb702-4290" aria-hidden="true" tabindex="-1"></a>wellness_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb702-4291"><a href="#cb702-4291" aria-hidden="true" tabindex="-1"></a>  <span class="at">participant_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>,</span>
<span id="cb702-4292"><a href="#cb702-4292" aria-hidden="true" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Control"</span>, <span class="st">"Intervention"</span>), <span class="at">each =</span> <span class="dv">10</span>),</span>
<span id="cb702-4293"><a href="#cb702-4293" aria-hidden="true" tabindex="-1"></a>  <span class="at">stress_baseline =</span> <span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="dv">65</span>, <span class="dv">12</span>)),</span>
<span id="cb702-4294"><a href="#cb702-4294" aria-hidden="true" tabindex="-1"></a>  <span class="at">stress_post =</span> <span class="fu">c</span>(</span>
<span id="cb702-4295"><a href="#cb702-4295" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="dv">63</span>, <span class="dv">11</span>)),      <span class="co"># Control: minimal change</span></span>
<span id="cb702-4296"><a href="#cb702-4296" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="dv">48</span>, <span class="dv">10</span>))       <span class="co"># Intervention: larger reduction</span></span>
<span id="cb702-4297"><a href="#cb702-4297" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb702-4298"><a href="#cb702-4298" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb702-4299"><a href="#cb702-4299" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">stress_change =</span> stress_post <span class="sc">-</span> stress_baseline)</span>
<span id="cb702-4300"><a href="#cb702-4300" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-4301"><a href="#cb702-4301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4302"><a href="#cb702-4302" aria-hidden="true" tabindex="-1"></a>**Your Tasks:**</span>
<span id="cb702-4303"><a href="#cb702-4303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4304"><a href="#cb702-4304" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Calculate descriptive statistics (M, SD) for each group's stress change</span>
<span id="cb702-4305"><a href="#cb702-4305" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Conduct independent t-test on stress_change</span>
<span id="cb702-4306"><a href="#cb702-4306" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Calculate Cohen's d for the group difference</span>
<span id="cb702-4307"><a href="#cb702-4307" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Compute 95% CI for Cohen's d using MBESS</span>
<span id="cb702-4308"><a href="#cb702-4308" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>Calculate point-biserial correlation (r) and R²</span>
<span id="cb702-4309"><a href="#cb702-4309" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span>Calculate Common Language Effect Size (CLES)</span>
<span id="cb702-4310"><a href="#cb702-4310" aria-hidden="true" tabindex="-1"></a><span class="ss">7. </span>Interpret effect size using Cohen's benchmarks</span>
<span id="cb702-4311"><a href="#cb702-4311" aria-hidden="true" tabindex="-1"></a><span class="ss">8. </span>Create a forest plot showing d with 95% CI</span>
<span id="cb702-4312"><a href="#cb702-4312" aria-hidden="true" tabindex="-1"></a><span class="ss">9. </span>Compare statistical significance (p-value) with practical significance (effect size)</span>
<span id="cb702-4313"><a href="#cb702-4313" aria-hidden="true" tabindex="-1"></a><span class="ss">10. </span>Write an APA-style results statement reporting all relevant statistics</span>
<span id="cb702-4314"><a href="#cb702-4314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4315"><a href="#cb702-4315" aria-hidden="true" tabindex="-1"></a>**Expected Results:**</span>
<span id="cb702-4316"><a href="#cb702-4316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4317"><a href="#cb702-4317" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Intervention group shows greater stress reduction (larger negative change)</span>
<span id="cb702-4318"><a href="#cb702-4318" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Cohen's d approximately 1.0-1.5 (large effect)</span>
<span id="cb702-4319"><a href="#cb702-4319" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Statistically significant (p &lt; .05)</span>
<span id="cb702-4320"><a href="#cb702-4320" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>95% CI for d should exclude zero but be fairly wide (small sample)</span>
<span id="cb702-4321"><a href="#cb702-4321" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>CLES ~75-85% (intervention advantage)</span>
<span id="cb702-4322"><a href="#cb702-4322" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>R² ~25-40% (substantial variance explained)</span>
<span id="cb702-4323"><a href="#cb702-4323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4324"><a href="#cb702-4324" aria-hidden="true" tabindex="-1"></a>**Hints:**</span>
<span id="cb702-4325"><a href="#cb702-4325" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Use <span class="in">`stress_change`</span> as outcome (negative values = stress reduction)</span>
<span id="cb702-4326"><a href="#cb702-4326" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>For d: <span class="in">`cohen.d(group2, group1)`</span> or manual calculation with pooled SD</span>
<span id="cb702-4327"><a href="#cb702-4327" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>For CI: <span class="in">`ci.smd(smd = d, n.1 = 10, n.2 = 10)`</span></span>
<span id="cb702-4328"><a href="#cb702-4328" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>CLES = <span class="in">`pnorm(d / sqrt(2))`</span></span>
<span id="cb702-4329"><a href="#cb702-4329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4330"><a href="#cb702-4330" aria-hidden="true" tabindex="-1"></a>**Bonus:** Dichotomize the outcome: "Clinically meaningful reduction" = stress change ≤ -10 points. Calculate odds ratio and risk ratio for the intervention vs control. Which metric (d, OR, RR) is most interpretable for a clinical audience? Why?</span>
<span id="cb702-4331"><a href="#cb702-4331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4332"><a href="#cb702-4332" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-4333"><a href="#cb702-4333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4334"><a href="#cb702-4334" aria-hidden="true" tabindex="-1"></a><span class="fu">## Lab 12: Visualization Best Practices for Small Samples {#lab-visualization}</span></span>
<span id="cb702-4335"><a href="#cb702-4335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4336"><a href="#cb702-4336" aria-hidden="true" tabindex="-1"></a>**Learning Objectives:**</span>
<span id="cb702-4337"><a href="#cb702-4337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4338"><a href="#cb702-4338" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Create effective visualizations for small-sample data</span>
<span id="cb702-4339"><a href="#cb702-4339" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Show individual data points (avoid hiding observations)</span>
<span id="cb702-4340"><a href="#cb702-4340" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Display uncertainty with error bars and confidence bands</span>
<span id="cb702-4341"><a href="#cb702-4341" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Use appropriate plot types for different data structures</span>
<span id="cb702-4342"><a href="#cb702-4342" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Apply principles of clear, honest data presentation</span>
<span id="cb702-4343"><a href="#cb702-4343" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Generate publication-ready figures with ggplot2</span>
<span id="cb702-4344"><a href="#cb702-4344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4345"><a href="#cb702-4345" aria-hidden="true" tabindex="-1"></a>**Scenario:** You have pilot data (n=18) from a within-subjects study where participants completed a task under three conditions. You need to create visualizations that clearly communicate patterns while honestly representing uncertainty.</span>
<span id="cb702-4346"><a href="#cb702-4346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4347"><a href="#cb702-4347" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 1: Set Up and Load Data</span></span>
<span id="cb702-4348"><a href="#cb702-4348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4349"><a href="#cb702-4349" aria-hidden="true" tabindex="-1"></a>Create within-subjects data:</span>
<span id="cb702-4350"><a href="#cb702-4350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4351"><a href="#cb702-4351" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lab12-data}</span></span>
<span id="cb702-4352"><a href="#cb702-4352" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb702-4353"><a href="#cb702-4353" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb702-4354"><a href="#cb702-4354" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggbeeswarm)  <span class="co"># For jittered points</span></span>
<span id="cb702-4355"><a href="#cb702-4355" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggdist)      <span class="co"># For distribution visualizations</span></span>
<span id="cb702-4356"><a href="#cb702-4356" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)   <span class="co"># For combining plots</span></span>
<span id="cb702-4357"><a href="#cb702-4357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4358"><a href="#cb702-4358" aria-hidden="true" tabindex="-1"></a><span class="co"># Set seed for reproducibility</span></span>
<span id="cb702-4359"><a href="#cb702-4359" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb702-4360"><a href="#cb702-4360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4361"><a href="#cb702-4361" aria-hidden="true" tabindex="-1"></a><span class="co"># Within-subjects data: 3 conditions</span></span>
<span id="cb702-4362"><a href="#cb702-4362" aria-hidden="true" tabindex="-1"></a>pilot_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb702-4363"><a href="#cb702-4363" aria-hidden="true" tabindex="-1"></a>  <span class="at">participant_id =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">18</span>, <span class="at">each =</span> <span class="dv">3</span>),</span>
<span id="cb702-4364"><a href="#cb702-4364" aria-hidden="true" tabindex="-1"></a>  <span class="at">condition =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Baseline"</span>, <span class="st">"Treatment A"</span>, <span class="st">"Treatment B"</span>), <span class="at">times =</span> <span class="dv">18</span>),</span>
<span id="cb702-4365"><a href="#cb702-4365" aria-hidden="true" tabindex="-1"></a>  <span class="at">reaction_time =</span> <span class="fu">c</span>(</span>
<span id="cb702-4366"><a href="#cb702-4366" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="dv">18</span>, <span class="dv">450</span>, <span class="dv">60</span>)),    <span class="co"># Baseline</span></span>
<span id="cb702-4367"><a href="#cb702-4367" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="dv">18</span>, <span class="dv">420</span>, <span class="dv">55</span>)),    <span class="co"># Treatment A: slight improvement</span></span>
<span id="cb702-4368"><a href="#cb702-4368" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="dv">18</span>, <span class="dv">380</span>, <span class="dv">50</span>))     <span class="co"># Treatment B: larger improvement</span></span>
<span id="cb702-4369"><a href="#cb702-4369" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb702-4370"><a href="#cb702-4370" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb702-4371"><a href="#cb702-4371" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">condition =</span> <span class="fu">factor</span>(condition, </span>
<span id="cb702-4372"><a href="#cb702-4372" aria-hidden="true" tabindex="-1"></a>                           <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Baseline"</span>, <span class="st">"Treatment A"</span>, <span class="st">"Treatment B"</span>)))</span>
<span id="cb702-4373"><a href="#cb702-4373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4374"><a href="#cb702-4374" aria-hidden="true" tabindex="-1"></a><span class="co"># Descriptive statistics</span></span>
<span id="cb702-4375"><a href="#cb702-4375" aria-hidden="true" tabindex="-1"></a>summary_stats <span class="ot">&lt;-</span> pilot_data <span class="sc">%&gt;%</span></span>
<span id="cb702-4376"><a href="#cb702-4376" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(condition) <span class="sc">%&gt;%</span></span>
<span id="cb702-4377"><a href="#cb702-4377" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb702-4378"><a href="#cb702-4378" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb702-4379"><a href="#cb702-4379" aria-hidden="true" tabindex="-1"></a>    <span class="at">M =</span> <span class="fu">mean</span>(reaction_time),</span>
<span id="cb702-4380"><a href="#cb702-4380" aria-hidden="true" tabindex="-1"></a>    <span class="at">SD =</span> <span class="fu">sd</span>(reaction_time),</span>
<span id="cb702-4381"><a href="#cb702-4381" aria-hidden="true" tabindex="-1"></a>    <span class="at">SE =</span> SD <span class="sc">/</span> <span class="fu">sqrt</span>(n),</span>
<span id="cb702-4382"><a href="#cb702-4382" aria-hidden="true" tabindex="-1"></a>    <span class="at">CI_lower =</span> M <span class="sc">-</span> <span class="fu">qt</span>(<span class="fl">0.975</span>, n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> SE,</span>
<span id="cb702-4383"><a href="#cb702-4383" aria-hidden="true" tabindex="-1"></a>    <span class="at">CI_upper =</span> M <span class="sc">+</span> <span class="fu">qt</span>(<span class="fl">0.975</span>, n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> SE,</span>
<span id="cb702-4384"><a href="#cb702-4384" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb702-4385"><a href="#cb702-4385" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb702-4386"><a href="#cb702-4386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4387"><a href="#cb702-4387" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(summary_stats)</span>
<span id="cb702-4388"><a href="#cb702-4388" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-4389"><a href="#cb702-4389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4390"><a href="#cb702-4390" aria-hidden="true" tabindex="-1"></a>**Checkpoint:** You should have n=18 observations per condition with decreasing reaction times across conditions.</span>
<span id="cb702-4391"><a href="#cb702-4391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4392"><a href="#cb702-4392" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-4393"><a href="#cb702-4393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4394"><a href="#cb702-4394" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 2: Bad Practices vs Good Practices</span></span>
<span id="cb702-4395"><a href="#cb702-4395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4396"><a href="#cb702-4396" aria-hidden="true" tabindex="-1"></a>Contrast ineffective and effective visualizations:</span>
<span id="cb702-4397"><a href="#cb702-4397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4398"><a href="#cb702-4398" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lab12-comparison}</span></span>
<span id="cb702-4399"><a href="#cb702-4399" aria-hidden="true" tabindex="-1"></a><span class="co"># BAD: Bar chart without individual points (hides data)</span></span>
<span id="cb702-4400"><a href="#cb702-4400" aria-hidden="true" tabindex="-1"></a>bad_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(summary_stats, <span class="fu">aes</span>(<span class="at">x =</span> condition, <span class="at">y =</span> M)) <span class="sc">+</span></span>
<span id="cb702-4401"><a href="#cb702-4401" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb702-4402"><a href="#cb702-4402" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> CI_lower, <span class="at">ymax =</span> CI_upper), <span class="at">width =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb702-4403"><a href="#cb702-4403" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"BAD: Bars Hide Data (n=18 per condition)"</span>,</span>
<span id="cb702-4404"><a href="#cb702-4404" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Reaction Time (ms)"</span>) <span class="sc">+</span></span>
<span id="cb702-4405"><a href="#cb702-4405" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb702-4406"><a href="#cb702-4406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4407"><a href="#cb702-4407" aria-hidden="true" tabindex="-1"></a><span class="co"># GOOD: Show all individual points with summary</span></span>
<span id="cb702-4408"><a href="#cb702-4408" aria-hidden="true" tabindex="-1"></a>good_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(pilot_data, <span class="fu">aes</span>(<span class="at">x =</span> condition, <span class="at">y =</span> reaction_time)) <span class="sc">+</span></span>
<span id="cb702-4409"><a href="#cb702-4409" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span>  <span class="co"># Individual points</span></span>
<span id="cb702-4410"><a href="#cb702-4410" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"point"</span>, </span>
<span id="cb702-4411"><a href="#cb702-4411" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">shape =</span> <span class="dv">18</span>) <span class="sc">+</span>  <span class="co"># Mean</span></span>
<span id="cb702-4412"><a href="#cb702-4412" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_cl_normal, <span class="at">geom =</span> <span class="st">"errorbar"</span>,</span>
<span id="cb702-4413"><a href="#cb702-4413" aria-hidden="true" tabindex="-1"></a>               <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span>  <span class="co"># 95% CI</span></span>
<span id="cb702-4414"><a href="#cb702-4414" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"GOOD: Show Individual Data Points (n=18 per condition)"</span>,</span>
<span id="cb702-4415"><a href="#cb702-4415" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Reaction Time (ms)"</span>,</span>
<span id="cb702-4416"><a href="#cb702-4416" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Red diamonds = means with 95% CIs"</span>) <span class="sc">+</span></span>
<span id="cb702-4417"><a href="#cb702-4417" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb702-4418"><a href="#cb702-4418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4419"><a href="#cb702-4419" aria-hidden="true" tabindex="-1"></a><span class="co"># Display side-by-side</span></span>
<span id="cb702-4420"><a href="#cb702-4420" aria-hidden="true" tabindex="-1"></a>bad_plot <span class="sc">+</span> good_plot</span>
<span id="cb702-4421"><a href="#cb702-4421" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-4422"><a href="#cb702-4422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4423"><a href="#cb702-4423" aria-hidden="true" tabindex="-1"></a>**Checkpoint:** Good plot reveals individual variability and distribution; bad plot hides critical information.</span>
<span id="cb702-4424"><a href="#cb702-4424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4425"><a href="#cb702-4425" aria-hidden="true" tabindex="-1"></a>**Discussion:** Why is hiding data particularly problematic with small samples?</span>
<span id="cb702-4426"><a href="#cb702-4426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4427"><a href="#cb702-4427" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-4428"><a href="#cb702-4428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4429"><a href="#cb702-4429" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 3: Effective Within-Subjects Visualization</span></span>
<span id="cb702-4430"><a href="#cb702-4430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4431"><a href="#cb702-4431" aria-hidden="true" tabindex="-1"></a>Show paired nature of the data:</span>
<span id="cb702-4432"><a href="#cb702-4432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4433"><a href="#cb702-4433" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lab12-within-subjects}</span></span>
<span id="cb702-4434"><a href="#cb702-4434" aria-hidden="true" tabindex="-1"></a><span class="co"># Connect individual trajectories</span></span>
<span id="cb702-4435"><a href="#cb702-4435" aria-hidden="true" tabindex="-1"></a>trajectory_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(pilot_data, </span>
<span id="cb702-4436"><a href="#cb702-4436" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">aes</span>(<span class="at">x =</span> condition, <span class="at">y =</span> reaction_time, </span>
<span id="cb702-4437"><a href="#cb702-4437" aria-hidden="true" tabindex="-1"></a>                              <span class="at">group =</span> participant_id)) <span class="sc">+</span></span>
<span id="cb702-4438"><a href="#cb702-4438" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">color =</span> <span class="st">"gray50"</span>) <span class="sc">+</span>  <span class="co"># Individual lines</span></span>
<span id="cb702-4439"><a href="#cb702-4439" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span>         <span class="co"># Individual points</span></span>
<span id="cb702-4440"><a href="#cb702-4440" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="fu">aes</span>(<span class="at">group =</span> <span class="dv">1</span>), <span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"line"</span>, </span>
<span id="cb702-4441"><a href="#cb702-4441" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linewidth =</span> <span class="fl">1.5</span>) <span class="sc">+</span>  <span class="co"># Mean trajectory</span></span>
<span id="cb702-4442"><a href="#cb702-4442" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"point"</span>, </span>
<span id="cb702-4443"><a href="#cb702-4443" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">shape =</span> <span class="dv">18</span>) <span class="sc">+</span></span>
<span id="cb702-4444"><a href="#cb702-4444" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Individual Trajectories with Mean (n=18)"</span>,</span>
<span id="cb702-4445"><a href="#cb702-4445" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Within-Subjects Design"</span>,</span>
<span id="cb702-4446"><a href="#cb702-4446" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Reaction Time (ms)"</span>,</span>
<span id="cb702-4447"><a href="#cb702-4447" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>) <span class="sc">+</span></span>
<span id="cb702-4448"><a href="#cb702-4448" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb702-4449"><a href="#cb702-4449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4450"><a href="#cb702-4450" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(trajectory_plot)</span>
<span id="cb702-4451"><a href="#cb702-4451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4452"><a href="#cb702-4452" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternative: Raincloud plot (distribution + points + boxplot)</span></span>
<span id="cb702-4453"><a href="#cb702-4453" aria-hidden="true" tabindex="-1"></a>raincloud_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(pilot_data, <span class="fu">aes</span>(<span class="at">x =</span> condition, <span class="at">y =</span> reaction_time, </span>
<span id="cb702-4454"><a href="#cb702-4454" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">fill =</span> condition)) <span class="sc">+</span></span>
<span id="cb702-4455"><a href="#cb702-4455" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Half violin (distribution)</span></span>
<span id="cb702-4456"><a href="#cb702-4456" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(<span class="at">adjust =</span> <span class="dv">1</span>, <span class="at">width =</span> <span class="fl">0.6</span>, <span class="at">.width =</span> <span class="dv">0</span>, </span>
<span id="cb702-4457"><a href="#cb702-4457" aria-hidden="true" tabindex="-1"></a>               <span class="at">justification =</span> <span class="sc">-</span><span class="fl">0.2</span>, <span class="at">point_colour =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb702-4458"><a href="#cb702-4458" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Boxplot</span></span>
<span id="cb702-4459"><a href="#cb702-4459" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.15</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb702-4460"><a href="#cb702-4460" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Individual points</span></span>
<span id="cb702-4461"><a href="#cb702-4461" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, </span>
<span id="cb702-4462"><a href="#cb702-4462" aria-hidden="true" tabindex="-1"></a>             <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">width =</span> <span class="fl">0.05</span>)) <span class="sc">+</span></span>
<span id="cb702-4463"><a href="#cb702-4463" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Raincloud Plot: Distribution + Box + Points"</span>,</span>
<span id="cb702-4464"><a href="#cb702-4464" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Reaction Time (ms)"</span>) <span class="sc">+</span></span>
<span id="cb702-4465"><a href="#cb702-4465" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb702-4466"><a href="#cb702-4466" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb702-4467"><a href="#cb702-4467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4468"><a href="#cb702-4468" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(raincloud_plot)</span>
<span id="cb702-4469"><a href="#cb702-4469" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-4470"><a href="#cb702-4470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4471"><a href="#cb702-4471" aria-hidden="true" tabindex="-1"></a>**Checkpoint:** Individual trajectories reveal within-person changes (most participants improve). Raincloud shows full distribution.</span>
<span id="cb702-4472"><a href="#cb702-4472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4473"><a href="#cb702-4473" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-4474"><a href="#cb702-4474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4475"><a href="#cb702-4475" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 4: Uncertainty Visualization</span></span>
<span id="cb702-4476"><a href="#cb702-4476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4477"><a href="#cb702-4477" aria-hidden="true" tabindex="-1"></a>Emphasize confidence intervals and prediction intervals:</span>
<span id="cb702-4478"><a href="#cb702-4478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4479"><a href="#cb702-4479" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lab12-uncertainty}</span></span>
<span id="cb702-4480"><a href="#cb702-4480" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to wide format for plotting</span></span>
<span id="cb702-4481"><a href="#cb702-4481" aria-hidden="true" tabindex="-1"></a>pilot_wide <span class="ot">&lt;-</span> pilot_data <span class="sc">%&gt;%</span></span>
<span id="cb702-4482"><a href="#cb702-4482" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> condition, <span class="at">values_from =</span> reaction_time)</span>
<span id="cb702-4483"><a href="#cb702-4483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4484"><a href="#cb702-4484" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter plot with regression line and confidence/prediction bands</span></span>
<span id="cb702-4485"><a href="#cb702-4485" aria-hidden="true" tabindex="-1"></a>scatter_uncertainty <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(pilot_wide, </span>
<span id="cb702-4486"><a href="#cb702-4486" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">aes</span>(<span class="at">x =</span> Baseline, <span class="at">y =</span> <span class="st">`</span><span class="at">Treatment B</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb702-4487"><a href="#cb702-4487" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, </span>
<span id="cb702-4488"><a href="#cb702-4488" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"gray50"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span>  <span class="co"># Identity line</span></span>
<span id="cb702-4489"><a href="#cb702-4489" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>, </span>
<span id="cb702-4490"><a href="#cb702-4490" aria-hidden="true" tabindex="-1"></a>              <span class="at">level =</span> <span class="fl">0.95</span>, <span class="at">fill =</span> <span class="st">"blue"</span>, <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span>  <span class="co"># 95% CI</span></span>
<span id="cb702-4491"><a href="#cb702-4491" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb702-4492"><a href="#cb702-4492" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Baseline vs Treatment B (n=18)"</span>,</span>
<span id="cb702-4493"><a href="#cb702-4493" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Blue band = 95% confidence interval for regression line"</span>,</span>
<span id="cb702-4494"><a href="#cb702-4494" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Baseline Reaction Time (ms)"</span>,</span>
<span id="cb702-4495"><a href="#cb702-4495" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Treatment B Reaction Time (ms)"</span>) <span class="sc">+</span></span>
<span id="cb702-4496"><a href="#cb702-4496" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>(<span class="at">ratio =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb702-4497"><a href="#cb702-4497" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb702-4498"><a href="#cb702-4498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4499"><a href="#cb702-4499" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(scatter_uncertainty)</span>
<span id="cb702-4500"><a href="#cb702-4500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4501"><a href="#cb702-4501" aria-hidden="true" tabindex="-1"></a><span class="co"># Error bar plot with different CI levels</span></span>
<span id="cb702-4502"><a href="#cb702-4502" aria-hidden="true" tabindex="-1"></a>ci_levels <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(</span>
<span id="cb702-4503"><a href="#cb702-4503" aria-hidden="true" tabindex="-1"></a>  <span class="at">condition =</span> summary_stats<span class="sc">$</span>condition,</span>
<span id="cb702-4504"><a href="#cb702-4504" aria-hidden="true" tabindex="-1"></a>  <span class="at">ci_level =</span> <span class="fu">c</span>(<span class="fl">0.80</span>, <span class="fl">0.90</span>, <span class="fl">0.95</span>)</span>
<span id="cb702-4505"><a href="#cb702-4505" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb702-4506"><a href="#cb702-4506" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(pilot_data, <span class="at">by =</span> <span class="st">"condition"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb702-4507"><a href="#cb702-4507" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(condition, ci_level) <span class="sc">%&gt;%</span></span>
<span id="cb702-4508"><a href="#cb702-4508" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb702-4509"><a href="#cb702-4509" aria-hidden="true" tabindex="-1"></a>    <span class="at">M =</span> <span class="fu">mean</span>(reaction_time),</span>
<span id="cb702-4510"><a href="#cb702-4510" aria-hidden="true" tabindex="-1"></a>    <span class="at">SE =</span> <span class="fu">sd</span>(reaction_time) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">n</span>()),</span>
<span id="cb702-4511"><a href="#cb702-4511" aria-hidden="true" tabindex="-1"></a>    <span class="at">CI_lower =</span> M <span class="sc">-</span> <span class="fu">qt</span>((<span class="dv">1</span> <span class="sc">+</span> ci_level) <span class="sc">/</span> <span class="dv">2</span>, <span class="fu">n</span>() <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> SE,</span>
<span id="cb702-4512"><a href="#cb702-4512" aria-hidden="true" tabindex="-1"></a>    <span class="at">CI_upper =</span> M <span class="sc">+</span> <span class="fu">qt</span>((<span class="dv">1</span> <span class="sc">+</span> ci_level) <span class="sc">/</span> <span class="dv">2</span>, <span class="fu">n</span>() <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> SE,</span>
<span id="cb702-4513"><a href="#cb702-4513" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb702-4514"><a href="#cb702-4514" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb702-4515"><a href="#cb702-4515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4516"><a href="#cb702-4516" aria-hidden="true" tabindex="-1"></a>ci_comparison <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(ci_levels, <span class="fu">aes</span>(<span class="at">x =</span> condition, <span class="at">y =</span> M, </span>
<span id="cb702-4517"><a href="#cb702-4517" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">color =</span> <span class="fu">factor</span>(ci_level))) <span class="sc">+</span></span>
<span id="cb702-4518"><a href="#cb702-4518" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.3</span>)) <span class="sc">+</span></span>
<span id="cb702-4519"><a href="#cb702-4519" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> CI_lower, <span class="at">ymax =</span> CI_upper), </span>
<span id="cb702-4520"><a href="#cb702-4520" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">linewidth =</span> <span class="dv">1</span>,</span>
<span id="cb702-4521"><a href="#cb702-4521" aria-hidden="true" tabindex="-1"></a>                <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.3</span>)) <span class="sc">+</span></span>
<span id="cb702-4522"><a href="#cb702-4522" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"green"</span>, <span class="st">"blue"</span>, <span class="st">"red"</span>),</span>
<span id="cb702-4523"><a href="#cb702-4523" aria-hidden="true" tabindex="-1"></a>                    <span class="at">name =</span> <span class="st">"Confidence Level"</span>) <span class="sc">+</span></span>
<span id="cb702-4524"><a href="#cb702-4524" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Comparing Confidence Interval Widths"</span>,</span>
<span id="cb702-4525"><a href="#cb702-4525" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Wider intervals = higher confidence"</span>,</span>
<span id="cb702-4526"><a href="#cb702-4526" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Reaction Time (ms)"</span>) <span class="sc">+</span></span>
<span id="cb702-4527"><a href="#cb702-4527" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb702-4528"><a href="#cb702-4528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4529"><a href="#cb702-4529" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(ci_comparison)</span>
<span id="cb702-4530"><a href="#cb702-4530" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-4531"><a href="#cb702-4531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4532"><a href="#cb702-4532" aria-hidden="true" tabindex="-1"></a>**Checkpoint:** Visualizations honestly communicate uncertainty. Wider CIs reflect small sample imprecision.</span>
<span id="cb702-4533"><a href="#cb702-4533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4534"><a href="#cb702-4534" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-4535"><a href="#cb702-4535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4536"><a href="#cb702-4536" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 5: Publication-Ready Formatting</span></span>
<span id="cb702-4537"><a href="#cb702-4537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4538"><a href="#cb702-4538" aria-hidden="true" tabindex="-1"></a>Apply professional styling:</span>
<span id="cb702-4539"><a href="#cb702-4539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4540"><a href="#cb702-4540" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lab12-publication}</span></span>
<span id="cb702-4541"><a href="#cb702-4541" aria-hidden="true" tabindex="-1"></a><span class="co"># Publication-quality figure</span></span>
<span id="cb702-4542"><a href="#cb702-4542" aria-hidden="true" tabindex="-1"></a>pub_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(pilot_data, <span class="fu">aes</span>(<span class="at">x =</span> condition, <span class="at">y =</span> reaction_time)) <span class="sc">+</span></span>
<span id="cb702-4543"><a href="#cb702-4543" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Individual points with beeswarm layout (no overlap)</span></span>
<span id="cb702-4544"><a href="#cb702-4544" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_beeswarm</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="fl">2.5</span>, <span class="at">cex =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb702-4545"><a href="#cb702-4545" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Mean with 95% CI</span></span>
<span id="cb702-4546"><a href="#cb702-4546" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_cl_normal, <span class="at">geom =</span> <span class="st">"errorbar"</span>,</span>
<span id="cb702-4547"><a href="#cb702-4547" aria-hidden="true" tabindex="-1"></a>               <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">linewidth =</span> <span class="fl">1.2</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb702-4548"><a href="#cb702-4548" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"point"</span>, </span>
<span id="cb702-4549"><a href="#cb702-4549" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">5</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">shape =</span> <span class="dv">18</span>) <span class="sc">+</span></span>
<span id="cb702-4550"><a href="#cb702-4550" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Styling</span></span>
<span id="cb702-4551"><a href="#cb702-4551" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">300</span>, <span class="dv">600</span>, <span class="dv">50</span>)) <span class="sc">+</span></span>
<span id="cb702-4552"><a href="#cb702-4552" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb702-4553"><a href="#cb702-4553" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Reaction Time by Condition"</span>,</span>
<span id="cb702-4554"><a href="#cb702-4554" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Within-subjects pilot study (N=18)"</span>,</span>
<span id="cb702-4555"><a href="#cb702-4555" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Experimental Condition"</span>,</span>
<span id="cb702-4556"><a href="#cb702-4556" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Reaction Time (ms)"</span>,</span>
<span id="cb702-4557"><a href="#cb702-4557" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"Individual points shown with means (red diamonds) and 95% CIs.</span><span class="sc">\n</span><span class="st">Error bars represent between-subjects variability."</span></span>
<span id="cb702-4558"><a href="#cb702-4558" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb702-4559"><a href="#cb702-4559" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb702-4560"><a href="#cb702-4560" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb702-4561"><a href="#cb702-4561" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">family =</span> <span class="st">"sans"</span>),</span>
<span id="cb702-4562"><a href="#cb702-4562" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb702-4563"><a href="#cb702-4563" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>, <span class="at">color =</span> <span class="st">"gray30"</span>),</span>
<span id="cb702-4564"><a href="#cb702-4564" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"gray50"</span>),</span>
<span id="cb702-4565"><a href="#cb702-4565" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb702-4566"><a href="#cb702-4566" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb702-4567"><a href="#cb702-4567" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"gray90"</span>),</span>
<span id="cb702-4568"><a href="#cb702-4568" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()</span>
<span id="cb702-4569"><a href="#cb702-4569" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb702-4570"><a href="#cb702-4570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4571"><a href="#cb702-4571" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pub_plot)</span>
<span id="cb702-4572"><a href="#cb702-4572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4573"><a href="#cb702-4573" aria-hidden="true" tabindex="-1"></a><span class="co"># Save high-resolution version</span></span>
<span id="cb702-4574"><a href="#cb702-4574" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"pilot_reaction_time.png"</span>, pub_plot, </span>
<span id="cb702-4575"><a href="#cb702-4575" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">7</span>, <span class="at">height =</span> <span class="dv">5</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb702-4576"><a href="#cb702-4576" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Figure saved as 'pilot_reaction_time.png'</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-4577"><a href="#cb702-4577" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-4578"><a href="#cb702-4578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4579"><a href="#cb702-4579" aria-hidden="true" tabindex="-1"></a>**Checkpoint:** Publication-ready figure with clear labels, appropriate font sizes, and professional appearance.</span>
<span id="cb702-4580"><a href="#cb702-4580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4581"><a href="#cb702-4581" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-4582"><a href="#cb702-4582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4583"><a href="#cb702-4583" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 6: Small Sample Specific Techniques</span></span>
<span id="cb702-4584"><a href="#cb702-4584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4585"><a href="#cb702-4585" aria-hidden="true" tabindex="-1"></a>Apply strategies tailored to small n:</span>
<span id="cb702-4586"><a href="#cb702-4586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4587"><a href="#cb702-4587" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lab12-small-n-techniques}</span></span>
<span id="cb702-4588"><a href="#cb702-4588" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Annotate with exact n</span></span>
<span id="cb702-4589"><a href="#cb702-4589" aria-hidden="true" tabindex="-1"></a>annotated_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(summary_stats, <span class="fu">aes</span>(<span class="at">x =</span> condition, <span class="at">y =</span> M)) <span class="sc">+</span></span>
<span id="cb702-4590"><a href="#cb702-4590" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">"lightblue"</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb702-4591"><a href="#cb702-4591" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> CI_lower, <span class="at">ymax =</span> CI_upper), <span class="at">width =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb702-4592"><a href="#cb702-4592" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"n="</span>, n)), </span>
<span id="cb702-4593"><a href="#cb702-4593" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>) <span class="sc">+</span></span>
<span id="cb702-4594"><a href="#cb702-4594" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">data =</span> pilot_data, </span>
<span id="cb702-4595"><a href="#cb702-4595" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> condition, <span class="at">y =</span> reaction_time),</span>
<span id="cb702-4596"><a href="#cb702-4596" aria-hidden="true" tabindex="-1"></a>              <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb702-4597"><a href="#cb702-4597" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Explicitly State Sample Size"</span>,</span>
<span id="cb702-4598"><a href="#cb702-4598" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Reaction Time (ms)"</span>) <span class="sc">+</span></span>
<span id="cb702-4599"><a href="#cb702-4599" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb702-4600"><a href="#cb702-4600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4601"><a href="#cb702-4601" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Show effect sizes, not just means</span></span>
<span id="cb702-4602"><a href="#cb702-4602" aria-hidden="true" tabindex="-1"></a>effect_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb702-4603"><a href="#cb702-4603" aria-hidden="true" tabindex="-1"></a>  <span class="at">comparison =</span> <span class="fu">c</span>(<span class="st">"Baseline vs Treatment A"</span>, </span>
<span id="cb702-4604"><a href="#cb702-4604" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Baseline vs Treatment B"</span>,</span>
<span id="cb702-4605"><a href="#cb702-4605" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Treatment A vs Treatment B"</span>),</span>
<span id="cb702-4606"><a href="#cb702-4606" aria-hidden="true" tabindex="-1"></a>  <span class="at">cohens_d =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.52</span>, <span class="sc">-</span><span class="fl">1.32</span>, <span class="sc">-</span><span class="fl">0.75</span>),  <span class="co"># Example values</span></span>
<span id="cb702-4607"><a href="#cb702-4607" aria-hidden="true" tabindex="-1"></a>  <span class="at">ci_lower =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.15</span>, <span class="sc">-</span><span class="fl">2.03</span>, <span class="sc">-</span><span class="fl">1.40</span>),</span>
<span id="cb702-4608"><a href="#cb702-4608" aria-hidden="true" tabindex="-1"></a>  <span class="at">ci_upper =</span> <span class="fu">c</span>(<span class="fl">0.12</span>, <span class="sc">-</span><span class="fl">0.60</span>, <span class="sc">-</span><span class="fl">0.10</span>)</span>
<span id="cb702-4609"><a href="#cb702-4609" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb702-4610"><a href="#cb702-4610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4611"><a href="#cb702-4611" aria-hidden="true" tabindex="-1"></a>effect_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(effect_data, <span class="fu">aes</span>(<span class="at">x =</span> comparison, <span class="at">y =</span> cohens_d)) <span class="sc">+</span></span>
<span id="cb702-4612"><a href="#cb702-4612" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"gray50"</span>) <span class="sc">+</span></span>
<span id="cb702-4613"><a href="#cb702-4613" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.2</span>, <span class="sc">-</span><span class="fl">0.5</span>, <span class="sc">-</span><span class="fl">0.8</span>), </span>
<span id="cb702-4614"><a href="#cb702-4614" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dotted"</span>, <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb702-4615"><a href="#cb702-4615" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb702-4616"><a href="#cb702-4616" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> ci_lower, <span class="at">ymax =</span> ci_upper), </span>
<span id="cb702-4617"><a href="#cb702-4617" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb702-4618"><a href="#cb702-4618" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb702-4619"><a href="#cb702-4619" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Effect Sizes with 95% CIs"</span>,</span>
<span id="cb702-4620"><a href="#cb702-4620" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"Cohen's d (negative = faster reaction time)"</span>,</span>
<span id="cb702-4621"><a href="#cb702-4621" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Blue lines indicate small (-0.2), medium (-0.5), large (-0.8) benchmarks"</span>) <span class="sc">+</span></span>
<span id="cb702-4622"><a href="#cb702-4622" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb702-4623"><a href="#cb702-4623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4624"><a href="#cb702-4624" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Emphasize individual differences</span></span>
<span id="cb702-4625"><a href="#cb702-4625" aria-hidden="true" tabindex="-1"></a>individual_plot <span class="ot">&lt;-</span> pilot_wide <span class="sc">%&gt;%</span></span>
<span id="cb702-4626"><a href="#cb702-4626" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">improved =</span> <span class="st">`</span><span class="at">Treatment B</span><span class="st">`</span> <span class="sc">&lt;</span> Baseline) <span class="sc">%&gt;%</span></span>
<span id="cb702-4627"><a href="#cb702-4627" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Baseline, <span class="at">y =</span> <span class="st">`</span><span class="at">Treatment B</span><span class="st">`</span>, <span class="at">color =</span> improved)) <span class="sc">+</span></span>
<span id="cb702-4628"><a href="#cb702-4628" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"gray50"</span>) <span class="sc">+</span></span>
<span id="cb702-4629"><a href="#cb702-4629" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb702-4630"><a href="#cb702-4630" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> participant_id), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.8</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb702-4631"><a href="#cb702-4631" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"darkgreen"</span>),</span>
<span id="cb702-4632"><a href="#cb702-4632" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Worsened"</span>, <span class="st">"Improved"</span>),</span>
<span id="cb702-4633"><a href="#cb702-4633" aria-hidden="true" tabindex="-1"></a>                    <span class="at">name =</span> <span class="st">"Change"</span>) <span class="sc">+</span></span>
<span id="cb702-4634"><a href="#cb702-4634" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Individual Response to Treatment B (n=18)"</span>,</span>
<span id="cb702-4635"><a href="#cb702-4635" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Points below diagonal = improvement"</span>,</span>
<span id="cb702-4636"><a href="#cb702-4636" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Baseline RT (ms)"</span>, <span class="at">y =</span> <span class="st">"Treatment B RT (ms)"</span>) <span class="sc">+</span></span>
<span id="cb702-4637"><a href="#cb702-4637" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>(<span class="at">ratio =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb702-4638"><a href="#cb702-4638" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb702-4639"><a href="#cb702-4639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4640"><a href="#cb702-4640" aria-hidden="true" tabindex="-1"></a><span class="co"># Display all</span></span>
<span id="cb702-4641"><a href="#cb702-4641" aria-hidden="true" tabindex="-1"></a>annotated_plot <span class="sc">/</span> (effect_plot <span class="sc">|</span> individual_plot)</span>
<span id="cb702-4642"><a href="#cb702-4642" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-4643"><a href="#cb702-4643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4644"><a href="#cb702-4644" aria-hidden="true" tabindex="-1"></a>**Checkpoint:** Multiple strategies communicate both group trends and individual variability.</span>
<span id="cb702-4645"><a href="#cb702-4645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4646"><a href="#cb702-4646" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-4647"><a href="#cb702-4647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4648"><a href="#cb702-4648" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 7: Avoid Common Pitfalls</span></span>
<span id="cb702-4649"><a href="#cb702-4649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4650"><a href="#cb702-4650" aria-hidden="true" tabindex="-1"></a>Demonstrate what NOT to do:</span>
<span id="cb702-4651"><a href="#cb702-4651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4652"><a href="#cb702-4652" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lab12-pitfalls}</span></span>
<span id="cb702-4653"><a href="#cb702-4653" aria-hidden="true" tabindex="-1"></a><span class="co"># PITFALL 1: Dynamite plots (bars + SE, no data shown)</span></span>
<span id="cb702-4654"><a href="#cb702-4654" aria-hidden="true" tabindex="-1"></a>pitfall1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(summary_stats, <span class="fu">aes</span>(<span class="at">x =</span> condition, <span class="at">y =</span> M)) <span class="sc">+</span></span>
<span id="cb702-4655"><a href="#cb702-4655" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">"gray50"</span>) <span class="sc">+</span></span>
<span id="cb702-4656"><a href="#cb702-4656" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> M <span class="sc">-</span> SE, <span class="at">ymax =</span> M <span class="sc">+</span> SE), <span class="at">width =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb702-4657"><a href="#cb702-4657" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"AVOID: Dynamite Plot (Bars + SE)"</span>,</span>
<span id="cb702-4658"><a href="#cb702-4658" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Hides distribution, SE is not CI"</span>,</span>
<span id="cb702-4659"><a href="#cb702-4659" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Reaction Time (ms)"</span>) <span class="sc">+</span></span>
<span id="cb702-4660"><a href="#cb702-4660" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb702-4661"><a href="#cb702-4661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4662"><a href="#cb702-4662" aria-hidden="true" tabindex="-1"></a><span class="co"># PITFALL 2: Over-smoothing with small n</span></span>
<span id="cb702-4663"><a href="#cb702-4663" aria-hidden="true" tabindex="-1"></a>pitfall2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(pilot_data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.numeric</span>(condition), </span>
<span id="cb702-4664"><a href="#cb702-4664" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">y =</span> reaction_time)) <span class="sc">+</span></span>
<span id="cb702-4665"><a href="#cb702-4665" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"loess"</span>, <span class="at">span =</span> <span class="fl">0.5</span>, <span class="at">se =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb702-4666"><a href="#cb702-4666" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"AVOID: Over-smoothed Curve (Implies More Data)"</span>,</span>
<span id="cb702-4667"><a href="#cb702-4667" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Only 3 conditions but curve suggests continuous relationship"</span>,</span>
<span id="cb702-4668"><a href="#cb702-4668" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition"</span>, <span class="at">y =</span> <span class="st">"Reaction Time (ms)"</span>) <span class="sc">+</span></span>
<span id="cb702-4669"><a href="#cb702-4669" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb702-4670"><a href="#cb702-4670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4671"><a href="#cb702-4671" aria-hidden="true" tabindex="-1"></a><span class="co"># PITFALL 3: Missing sample size annotation</span></span>
<span id="cb702-4672"><a href="#cb702-4672" aria-hidden="true" tabindex="-1"></a>pitfall3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(summary_stats, <span class="fu">aes</span>(<span class="at">x =</span> condition, <span class="at">y =</span> M)) <span class="sc">+</span></span>
<span id="cb702-4673"><a href="#cb702-4673" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb702-4674"><a href="#cb702-4674" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> CI_lower, <span class="at">ymax =</span> CI_upper), <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb702-4675"><a href="#cb702-4675" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"AVOID: No Sample Size Stated"</span>,</span>
<span id="cb702-4676"><a href="#cb702-4676" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Reader cannot judge CI width appropriateness"</span>,</span>
<span id="cb702-4677"><a href="#cb702-4677" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Reaction Time (ms)"</span>) <span class="sc">+</span></span>
<span id="cb702-4678"><a href="#cb702-4678" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb702-4679"><a href="#cb702-4679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4680"><a href="#cb702-4680" aria-hidden="true" tabindex="-1"></a><span class="co"># BETTER alternatives</span></span>
<span id="cb702-4681"><a href="#cb702-4681" aria-hidden="true" tabindex="-1"></a>better1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(pilot_data, <span class="fu">aes</span>(<span class="at">x =</span> condition, <span class="at">y =</span> reaction_time)) <span class="sc">+</span></span>
<span id="cb702-4682"><a href="#cb702-4682" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.shape =</span> <span class="cn">NA</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb702-4683"><a href="#cb702-4683" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb702-4684"><a href="#cb702-4684" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"BETTER: Boxplot + Points"</span>,</span>
<span id="cb702-4685"><a href="#cb702-4685" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Reaction Time (ms)"</span>) <span class="sc">+</span></span>
<span id="cb702-4686"><a href="#cb702-4686" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb702-4687"><a href="#cb702-4687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4688"><a href="#cb702-4688" aria-hidden="true" tabindex="-1"></a>better2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(summary_stats, <span class="fu">aes</span>(<span class="at">x =</span> condition, <span class="at">y =</span> M)) <span class="sc">+</span></span>
<span id="cb702-4689"><a href="#cb702-4689" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb702-4690"><a href="#cb702-4690" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> CI_lower, <span class="at">ymax =</span> CI_upper), <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb702-4691"><a href="#cb702-4691" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">data =</span> pilot_data, </span>
<span id="cb702-4692"><a href="#cb702-4692" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> condition, <span class="at">y =</span> reaction_time),</span>
<span id="cb702-4693"><a href="#cb702-4693" aria-hidden="true" tabindex="-1"></a>              <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb702-4694"><a href="#cb702-4694" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"BETTER: Points + 95% CI + Data"</span>,</span>
<span id="cb702-4695"><a href="#cb702-4695" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"n=18 per condition"</span>,</span>
<span id="cb702-4696"><a href="#cb702-4696" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Reaction Time (ms)"</span>) <span class="sc">+</span></span>
<span id="cb702-4697"><a href="#cb702-4697" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb702-4698"><a href="#cb702-4698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4699"><a href="#cb702-4699" aria-hidden="true" tabindex="-1"></a>(pitfall1 <span class="sc">|</span> better1) <span class="sc">/</span> (pitfall2 <span class="sc">|</span> better2)</span>
<span id="cb702-4700"><a href="#cb702-4700" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-4701"><a href="#cb702-4701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4702"><a href="#cb702-4702" aria-hidden="true" tabindex="-1"></a>**Checkpoint:** Contrast highlights importance of showing data and being transparent about sample size.</span>
<span id="cb702-4703"><a href="#cb702-4703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4704"><a href="#cb702-4704" aria-hidden="true" tabindex="-1"></a>**Discussion:** Why are dynamite plots especially misleading with small samples?</span>
<span id="cb702-4705"><a href="#cb702-4705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4706"><a href="#cb702-4706" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-4707"><a href="#cb702-4707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4708"><a href="#cb702-4708" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 8: Create Multi-Panel Publication Figure</span></span>
<span id="cb702-4709"><a href="#cb702-4709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4710"><a href="#cb702-4710" aria-hidden="true" tabindex="-1"></a>Combine multiple visualizations:</span>
<span id="cb702-4711"><a href="#cb702-4711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4712"><a href="#cb702-4712" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lab12-multipanel}</span></span>
<span id="cb702-4713"><a href="#cb702-4713" aria-hidden="true" tabindex="-1"></a><span class="co"># Panel A: Main result with individual trajectories</span></span>
<span id="cb702-4714"><a href="#cb702-4714" aria-hidden="true" tabindex="-1"></a>panel_a <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(pilot_data, </span>
<span id="cb702-4715"><a href="#cb702-4715" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">aes</span>(<span class="at">x =</span> condition, <span class="at">y =</span> reaction_time, </span>
<span id="cb702-4716"><a href="#cb702-4716" aria-hidden="true" tabindex="-1"></a>                      <span class="at">group =</span> participant_id)) <span class="sc">+</span></span>
<span id="cb702-4717"><a href="#cb702-4717" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">color =</span> <span class="st">"gray70"</span>) <span class="sc">+</span></span>
<span id="cb702-4718"><a href="#cb702-4718" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb702-4719"><a href="#cb702-4719" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="fu">aes</span>(<span class="at">group =</span> <span class="dv">1</span>), <span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"line"</span>, </span>
<span id="cb702-4720"><a href="#cb702-4720" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linewidth =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb702-4721"><a href="#cb702-4721" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"point"</span>, </span>
<span id="cb702-4722"><a href="#cb702-4722" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">shape =</span> <span class="dv">18</span>) <span class="sc">+</span></span>
<span id="cb702-4723"><a href="#cb702-4723" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_cl_normal, <span class="at">geom =</span> <span class="st">"errorbar"</span>,</span>
<span id="cb702-4724"><a href="#cb702-4724" aria-hidden="true" tabindex="-1"></a>               <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb702-4725"><a href="#cb702-4725" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">"A. Individual Trajectories"</span>,</span>
<span id="cb702-4726"><a href="#cb702-4726" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Reaction Time (ms)"</span>, <span class="at">x =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb702-4727"><a href="#cb702-4727" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb702-4728"><a href="#cb702-4728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4729"><a href="#cb702-4729" aria-hidden="true" tabindex="-1"></a><span class="co"># Panel B: Distribution comparison</span></span>
<span id="cb702-4730"><a href="#cb702-4730" aria-hidden="true" tabindex="-1"></a>panel_b <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(pilot_data, <span class="fu">aes</span>(<span class="at">x =</span> reaction_time, <span class="at">fill =</span> condition)) <span class="sc">+</span></span>
<span id="cb702-4731"><a href="#cb702-4731" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb702-4732"><a href="#cb702-4732" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">"B. Density Distributions"</span>,</span>
<span id="cb702-4733"><a href="#cb702-4733" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Reaction Time (ms)"</span>, <span class="at">y =</span> <span class="st">"Density"</span>) <span class="sc">+</span></span>
<span id="cb702-4734"><a href="#cb702-4734" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb702-4735"><a href="#cb702-4735" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb702-4736"><a href="#cb702-4736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4737"><a href="#cb702-4737" aria-hidden="true" tabindex="-1"></a><span class="co"># Panel C: Effect sizes</span></span>
<span id="cb702-4738"><a href="#cb702-4738" aria-hidden="true" tabindex="-1"></a>treat_b_vs_baseline <span class="ot">&lt;-</span> pilot_wide <span class="sc">%&gt;%</span></span>
<span id="cb702-4739"><a href="#cb702-4739" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb702-4740"><a href="#cb702-4740" aria-hidden="true" tabindex="-1"></a>    <span class="at">d =</span> (<span class="fu">mean</span>(Baseline) <span class="sc">-</span> <span class="fu">mean</span>(<span class="st">`</span><span class="at">Treatment B</span><span class="st">`</span>)) <span class="sc">/</span> </span>
<span id="cb702-4741"><a href="#cb702-4741" aria-hidden="true" tabindex="-1"></a>        <span class="fu">sqrt</span>((<span class="fu">sd</span>(Baseline)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">sd</span>(<span class="st">`</span><span class="at">Treatment B</span><span class="st">`</span>)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb702-4742"><a href="#cb702-4742" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb702-4743"><a href="#cb702-4743" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(d)</span>
<span id="cb702-4744"><a href="#cb702-4744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4745"><a href="#cb702-4745" aria-hidden="true" tabindex="-1"></a>effect_summary <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb702-4746"><a href="#cb702-4746" aria-hidden="true" tabindex="-1"></a>  <span class="at">Comparison =</span> <span class="fu">c</span>(<span class="st">"Treatment A vs Baseline"</span>, <span class="st">"Treatment B vs Baseline"</span>),</span>
<span id="cb702-4747"><a href="#cb702-4747" aria-hidden="true" tabindex="-1"></a>  <span class="at">d =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>, treat_b_vs_baseline),  <span class="co"># Negative = improvement</span></span>
<span id="cb702-4748"><a href="#cb702-4748" aria-hidden="true" tabindex="-1"></a>  <span class="at">ci_lower =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.1</span>, treat_b_vs_baseline <span class="sc">-</span> <span class="fl">0.6</span>),</span>
<span id="cb702-4749"><a href="#cb702-4749" aria-hidden="true" tabindex="-1"></a>  <span class="at">ci_upper =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, treat_b_vs_baseline <span class="sc">+</span> <span class="fl">0.6</span>)</span>
<span id="cb702-4750"><a href="#cb702-4750" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb702-4751"><a href="#cb702-4751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4752"><a href="#cb702-4752" aria-hidden="true" tabindex="-1"></a>panel_c <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(effect_summary, <span class="fu">aes</span>(<span class="at">x =</span> Comparison, <span class="at">y =</span> d)) <span class="sc">+</span></span>
<span id="cb702-4753"><a href="#cb702-4753" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb702-4754"><a href="#cb702-4754" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb702-4755"><a href="#cb702-4755" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> ci_lower, <span class="at">ymax =</span> ci_upper), </span>
<span id="cb702-4756"><a href="#cb702-4756" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb702-4757"><a href="#cb702-4757" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb702-4758"><a href="#cb702-4758" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">"C. Standardized Effect Sizes"</span>,</span>
<span id="cb702-4759"><a href="#cb702-4759" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"Cohen's d (95% CI)"</span>) <span class="sc">+</span></span>
<span id="cb702-4760"><a href="#cb702-4760" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb702-4761"><a href="#cb702-4761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4762"><a href="#cb702-4762" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine panels</span></span>
<span id="cb702-4763"><a href="#cb702-4763" aria-hidden="true" tabindex="-1"></a>final_figure <span class="ot">&lt;-</span> (panel_a <span class="sc">|</span> panel_b) <span class="sc">/</span> panel_c <span class="sc">+</span></span>
<span id="cb702-4764"><a href="#cb702-4764" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(</span>
<span id="cb702-4765"><a href="#cb702-4765" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Reaction Time Across Experimental Conditions"</span>,</span>
<span id="cb702-4766"><a href="#cb702-4766" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Within-subjects pilot study (N=18)"</span>,</span>
<span id="cb702-4767"><a href="#cb702-4767" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"Red line/points = group means with 95% CIs. Effect sizes calculated as within-subjects Cohen's d."</span>,</span>
<span id="cb702-4768"><a href="#cb702-4768" aria-hidden="true" tabindex="-1"></a>    <span class="at">theme =</span> <span class="fu">theme</span>(</span>
<span id="cb702-4769"><a href="#cb702-4769" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb702-4770"><a href="#cb702-4770" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>)</span>
<span id="cb702-4771"><a href="#cb702-4771" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb702-4772"><a href="#cb702-4772" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb702-4773"><a href="#cb702-4773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4774"><a href="#cb702-4774" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(final_figure)</span>
<span id="cb702-4775"><a href="#cb702-4775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4776"><a href="#cb702-4776" aria-hidden="true" tabindex="-1"></a><span class="co"># Save publication figure</span></span>
<span id="cb702-4777"><a href="#cb702-4777" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"figure_multipanel.png"</span>, final_figure, </span>
<span id="cb702-4778"><a href="#cb702-4778" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">8</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb702-4779"><a href="#cb702-4779" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Multi-panel figure saved as 'figure_multipanel.png'</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb702-4780"><a href="#cb702-4780" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-4781"><a href="#cb702-4781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4782"><a href="#cb702-4782" aria-hidden="true" tabindex="-1"></a>**Checkpoint:** Comprehensive multi-panel figure tells complete story: trajectories, distributions, and effect sizes.</span>
<span id="cb702-4783"><a href="#cb702-4783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4784"><a href="#cb702-4784" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-4785"><a href="#cb702-4785" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4786"><a href="#cb702-4786" aria-hidden="true" tabindex="-1"></a><span class="fu">### Discussion Questions</span></span>
<span id="cb702-4787"><a href="#cb702-4787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4788"><a href="#cb702-4788" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Bars vs Points:** Why are bar charts problematic for small-sample continuous data?</span>
<span id="cb702-4789"><a href="#cb702-4789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4790"><a href="#cb702-4790" aria-hidden="true" tabindex="-1"></a>   *Answer: Bars (1) hide individual data points, (2) imply data start at zero (rarely meaningful for reaction time, test scores, etc.), (3) obscure distributional shape, (4) waste ink on empty space. Points + error bars are more informative.*</span>
<span id="cb702-4791"><a href="#cb702-4791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4792"><a href="#cb702-4792" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**How Many Points:** With n=5, should you show all individual points?</span>
<span id="cb702-4793"><a href="#cb702-4793" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4794"><a href="#cb702-4794" aria-hidden="true" tabindex="-1"></a>   *Answer: Absolutely! With very small n, every observation is influential and readers should see them all. Use jittering to avoid overlap, and consider labeling points or using different symbols.*</span>
<span id="cb702-4795"><a href="#cb702-4795" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4796"><a href="#cb702-4796" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Error Bar Choice:** SE, 95% CI, or SD? Which should you display?</span>
<span id="cb702-4797"><a href="#cb702-4797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4798"><a href="#cb702-4798" aria-hidden="true" tabindex="-1"></a>   *Answer: Prefer 95% CI (matches hypothesis testing, directly interpretable). SD shows data spread (useful for understanding variability). Avoid SE (easily confused with CI, magnitude depends on n).*</span>
<span id="cb702-4799"><a href="#cb702-4799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4800"><a href="#cb702-4800" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Color Considerations:** What color choices improve accessibility?</span>
<span id="cb702-4801"><a href="#cb702-4801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4802"><a href="#cb702-4802" aria-hidden="true" tabindex="-1"></a>   *Answer: Use colorblind-safe palettes (e.g., viridis), ensure sufficient contrast, don't rely solely on color (use shapes/patterns too), test plots in grayscale, consider cultural associations.*</span>
<span id="cb702-4803"><a href="#cb702-4803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4804"><a href="#cb702-4804" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>**Transparency:** How do you communicate small sample limitations visually?</span>
<span id="cb702-4805"><a href="#cb702-4805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4806"><a href="#cb702-4806" aria-hidden="true" tabindex="-1"></a>   *Answer: (1) State n prominently, (2) show wide CIs, (3) display all individual points, (4) avoid over-confident smoothing, (5) use "pilot" or "preliminary" in titles, (6) show effect size uncertainty.*</span>
<span id="cb702-4807"><a href="#cb702-4807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4808"><a href="#cb702-4808" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-4809"><a href="#cb702-4809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4810"><a href="#cb702-4810" aria-hidden="true" tabindex="-1"></a><span class="fu">### Key Takeaways</span></span>
<span id="cb702-4811"><a href="#cb702-4811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4812"><a href="#cb702-4812" aria-hidden="true" tabindex="-1"></a>✓ **Always show individual data points** in small samples (n&lt;30)  </span>
<span id="cb702-4813"><a href="#cb702-4813" aria-hidden="true" tabindex="-1"></a>✓ **Display uncertainty** with confidence intervals, not just SEs  </span>
<span id="cb702-4814"><a href="#cb702-4814" aria-hidden="true" tabindex="-1"></a>✓ **Avoid bar charts** for continuous data – prefer points or boxes  </span>
<span id="cb702-4815"><a href="#cb702-4815" aria-hidden="true" tabindex="-1"></a>✓ **Within-subjects designs**: show individual trajectories  </span>
<span id="cb702-4816"><a href="#cb702-4816" aria-hidden="true" tabindex="-1"></a>✓ **State sample size** prominently in title, subtitle, or annotations  </span>
<span id="cb702-4817"><a href="#cb702-4817" aria-hidden="true" tabindex="-1"></a>✓ **Use professional styling** – clear labels, readable fonts, appropriate colors  </span>
<span id="cb702-4818"><a href="#cb702-4818" aria-hidden="true" tabindex="-1"></a>✓ **Multi-panel figures** tell richer stories than single plots  </span>
<span id="cb702-4819"><a href="#cb702-4819" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4820"><a href="#cb702-4820" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-4821"><a href="#cb702-4821" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4822"><a href="#cb702-4822" aria-hidden="true" tabindex="-1"></a><span class="fu">### Homework Exercise</span></span>
<span id="cb702-4823"><a href="#cb702-4823" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4824"><a href="#cb702-4824" aria-hidden="true" tabindex="-1"></a>**Dataset:** A pilot cognitive training study (n=15) with pre- and post-test scores.</span>
<span id="cb702-4825"><a href="#cb702-4825" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4826"><a href="#cb702-4826" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lab12-homework-data}</span></span>
<span id="cb702-4827"><a href="#cb702-4827" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">987</span>)</span>
<span id="cb702-4828"><a href="#cb702-4828" aria-hidden="true" tabindex="-1"></a>training_study <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb702-4829"><a href="#cb702-4829" aria-hidden="true" tabindex="-1"></a>  <span class="at">participant_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>,</span>
<span id="cb702-4830"><a href="#cb702-4830" aria-hidden="true" tabindex="-1"></a>  <span class="at">age =</span> <span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="dv">15</span>, <span class="dv">28</span>, <span class="dv">5</span>)),</span>
<span id="cb702-4831"><a href="#cb702-4831" aria-hidden="true" tabindex="-1"></a>  <span class="at">pretest =</span> <span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="dv">15</span>, <span class="dv">60</span>, <span class="dv">10</span>)),</span>
<span id="cb702-4832"><a href="#cb702-4832" aria-hidden="true" tabindex="-1"></a>  <span class="at">posttest =</span> <span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="dv">15</span>, <span class="dv">72</span>, <span class="dv">12</span>))</span>
<span id="cb702-4833"><a href="#cb702-4833" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb702-4834"><a href="#cb702-4834" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb702-4835"><a href="#cb702-4835" aria-hidden="true" tabindex="-1"></a>    <span class="at">gain =</span> posttest <span class="sc">-</span> pretest,</span>
<span id="cb702-4836"><a href="#cb702-4836" aria-hidden="true" tabindex="-1"></a>    <span class="at">percent_gain =</span> (gain <span class="sc">/</span> pretest) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb702-4837"><a href="#cb702-4837" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb702-4838"><a href="#cb702-4838" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb702-4839"><a href="#cb702-4839" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4840"><a href="#cb702-4840" aria-hidden="true" tabindex="-1"></a>**Your Tasks:**</span>
<span id="cb702-4841"><a href="#cb702-4841" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4842"><a href="#cb702-4842" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Create a "bad" visualization (bar chart hiding data) and a "good" visualization (showing individual points)</span>
<span id="cb702-4843"><a href="#cb702-4843" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Make a paired scatter plot (pretest vs posttest) with identity line</span>
<span id="cb702-4844"><a href="#cb702-4844" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Create a trajectory plot showing individual pre-to-post changes</span>
<span id="cb702-4845"><a href="#cb702-4845" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Generate a raincloud plot for the gain scores</span>
<span id="cb702-4846"><a href="#cb702-4846" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>Make a plot emphasizing uncertainty (show 80%, 90%, 95% CIs)</span>
<span id="cb702-4847"><a href="#cb702-4847" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span>Calculate Cohen's d for pre-post difference and create a forest plot</span>
<span id="cb702-4848"><a href="#cb702-4848" aria-hidden="true" tabindex="-1"></a><span class="ss">7. </span>Create a multi-panel figure combining: (A) trajectories, (B) gain distribution, (C) effect size</span>
<span id="cb702-4849"><a href="#cb702-4849" aria-hidden="true" tabindex="-1"></a><span class="ss">8. </span>Apply publication-ready formatting (clear labels, professional theme, sample size annotation)</span>
<span id="cb702-4850"><a href="#cb702-4850" aria-hidden="true" tabindex="-1"></a><span class="ss">9. </span>Save the final figure as high-resolution PNG (300 dpi)</span>
<span id="cb702-4851"><a href="#cb702-4851" aria-hidden="true" tabindex="-1"></a><span class="ss">10. </span>Write a figure caption describing what is shown</span>
<span id="cb702-4852"><a href="#cb702-4852" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4853"><a href="#cb702-4853" aria-hidden="true" tabindex="-1"></a>**Expected Results:**</span>
<span id="cb702-4854"><a href="#cb702-4854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4855"><a href="#cb702-4855" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Significant pre-post improvement (gain ~10-15 points)</span>
<span id="cb702-4856"><a href="#cb702-4856" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Wide CIs reflecting small sample (n=15)</span>
<span id="cb702-4857"><a href="#cb702-4857" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Most individuals improve (but show variability)</span>
<span id="cb702-4858"><a href="#cb702-4858" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Cohen's d approximately 0.8-1.2 (large effect)</span>
<span id="cb702-4859"><a href="#cb702-4859" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Publication figure should be clear, honest, and professional</span>
<span id="cb702-4860"><a href="#cb702-4860" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4861"><a href="#cb702-4861" aria-hidden="true" tabindex="-1"></a>**Hints:**</span>
<span id="cb702-4862"><a href="#cb702-4862" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Use <span class="in">`geom_segment()`</span> or <span class="in">`geom_line()`</span> for trajectory plots</span>
<span id="cb702-4863"><a href="#cb702-4863" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>For paired scatter: <span class="in">`geom_abline(slope=1, intercept=0)`</span> for identity line</span>
<span id="cb702-4864"><a href="#cb702-4864" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Use <span class="in">`patchwork`</span> to combine plots: <span class="in">`plot_a | plot_b`</span> or <span class="in">`plot_a / plot_b`</span></span>
<span id="cb702-4865"><a href="#cb702-4865" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Add n to subtitle: <span class="in">`subtitle = "Pilot cognitive training study (N=15)"`</span></span>
<span id="cb702-4866"><a href="#cb702-4866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4867"><a href="#cb702-4867" aria-hidden="true" tabindex="-1"></a>**Bonus:** Create an animated version showing the transition from pretest to posttest using <span class="in">`gganimate`</span>. This can effectively communicate within-subjects change even in presentations. Export as GIF or MP4.</span>
<span id="cb702-4868"><a href="#cb702-4868" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4869"><a href="#cb702-4869" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb702-4870"><a href="#cb702-4870" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb702-4871"><a href="#cb702-4871" aria-hidden="true" tabindex="-1"></a>*Congratulations! You've completed all 12 guided lab practicals covering essential statistical techniques for small-sample research. These hands-on exercises complement the theoretical content throughout the book and prepare you for real-world data analysis challenges.*</span>
</code></pre></div><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>